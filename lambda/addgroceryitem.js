!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=286)}([function(e,t,r){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};Object.assign;r.d(t,"e",function(){return o}),r.d(t,"f",function(){return s}),r.d(t,"g",function(){return c}),r.d(t,"h",function(){return u}),r.d(t,"a",function(){return i}),r.d(t,"l",function(){return h}),r.d(t,"m",function(){return p}),r.d(t,"D",function(){return f}),r.d(t,"b",function(){return d}),r.d(t,"x",function(){return g}),r.d(t,"y",function(){return y}),r.d(t,"z",function(){return m}),r.d(t,"c",function(){return E}),r.d(t,"B",function(){return C}),r.d(t,"I",function(){return w}),r.d(t,"v",function(){return A}),r.d(t,"A",function(){return T}),r.d(t,"i",function(){return R}),r.d(t,"j",function(){return I}),r.d(t,"o",function(){return U}),r.d(t,"p",function(){return D}),r.d(t,"q",function(){return P}),r.d(t,"r",function(){return k}),r.d(t,"s",function(){return L}),r.d(t,"t",function(){return x}),r.d(t,"u",function(){return j}),r.d(t,"w",function(){return O}),r.d(t,"C",function(){return B}),r.d(t,"F",function(){return N}),r.d(t,"E",function(){return M}),r.d(t,"d",function(){return F}),r.d(t,"k",function(){return V}),r.d(t,"n",function(){return G}),r.d(t,"J",function(){return H}),r.d(t,"K",function(){return z}),r.d(t,"L",function(){return W}),r.d(t,"G",function(){return Q}),r.d(t,"H",function(){return Y});var i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},a=function(e){for(var t=[],r=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[],i=0;i<e.length;i+=3){var o=e[i],s=i+1<e.length,a=s?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,l=o>>2,h=(3&o)<<4|a>>4,p=(15&a)<<2|u>>6,f=63&u;c||(f=64,s||(p=64)),n.push(r[l],r[h],r[p],r[f])}return n.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],r=0,n=0;r<e.length;){var i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=e[r++]))<<12|(63&(a=e[r++]))<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{o=e[r++];var a=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[],i=0;i<e.length;){var o=r[e.charAt(i++)],s=i<e.length?r[e.charAt(i)]:0,a=++i<e.length?r[e.charAt(i)]:64,c=++i<e.length?r[e.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==c)throw Error();var u=o<<2|s>>4;if(n.push(u),64!=a){var l=s<<4&240|a>>2;if(n.push(l),64!=c){var h=a<<6&192|c;n.push(h)}}}return n},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},u=function(e){var t=a(e);return c.encodeByteArray(t,!0)},l=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function h(e){return p(void 0,e)}function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&(e[r]=p(e[r],t[r]));return e}function f(e,t,r){e[t]=r}var d=function(){function e(){var e=this;this.promise=new Promise(function(t,r){e.resolve=t,e.reject=r})}return e.prototype.wrapCallback=function(e){var t=this;return function(r,n){r?t.reject(r):t.resolve(n),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(r):e(r,n))}},e}(),g=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")},m=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},y=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},v="FirebaseError",b=Error.captureStackTrace;var _=function(){return function(e,t){if(this.code=e,this.message=t,b)b(this,E.prototype.create);else try{throw Error.apply(this,arguments)}catch(e){this.name=v,Object.defineProperty(this,"stack",{get:function(){return e.stack}})}}}();_.prototype=Object.create(Error.prototype),_.prototype.constructor=_,_.prototype.name=v;var E=function(){function e(e,t,r){this.service=e,this.serviceName=t,this.errors=r,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var r,n=this.errors[e],i=this.service+"/"+e;r=void 0===n?"Error":n.replace(this.pattern,function(e,r){var n=t[r];return void 0!==n?n.toString():"<"+r+"?>"}),r=this.serviceName+": "+r+" ("+i+").";var o=new _(i,r);for(var s in t)t.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(o[s]=t[s]);return o},e}();function C(e){return JSON.parse(e)}function w(e){return JSON.stringify(e)}var S=function(e){var t={},r={},n={},i="";try{var o=e.split(".");t=C(l(o[0])||""),r=C(l(o[1])||""),i=o[2],n=r.d||{},delete r.d}catch(e){}return{header:t,claims:r,data:n,signature:i}},T=function(e){var t=S(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},A=function(e){var t=S(e).claims;return"object"==typeof t&&!0===t.admin},I=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},N=function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},k=function(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])},R=function(e){return t={},k(e,function(e,r){t[e]=r}),t;var t},O=function(e){for(var t in e)return!1;return!0},x=function(e){var t=0;for(var r in e)t++;return t},B=function(e,t,r){var n={};for(var i in e)n[i]=t.call(r,e[i],i,e);return n},D=function(e,t,r){for(var n in e)if(t.call(r,e[n],n,e))return n},P=function(e,t,r){var n=D(e,t,r);return n&&e[n]},L=function(e){for(var t in e)return t},j=function(e){var t=[],r=0;for(var n in e)t[r++]=e[n];return t},U=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&!t(r,e[r]))return!1;return!0},M=function(e){var t=[];return k(e,function(e,r){Array.isArray(r)?r.forEach(function(r){t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}),t.length?"&"+t.join("&"):""},F=function(e){function t(){var t=e.call(this)||this;t.chain_=[],t.buf_=[],t.W_=[],t.pad_=[],t.inbuf_=0,t.total_=0,t.blockSize=64,t.pad_[0]=128;for(var r=1;r<t.blockSize;++r)t.pad_[r]=0;return t.reset(),t}return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(e,t){t||(t=0);var r=this.W_;if("string"==typeof e)for(var n=0;n<16;n++)r[n]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(n=0;n<16;n++)r[n]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(n=16;n<80;n++){var i=r[n-3]^r[n-8]^r[n-14]^r[n-16];r[n]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(n=0;n<80;n++){n<40?n<20?(o=l^c&(u^l),s=1518500249):(o=c^u^l,s=1859775393):n<60?(o=c&u|l&(c|u),s=2400959708):(o=c^u^l,s=3395469782);i=(a<<5|a>>>27)+o+h+s+r[n]&4294967295;h=l,l=u,u=4294967295&(c<<30|c>>>2),c=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var r=t-this.blockSize,n=0,i=this.buf_,o=this.inbuf_;n<t;){if(0==o)for(;n<=r;)this.compress_(e,n),n+=this.blockSize;if("string"==typeof e){for(;n<t;)if(i[o]=e.charCodeAt(n),++n,++o==this.blockSize){this.compress_(i),o=0;break}}else for(;n<t;)if(i[o]=e[n],++n,++o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},t.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);var n=0;for(r=0;r<5;r++)for(var i=24;i>=0;i-=8)e[n]=this.chain_[r]>>i&255,++n;return e},t}(function(){return function(){this.blockSize=-1}}());function V(e,t){var r=new q(e,t);return r.subscribe.bind(r)}var q=function(){function e(e,t){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(r)}).catch(function(e){r.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,r){var n,i=this;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");void 0===(n=function(e,t){if("object"!=typeof e||null===e)return!1;for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r}).next&&(n.next=K),void 0===n.error&&(n.error=K),void 0===n.complete&&(n.complete=K);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?n.error(i.finalError):n.complete()}catch(e){}}),this.observers.push(n),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var r=this;this.task.then(function(){if(void 0!==r.observers&&void 0!==r.observers[e])try{t(r.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();function K(){}var H=function(e,t,r,n){var i;if(n<t?i="at least "+t:n>r&&(i=0===r?"none":"no more than "+r),i)throw new Error(e+" failed: Was called with "+n+(1===n?" argument.":" arguments.")+" Expects "+i+".")};function G(e,t,r){var n="";switch(t){case 1:n=r?"first":"First";break;case 2:n=r?"second":"Second";break;case 3:n=r?"third":"Third";break;case 4:n=r?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=n+" argument "}function z(e,t,r,n){if((!n||r)&&"function"!=typeof r)throw new Error(G(e,t,n)+"must be a valid function.")}function W(e,t,r,n){if((!n||r)&&("object"!=typeof r||null===r))throw new Error(G(e,t,n)+"must be a valid context object.")}var Y=function(e){for(var t=[],r=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);if(i>=55296&&i<=56319){var s=i-55296;o(++n<e.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(e.charCodeAt(n)-56320)}i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):i<65536?(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t},Q=function(e){for(var t=0,r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t++:n<2048?t+=2:n>=55296&&n<=56319?(t+=4,r++):t+=3}return t}},function(e,t,r){"use strict";var n=r(41),i=r(81),o=Object.prototype.toString;function s(e){return"[object Array]"===o.call(e)}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===o.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:i,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,i=arguments.length;n<i;n++)u(arguments[n],r);return t},extend:function(e,t,r){return u(t,function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t){e.exports={options:{usePureJavaScript:!1}}},function(e,t){e.exports={options:{usePureJavaScript:!1}}},function(e,t){e.exports=require("util")},function(e,t,r){var n=r(2),i=r(292),o=e.exports=n.util=n.util||{};function s(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function a(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(o.isArrayBuffer(e)||o.isArrayBufferView(e))if("undefined"!=typeof Buffer&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof a||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if("undefined"!=typeof process&&process.nextTick)return o.nextTick=process.nextTick,void("function"==typeof setImmediate?o.setImmediate=setImmediate:o.setImmediate=o.nextTick);if("function"==typeof setImmediate)return o.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(o.nextTick=function(e){return setImmediate(e)});if(o.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",t=[];o.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",function(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach(function(e){e()})}},!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),n=!0,i=document.createElement("div");t=[];new MutationObserver(function(){var e=t.slice();t.length=0,e.forEach(function(e){e()})}).observe(i,{attributes:!0});var s=o.setImmediate;o.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),s(e)):(t.push(e),1===t.length&&i.setAttribute("a",n=!n))}}o.nextTick=o.setImmediate}(),o.isNodejs="undefined"!=typeof process&&process.versions&&process.versions.node,o.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},o.isArrayBufferView=function(e){return e&&o.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},o.ByteBuffer=a,o.ByteStringBuffer=a;o.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},o.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},o.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},o.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},o.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},o.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},o.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(o.encodeUtf8(e))},o.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},o.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},o.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},o.ByteStringBuffer.prototype.putInt=function(e,t){s(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},o.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},o.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},o.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},o.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},o.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},o.ByteStringBuffer.prototype.getInt=function(e){s(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},o.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},o.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},o.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},o.ByteStringBuffer.prototype.copy=function(){var e=o.createBuffer(this.data);return e.read=this.read,e},o.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},o.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},o.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},o.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.ByteStringBuffer.prototype.toString=function(){return o.decodeUtf8(this.bytes())},o.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=o.isArrayBuffer(e),n=o.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},o.DataBuffer.prototype.length=function(){return this.write-this.read},o.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},o.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},o.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},o.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},o.DataBuffer.prototype.putBytes=function(e,t){if(o.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(o.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof o.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&o.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof o.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=o.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=o.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},o.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},o.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},o.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},o.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},o.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},o.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},o.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},o.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},o.DataBuffer.prototype.putInt=function(e,t){s(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},o.DataBuffer.prototype.putSignedInt=function(e,t){return s(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},o.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},o.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},o.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},o.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},o.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},o.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},o.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},o.DataBuffer.prototype.getInt=function(e){s(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},o.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},o.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},o.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},o.DataBuffer.prototype.copy=function(){return new o.DataBuffer(this)},o.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},o.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},o.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},o.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return o.binary.raw.encode(t);if("hex"===e)return o.binary.hex.encode(t);if("base64"===e)return o.binary.base64.encode(t);if("utf8"===e)return o.text.utf8.decode(t);if("utf16"===e)return o.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},o.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=o.encodeUtf8(e)),new o.ByteBuffer(e)},o.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},o.xorBytes=function(e,t,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o},o.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},o.bytesToHex=function(e){return o.createBuffer(e).toHex()},o.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";o.encode64=function(e,t){for(var r,n,i,o="",s="",a=0;a<e.length;)r=e.charCodeAt(a++),n=e.charCodeAt(a++),i=e.charCodeAt(a++),o+=c.charAt(r>>2),o+=c.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=c.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":c.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},o.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,o="",s=0;s<e.length;)t=u[e.charCodeAt(s++)-43],r=u[e.charCodeAt(s++)-43],n=u[e.charCodeAt(s++)-43],i=u[e.charCodeAt(s++)-43],o+=String.fromCharCode(t<<2|r>>4),64!==n&&(o+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(o+=String.fromCharCode((3&n)<<6|i)));return o},o.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},o.decodeUtf8=function(e){return decodeURIComponent(escape(e))},o.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:i.encode,decode:i.decode}},o.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},o.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},o.binary.hex.encode=o.bytesToHex,o.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,o=r=r||0;for(1&e.length&&(i=1,n[o++]=parseInt(e[0],16));i<e.length;i+=2)n[o++]=parseInt(e.substr(i,2),16);return t?o-r:n},o.binary.base64.encode=function(e,t){for(var r,n,i,o="",s="",a=0;a<e.byteLength;)r=e[a++],n=e[a++],i=e[a++],o+=c.charAt(r>>2),o+=c.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=c.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":c.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},o.binary.base64.decode=function(e,t,r){var n,i,o,s,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c=0,l=r=r||0;c<e.length;)n=u[e.charCodeAt(c++)-43],i=u[e.charCodeAt(c++)-43],o=u[e.charCodeAt(c++)-43],s=u[e.charCodeAt(c++)-43],a[l++]=n<<2|i>>4,64!==o&&(a[l++]=(15&i)<<4|o>>2,64!==s&&(a[l++]=(3&o)<<6|s));return t?l-r:a.subarray(0,l)},o.binary.base58.encode=function(e,t){return o.binary.baseN.encode(e,l,t)},o.binary.base58.decode=function(e,t){return o.binary.baseN.decode(e,l,t)},o.text={utf8:{},utf16:{}},o.text.utf8.encode=function(e,t,r){e=o.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n},o.text.utf8.decode=function(e){return o.decodeUtf8(String.fromCharCode.apply(null,e))},o.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),o=r=r||0,s=r,a=0;a<e.length;++a)i[s++]=e.charCodeAt(a),o+=2;return t?o-r:n},o.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},o.deflate=function(e,t,r){if(t=o.decode64(e.deflate(o.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},o.inflate=function(e,t,r){var n=e.inflate(o.encode64(t)).rval;return null===n?null:o.decode64(n)};var h=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=o.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},p=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(o.decode64(r))),r},f=function(e,t,r,n){var i=p(e,t);null===i&&(i={}),i[r]=n,h(e,t,i)},d=function(e,t,r){var n=p(e,t);return null!==n&&(n=r in n?n[r]:null),n},g=function(e,t,r){var n=p(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),h(e,t,n)}},m=function(e,t){h(e,t,null)},y=function(e,t,r){var n,i=null;void 0===r&&(r=["web","flash"]);var o=!1,s=null;for(var a in r){n=r[a];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),o="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),o=!0)}catch(e){s=e}if(o)break}if(!o)throw s;return i};o.setItem=function(e,t,r,n,i){y(f,arguments,i)},o.getItem=function(e,t,r,n){return y(d,arguments,n)},o.removeItem=function(e,t,r,n){y(g,arguments,n)},o.clearItems=function(e,t,r){y(m,arguments,r)},o.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?80!==n.port&&"http"===n.scheme?n.fullHost+=":"+n.port:443!==n.port&&"https"===n.scheme&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var v=null;o.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),n=0;n<r.length;n++){var i,o,s=r[n].indexOf("=");s>0?(i=r[n].substring(0,s),o=r[n].substring(s+1)):(i=r[n],o=null),i in t||(t[i]=[]),i in Object.prototype||null===o||t[i].push(unescape(o))}return t};return void 0===e?(null===v&&(v="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),t=v):t=r(e),t},o.parseFragment=function(e){var t=e,r="",n=e.indexOf("?");n>0&&(t=e.substring(0,n),r=e.substring(n+1));var i=t.split("/");return i.length>0&&""===i[0]&&i.shift(),{pathString:t,queryString:r,path:i,query:""===r?{}:o.getQueryVariables(r)}},o.makeRequest=function(e){var t=o.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return void 0===e?t.path:t.path[e]},getQuery:function(e,r){var n;return void 0===e?n=t.query:(n=t.query[e])&&void 0!==r&&(n=n[r]),n},getQueryLast:function(e,t){var n=r.getQuery(e);return n?n[n.length-1]:t}};return r},o.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},o.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var n=0,i=t.length;n<i;){var o=t[n++];if(n==i)e[o]=r;else{var s=o in e;(!s||s&&"object"!=typeof e[o]||s&&null===e[o])&&(e[o]={}),e=e[o]}}},o.getPath=function(e,t,r){for(var n=0,i=t.length,o=!0;o&&n<i&&"object"==typeof e&&null!==e;){var s=t[n++];(o=s in e)&&(e=e[s])}return o?e:r},o.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,n=t.length;r<n;){var i=t[r++];if(r==n)delete e[i];else{if(!(i in e)||"object"!=typeof e[i]||null===e[i])break;e=e[i]}}},o.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},o.format=function(e){for(var t,r,n=/%./g,i=0,o=[],s=0;t=n.exec(e);){(r=e.substring(s,n.lastIndex-2)).length>0&&o.push(r),s=n.lastIndex;var a=t[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[1+i++]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(e.substring(s)),o.join("")},o.formatNumber=function(e,t,r,n){var i=e,o=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,a=void 0===n?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-u).toFixed(o).slice(2):"")},o.formatSize=function(e){return e=e>=1073741824?o.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?o.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?o.formatNumber(e/1024,0)+" KiB":o.formatNumber(e,0)+" bytes"},o.bytesFromIP=function(e){return-1!==e.indexOf(".")?o.bytesFromIPv4(e):-1!==e.indexOf(":")?o.bytesFromIPv6(e):null},o.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=o.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},o.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter(function(e){return 0===e.length&&++t,!0})).length+t),n=o.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var s=o.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}else n.fillWithByte(0,r),r=0;return n.getBytes()},o.bytesToIP=function(e){return 4===e.length?o.bytesToIPv4(e):16===e.length?o.bytesToIPv6(e):null},o.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},o.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=o.bytesToHex(e[i]+e[i+1]);"0"===s[0]&&"0"!==s;)s=s.substr(1);if("0"===s){var a=r[r.length-1],c=t.length;a&&c===a.end+1?(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:c,end:c})}t.push(s)}if(r.length>0){var u=r[n];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),0===u.start&&t.unshift(""),7===u.end&&t.push(""))}return t.join(":")},o.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in o&&!e.update)return t(null,o.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return o.cores=navigator.hardwareConcurrency,t(null,o.cores);if("undefined"==typeof Worker)return o.cores=1,t(null,o.cores);if("undefined"==typeof Blob)return o.cores=2,t(null,o.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));!function e(n,i,s){if(0===i){var a=Math.floor(n.reduce(function(e,t){return e+t},0)/n.length);return o.cores=Math.max(1,a),URL.revokeObjectURL(r),t(null,o.cores)}!function(e,t){for(var n=[],i=[],o=0;o<e;++o){var s=new Worker(r);s.addEventListener("message",function(r){if(i.push(r.data),i.length===e){for(var o=0;o<e;++o)n[o].terminate();t(null,i)}}),n.push(s)}for(var o=0;o<e;++o)n[o].postMessage(o)}(s,function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],o=r[n]=[],s=0;s<e;++s)if(n!==s){var a=t[s];(i.st>a.st&&i.st<a.et||a.st>i.st&&a.st<i.et)&&o.push(s)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}(s,r)),e(n,i-1,s)})}([],5,16)}},function(e,t,r){var n=r(3),i=r(388),o=e.exports=n.util=n.util||{};function s(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function a(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(o.isArrayBuffer(e)||o.isArrayBufferView(e))if("undefined"!=typeof Buffer&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof a||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if("undefined"!=typeof process&&process.nextTick&&!process.browser)return o.nextTick=process.nextTick,void("function"==typeof setImmediate?o.setImmediate=setImmediate:o.setImmediate=o.nextTick);if("function"==typeof setImmediate)return o.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(o.nextTick=function(e){return setImmediate(e)});if(o.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",t=[];o.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",function(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach(function(e){e()})}},!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),n=!0,i=document.createElement("div");t=[];new MutationObserver(function(){var e=t.slice();t.length=0,e.forEach(function(e){e()})}).observe(i,{attributes:!0});var s=o.setImmediate;o.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),s(e)):(t.push(e),1===t.length&&i.setAttribute("a",n=!n))}}o.nextTick=o.setImmediate}(),o.isNodejs="undefined"!=typeof process&&process.versions&&process.versions.node,o.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},o.isArrayBufferView=function(e){return e&&o.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},o.ByteBuffer=a,o.ByteStringBuffer=a;o.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},o.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},o.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},o.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},o.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},o.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},o.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(o.encodeUtf8(e))},o.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},o.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},o.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},o.ByteStringBuffer.prototype.putInt=function(e,t){s(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},o.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},o.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},o.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},o.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},o.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},o.ByteStringBuffer.prototype.getInt=function(e){s(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},o.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},o.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},o.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},o.ByteStringBuffer.prototype.copy=function(){var e=o.createBuffer(this.data);return e.read=this.read,e},o.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},o.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},o.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},o.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.ByteStringBuffer.prototype.toString=function(){return o.decodeUtf8(this.bytes())},o.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=o.isArrayBuffer(e),n=o.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},o.DataBuffer.prototype.length=function(){return this.write-this.read},o.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},o.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},o.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},o.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},o.DataBuffer.prototype.putBytes=function(e,t){if(o.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(o.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof o.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&o.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof o.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=o.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=o.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},o.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},o.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},o.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},o.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},o.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},o.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},o.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},o.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},o.DataBuffer.prototype.putInt=function(e,t){s(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},o.DataBuffer.prototype.putSignedInt=function(e,t){return s(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},o.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},o.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},o.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},o.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},o.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},o.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},o.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},o.DataBuffer.prototype.getInt=function(e){s(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},o.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},o.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},o.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},o.DataBuffer.prototype.copy=function(){return new o.DataBuffer(this)},o.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},o.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},o.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},o.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return o.binary.raw.encode(t);if("hex"===e)return o.binary.hex.encode(t);if("base64"===e)return o.binary.base64.encode(t);if("utf8"===e)return o.text.utf8.decode(t);if("utf16"===e)return o.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},o.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=o.encodeUtf8(e)),new o.ByteBuffer(e)},o.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},o.xorBytes=function(e,t,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o},o.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},o.bytesToHex=function(e){return o.createBuffer(e).toHex()},o.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";o.encode64=function(e,t){for(var r,n,i,o="",s="",a=0;a<e.length;)r=e.charCodeAt(a++),n=e.charCodeAt(a++),i=e.charCodeAt(a++),o+=c.charAt(r>>2),o+=c.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=c.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":c.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},o.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,o="",s=0;s<e.length;)t=u[e.charCodeAt(s++)-43],r=u[e.charCodeAt(s++)-43],n=u[e.charCodeAt(s++)-43],i=u[e.charCodeAt(s++)-43],o+=String.fromCharCode(t<<2|r>>4),64!==n&&(o+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(o+=String.fromCharCode((3&n)<<6|i)));return o},o.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},o.decodeUtf8=function(e){return decodeURIComponent(escape(e))},o.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:i.encode,decode:i.decode}},o.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},o.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},o.binary.hex.encode=o.bytesToHex,o.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,o=r=r||0;for(1&e.length&&(i=1,n[o++]=parseInt(e[0],16));i<e.length;i+=2)n[o++]=parseInt(e.substr(i,2),16);return t?o-r:n},o.binary.base64.encode=function(e,t){for(var r,n,i,o="",s="",a=0;a<e.byteLength;)r=e[a++],n=e[a++],i=e[a++],o+=c.charAt(r>>2),o+=c.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=c.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":c.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},o.binary.base64.decode=function(e,t,r){var n,i,o,s,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c=0,l=r=r||0;c<e.length;)n=u[e.charCodeAt(c++)-43],i=u[e.charCodeAt(c++)-43],o=u[e.charCodeAt(c++)-43],s=u[e.charCodeAt(c++)-43],a[l++]=n<<2|i>>4,64!==o&&(a[l++]=(15&i)<<4|o>>2,64!==s&&(a[l++]=(3&o)<<6|s));return t?l-r:a.subarray(0,l)},o.binary.base58.encode=function(e,t){return o.binary.baseN.encode(e,l,t)},o.binary.base58.decode=function(e,t){return o.binary.baseN.decode(e,l,t)},o.text={utf8:{},utf16:{}},o.text.utf8.encode=function(e,t,r){e=o.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n},o.text.utf8.decode=function(e){return o.decodeUtf8(String.fromCharCode.apply(null,e))},o.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),o=r=r||0,s=r,a=0;a<e.length;++a)i[s++]=e.charCodeAt(a),o+=2;return t?o-r:n},o.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},o.deflate=function(e,t,r){if(t=o.decode64(e.deflate(o.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},o.inflate=function(e,t,r){var n=e.inflate(o.encode64(t)).rval;return null===n?null:o.decode64(n)};var h=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=o.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},p=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(o.decode64(r))),r},f=function(e,t,r,n){var i=p(e,t);null===i&&(i={}),i[r]=n,h(e,t,i)},d=function(e,t,r){var n=p(e,t);return null!==n&&(n=r in n?n[r]:null),n},g=function(e,t,r){var n=p(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),h(e,t,n)}},m=function(e,t){h(e,t,null)},y=function(e,t,r){var n,i=null;void 0===r&&(r=["web","flash"]);var o=!1,s=null;for(var a in r){n=r[a];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),o="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),o=!0)}catch(e){s=e}if(o)break}if(!o)throw s;return i};o.setItem=function(e,t,r,n,i){y(f,arguments,i)},o.getItem=function(e,t,r,n){return y(d,arguments,n)},o.removeItem=function(e,t,r,n){y(g,arguments,n)},o.clearItems=function(e,t,r){y(m,arguments,r)},o.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?80!==n.port&&"http"===n.scheme?n.fullHost+=":"+n.port:443!==n.port&&"https"===n.scheme&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var v=null;o.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),n=0;n<r.length;n++){var i,o,s=r[n].indexOf("=");s>0?(i=r[n].substring(0,s),o=r[n].substring(s+1)):(i=r[n],o=null),i in t||(t[i]=[]),i in Object.prototype||null===o||t[i].push(unescape(o))}return t};return void 0===e?(null===v&&(v="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),t=v):t=r(e),t},o.parseFragment=function(e){var t=e,r="",n=e.indexOf("?");n>0&&(t=e.substring(0,n),r=e.substring(n+1));var i=t.split("/");return i.length>0&&""===i[0]&&i.shift(),{pathString:t,queryString:r,path:i,query:""===r?{}:o.getQueryVariables(r)}},o.makeRequest=function(e){var t=o.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return void 0===e?t.path:t.path[e]},getQuery:function(e,r){var n;return void 0===e?n=t.query:(n=t.query[e])&&void 0!==r&&(n=n[r]),n},getQueryLast:function(e,t){var n=r.getQuery(e);return n?n[n.length-1]:t}};return r},o.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},o.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var n=0,i=t.length;n<i;){var o=t[n++];if(n==i)e[o]=r;else{var s=o in e;(!s||s&&"object"!=typeof e[o]||s&&null===e[o])&&(e[o]={}),e=e[o]}}},o.getPath=function(e,t,r){for(var n=0,i=t.length,o=!0;o&&n<i&&"object"==typeof e&&null!==e;){var s=t[n++];(o=s in e)&&(e=e[s])}return o?e:r},o.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,n=t.length;r<n;){var i=t[r++];if(r==n)delete e[i];else{if(!(i in e)||"object"!=typeof e[i]||null===e[i])break;e=e[i]}}},o.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},o.format=function(e){for(var t,r,n=/%./g,i=0,o=[],s=0;t=n.exec(e);){(r=e.substring(s,n.lastIndex-2)).length>0&&o.push(r),s=n.lastIndex;var a=t[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[1+i++]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(e.substring(s)),o.join("")},o.formatNumber=function(e,t,r,n){var i=e,o=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,a=void 0===n?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-u).toFixed(o).slice(2):"")},o.formatSize=function(e){return e=e>=1073741824?o.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?o.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?o.formatNumber(e/1024,0)+" KiB":o.formatNumber(e,0)+" bytes"},o.bytesFromIP=function(e){return-1!==e.indexOf(".")?o.bytesFromIPv4(e):-1!==e.indexOf(":")?o.bytesFromIPv6(e):null},o.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=o.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},o.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter(function(e){return 0===e.length&&++t,!0})).length+t),n=o.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var s=o.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}else n.fillWithByte(0,r),r=0;return n.getBytes()},o.bytesToIP=function(e){return 4===e.length?o.bytesToIPv4(e):16===e.length?o.bytesToIPv6(e):null},o.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},o.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=o.bytesToHex(e[i]+e[i+1]);"0"===s[0]&&"0"!==s;)s=s.substr(1);if("0"===s){var a=r[r.length-1],c=t.length;a&&c===a.end+1?(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:c,end:c})}t.push(s)}if(r.length>0){var u=r[n];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),0===u.start&&t.unshift(""),7===u.end&&t.push(""))}return t.join(":")},o.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in o&&!e.update)return t(null,o.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return o.cores=navigator.hardwareConcurrency,t(null,o.cores);if("undefined"==typeof Worker)return o.cores=1,t(null,o.cores);if("undefined"==typeof Blob)return o.cores=2,t(null,o.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));!function e(n,i,s){if(0===i){var a=Math.floor(n.reduce(function(e,t){return e+t},0)/n.length);return o.cores=Math.max(1,a),URL.revokeObjectURL(r),t(null,o.cores)}!function(e,t){for(var n=[],i=[],o=0;o<e;++o){var s=new Worker(r);s.addEventListener("message",function(r){if(i.push(r.data),i.length===e){for(var o=0;o<e;++o)n[o].terminate();t(null,i)}}),n.push(s)}for(var o=0;o<e;++o)n[o].postMessage(o)}(s,function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],o=r[n]=[],s=0;s<e;++s)if(n!==s){var a=t[s];(i.st>a.st&&i.st<a.et||a.st>i.st&&a.st<i.et)&&o.push(s)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}(s,r)),e(n,i-1,s)})}([],5,16)}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("stream")},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(39),s=function(e){function t(r){var n=e.call(this,r.message)||this;return n.errorInfo=r,n.__proto__=t.prototype,n}return i(t,e),Object.defineProperty(t.prototype,"code",{get:function(){return this.errorInfo.code},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.errorInfo.message},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{code:this.code,message:this.message}},t}(Error);t.FirebaseError=s;var a=function(e){function t(r,n,i){var o=e.call(this,{code:r+"/"+n,message:i})||this;return o.codePrefix=r,o.__proto__=t.prototype,o}return i(t,e),t.prototype.hasCode=function(e){return this.codePrefix+"/"+e===this.code},t}(s),c=function(e){function t(r,n){var i=e.call(this,"app",r,n)||this;return i.__proto__=t.prototype,i}return i(t,e),t}(a);t.FirebaseAppError=c;var u=function(e){function t(r,n){var i=e.call(this,"auth",r.code,n||r.message)||this;return i.__proto__=t.prototype,i}return i(t,e),t.fromServerError=function(e,r,n){var i=b[e]||"INTERNAL_ERROR",s=o.deepCopy(m[i]);if(s.message=r||s.message,"INTERNAL_ERROR"===i&&void 0!==n)try{s.message+=' Raw server response: "'+JSON.stringify(n)+'"'}catch(e){}return new t(s)},t}(a);t.FirebaseAuthError=u;var l=function(e){function t(t,r){return e.call(this,{code:"database/"+t.code,message:r||t.message})||this}return i(t,e),t}(s);t.FirebaseDatabaseError=l;var h=function(e){function t(t,r){return e.call(this,{code:"firestore/"+t.code,message:r||t.message})||this}return i(t,e),t}(s);t.FirebaseFirestoreError=h;var p=function(e){function t(t,r){return e.call(this,{code:"instance-id/"+t.code,message:r||t.message})||this}return i(t,e),t}(s);t.FirebaseInstanceIdError=p;var f=function(e){function t(r,n){var i=e.call(this,"messaging",r.code,n||r.message)||this;return i.__proto__=t.prototype,i}return i(t,e),t.fromServerError=function(e,r,n){var i=_[e]||"UNKNOWN_ERROR",s=o.deepCopy(y[i]);if(s.message=r||s.message,"UNKNOWN_ERROR"===i&&void 0!==n)try{s.message+=' Raw server response: "'+JSON.stringify(n)+'"'}catch(e){}return new t(s)},t.fromTopicManagementServerError=function(e,r,n){var i=E[e]||"UNKNOWN_ERROR",s=o.deepCopy(y[i]);if(s.message=r||s.message,"UNKNOWN_ERROR"===i&&void 0!==n)try{s.message+=' Raw server response: "'+JSON.stringify(n)+'"'}catch(e){}return new t(s)},t}(a);t.FirebaseMessagingError=f;var d=function(e){function t(t,r){return e.call(this,"project-management",t,r)||this}return i(t,e),t}(a);t.FirebaseProjectManagementError=d;var g=function(){function e(){}return e.APP_DELETED="app-deleted",e.DUPLICATE_APP="duplicate-app",e.INTERNAL_ERROR="internal-error",e.INVALID_APP_NAME="invalid-app-name",e.INVALID_APP_OPTIONS="invalid-app-options",e.INVALID_CREDENTIAL="invalid-credential",e.NETWORK_ERROR="network-error",e.NETWORK_TIMEOUT="network-timeout",e.NO_APP="no-app",e.UNABLE_TO_PARSE_RESPONSE="unable-to-parse-response",e}();t.AppErrorCodes=g;var m=function(){function e(){}return e.CLAIMS_TOO_LARGE={code:"claims-too-large",message:"Developer claims maximum payload size exceeded."},e.ID_TOKEN_EXPIRED={code:"id-token-expired",message:"The provided Firebase ID token is expired."},e.INVALID_ARGUMENT={code:"argument-error",message:"Invalid argument provided."},e.EMAIL_ALREADY_EXISTS={code:"email-already-exists",message:"The email address is already in use by another account."},e.FORBIDDEN_CLAIM={code:"reserved-claim",message:"The specified developer claim is reserved and cannot be specified."},e.INVALID_ID_TOKEN={code:"invalid-id-token",message:"The provided ID token is not a valid Firebase ID token."},e.ID_TOKEN_REVOKED={code:"id-token-revoked",message:"The Firebase ID token has been revoked."},e.INTERNAL_ERROR={code:"internal-error",message:"An internal error has occurred."},e.INVALID_CLAIMS={code:"invalid-claims",message:"The provided custom claim attributes are invalid."},e.INVALID_CONTINUE_URI={code:"invalid-continue-uri",message:"The continue URL must be a valid URL string."},e.INVALID_CREATION_TIME={code:"invalid-creation-time",message:"The creation time must be a valid UTC date string."},e.INVALID_CREDENTIAL={code:"invalid-credential",message:"Invalid credential object provided."},e.INVALID_DISABLED_FIELD={code:"invalid-disabled-field",message:"The disabled field must be a boolean."},e.INVALID_DISPLAY_NAME={code:"invalid-display-name",message:"The displayName field must be a valid string."},e.INVALID_DYNAMIC_LINK_DOMAIN={code:"invalid-dynamic-link-domain",message:"The provided dynamic link domain is not configured or authorized for the current project."},e.INVALID_EMAIL_VERIFIED={code:"invalid-email-verified",message:"The emailVerified field must be a boolean."},e.INVALID_EMAIL={code:"invalid-email",message:"The email address is improperly formatted."},e.INVALID_HASH_ALGORITHM={code:"invalid-hash-algorithm",message:"The hash algorithm must match one of the strings in the list of supported algorithms."},e.INVALID_HASH_BLOCK_SIZE={code:"invalid-hash-block-size",message:"The hash block size must be a valid number."},e.INVALID_HASH_DERIVED_KEY_LENGTH={code:"invalid-hash-derived-key-length",message:"The hash derived key length must be a valid number."},e.INVALID_HASH_KEY={code:"invalid-hash-key",message:"The hash key must a valid byte buffer."},e.INVALID_HASH_MEMORY_COST={code:"invalid-hash-memory-cost",message:"The hash memory cost must be a valid number."},e.INVALID_HASH_PARALLELIZATION={code:"invalid-hash-parallelization",message:"The hash parallelization must be a valid number."},e.INVALID_HASH_ROUNDS={code:"invalid-hash-rounds",message:"The hash rounds must be a valid number."},e.INVALID_HASH_SALT_SEPARATOR={code:"invalid-hash-salt-separator",message:"The hashing algorithm salt separator field must be a valid byte buffer."},e.INVALID_LAST_SIGN_IN_TIME={code:"invalid-last-sign-in-time",message:"The last sign-in time must be a valid UTC date string."},e.INVALID_PAGE_TOKEN={code:"invalid-page-token",message:"The page token must be a valid non-empty string."},e.INVALID_PASSWORD={code:"invalid-password",message:"The password must be a string with at least 6 characters."},e.INVALID_PASSWORD_HASH={code:"invalid-password-hash",message:"The password hash must be a valid byte buffer."},e.INVALID_PASSWORD_SALT={code:"invalid-password-salt",message:"The password salt must be a valid byte buffer."},e.INVALID_PHONE_NUMBER={code:"invalid-phone-number",message:"The phone number must be a non-empty E.164 standard compliant identifier string."},e.INVALID_PHOTO_URL={code:"invalid-photo-url",message:"The photoURL field must be a valid URL."},e.INVALID_PROVIDER_DATA={code:"invalid-provider-data",message:"The providerData must be a valid array of UserInfo objects."},e.INVALID_PROVIDER_ID={code:"invalid-provider-id",message:"The providerId must be a valid supported provider identifier string."},e.INVALID_SESSION_COOKIE_DURATION={code:"invalid-session-cookie-duration",message:"The session cookie duration must be a valid number in milliseconds between 5 minutes and 2 weeks."},e.INVALID_UID={code:"invalid-uid",message:"The uid must be a non-empty string with at most 128 characters."},e.INVALID_USER_IMPORT={code:"invalid-user-import",message:"The user record to import is invalid."},e.INVALID_TOKENS_VALID_AFTER_TIME={code:"invalid-tokens-valid-after-time",message:"The tokensValidAfterTime must be a valid UTC number in seconds."},e.MISSING_ANDROID_PACKAGE_NAME={code:"missing-android-pkg-name",message:"An Android Package Name must be provided if the Android App is required to be installed."},e.MISSING_CONTINUE_URI={code:"missing-continue-uri",message:"A valid continue URL must be provided in the request."},e.MISSING_IOS_BUNDLE_ID={code:"missing-ios-bundle-id",message:"The request is missing an iOS Bundle ID."},e.MISSING_HASH_ALGORITHM={code:"missing-hash-algorithm",message:"Importing users with password hashes requires that the hashing algorithm and its parameters be provided."},e.MAXIMUM_USER_COUNT_EXCEEDED={code:"maximum-user-count-exceeded",message:"The maximum allowed number of users to import has been exceeded."},e.MISSING_UID={code:"missing-uid",message:"A uid identifier is required for the current operation."},e.OPERATION_NOT_ALLOWED={code:"operation-not-allowed",message:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."},e.PHONE_NUMBER_ALREADY_EXISTS={code:"phone-number-already-exists",message:"The user with the provided phone number already exists."},e.PROJECT_NOT_FOUND={code:"project-not-found",message:"No Firebase project was found for the provided credential."},e.INSUFFICIENT_PERMISSION={code:"insufficient-permission",message:'Credential implementation provided to initializeApp() via the "credential" property has insufficient permission to access the requested resource. See https://firebase.google.com/docs/admin/setup for details on how to authenticate this SDK with appropriate permissions.'},e.SESSION_COOKIE_REVOKED={code:"session-cookie-revoked",message:"The Firebase session cookie has been revoked."},e.UID_ALREADY_EXISTS={code:"uid-already-exists",message:"The user with the provided uid already exists."},e.UNAUTHORIZED_DOMAIN={code:"unauthorized-continue-uri",message:"The domain of the continue URL is not whitelisted. Whitelist the domain in the Firebase console."},e.USER_NOT_FOUND={code:"user-not-found",message:"There is no user record corresponding to the provided identifier."},e}();t.AuthClientErrorCode=m;var y=function(){function e(){}return e.INVALID_ARGUMENT={code:"invalid-argument",message:"Invalid argument provided."},e.INVALID_RECIPIENT={code:"invalid-recipient",message:"Invalid message recipient provided."},e.INVALID_PAYLOAD={code:"invalid-payload",message:"Invalid message payload provided."},e.INVALID_DATA_PAYLOAD_KEY={code:"invalid-data-payload-key",message:"The data message payload contains an invalid key. See the reference documentation for the DataMessagePayload type for restricted keys."},e.PAYLOAD_SIZE_LIMIT_EXCEEDED={code:"payload-size-limit-exceeded",message:"The provided message payload exceeds the FCM size limits. See the error documentation for more details."},e.INVALID_OPTIONS={code:"invalid-options",message:"Invalid message options provided."},e.INVALID_REGISTRATION_TOKEN={code:"invalid-registration-token",message:"Invalid registration token provided. Make sure it matches the registration token the client app receives from registering with FCM."},e.REGISTRATION_TOKEN_NOT_REGISTERED={code:"registration-token-not-registered",message:"The provided registration token is not registered. A previously valid registration token can be unregistered for a variety of reasons. See the error documentation for more details. Remove this registration token and stop using it to send messages."},e.MISMATCHED_CREDENTIAL={code:"mismatched-credential",message:"The credential used to authenticate this SDK does not have permission to send messages to the device corresponding to the provided registration token. Make sure the credential and registration token both belong to the same Firebase project."},e.INVALID_PACKAGE_NAME={code:"invalid-package-name",message:'The message was addressed to a registration token whose package name does not match the provided "restrictedPackageName" option.'},e.DEVICE_MESSAGE_RATE_EXCEEDED={code:"device-message-rate-exceeded",message:"The rate of messages to a particular device is too high. Reduce the number of messages sent to this device and do not immediately retry sending to this device."},e.TOPICS_MESSAGE_RATE_EXCEEDED={code:"topics-message-rate-exceeded",message:"The rate of messages to subscribers to a particular topic is too high. Reduce the number of messages sent for this topic, and do not immediately retry sending to this topic."},e.MESSAGE_RATE_EXCEEDED={code:"message-rate-exceeded",message:"Sending limit exceeded for the message target."},e.INVALID_APNS_CREDENTIALS={code:"invalid-apns-credentials",message:"A message targeted to an iOS device could not be sent because the required APNs SSL certificate was not uploaded or has expired. Check the validity of your development and production certificates."},e.TOO_MANY_TOPICS={code:"too-many-topics",message:"The maximum number of topics the provided registration token can be subscribed to has been exceeded."},e.AUTHENTICATION_ERROR={code:"authentication-error",message:"An error occurred when trying to authenticate to the FCM servers. Make sure the credential used to authenticate this SDK has the proper permissions. See https://firebase.google.com/docs/admin/setup for setup instructions."},e.SERVER_UNAVAILABLE={code:"server-unavailable",message:"The FCM server could not process the request in time. See the error documentation for more details."},e.INTERNAL_ERROR={code:"internal-error",message:"An internal error has occurred. Please retry the request."},e.UNKNOWN_ERROR={code:"unknown-error",message:"An unknown server error was returned."},e}();t.MessagingClientErrorCode=y;var v=function(){function e(){}return e.INVALID_ARGUMENT={code:"invalid-argument",message:"Invalid argument provided."},e.INVALID_PROJECT_ID={code:"invalid-project-id",message:"Invalid project ID provided."},e.INVALID_INSTANCE_ID={code:"invalid-instance-id",message:"Invalid instance ID provided."},e.API_ERROR={code:"api-error",message:"Instance ID API call failed."},e}();t.InstanceIdClientErrorCode=v;var b={CLAIMS_TOO_LARGE:"CLAIMS_TOO_LARGE",CONFIGURATION_NOT_FOUND:"PROJECT_NOT_FOUND",INSUFFICIENT_PERMISSION:"INSUFFICIENT_PERMISSION",INVALID_CONTINUE_URI:"INVALID_CONTINUE_URI",INVALID_DYNAMIC_LINK_DOMAIN:"INVALID_DYNAMIC_LINK_DOMAIN",DUPLICATE_EMAIL:"EMAIL_ALREADY_EXISTS",DUPLICATE_LOCAL_ID:"UID_ALREADY_EXISTS",EMAIL_EXISTS:"EMAIL_ALREADY_EXISTS",FORBIDDEN_CLAIM:"FORBIDDEN_CLAIM",INVALID_CLAIMS:"INVALID_CLAIMS",INVALID_DURATION:"INVALID_SESSION_COOKIE_DURATION",INVALID_EMAIL:"INVALID_EMAIL",INVALID_ID_TOKEN:"INVALID_ID_TOKEN",INVALID_PAGE_SELECTION:"INVALID_PAGE_TOKEN",INVALID_PHONE_NUMBER:"INVALID_PHONE_NUMBER",INVALID_SERVICE_ACCOUNT:"INVALID_SERVICE_ACCOUNT",MISSING_ANDROID_PACKAGE_NAME:"MISSING_ANDROID_PACKAGE_NAME",MISSING_IOS_BUNDLE_ID:"MISSING_IOS_BUNDLE_ID",MISSING_LOCAL_ID:"MISSING_UID",MISSING_USER_ACCOUNT:"MISSING_UID",OPERATION_NOT_ALLOWED:"OPERATION_NOT_ALLOWED",PERMISSION_DENIED:"INSUFFICIENT_PERMISSION",PHONE_NUMBER_EXISTS:"PHONE_NUMBER_ALREADY_EXISTS",PROJECT_NOT_FOUND:"PROJECT_NOT_FOUND",TOKEN_EXPIRED:"ID_TOKEN_EXPIRED",UNAUTHORIZED_DOMAIN:"UNAUTHORIZED_DOMAIN",USER_NOT_FOUND:"USER_NOT_FOUND",WEAK_PASSWORD:"INVALID_PASSWORD"},_={InvalidParameters:"INVALID_ARGUMENT",MismatchSenderId:"MISMATCHED_CREDENTIAL",Unavailable:"SERVER_UNAVAILABLE",InternalServerError:"INTERNAL_ERROR",InvalidRegistration:"INVALID_REGISTRATION_TOKEN",NotRegistered:"REGISTRATION_TOKEN_NOT_REGISTERED",InvalidPackageName:"INVALID_PACKAGE_NAME",MessageTooBig:"PAYLOAD_SIZE_LIMIT_EXCEEDED",InvalidDataKey:"INVALID_DATA_PAYLOAD_KEY",InvalidTtl:"INVALID_OPTIONS",DeviceMessageRateExceeded:"DEVICE_MESSAGE_RATE_EXCEEDED",TopicsMessageRateExceeded:"TOPICS_MESSAGE_RATE_EXCEEDED",InvalidApnsCredential:"INVALID_APNS_CREDENTIALS",NOT_FOUND:"REGISTRATION_TOKEN_NOT_REGISTERED",PERMISSION_DENIED:"MISMATCHED_CREDENTIAL",RESOURCE_EXHAUSTED:"MESSAGE_RATE_EXCEEDED",UNAUTHENTICATED:"INVALID_APNS_CREDENTIALS",APNS_AUTH_ERROR:"INVALID_APNS_CREDENTIALS",INTERNAL:"INTERNAL_ERROR",INVALID_ARGUMENT:"INVALID_ARGUMENT",QUOTA_EXCEEDED:"MESSAGE_RATE_EXCEEDED",SENDER_ID_MISMATCH:"MISMATCHED_CREDENTIAL",UNAVAILABLE:"SERVER_UNAVAILABLE",UNREGISTERED:"REGISTRATION_TOKEN_NOT_REGISTERED",UNSPECIFIED_ERROR:"UNKNOWN_ERROR"},E={NOT_FOUND:"REGISTRATION_TOKEN_NOT_REGISTERED",INVALID_ARGUMENT:"INVALID_REGISTRATION_TOKEN",TOO_MANY_TOPICS:"TOO_MANY_TOPICS",RESOURCE_EXHAUSTED:"TOO_MANY_TOPICS",PERMISSION_DENIED:"AUTHENTICATION_ERROR",DEADLINE_EXCEEDED:"SERVER_UNAVAILABLE",INTERNAL:"INTERNAL_ERROR",UNKNOWN:"UNKNOWN_ERROR"}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(14);function i(e){return Array.isArray(e)}function o(e){return"string"==typeof e}function s(e){return"object"==typeof e&&!i(e)}t.isBuffer=function(e){return e instanceof Buffer},t.isArray=i,t.isNonEmptyArray=function(e){return i(e)&&0!==e.length},t.isBoolean=function(e){return"boolean"==typeof e},t.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},t.isString=o,t.isBase64String=function(e){return!!o(e)&&/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},t.isNonEmptyString=function(e){return o(e)&&""!==e},t.isObject=s,t.isNonNullObject=function(e){return s(e)&&null!==e},t.isUid=function(e){return"string"==typeof e&&e.length>0&&e.length<=128},t.isPassword=function(e){return"string"==typeof e&&e.length>=6},t.isEmail=function(e){return"string"==typeof e&&/^[^@]+@[^@]+$/.test(e)},t.isPhoneNumber=function(e){return"string"==typeof e&&/^\+/.test(e)&&/[\da-zA-Z]+/.test(e)},t.isURL=function(e){if("string"!=typeof e)return!1;if(/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(e))return!1;try{var t=n.parse(e),r=t.protocol,i=t.slashes,o=t.hostname,s=t.pathname;if("http:"!==r&&"https:"!==r||!i)return!1;if(!/^[a-zA-Z0-9]+[\w\-]*([\.]?[a-zA-Z0-9]+[\w\-]*)*$/.test(o))return!1;if(s&&"/"!==s&&!/^(\/[\w\-\.\~\!\$\'\(\)\*\+\,\;\=\:\@\%]+)*\/?$/.test(s))return!1}catch(e){return!1}return!0},t.isTopic=function(e){return"string"==typeof e&&/^(\/topics\/)?(private\/)?[a-zA-Z0-9-_.~%]+$/.test(e)}},function(e,t){e.exports=require("events")},function(e,t,r){"use strict";var n,i,o=e.exports=r(36),s=r(221);o.codegen=r(357),o.fetch=r(358),o.path=r(359),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),n=0;n<t.length;)r[n]=e[t[n++]];return r}return[]},o.toObject=function(e){for(var t={},r=0;r<e.length;){var n=e[r++],i=e[r++];void 0!==i&&(t[n]=i)}return t};var a=/\\/g,c=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(a,"\\\\").replace(c,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var u=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(u,function(e,t){return t.toUpperCase()})},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(o.decorateRoot.remove(e.$type),e.$type.name=t,o.decorateRoot.add(e.$type)),e.$type;n||(n=r(147));var i=new n(t||e.name);return o.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var l=0;o.decorateEnum=function(e){if(e.$type)return e.$type;i||(i=r(28));var t=new i("Enum"+l++,e);return o.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},Object.defineProperty(o,"decorateRoot",{get:function(){return s.decorated||(s.decorated=new(r(152)))}})},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("assert")},function(e,t,r){(function(e){var n;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright JS Foundation and other contributors <https://js.foundation/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var i,o=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",c="__lodash_hash_undefined__",u=500,l="__lodash_placeholder__",h=1,p=2,f=4,d=1,g=2,m=1,y=2,v=4,b=8,_=16,E=32,C=64,w=128,S=256,T=512,A=30,I="...",N=800,k=16,R=1,O=2,x=1/0,B=9007199254740991,D=1.7976931348623157e308,P=NaN,L=4294967295,j=L-1,U=L>>>1,M=[["ary",w],["bind",m],["bindKey",y],["curry",b],["curryRight",_],["flip",T],["partial",E],["partialRight",C],["rearg",S]],F="[object Arguments]",V="[object Array]",q="[object AsyncFunction]",K="[object Boolean]",H="[object Date]",G="[object DOMException]",z="[object Error]",W="[object Function]",Y="[object GeneratorFunction]",Q="[object Map]",$="[object Number]",J="[object Null]",X="[object Object]",Z="[object Proxy]",ee="[object RegExp]",te="[object Set]",re="[object String]",ne="[object Symbol]",ie="[object Undefined]",oe="[object WeakMap]",se="[object WeakSet]",ae="[object ArrayBuffer]",ce="[object DataView]",ue="[object Float32Array]",le="[object Float64Array]",he="[object Int8Array]",pe="[object Int16Array]",fe="[object Int32Array]",de="[object Uint8Array]",ge="[object Uint8ClampedArray]",me="[object Uint16Array]",ye="[object Uint32Array]",ve=/\b__p \+= '';/g,be=/\b(__p \+=) '' \+/g,_e=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ee=/&(?:amp|lt|gt|quot|#39);/g,Ce=/[&<>"']/g,we=RegExp(Ee.source),Se=RegExp(Ce.source),Te=/<%-([\s\S]+?)%>/g,Ae=/<%([\s\S]+?)%>/g,Ie=/<%=([\s\S]+?)%>/g,Ne=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ke=/^\w*$/,Re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Oe=/[\\^$.*+?()[\]{}|]/g,xe=RegExp(Oe.source),Be=/^\s+|\s+$/g,De=/^\s+/,Pe=/\s+$/,Le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,je=/\{\n\/\* \[wrapped with (.+)\] \*/,Ue=/,? & /,Me=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Fe=/\\(\\)?/g,Ve=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qe=/\w*$/,Ke=/^[-+]0x[0-9a-f]+$/i,He=/^0b[01]+$/i,Ge=/^\[object .+?Constructor\]$/,ze=/^0o[0-7]+$/i,We=/^(?:0|[1-9]\d*)$/,Ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qe=/($^)/,$e=/['\n\r\u2028\u2029\\]/g,Je="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Xe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ze="[\\ud800-\\udfff]",et="["+Xe+"]",tt="["+Je+"]",rt="\\d+",nt="[\\u2700-\\u27bf]",it="[a-z\\xdf-\\xf6\\xf8-\\xff]",ot="[^\\ud800-\\udfff"+Xe+rt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",st="\\ud83c[\\udffb-\\udfff]",at="[^\\ud800-\\udfff]",ct="(?:\\ud83c[\\udde6-\\uddff]){2}",ut="[\\ud800-\\udbff][\\udc00-\\udfff]",lt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ht="(?:"+it+"|"+ot+")",pt="(?:"+lt+"|"+ot+")",ft="(?:"+tt+"|"+st+")"+"?",dt="[\\ufe0e\\ufe0f]?"+ft+("(?:\\u200d(?:"+[at,ct,ut].join("|")+")[\\ufe0e\\ufe0f]?"+ft+")*"),gt="(?:"+[nt,ct,ut].join("|")+")"+dt,mt="(?:"+[at+tt+"?",tt,ct,ut,Ze].join("|")+")",yt=RegExp("[']","g"),vt=RegExp(tt,"g"),bt=RegExp(st+"(?="+st+")|"+mt+dt,"g"),_t=RegExp([lt+"?"+it+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[et,lt,"$"].join("|")+")",pt+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[et,lt+ht,"$"].join("|")+")",lt+"?"+ht+"+(?:['](?:d|ll|m|re|s|t|ve))?",lt+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rt,gt].join("|"),"g"),Et=RegExp("[\\u200d\\ud800-\\udfff"+Je+"\\ufe0e\\ufe0f]"),Ct=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,wt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],St=-1,Tt={};Tt[ue]=Tt[le]=Tt[he]=Tt[pe]=Tt[fe]=Tt[de]=Tt[ge]=Tt[me]=Tt[ye]=!0,Tt[F]=Tt[V]=Tt[ae]=Tt[K]=Tt[ce]=Tt[H]=Tt[z]=Tt[W]=Tt[Q]=Tt[$]=Tt[X]=Tt[ee]=Tt[te]=Tt[re]=Tt[oe]=!1;var At={};At[F]=At[V]=At[ae]=At[ce]=At[K]=At[H]=At[ue]=At[le]=At[he]=At[pe]=At[fe]=At[Q]=At[$]=At[X]=At[ee]=At[te]=At[re]=At[ne]=At[de]=At[ge]=At[me]=At[ye]=!0,At[z]=At[W]=At[oe]=!1;var It={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Nt=parseFloat,kt=parseInt,Rt="object"==typeof global&&global&&global.Object===Object&&global,Ot="object"==typeof self&&self&&self.Object===Object&&self,xt=Rt||Ot||Function("return this")(),Bt=t&&!t.nodeType&&t,Dt=Bt&&"object"==typeof e&&e&&!e.nodeType&&e,Pt=Dt&&Dt.exports===Bt,Lt=Pt&&Rt.process,jt=function(){try{var e=Dt&&Dt.require&&Dt.require("util").types;return e||Lt&&Lt.binding&&Lt.binding("util")}catch(e){}}(),Ut=jt&&jt.isArrayBuffer,Mt=jt&&jt.isDate,Ft=jt&&jt.isMap,Vt=jt&&jt.isRegExp,qt=jt&&jt.isSet,Kt=jt&&jt.isTypedArray;function Ht(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function Gt(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(n,s,r(s),e)}return n}function zt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function Wt(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}function Yt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function Qt(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}function $t(e,t){return!!(null==e?0:e.length)&&sr(e,t,0)>-1}function Jt(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}function Xt(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}function Zt(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function er(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function tr(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r}function rr(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var nr=lr("length");function ir(e,t,r){var n;return r(e,function(e,r,i){if(t(e,r,i))return n=r,!1}),n}function or(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function sr(e,t,r){return t==t?function(e,t,r){var n=r-1,i=e.length;for(;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):or(e,cr,r)}function ar(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1}function cr(e){return e!=e}function ur(e,t){var r=null==e?0:e.length;return r?fr(e,t)/r:P}function lr(e){return function(t){return null==t?i:t[e]}}function hr(e){return function(t){return null==e?i:e[t]}}function pr(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r}function fr(e,t){for(var r,n=-1,o=e.length;++n<o;){var s=t(e[n]);s!==i&&(r=r===i?s:r+s)}return r}function dr(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function gr(e){return function(t){return e(t)}}function mr(e,t){return Xt(t,function(t){return e[t]})}function yr(e,t){return e.has(t)}function vr(e,t){for(var r=-1,n=e.length;++r<n&&sr(t,e[r],0)>-1;);return r}function br(e,t){for(var r=e.length;r--&&sr(t,e[r],0)>-1;);return r}var _r=hr({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Er=hr({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Cr(e){return"\\"+It[e]}function wr(e){return Et.test(e)}function Sr(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function Tr(e,t){return function(r){return e(t(r))}}function Ar(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var s=e[r];s!==t&&s!==l||(e[r]=l,o[i++]=r)}return o}function Ir(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}function Nr(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=[e,e]}),r}function kr(e){return wr(e)?function(e){var t=bt.lastIndex=0;for(;bt.test(e);)++t;return t}(e):nr(e)}function Rr(e){return wr(e)?function(e){return e.match(bt)||[]}(e):function(e){return e.split("")}(e)}var Or=hr({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var xr=function e(t){var r,n=(t=null==t?xt:xr.defaults(xt.Object(),t,xr.pick(xt,wt))).Array,Je=t.Date,Xe=t.Error,Ze=t.Function,et=t.Math,tt=t.Object,rt=t.RegExp,nt=t.String,it=t.TypeError,ot=n.prototype,st=Ze.prototype,at=tt.prototype,ct=t["__core-js_shared__"],ut=st.toString,lt=at.hasOwnProperty,ht=0,pt=(r=/[^.]+$/.exec(ct&&ct.keys&&ct.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",ft=at.toString,dt=ut.call(tt),gt=xt._,mt=rt("^"+ut.call(lt).replace(Oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=Pt?t.Buffer:i,Et=t.Symbol,It=t.Uint8Array,Rt=bt?bt.allocUnsafe:i,Ot=Tr(tt.getPrototypeOf,tt),Bt=tt.create,Dt=at.propertyIsEnumerable,Lt=ot.splice,jt=Et?Et.isConcatSpreadable:i,nr=Et?Et.iterator:i,hr=Et?Et.toStringTag:i,Br=function(){try{var e=Mo(tt,"defineProperty");return e({},"",{}),e}catch(e){}}(),Dr=t.clearTimeout!==xt.clearTimeout&&t.clearTimeout,Pr=Je&&Je.now!==xt.Date.now&&Je.now,Lr=t.setTimeout!==xt.setTimeout&&t.setTimeout,jr=et.ceil,Ur=et.floor,Mr=tt.getOwnPropertySymbols,Fr=bt?bt.isBuffer:i,Vr=t.isFinite,qr=ot.join,Kr=Tr(tt.keys,tt),Hr=et.max,Gr=et.min,zr=Je.now,Wr=t.parseInt,Yr=et.random,Qr=ot.reverse,$r=Mo(t,"DataView"),Jr=Mo(t,"Map"),Xr=Mo(t,"Promise"),Zr=Mo(t,"Set"),en=Mo(t,"WeakMap"),tn=Mo(tt,"create"),rn=en&&new en,nn={},on=hs($r),sn=hs(Jr),an=hs(Xr),cn=hs(Zr),un=hs(en),ln=Et?Et.prototype:i,hn=ln?ln.valueOf:i,pn=ln?ln.toString:i;function fn(e){if(Na(e)&&!ya(e)&&!(e instanceof yn)){if(e instanceof mn)return e;if(lt.call(e,"__wrapped__"))return ps(e)}return new mn(e)}var dn=function(){function e(){}return function(t){if(!Ia(t))return{};if(Bt)return Bt(t);e.prototype=t;var r=new e;return e.prototype=i,r}}();function gn(){}function mn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function yn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=L,this.__views__=[]}function vn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function bn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function _n(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function En(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new _n;++t<r;)this.add(e[t])}function Cn(e){var t=this.__data__=new bn(e);this.size=t.size}function wn(e,t){var r=ya(e),n=!r&&ma(e),i=!r&&!n&&Ea(e),o=!r&&!n&&!i&&La(e),s=r||n||i||o,a=s?dr(e.length,nt):[],c=a.length;for(var u in e)!t&&!lt.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||zo(u,c))||a.push(u);return a}function Sn(e){var t=e.length;return t?e[Ei(0,t-1)]:i}function Tn(e,t){return cs(ro(e),Dn(t,0,e.length))}function An(e){return cs(ro(e))}function In(e,t,r){(r===i||fa(e[t],r))&&(r!==i||t in e)||xn(e,t,r)}function Nn(e,t,r){var n=e[t];lt.call(e,t)&&fa(n,r)&&(r!==i||t in e)||xn(e,t,r)}function kn(e,t){for(var r=e.length;r--;)if(fa(e[r][0],t))return r;return-1}function Rn(e,t,r,n){return Mn(e,function(e,i,o){t(n,e,r(e),o)}),n}function On(e,t){return e&&no(t,ic(t),e)}function xn(e,t,r){"__proto__"==t&&Br?Br(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Bn(e,t){for(var r=-1,o=t.length,s=n(o),a=null==e;++r<o;)s[r]=a?i:Za(e,t[r]);return s}function Dn(e,t,r){return e==e&&(r!==i&&(e=e<=r?e:r),t!==i&&(e=e>=t?e:t)),e}function Pn(e,t,r,n,o,s){var a,c=t&h,u=t&p,l=t&f;if(r&&(a=o?r(e,n,o,s):r(e)),a!==i)return a;if(!Ia(e))return e;var d=ya(e);if(d){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&lt.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!c)return ro(e,a)}else{var g=qo(e),m=g==W||g==Y;if(Ea(e))return $i(e,c);if(g==X||g==F||m&&!o){if(a=u||m?{}:Ho(e),!c)return u?function(e,t){return no(e,Vo(e),t)}(e,function(e,t){return e&&no(t,oc(t),e)}(a,e)):function(e,t){return no(e,Fo(e),t)}(e,On(a,e))}else{if(!At[g])return o?e:{};a=function(e,t,r){var n,i,o,s=e.constructor;switch(t){case ae:return Ji(e);case K:case H:return new s(+e);case ce:return function(e,t){var r=t?Ji(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case ue:case le:case he:case pe:case fe:case de:case ge:case me:case ye:return Xi(e,r);case Q:return new s;case $:case re:return new s(e);case ee:return(o=new(i=e).constructor(i.source,qe.exec(i))).lastIndex=i.lastIndex,o;case te:return new s;case ne:return n=e,hn?tt(hn.call(n)):{}}}(e,g,c)}}s||(s=new Cn);var y=s.get(e);if(y)return y;if(s.set(e,a),Ba(e))return e.forEach(function(n){a.add(Pn(n,t,r,n,e,s))}),a;if(ka(e))return e.forEach(function(n,i){a.set(i,Pn(n,t,r,i,e,s))}),a;var v=d?i:(l?u?xo:Oo:u?oc:ic)(e);return zt(v||e,function(n,i){v&&(n=e[i=n]),Nn(a,i,Pn(n,t,r,i,e,s))}),a}function Ln(e,t,r){var n=r.length;if(null==e)return!n;for(e=tt(e);n--;){var o=r[n],s=t[o],a=e[o];if(a===i&&!(o in e)||!s(a))return!1}return!0}function jn(e,t,r){if("function"!=typeof e)throw new it(a);return is(function(){e.apply(i,r)},t)}function Un(e,t,r,n){var i=-1,s=$t,a=!0,c=e.length,u=[],l=t.length;if(!c)return u;r&&(t=Xt(t,gr(r))),n?(s=Jt,a=!1):t.length>=o&&(s=yr,a=!1,t=new En(t));e:for(;++i<c;){var h=e[i],p=null==r?h:r(h);if(h=n||0!==h?h:0,a&&p==p){for(var f=l;f--;)if(t[f]===p)continue e;u.push(h)}else s(t,p,n)||u.push(h)}return u}fn.templateSettings={escape:Te,evaluate:Ae,interpolate:Ie,variable:"",imports:{_:fn}},fn.prototype=gn.prototype,fn.prototype.constructor=fn,mn.prototype=dn(gn.prototype),mn.prototype.constructor=mn,yn.prototype=dn(gn.prototype),yn.prototype.constructor=yn,vn.prototype.clear=function(){this.__data__=tn?tn(null):{},this.size=0},vn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},vn.prototype.get=function(e){var t=this.__data__;if(tn){var r=t[e];return r===c?i:r}return lt.call(t,e)?t[e]:i},vn.prototype.has=function(e){var t=this.__data__;return tn?t[e]!==i:lt.call(t,e)},vn.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=tn&&t===i?c:t,this},bn.prototype.clear=function(){this.__data__=[],this.size=0},bn.prototype.delete=function(e){var t=this.__data__,r=kn(t,e);return!(r<0||(r==t.length-1?t.pop():Lt.call(t,r,1),--this.size,0))},bn.prototype.get=function(e){var t=this.__data__,r=kn(t,e);return r<0?i:t[r][1]},bn.prototype.has=function(e){return kn(this.__data__,e)>-1},bn.prototype.set=function(e,t){var r=this.__data__,n=kn(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},_n.prototype.clear=function(){this.size=0,this.__data__={hash:new vn,map:new(Jr||bn),string:new vn}},_n.prototype.delete=function(e){var t=jo(this,e).delete(e);return this.size-=t?1:0,t},_n.prototype.get=function(e){return jo(this,e).get(e)},_n.prototype.has=function(e){return jo(this,e).has(e)},_n.prototype.set=function(e,t){var r=jo(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},En.prototype.add=En.prototype.push=function(e){return this.__data__.set(e,c),this},En.prototype.has=function(e){return this.__data__.has(e)},Cn.prototype.clear=function(){this.__data__=new bn,this.size=0},Cn.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Cn.prototype.get=function(e){return this.__data__.get(e)},Cn.prototype.has=function(e){return this.__data__.has(e)},Cn.prototype.set=function(e,t){var r=this.__data__;if(r instanceof bn){var n=r.__data__;if(!Jr||n.length<o-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new _n(n)}return r.set(e,t),this.size=r.size,this};var Mn=so(Wn),Fn=so(Yn,!0);function Vn(e,t){var r=!0;return Mn(e,function(e,n,i){return r=!!t(e,n,i)}),r}function qn(e,t,r){for(var n=-1,o=e.length;++n<o;){var s=e[n],a=t(s);if(null!=a&&(c===i?a==a&&!Pa(a):r(a,c)))var c=a,u=s}return u}function Kn(e,t){var r=[];return Mn(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r}function Hn(e,t,r,n,i){var o=-1,s=e.length;for(r||(r=Go),i||(i=[]);++o<s;){var a=e[o];t>0&&r(a)?t>1?Hn(a,t-1,r,n,i):Zt(i,a):n||(i[i.length]=a)}return i}var Gn=ao(),zn=ao(!0);function Wn(e,t){return e&&Gn(e,t,ic)}function Yn(e,t){return e&&zn(e,t,ic)}function Qn(e,t){return Qt(t,function(t){return Sa(e[t])})}function $n(e,t){for(var r=0,n=(t=zi(t,e)).length;null!=e&&r<n;)e=e[ls(t[r++])];return r&&r==n?e:i}function Jn(e,t,r){var n=t(e);return ya(e)?n:Zt(n,r(e))}function Xn(e){return null==e?e===i?ie:J:hr&&hr in tt(e)?function(e){var t=lt.call(e,hr),r=e[hr];try{e[hr]=i;var n=!0}catch(e){}var o=ft.call(e);return n&&(t?e[hr]=r:delete e[hr]),o}(e):function(e){return ft.call(e)}(e)}function Zn(e,t){return e>t}function ei(e,t){return null!=e&&lt.call(e,t)}function ti(e,t){return null!=e&&t in tt(e)}function ri(e,t,r){for(var o=r?Jt:$t,s=e[0].length,a=e.length,c=a,u=n(a),l=1/0,h=[];c--;){var p=e[c];c&&t&&(p=Xt(p,gr(t))),l=Gr(p.length,l),u[c]=!r&&(t||s>=120&&p.length>=120)?new En(c&&p):i}p=e[0];var f=-1,d=u[0];e:for(;++f<s&&h.length<l;){var g=p[f],m=t?t(g):g;if(g=r||0!==g?g:0,!(d?yr(d,m):o(h,m,r))){for(c=a;--c;){var y=u[c];if(!(y?yr(y,m):o(e[c],m,r)))continue e}d&&d.push(m),h.push(g)}}return h}function ni(e,t,r){var n=null==(e=ts(e,t=zi(t,e)))?e:e[ls(ws(t))];return null==n?i:Ht(n,e,r)}function ii(e){return Na(e)&&Xn(e)==F}function oi(e,t,r,n,o){return e===t||(null==e||null==t||!Na(e)&&!Na(t)?e!=e&&t!=t:function(e,t,r,n,o,s){var a=ya(e),c=ya(t),u=a?V:qo(e),l=c?V:qo(t),h=(u=u==F?X:u)==X,p=(l=l==F?X:l)==X,f=u==l;if(f&&Ea(e)){if(!Ea(t))return!1;a=!0,h=!1}if(f&&!h)return s||(s=new Cn),a||La(e)?ko(e,t,r,n,o,s):function(e,t,r,n,i,o,s){switch(r){case ce:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ae:return!(e.byteLength!=t.byteLength||!o(new It(e),new It(t)));case K:case H:case $:return fa(+e,+t);case z:return e.name==t.name&&e.message==t.message;case ee:case re:return e==t+"";case Q:var a=Sr;case te:var c=n&d;if(a||(a=Ir),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;n|=g,s.set(e,t);var l=ko(a(e),a(t),n,i,o,s);return s.delete(e),l;case ne:if(hn)return hn.call(e)==hn.call(t)}return!1}(e,t,u,r,n,o,s);if(!(r&d)){var m=h&&lt.call(e,"__wrapped__"),y=p&&lt.call(t,"__wrapped__");if(m||y){var v=m?e.value():e,b=y?t.value():t;return s||(s=new Cn),o(v,b,r,n,s)}}return!!f&&(s||(s=new Cn),function(e,t,r,n,o,s){var a=r&d,c=Oo(e),u=c.length,l=Oo(t).length;if(u!=l&&!a)return!1;for(var h=u;h--;){var p=c[h];if(!(a?p in t:lt.call(t,p)))return!1}var f=s.get(e);if(f&&s.get(t))return f==t;var g=!0;s.set(e,t),s.set(t,e);for(var m=a;++h<u;){p=c[h];var y=e[p],v=t[p];if(n)var b=a?n(v,y,p,t,e,s):n(y,v,p,e,t,s);if(!(b===i?y===v||o(y,v,r,n,s):b)){g=!1;break}m||(m="constructor"==p)}if(g&&!m){var _=e.constructor,E=t.constructor;_!=E&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof E&&E instanceof E)&&(g=!1)}return s.delete(e),s.delete(t),g}(e,t,r,n,o,s))}(e,t,r,n,oi,o))}function si(e,t,r,n){var o=r.length,s=o,a=!n;if(null==e)return!s;for(e=tt(e);o--;){var c=r[o];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){var u=(c=r[o])[0],l=e[u],h=c[1];if(a&&c[2]){if(l===i&&!(u in e))return!1}else{var p=new Cn;if(n)var f=n(l,h,u,e,t,p);if(!(f===i?oi(h,l,d|g,n,p):f))return!1}}return!0}function ai(e){return!(!Ia(e)||(t=e,pt&&pt in t))&&(Sa(e)?mt:Ge).test(hs(e));var t}function ci(e){return"function"==typeof e?e:null==e?Rc:"object"==typeof e?ya(e)?di(e[0],e[1]):fi(e):Mc(e)}function ui(e){if(!Jo(e))return Kr(e);var t=[];for(var r in tt(e))lt.call(e,r)&&"constructor"!=r&&t.push(r);return t}function li(e){if(!Ia(e))return function(e){var t=[];if(null!=e)for(var r in tt(e))t.push(r);return t}(e);var t=Jo(e),r=[];for(var n in e)("constructor"!=n||!t&&lt.call(e,n))&&r.push(n);return r}function hi(e,t){return e<t}function pi(e,t){var r=-1,i=ba(e)?n(e.length):[];return Mn(e,function(e,n,o){i[++r]=t(e,n,o)}),i}function fi(e){var t=Uo(e);return 1==t.length&&t[0][2]?Zo(t[0][0],t[0][1]):function(r){return r===e||si(r,e,t)}}function di(e,t){return Yo(e)&&Xo(t)?Zo(ls(e),t):function(r){var n=Za(r,e);return n===i&&n===t?ec(r,e):oi(t,n,d|g)}}function gi(e,t,r,n,o){e!==t&&Gn(t,function(s,a){if(Ia(s))o||(o=new Cn),function(e,t,r,n,o,s,a){var c=rs(e,r),u=rs(t,r),l=a.get(u);if(l)In(e,r,l);else{var h=s?s(c,u,r+"",e,t,a):i,p=h===i;if(p){var f=ya(u),d=!f&&Ea(u),g=!f&&!d&&La(u);h=u,f||d||g?ya(c)?h=c:_a(c)?h=ro(c):d?(p=!1,h=$i(u,!0)):g?(p=!1,h=Xi(u,!0)):h=[]:Oa(u)||ma(u)?(h=c,ma(c)?h=Ha(c):Ia(c)&&!Sa(c)||(h=Ho(u))):p=!1}p&&(a.set(u,h),o(h,u,n,s,a),a.delete(u)),In(e,r,h)}}(e,t,a,r,gi,n,o);else{var c=n?n(rs(e,a),s,a+"",e,t,o):i;c===i&&(c=s),In(e,a,c)}},oc)}function mi(e,t){var r=e.length;if(r)return zo(t+=t<0?r:0,r)?e[t]:i}function yi(e,t,r){var n=-1;return t=Xt(t.length?t:[Rc],gr(Lo())),function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}(pi(e,function(e,r,i){return{criteria:Xt(t,function(t){return t(e)}),index:++n,value:e}}),function(e,t){return function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,s=i.length,a=r.length;++n<s;){var c=Zi(i[n],o[n]);if(c){if(n>=a)return c;var u=r[n];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,r)})}function vi(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var s=t[n],a=$n(e,s);r(a,s)&&Ai(o,zi(s,e),a)}return o}function bi(e,t,r,n){var i=n?ar:sr,o=-1,s=t.length,a=e;for(e===t&&(t=ro(t)),r&&(a=Xt(e,gr(r)));++o<s;)for(var c=0,u=t[o],l=r?r(u):u;(c=i(a,l,c,n))>-1;)a!==e&&Lt.call(a,c,1),Lt.call(e,c,1);return e}function _i(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==o){var o=i;zo(i)?Lt.call(e,i,1):Ui(e,i)}}return e}function Ei(e,t){return e+Ur(Yr()*(t-e+1))}function Ci(e,t){var r="";if(!e||t<1||t>B)return r;do{t%2&&(r+=e),(t=Ur(t/2))&&(e+=e)}while(t);return r}function wi(e,t){return os(es(e,t,Rc),e+"")}function Si(e){return Sn(fc(e))}function Ti(e,t){var r=fc(e);return cs(r,Dn(t,0,r.length))}function Ai(e,t,r,n){if(!Ia(e))return e;for(var o=-1,s=(t=zi(t,e)).length,a=s-1,c=e;null!=c&&++o<s;){var u=ls(t[o]),l=r;if(o!=a){var h=c[u];(l=n?n(h,u,c):i)===i&&(l=Ia(h)?h:zo(t[o+1])?[]:{})}Nn(c,u,l),c=c[u]}return e}var Ii=rn?function(e,t){return rn.set(e,t),e}:Rc,Ni=Br?function(e,t){return Br(e,"toString",{configurable:!0,enumerable:!1,value:Ic(t),writable:!0})}:Rc;function ki(e){return cs(fc(e))}function Ri(e,t,r){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var s=n(o);++i<o;)s[i]=e[i+t];return s}function Oi(e,t){var r;return Mn(e,function(e,n,i){return!(r=t(e,n,i))}),!!r}function xi(e,t,r){var n=0,i=null==e?n:e.length;if("number"==typeof t&&t==t&&i<=U){for(;n<i;){var o=n+i>>>1,s=e[o];null!==s&&!Pa(s)&&(r?s<=t:s<t)?n=o+1:i=o}return i}return Bi(e,t,Rc,r)}function Bi(e,t,r,n){t=r(t);for(var o=0,s=null==e?0:e.length,a=t!=t,c=null===t,u=Pa(t),l=t===i;o<s;){var h=Ur((o+s)/2),p=r(e[h]),f=p!==i,d=null===p,g=p==p,m=Pa(p);if(a)var y=n||g;else y=l?g&&(n||f):c?g&&f&&(n||!d):u?g&&f&&!d&&(n||!m):!d&&!m&&(n?p<=t:p<t);y?o=h+1:s=h}return Gr(s,j)}function Di(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var s=e[r],a=t?t(s):s;if(!r||!fa(a,c)){var c=a;o[i++]=0===s?0:s}}return o}function Pi(e){return"number"==typeof e?e:Pa(e)?P:+e}function Li(e){if("string"==typeof e)return e;if(ya(e))return Xt(e,Li)+"";if(Pa(e))return pn?pn.call(e):"";var t=e+"";return"0"==t&&1/e==-x?"-0":t}function ji(e,t,r){var n=-1,i=$t,s=e.length,a=!0,c=[],u=c;if(r)a=!1,i=Jt;else if(s>=o){var l=t?null:wo(e);if(l)return Ir(l);a=!1,i=yr,u=new En}else u=t?[]:c;e:for(;++n<s;){var h=e[n],p=t?t(h):h;if(h=r||0!==h?h:0,a&&p==p){for(var f=u.length;f--;)if(u[f]===p)continue e;t&&u.push(p),c.push(h)}else i(u,p,r)||(u!==c&&u.push(p),c.push(h))}return c}function Ui(e,t){return null==(e=ts(e,t=zi(t,e)))||delete e[ls(ws(t))]}function Mi(e,t,r,n){return Ai(e,t,r($n(e,t)),n)}function Fi(e,t,r,n){for(var i=e.length,o=n?i:-1;(n?o--:++o<i)&&t(e[o],o,e););return r?Ri(e,n?0:o,n?o+1:i):Ri(e,n?o+1:0,n?i:o)}function Vi(e,t){var r=e;return r instanceof yn&&(r=r.value()),er(t,function(e,t){return t.func.apply(t.thisArg,Zt([e],t.args))},r)}function qi(e,t,r){var i=e.length;if(i<2)return i?ji(e[0]):[];for(var o=-1,s=n(i);++o<i;)for(var a=e[o],c=-1;++c<i;)c!=o&&(s[o]=Un(s[o]||a,e[c],t,r));return ji(Hn(s,1),t,r)}function Ki(e,t,r){for(var n=-1,o=e.length,s=t.length,a={};++n<o;){var c=n<s?t[n]:i;r(a,e[n],c)}return a}function Hi(e){return _a(e)?e:[]}function Gi(e){return"function"==typeof e?e:Rc}function zi(e,t){return ya(e)?e:Yo(e,t)?[e]:us(Ga(e))}var Wi=wi;function Yi(e,t,r){var n=e.length;return r=r===i?n:r,!t&&r>=n?e:Ri(e,t,r)}var Qi=Dr||function(e){return xt.clearTimeout(e)};function $i(e,t){if(t)return e.slice();var r=e.length,n=Rt?Rt(r):new e.constructor(r);return e.copy(n),n}function Ji(e){var t=new e.constructor(e.byteLength);return new It(t).set(new It(e)),t}function Xi(e,t){var r=t?Ji(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function Zi(e,t){if(e!==t){var r=e!==i,n=null===e,o=e==e,s=Pa(e),a=t!==i,c=null===t,u=t==t,l=Pa(t);if(!c&&!l&&!s&&e>t||s&&a&&u&&!c&&!l||n&&a&&u||!r&&u||!o)return 1;if(!n&&!s&&!l&&e<t||l&&r&&o&&!n&&!s||c&&r&&o||!a&&o||!u)return-1}return 0}function eo(e,t,r,i){for(var o=-1,s=e.length,a=r.length,c=-1,u=t.length,l=Hr(s-a,0),h=n(u+l),p=!i;++c<u;)h[c]=t[c];for(;++o<a;)(p||o<s)&&(h[r[o]]=e[o]);for(;l--;)h[c++]=e[o++];return h}function to(e,t,r,i){for(var o=-1,s=e.length,a=-1,c=r.length,u=-1,l=t.length,h=Hr(s-c,0),p=n(h+l),f=!i;++o<h;)p[o]=e[o];for(var d=o;++u<l;)p[d+u]=t[u];for(;++a<c;)(f||o<s)&&(p[d+r[a]]=e[o++]);return p}function ro(e,t){var r=-1,i=e.length;for(t||(t=n(i));++r<i;)t[r]=e[r];return t}function no(e,t,r,n){var o=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var c=t[s],u=n?n(r[c],e[c],c,r,e):i;u===i&&(u=e[c]),o?xn(r,c,u):Nn(r,c,u)}return r}function io(e,t){return function(r,n){var i=ya(r)?Gt:Rn,o=t?t():{};return i(r,e,Lo(n,2),o)}}function oo(e){return wi(function(t,r){var n=-1,o=r.length,s=o>1?r[o-1]:i,a=o>2?r[2]:i;for(s=e.length>3&&"function"==typeof s?(o--,s):i,a&&Wo(r[0],r[1],a)&&(s=o<3?i:s,o=1),t=tt(t);++n<o;){var c=r[n];c&&e(t,c,n,s)}return t})}function so(e,t){return function(r,n){if(null==r)return r;if(!ba(r))return e(r,n);for(var i=r.length,o=t?i:-1,s=tt(r);(t?o--:++o<i)&&!1!==n(s[o],o,s););return r}}function ao(e){return function(t,r,n){for(var i=-1,o=tt(t),s=n(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===r(o[c],c,o))break}return t}}function co(e){return function(t){var r=wr(t=Ga(t))?Rr(t):i,n=r?r[0]:t.charAt(0),o=r?Yi(r,1).join(""):t.slice(1);return n[e]()+o}}function uo(e){return function(t){return er(Sc(mc(t).replace(yt,"")),e,"")}}function lo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=dn(e.prototype),n=e.apply(r,t);return Ia(n)?n:r}}function ho(e){return function(t,r,n){var o=tt(t);if(!ba(t)){var s=Lo(r,3);t=ic(t),r=function(e){return s(o[e],e,o)}}var a=e(t,r,n);return a>-1?o[s?t[a]:a]:i}}function po(e){return Ro(function(t){var r=t.length,n=r,o=mn.prototype.thru;for(e&&t.reverse();n--;){var s=t[n];if("function"!=typeof s)throw new it(a);if(o&&!c&&"wrapper"==Do(s))var c=new mn([],!0)}for(n=c?n:r;++n<r;){var u=Do(s=t[n]),l="wrapper"==u?Bo(s):i;c=l&&Qo(l[0])&&l[1]==(w|b|E|S)&&!l[4].length&&1==l[9]?c[Do(l[0])].apply(c,l[3]):1==s.length&&Qo(s)?c[u]():c.thru(s)}return function(){var e=arguments,n=e[0];if(c&&1==e.length&&ya(n))return c.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}})}function fo(e,t,r,o,s,a,c,u,l,h){var p=t&w,f=t&m,d=t&y,g=t&(b|_),v=t&T,E=d?i:lo(e);return function m(){for(var y=arguments.length,b=n(y),_=y;_--;)b[_]=arguments[_];if(g)var C=Po(m),w=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}(b,C);if(o&&(b=eo(b,o,s,g)),a&&(b=to(b,a,c,g)),y-=w,g&&y<h){var S=Ar(b,C);return Eo(e,t,fo,m.placeholder,r,b,S,u,l,h-y)}var T=f?r:this,A=d?T[e]:e;return y=b.length,u?b=function(e,t){for(var r=e.length,n=Gr(t.length,r),o=ro(e);n--;){var s=t[n];e[n]=zo(s,r)?o[s]:i}return e}(b,u):v&&y>1&&b.reverse(),p&&l<y&&(b.length=l),this&&this!==xt&&this instanceof m&&(A=E||lo(A)),A.apply(T,b)}}function go(e,t){return function(r,n){return function(e,t,r,n){return Wn(e,function(e,i,o){t(n,r(e),i,o)}),n}(r,e,t(n),{})}}function mo(e,t){return function(r,n){var o;if(r===i&&n===i)return t;if(r!==i&&(o=r),n!==i){if(o===i)return n;"string"==typeof r||"string"==typeof n?(r=Li(r),n=Li(n)):(r=Pi(r),n=Pi(n)),o=e(r,n)}return o}}function yo(e){return Ro(function(t){return t=Xt(t,gr(Lo())),wi(function(r){var n=this;return e(t,function(e){return Ht(e,n,r)})})})}function vo(e,t){var r=(t=t===i?" ":Li(t)).length;if(r<2)return r?Ci(t,e):t;var n=Ci(t,jr(e/kr(t)));return wr(t)?Yi(Rr(n),0,e).join(""):n.slice(0,e)}function bo(e){return function(t,r,o){return o&&"number"!=typeof o&&Wo(t,r,o)&&(r=o=i),t=Fa(t),r===i?(r=t,t=0):r=Fa(r),function(e,t,r,i){for(var o=-1,s=Hr(jr((t-e)/(r||1)),0),a=n(s);s--;)a[i?s:++o]=e,e+=r;return a}(t,r,o=o===i?t<r?1:-1:Fa(o),e)}}function _o(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=Ka(t),r=Ka(r)),e(t,r)}}function Eo(e,t,r,n,o,s,a,c,u,l){var h=t&b;t|=h?E:C,(t&=~(h?C:E))&v||(t&=~(m|y));var p=[e,t,o,h?s:i,h?a:i,h?i:s,h?i:a,c,u,l],f=r.apply(i,p);return Qo(e)&&ns(f,p),f.placeholder=n,ss(f,e,t)}function Co(e){var t=et[e];return function(e,r){if(e=Ka(e),r=null==r?0:Gr(Va(r),292)){var n=(Ga(e)+"e").split("e");return+((n=(Ga(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}var wo=Zr&&1/Ir(new Zr([,-0]))[1]==x?function(e){return new Zr(e)}:Pc;function So(e){return function(t){var r=qo(t);return r==Q?Sr(t):r==te?Nr(t):function(e,t){return Xt(t,function(t){return[t,e[t]]})}(t,e(t))}}function To(e,t,r,o,s,c,u,h){var p=t&y;if(!p&&"function"!=typeof e)throw new it(a);var f=o?o.length:0;if(f||(t&=~(E|C),o=s=i),u=u===i?u:Hr(Va(u),0),h=h===i?h:Va(h),f-=s?s.length:0,t&C){var d=o,g=s;o=s=i}var T=p?i:Bo(e),A=[e,t,r,o,s,d,g,c,u,h];if(T&&function(e,t){var r=e[1],n=t[1],i=r|n,o=i<(m|y|w),s=n==w&&r==b||n==w&&r==S&&e[7].length<=t[8]||n==(w|S)&&t[7].length<=t[8]&&r==b;if(!o&&!s)return e;n&m&&(e[2]=t[2],i|=r&m?0:v);var a=t[3];if(a){var c=e[3];e[3]=c?eo(c,a,t[4]):a,e[4]=c?Ar(e[3],l):t[4]}(a=t[5])&&(c=e[5],e[5]=c?to(c,a,t[6]):a,e[6]=c?Ar(e[5],l):t[6]),(a=t[7])&&(e[7]=a),n&w&&(e[8]=null==e[8]?t[8]:Gr(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(A,T),e=A[0],t=A[1],r=A[2],o=A[3],s=A[4],!(h=A[9]=A[9]===i?p?0:e.length:Hr(A[9]-f,0))&&t&(b|_)&&(t&=~(b|_)),t&&t!=m)I=t==b||t==_?function(e,t,r){var o=lo(e);return function s(){for(var a=arguments.length,c=n(a),u=a,l=Po(s);u--;)c[u]=arguments[u];var h=a<3&&c[0]!==l&&c[a-1]!==l?[]:Ar(c,l);return(a-=h.length)<r?Eo(e,t,fo,s.placeholder,i,c,h,i,i,r-a):Ht(this&&this!==xt&&this instanceof s?o:e,this,c)}}(e,t,h):t!=E&&t!=(m|E)||s.length?fo.apply(i,A):function(e,t,r,i){var o=t&m,s=lo(e);return function t(){for(var a=-1,c=arguments.length,u=-1,l=i.length,h=n(l+c),p=this&&this!==xt&&this instanceof t?s:e;++u<l;)h[u]=i[u];for(;c--;)h[u++]=arguments[++a];return Ht(p,o?r:this,h)}}(e,t,r,o);else var I=function(e,t,r){var n=t&m,i=lo(e);return function t(){return(this&&this!==xt&&this instanceof t?i:e).apply(n?r:this,arguments)}}(e,t,r);return ss((T?Ii:ns)(I,A),e,t)}function Ao(e,t,r,n){return e===i||fa(e,at[r])&&!lt.call(n,r)?t:e}function Io(e,t,r,n,o,s){return Ia(e)&&Ia(t)&&(s.set(t,e),gi(e,t,i,Io,s),s.delete(t)),e}function No(e){return Oa(e)?i:e}function ko(e,t,r,n,o,s){var a=r&d,c=e.length,u=t.length;if(c!=u&&!(a&&u>c))return!1;var l=s.get(e);if(l&&s.get(t))return l==t;var h=-1,p=!0,f=r&g?new En:i;for(s.set(e,t),s.set(t,e);++h<c;){var m=e[h],y=t[h];if(n)var v=a?n(y,m,h,t,e,s):n(m,y,h,e,t,s);if(v!==i){if(v)continue;p=!1;break}if(f){if(!rr(t,function(e,t){if(!yr(f,t)&&(m===e||o(m,e,r,n,s)))return f.push(t)})){p=!1;break}}else if(m!==y&&!o(m,y,r,n,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function Ro(e){return os(es(e,i,vs),e+"")}function Oo(e){return Jn(e,ic,Fo)}function xo(e){return Jn(e,oc,Vo)}var Bo=rn?function(e){return rn.get(e)}:Pc;function Do(e){for(var t=e.name+"",r=nn[t],n=lt.call(nn,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t}function Po(e){return(lt.call(fn,"placeholder")?fn:e).placeholder}function Lo(){var e=fn.iteratee||Oc;return e=e===Oc?ci:e,arguments.length?e(arguments[0],arguments[1]):e}function jo(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Uo(e){for(var t=ic(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,Xo(i)]}return t}function Mo(e,t){var r=function(e,t){return null==e?i:e[t]}(e,t);return ai(r)?r:i}var Fo=Mr?function(e){return null==e?[]:(e=tt(e),Qt(Mr(e),function(t){return Dt.call(e,t)}))}:qc,Vo=Mr?function(e){for(var t=[];e;)Zt(t,Fo(e)),e=Ot(e);return t}:qc,qo=Xn;function Ko(e,t,r){for(var n=-1,i=(t=zi(t,e)).length,o=!1;++n<i;){var s=ls(t[n]);if(!(o=null!=e&&r(e,s)))break;e=e[s]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Aa(i)&&zo(s,i)&&(ya(e)||ma(e))}function Ho(e){return"function"!=typeof e.constructor||Jo(e)?{}:dn(Ot(e))}function Go(e){return ya(e)||ma(e)||!!(jt&&e&&e[jt])}function zo(e,t){var r=typeof e;return!!(t=null==t?B:t)&&("number"==r||"symbol"!=r&&We.test(e))&&e>-1&&e%1==0&&e<t}function Wo(e,t,r){if(!Ia(r))return!1;var n=typeof t;return!!("number"==n?ba(r)&&zo(t,r.length):"string"==n&&t in r)&&fa(r[t],e)}function Yo(e,t){if(ya(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Pa(e))||ke.test(e)||!Ne.test(e)||null!=t&&e in tt(t)}function Qo(e){var t=Do(e),r=fn[t];if("function"!=typeof r||!(t in yn.prototype))return!1;if(e===r)return!0;var n=Bo(r);return!!n&&e===n[0]}($r&&qo(new $r(new ArrayBuffer(1)))!=ce||Jr&&qo(new Jr)!=Q||Xr&&"[object Promise]"!=qo(Xr.resolve())||Zr&&qo(new Zr)!=te||en&&qo(new en)!=oe)&&(qo=function(e){var t=Xn(e),r=t==X?e.constructor:i,n=r?hs(r):"";if(n)switch(n){case on:return ce;case sn:return Q;case an:return"[object Promise]";case cn:return te;case un:return oe}return t});var $o=ct?Sa:Kc;function Jo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||at)}function Xo(e){return e==e&&!Ia(e)}function Zo(e,t){return function(r){return null!=r&&r[e]===t&&(t!==i||e in tt(r))}}function es(e,t,r){return t=Hr(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=Hr(i.length-t,0),a=n(s);++o<s;)a[o]=i[t+o];o=-1;for(var c=n(t+1);++o<t;)c[o]=i[o];return c[t]=r(a),Ht(e,this,c)}}function ts(e,t){return t.length<2?e:$n(e,Ri(t,0,-1))}function rs(e,t){if("__proto__"!=t)return e[t]}var ns=as(Ii),is=Lr||function(e,t){return xt.setTimeout(e,t)},os=as(Ni);function ss(e,t,r){var n=t+"";return os(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(Le,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return zt(M,function(r){var n="_."+r[0];t&r[1]&&!$t(e,n)&&e.push(n)}),e.sort()}(function(e){var t=e.match(je);return t?t[1].split(Ue):[]}(n),r)))}function as(e){var t=0,r=0;return function(){var n=zr(),o=k-(n-r);if(r=n,o>0){if(++t>=N)return arguments[0]}else t=0;return e.apply(i,arguments)}}function cs(e,t){var r=-1,n=e.length,o=n-1;for(t=t===i?n:t;++r<t;){var s=Ei(r,o),a=e[s];e[s]=e[r],e[r]=a}return e.length=t,e}var us=function(e){var t=aa(e,function(e){return r.size===u&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Re,function(e,r,n,i){t.push(n?i.replace(Fe,"$1"):r||e)}),t});function ls(e){if("string"==typeof e||Pa(e))return e;var t=e+"";return"0"==t&&1/e==-x?"-0":t}function hs(e){if(null!=e){try{return ut.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ps(e){if(e instanceof yn)return e.clone();var t=new mn(e.__wrapped__,e.__chain__);return t.__actions__=ro(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var fs=wi(function(e,t){return _a(e)?Un(e,Hn(t,1,_a,!0)):[]}),ds=wi(function(e,t){var r=ws(t);return _a(r)&&(r=i),_a(e)?Un(e,Hn(t,1,_a,!0),Lo(r,2)):[]}),gs=wi(function(e,t){var r=ws(t);return _a(r)&&(r=i),_a(e)?Un(e,Hn(t,1,_a,!0),i,r):[]});function ms(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Va(r);return i<0&&(i=Hr(n+i,0)),or(e,Lo(t,3),i)}function ys(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=n-1;return r!==i&&(o=Va(r),o=r<0?Hr(n+o,0):Gr(o,n-1)),or(e,Lo(t,3),o,!0)}function vs(e){return null!=e&&e.length?Hn(e,1):[]}function bs(e){return e&&e.length?e[0]:i}var _s=wi(function(e){var t=Xt(e,Hi);return t.length&&t[0]===e[0]?ri(t):[]}),Es=wi(function(e){var t=ws(e),r=Xt(e,Hi);return t===ws(r)?t=i:r.pop(),r.length&&r[0]===e[0]?ri(r,Lo(t,2)):[]}),Cs=wi(function(e){var t=ws(e),r=Xt(e,Hi);return(t="function"==typeof t?t:i)&&r.pop(),r.length&&r[0]===e[0]?ri(r,i,t):[]});function ws(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Ss=wi(Ts);function Ts(e,t){return e&&e.length&&t&&t.length?bi(e,t):e}var As=Ro(function(e,t){var r=null==e?0:e.length,n=Bn(e,t);return _i(e,Xt(t,function(e){return zo(e,r)?+e:e}).sort(Zi)),n});function Is(e){return null==e?e:Qr.call(e)}var Ns=wi(function(e){return ji(Hn(e,1,_a,!0))}),ks=wi(function(e){var t=ws(e);return _a(t)&&(t=i),ji(Hn(e,1,_a,!0),Lo(t,2))}),Rs=wi(function(e){var t=ws(e);return t="function"==typeof t?t:i,ji(Hn(e,1,_a,!0),i,t)});function Os(e){if(!e||!e.length)return[];var t=0;return e=Qt(e,function(e){if(_a(e))return t=Hr(e.length,t),!0}),dr(t,function(t){return Xt(e,lr(t))})}function xs(e,t){if(!e||!e.length)return[];var r=Os(e);return null==t?r:Xt(r,function(e){return Ht(t,i,e)})}var Bs=wi(function(e,t){return _a(e)?Un(e,t):[]}),Ds=wi(function(e){return qi(Qt(e,_a))}),Ps=wi(function(e){var t=ws(e);return _a(t)&&(t=i),qi(Qt(e,_a),Lo(t,2))}),Ls=wi(function(e){var t=ws(e);return t="function"==typeof t?t:i,qi(Qt(e,_a),i,t)}),js=wi(Os);var Us=wi(function(e){var t=e.length,r=t>1?e[t-1]:i;return r="function"==typeof r?(e.pop(),r):i,xs(e,r)});function Ms(e){var t=fn(e);return t.__chain__=!0,t}function Fs(e,t){return t(e)}var Vs=Ro(function(e){var t=e.length,r=t?e[0]:0,n=this.__wrapped__,o=function(t){return Bn(t,e)};return!(t>1||this.__actions__.length)&&n instanceof yn&&zo(r)?((n=n.slice(r,+r+(t?1:0))).__actions__.push({func:Fs,args:[o],thisArg:i}),new mn(n,this.__chain__).thru(function(e){return t&&!e.length&&e.push(i),e})):this.thru(o)});var qs=io(function(e,t,r){lt.call(e,r)?++e[r]:xn(e,r,1)});var Ks=ho(ms),Hs=ho(ys);function Gs(e,t){return(ya(e)?zt:Mn)(e,Lo(t,3))}function zs(e,t){return(ya(e)?Wt:Fn)(e,Lo(t,3))}var Ws=io(function(e,t,r){lt.call(e,r)?e[r].push(t):xn(e,r,[t])});var Ys=wi(function(e,t,r){var i=-1,o="function"==typeof t,s=ba(e)?n(e.length):[];return Mn(e,function(e){s[++i]=o?Ht(t,e,r):ni(e,t,r)}),s}),Qs=io(function(e,t,r){xn(e,r,t)});function $s(e,t){return(ya(e)?Xt:pi)(e,Lo(t,3))}var Js=io(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]});var Xs=wi(function(e,t){if(null==e)return[];var r=t.length;return r>1&&Wo(e,t[0],t[1])?t=[]:r>2&&Wo(t[0],t[1],t[2])&&(t=[t[0]]),yi(e,Hn(t,1),[])}),Zs=Pr||function(){return xt.Date.now()};function ea(e,t,r){return t=r?i:t,t=e&&null==t?e.length:t,To(e,w,i,i,i,i,t)}function ta(e,t){var r;if("function"!=typeof t)throw new it(a);return e=Va(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=i),r}}var ra=wi(function(e,t,r){var n=m;if(r.length){var i=Ar(r,Po(ra));n|=E}return To(e,n,t,r,i)}),na=wi(function(e,t,r){var n=m|y;if(r.length){var i=Ar(r,Po(na));n|=E}return To(t,n,e,r,i)});function ia(e,t,r){var n,o,s,c,u,l,h=0,p=!1,f=!1,d=!0;if("function"!=typeof e)throw new it(a);function g(t){var r=n,s=o;return n=o=i,h=t,c=e.apply(s,r)}function m(e){var r=e-l;return l===i||r>=t||r<0||f&&e-h>=s}function y(){var e=Zs();if(m(e))return v(e);u=is(y,function(e){var r=t-(e-l);return f?Gr(r,s-(e-h)):r}(e))}function v(e){return u=i,d&&n?g(e):(n=o=i,c)}function b(){var e=Zs(),r=m(e);if(n=arguments,o=this,l=e,r){if(u===i)return function(e){return h=e,u=is(y,t),p?g(e):c}(l);if(f)return u=is(y,t),g(l)}return u===i&&(u=is(y,t)),c}return t=Ka(t)||0,Ia(r)&&(p=!!r.leading,s=(f="maxWait"in r)?Hr(Ka(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d),b.cancel=function(){u!==i&&Qi(u),h=0,n=l=o=u=i},b.flush=function(){return u===i?c:v(Zs())},b}var oa=wi(function(e,t){return jn(e,1,t)}),sa=wi(function(e,t,r){return jn(e,Ka(t)||0,r)});function aa(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new it(a);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(aa.Cache||_n),r}function ca(e){if("function"!=typeof e)throw new it(a);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}aa.Cache=_n;var ua=Wi(function(e,t){var r=(t=1==t.length&&ya(t[0])?Xt(t[0],gr(Lo())):Xt(Hn(t,1),gr(Lo()))).length;return wi(function(n){for(var i=-1,o=Gr(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return Ht(e,this,n)})}),la=wi(function(e,t){var r=Ar(t,Po(la));return To(e,E,i,t,r)}),ha=wi(function(e,t){var r=Ar(t,Po(ha));return To(e,C,i,t,r)}),pa=Ro(function(e,t){return To(e,S,i,i,i,t)});function fa(e,t){return e===t||e!=e&&t!=t}var da=_o(Zn),ga=_o(function(e,t){return e>=t}),ma=ii(function(){return arguments}())?ii:function(e){return Na(e)&&lt.call(e,"callee")&&!Dt.call(e,"callee")},ya=n.isArray,va=Ut?gr(Ut):function(e){return Na(e)&&Xn(e)==ae};function ba(e){return null!=e&&Aa(e.length)&&!Sa(e)}function _a(e){return Na(e)&&ba(e)}var Ea=Fr||Kc,Ca=Mt?gr(Mt):function(e){return Na(e)&&Xn(e)==H};function wa(e){if(!Na(e))return!1;var t=Xn(e);return t==z||t==G||"string"==typeof e.message&&"string"==typeof e.name&&!Oa(e)}function Sa(e){if(!Ia(e))return!1;var t=Xn(e);return t==W||t==Y||t==q||t==Z}function Ta(e){return"number"==typeof e&&e==Va(e)}function Aa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=B}function Ia(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Na(e){return null!=e&&"object"==typeof e}var ka=Ft?gr(Ft):function(e){return Na(e)&&qo(e)==Q};function Ra(e){return"number"==typeof e||Na(e)&&Xn(e)==$}function Oa(e){if(!Na(e)||Xn(e)!=X)return!1;var t=Ot(e);if(null===t)return!0;var r=lt.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&ut.call(r)==dt}var xa=Vt?gr(Vt):function(e){return Na(e)&&Xn(e)==ee};var Ba=qt?gr(qt):function(e){return Na(e)&&qo(e)==te};function Da(e){return"string"==typeof e||!ya(e)&&Na(e)&&Xn(e)==re}function Pa(e){return"symbol"==typeof e||Na(e)&&Xn(e)==ne}var La=Kt?gr(Kt):function(e){return Na(e)&&Aa(e.length)&&!!Tt[Xn(e)]};var ja=_o(hi),Ua=_o(function(e,t){return e<=t});function Ma(e){if(!e)return[];if(ba(e))return Da(e)?Rr(e):ro(e);if(nr&&e[nr])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[nr]());var t=qo(e);return(t==Q?Sr:t==te?Ir:fc)(e)}function Fa(e){return e?(e=Ka(e))===x||e===-x?(e<0?-1:1)*D:e==e?e:0:0===e?e:0}function Va(e){var t=Fa(e),r=t%1;return t==t?r?t-r:t:0}function qa(e){return e?Dn(Va(e),0,L):0}function Ka(e){if("number"==typeof e)return e;if(Pa(e))return P;if(Ia(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ia(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Be,"");var r=He.test(e);return r||ze.test(e)?kt(e.slice(2),r?2:8):Ke.test(e)?P:+e}function Ha(e){return no(e,oc(e))}function Ga(e){return null==e?"":Li(e)}var za=oo(function(e,t){if(Jo(t)||ba(t))no(t,ic(t),e);else for(var r in t)lt.call(t,r)&&Nn(e,r,t[r])}),Wa=oo(function(e,t){no(t,oc(t),e)}),Ya=oo(function(e,t,r,n){no(t,oc(t),e,n)}),Qa=oo(function(e,t,r,n){no(t,ic(t),e,n)}),$a=Ro(Bn);var Ja=wi(function(e,t){e=tt(e);var r=-1,n=t.length,o=n>2?t[2]:i;for(o&&Wo(t[0],t[1],o)&&(n=1);++r<n;)for(var s=t[r],a=oc(s),c=-1,u=a.length;++c<u;){var l=a[c],h=e[l];(h===i||fa(h,at[l])&&!lt.call(e,l))&&(e[l]=s[l])}return e}),Xa=wi(function(e){return e.push(i,Io),Ht(ac,i,e)});function Za(e,t,r){var n=null==e?i:$n(e,t);return n===i?r:n}function ec(e,t){return null!=e&&Ko(e,t,ti)}var tc=go(function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),e[t]=r},Ic(Rc)),rc=go(function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),lt.call(e,t)?e[t].push(r):e[t]=[r]},Lo),nc=wi(ni);function ic(e){return ba(e)?wn(e):ui(e)}function oc(e){return ba(e)?wn(e,!0):li(e)}var sc=oo(function(e,t,r){gi(e,t,r)}),ac=oo(function(e,t,r,n){gi(e,t,r,n)}),cc=Ro(function(e,t){var r={};if(null==e)return r;var n=!1;t=Xt(t,function(t){return t=zi(t,e),n||(n=t.length>1),t}),no(e,xo(e),r),n&&(r=Pn(r,h|p|f,No));for(var i=t.length;i--;)Ui(r,t[i]);return r});var uc=Ro(function(e,t){return null==e?{}:function(e,t){return vi(e,t,function(t,r){return ec(e,r)})}(e,t)});function lc(e,t){if(null==e)return{};var r=Xt(xo(e),function(e){return[e]});return t=Lo(t),vi(e,r,function(e,r){return t(e,r[0])})}var hc=So(ic),pc=So(oc);function fc(e){return null==e?[]:mr(e,ic(e))}var dc=uo(function(e,t,r){return t=t.toLowerCase(),e+(r?gc(t):t)});function gc(e){return wc(Ga(e).toLowerCase())}function mc(e){return(e=Ga(e))&&e.replace(Ye,_r).replace(vt,"")}var yc=uo(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),vc=uo(function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}),bc=co("toLowerCase");var _c=uo(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()});var Ec=uo(function(e,t,r){return e+(r?" ":"")+wc(t)});var Cc=uo(function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}),wc=co("toUpperCase");function Sc(e,t,r){return e=Ga(e),(t=r?i:t)===i?function(e){return Ct.test(e)}(e)?function(e){return e.match(_t)||[]}(e):function(e){return e.match(Me)||[]}(e):e.match(t)||[]}var Tc=wi(function(e,t){try{return Ht(e,i,t)}catch(e){return wa(e)?e:new Xe(e)}}),Ac=Ro(function(e,t){return zt(t,function(t){t=ls(t),xn(e,t,ra(e[t],e))}),e});function Ic(e){return function(){return e}}var Nc=po(),kc=po(!0);function Rc(e){return e}function Oc(e){return ci("function"==typeof e?e:Pn(e,h))}var xc=wi(function(e,t){return function(r){return ni(r,e,t)}}),Bc=wi(function(e,t){return function(r){return ni(e,r,t)}});function Dc(e,t,r){var n=ic(t),i=Qn(t,n);null!=r||Ia(t)&&(i.length||!n.length)||(r=t,t=e,e=this,i=Qn(t,ic(t)));var o=!(Ia(r)&&"chain"in r&&!r.chain),s=Sa(e);return zt(i,function(r){var n=t[r];e[r]=n,s&&(e.prototype[r]=function(){var t=this.__chain__;if(o||t){var r=e(this.__wrapped__);return(r.__actions__=ro(this.__actions__)).push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,Zt([this.value()],arguments))})}),e}function Pc(){}var Lc=yo(Xt),jc=yo(Yt),Uc=yo(rr);function Mc(e){return Yo(e)?lr(ls(e)):function(e){return function(t){return $n(t,e)}}(e)}var Fc=bo(),Vc=bo(!0);function qc(){return[]}function Kc(){return!1}var Hc=mo(function(e,t){return e+t},0),Gc=Co("ceil"),zc=mo(function(e,t){return e/t},1),Wc=Co("floor");var Yc,Qc=mo(function(e,t){return e*t},1),$c=Co("round"),Jc=mo(function(e,t){return e-t},0);return fn.after=function(e,t){if("function"!=typeof t)throw new it(a);return e=Va(e),function(){if(--e<1)return t.apply(this,arguments)}},fn.ary=ea,fn.assign=za,fn.assignIn=Wa,fn.assignInWith=Ya,fn.assignWith=Qa,fn.at=$a,fn.before=ta,fn.bind=ra,fn.bindAll=Ac,fn.bindKey=na,fn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return ya(e)?e:[e]},fn.chain=Ms,fn.chunk=function(e,t,r){t=(r?Wo(e,t,r):t===i)?1:Hr(Va(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var s=0,a=0,c=n(jr(o/t));s<o;)c[a++]=Ri(e,s,s+=t);return c},fn.compact=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},fn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Zt(ya(r)?ro(r):[r],Hn(t,1))},fn.cond=function(e){var t=null==e?0:e.length,r=Lo();return e=t?Xt(e,function(e){if("function"!=typeof e[1])throw new it(a);return[r(e[0]),e[1]]}):[],wi(function(r){for(var n=-1;++n<t;){var i=e[n];if(Ht(i[0],this,r))return Ht(i[1],this,r)}})},fn.conforms=function(e){return function(e){var t=ic(e);return function(r){return Ln(r,e,t)}}(Pn(e,h))},fn.constant=Ic,fn.countBy=qs,fn.create=function(e,t){var r=dn(e);return null==t?r:On(r,t)},fn.curry=function e(t,r,n){var o=To(t,b,i,i,i,i,i,r=n?i:r);return o.placeholder=e.placeholder,o},fn.curryRight=function e(t,r,n){var o=To(t,_,i,i,i,i,i,r=n?i:r);return o.placeholder=e.placeholder,o},fn.debounce=ia,fn.defaults=Ja,fn.defaultsDeep=Xa,fn.defer=oa,fn.delay=sa,fn.difference=fs,fn.differenceBy=ds,fn.differenceWith=gs,fn.drop=function(e,t,r){var n=null==e?0:e.length;return n?Ri(e,(t=r||t===i?1:Va(t))<0?0:t,n):[]},fn.dropRight=function(e,t,r){var n=null==e?0:e.length;return n?Ri(e,0,(t=n-(t=r||t===i?1:Va(t)))<0?0:t):[]},fn.dropRightWhile=function(e,t){return e&&e.length?Fi(e,Lo(t,3),!0,!0):[]},fn.dropWhile=function(e,t){return e&&e.length?Fi(e,Lo(t,3),!0):[]},fn.fill=function(e,t,r,n){var o=null==e?0:e.length;return o?(r&&"number"!=typeof r&&Wo(e,t,r)&&(r=0,n=o),function(e,t,r,n){var o=e.length;for((r=Va(r))<0&&(r=-r>o?0:o+r),(n=n===i||n>o?o:Va(n))<0&&(n+=o),n=r>n?0:qa(n);r<n;)e[r++]=t;return e}(e,t,r,n)):[]},fn.filter=function(e,t){return(ya(e)?Qt:Kn)(e,Lo(t,3))},fn.flatMap=function(e,t){return Hn($s(e,t),1)},fn.flatMapDeep=function(e,t){return Hn($s(e,t),x)},fn.flatMapDepth=function(e,t,r){return r=r===i?1:Va(r),Hn($s(e,t),r)},fn.flatten=vs,fn.flattenDeep=function(e){return null!=e&&e.length?Hn(e,x):[]},fn.flattenDepth=function(e,t){return null!=e&&e.length?Hn(e,t=t===i?1:Va(t)):[]},fn.flip=function(e){return To(e,T)},fn.flow=Nc,fn.flowRight=kc,fn.fromPairs=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n},fn.functions=function(e){return null==e?[]:Qn(e,ic(e))},fn.functionsIn=function(e){return null==e?[]:Qn(e,oc(e))},fn.groupBy=Ws,fn.initial=function(e){return null!=e&&e.length?Ri(e,0,-1):[]},fn.intersection=_s,fn.intersectionBy=Es,fn.intersectionWith=Cs,fn.invert=tc,fn.invertBy=rc,fn.invokeMap=Ys,fn.iteratee=Oc,fn.keyBy=Qs,fn.keys=ic,fn.keysIn=oc,fn.map=$s,fn.mapKeys=function(e,t){var r={};return t=Lo(t,3),Wn(e,function(e,n,i){xn(r,t(e,n,i),e)}),r},fn.mapValues=function(e,t){var r={};return t=Lo(t,3),Wn(e,function(e,n,i){xn(r,n,t(e,n,i))}),r},fn.matches=function(e){return fi(Pn(e,h))},fn.matchesProperty=function(e,t){return di(e,Pn(t,h))},fn.memoize=aa,fn.merge=sc,fn.mergeWith=ac,fn.method=xc,fn.methodOf=Bc,fn.mixin=Dc,fn.negate=ca,fn.nthArg=function(e){return e=Va(e),wi(function(t){return mi(t,e)})},fn.omit=cc,fn.omitBy=function(e,t){return lc(e,ca(Lo(t)))},fn.once=function(e){return ta(2,e)},fn.orderBy=function(e,t,r,n){return null==e?[]:(ya(t)||(t=null==t?[]:[t]),ya(r=n?i:r)||(r=null==r?[]:[r]),yi(e,t,r))},fn.over=Lc,fn.overArgs=ua,fn.overEvery=jc,fn.overSome=Uc,fn.partial=la,fn.partialRight=ha,fn.partition=Js,fn.pick=uc,fn.pickBy=lc,fn.property=Mc,fn.propertyOf=function(e){return function(t){return null==e?i:$n(e,t)}},fn.pull=Ss,fn.pullAll=Ts,fn.pullAllBy=function(e,t,r){return e&&e.length&&t&&t.length?bi(e,t,Lo(r,2)):e},fn.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?bi(e,t,i,r):e},fn.pullAt=As,fn.range=Fc,fn.rangeRight=Vc,fn.rearg=pa,fn.reject=function(e,t){return(ya(e)?Qt:Kn)(e,ca(Lo(t,3)))},fn.remove=function(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],o=e.length;for(t=Lo(t,3);++n<o;){var s=e[n];t(s,n,e)&&(r.push(s),i.push(n))}return _i(e,i),r},fn.rest=function(e,t){if("function"!=typeof e)throw new it(a);return wi(e,t=t===i?t:Va(t))},fn.reverse=Is,fn.sampleSize=function(e,t,r){return t=(r?Wo(e,t,r):t===i)?1:Va(t),(ya(e)?Tn:Ti)(e,t)},fn.set=function(e,t,r){return null==e?e:Ai(e,t,r)},fn.setWith=function(e,t,r,n){return n="function"==typeof n?n:i,null==e?e:Ai(e,t,r,n)},fn.shuffle=function(e){return(ya(e)?An:ki)(e)},fn.slice=function(e,t,r){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&Wo(e,t,r)?(t=0,r=n):(t=null==t?0:Va(t),r=r===i?n:Va(r)),Ri(e,t,r)):[]},fn.sortBy=Xs,fn.sortedUniq=function(e){return e&&e.length?Di(e):[]},fn.sortedUniqBy=function(e,t){return e&&e.length?Di(e,Lo(t,2)):[]},fn.split=function(e,t,r){return r&&"number"!=typeof r&&Wo(e,t,r)&&(t=r=i),(r=r===i?L:r>>>0)?(e=Ga(e))&&("string"==typeof t||null!=t&&!xa(t))&&!(t=Li(t))&&wr(e)?Yi(Rr(e),0,r):e.split(t,r):[]},fn.spread=function(e,t){if("function"!=typeof e)throw new it(a);return t=null==t?0:Hr(Va(t),0),wi(function(r){var n=r[t],i=Yi(r,0,t);return n&&Zt(i,n),Ht(e,this,i)})},fn.tail=function(e){var t=null==e?0:e.length;return t?Ri(e,1,t):[]},fn.take=function(e,t,r){return e&&e.length?Ri(e,0,(t=r||t===i?1:Va(t))<0?0:t):[]},fn.takeRight=function(e,t,r){var n=null==e?0:e.length;return n?Ri(e,(t=n-(t=r||t===i?1:Va(t)))<0?0:t,n):[]},fn.takeRightWhile=function(e,t){return e&&e.length?Fi(e,Lo(t,3),!1,!0):[]},fn.takeWhile=function(e,t){return e&&e.length?Fi(e,Lo(t,3)):[]},fn.tap=function(e,t){return t(e),e},fn.throttle=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new it(a);return Ia(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),ia(e,t,{leading:n,maxWait:t,trailing:i})},fn.thru=Fs,fn.toArray=Ma,fn.toPairs=hc,fn.toPairsIn=pc,fn.toPath=function(e){return ya(e)?Xt(e,ls):Pa(e)?[e]:ro(us(Ga(e)))},fn.toPlainObject=Ha,fn.transform=function(e,t,r){var n=ya(e),i=n||Ea(e)||La(e);if(t=Lo(t,4),null==r){var o=e&&e.constructor;r=i?n?new o:[]:Ia(e)&&Sa(o)?dn(Ot(e)):{}}return(i?zt:Wn)(e,function(e,n,i){return t(r,e,n,i)}),r},fn.unary=function(e){return ea(e,1)},fn.union=Ns,fn.unionBy=ks,fn.unionWith=Rs,fn.uniq=function(e){return e&&e.length?ji(e):[]},fn.uniqBy=function(e,t){return e&&e.length?ji(e,Lo(t,2)):[]},fn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?ji(e,i,t):[]},fn.unset=function(e,t){return null==e||Ui(e,t)},fn.unzip=Os,fn.unzipWith=xs,fn.update=function(e,t,r){return null==e?e:Mi(e,t,Gi(r))},fn.updateWith=function(e,t,r,n){return n="function"==typeof n?n:i,null==e?e:Mi(e,t,Gi(r),n)},fn.values=fc,fn.valuesIn=function(e){return null==e?[]:mr(e,oc(e))},fn.without=Bs,fn.words=Sc,fn.wrap=function(e,t){return la(Gi(t),e)},fn.xor=Ds,fn.xorBy=Ps,fn.xorWith=Ls,fn.zip=js,fn.zipObject=function(e,t){return Ki(e||[],t||[],Nn)},fn.zipObjectDeep=function(e,t){return Ki(e||[],t||[],Ai)},fn.zipWith=Us,fn.entries=hc,fn.entriesIn=pc,fn.extend=Wa,fn.extendWith=Ya,Dc(fn,fn),fn.add=Hc,fn.attempt=Tc,fn.camelCase=dc,fn.capitalize=gc,fn.ceil=Gc,fn.clamp=function(e,t,r){return r===i&&(r=t,t=i),r!==i&&(r=(r=Ka(r))==r?r:0),t!==i&&(t=(t=Ka(t))==t?t:0),Dn(Ka(e),t,r)},fn.clone=function(e){return Pn(e,f)},fn.cloneDeep=function(e){return Pn(e,h|f)},fn.cloneDeepWith=function(e,t){return Pn(e,h|f,t="function"==typeof t?t:i)},fn.cloneWith=function(e,t){return Pn(e,f,t="function"==typeof t?t:i)},fn.conformsTo=function(e,t){return null==t||Ln(e,t,ic(t))},fn.deburr=mc,fn.defaultTo=function(e,t){return null==e||e!=e?t:e},fn.divide=zc,fn.endsWith=function(e,t,r){e=Ga(e),t=Li(t);var n=e.length,o=r=r===i?n:Dn(Va(r),0,n);return(r-=t.length)>=0&&e.slice(r,o)==t},fn.eq=fa,fn.escape=function(e){return(e=Ga(e))&&Se.test(e)?e.replace(Ce,Er):e},fn.escapeRegExp=function(e){return(e=Ga(e))&&xe.test(e)?e.replace(Oe,"\\$&"):e},fn.every=function(e,t,r){var n=ya(e)?Yt:Vn;return r&&Wo(e,t,r)&&(t=i),n(e,Lo(t,3))},fn.find=Ks,fn.findIndex=ms,fn.findKey=function(e,t){return ir(e,Lo(t,3),Wn)},fn.findLast=Hs,fn.findLastIndex=ys,fn.findLastKey=function(e,t){return ir(e,Lo(t,3),Yn)},fn.floor=Wc,fn.forEach=Gs,fn.forEachRight=zs,fn.forIn=function(e,t){return null==e?e:Gn(e,Lo(t,3),oc)},fn.forInRight=function(e,t){return null==e?e:zn(e,Lo(t,3),oc)},fn.forOwn=function(e,t){return e&&Wn(e,Lo(t,3))},fn.forOwnRight=function(e,t){return e&&Yn(e,Lo(t,3))},fn.get=Za,fn.gt=da,fn.gte=ga,fn.has=function(e,t){return null!=e&&Ko(e,t,ei)},fn.hasIn=ec,fn.head=bs,fn.identity=Rc,fn.includes=function(e,t,r,n){e=ba(e)?e:fc(e),r=r&&!n?Va(r):0;var i=e.length;return r<0&&(r=Hr(i+r,0)),Da(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&sr(e,t,r)>-1},fn.indexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Va(r);return i<0&&(i=Hr(n+i,0)),sr(e,t,i)},fn.inRange=function(e,t,r){return t=Fa(t),r===i?(r=t,t=0):r=Fa(r),function(e,t,r){return e>=Gr(t,r)&&e<Hr(t,r)}(e=Ka(e),t,r)},fn.invoke=nc,fn.isArguments=ma,fn.isArray=ya,fn.isArrayBuffer=va,fn.isArrayLike=ba,fn.isArrayLikeObject=_a,fn.isBoolean=function(e){return!0===e||!1===e||Na(e)&&Xn(e)==K},fn.isBuffer=Ea,fn.isDate=Ca,fn.isElement=function(e){return Na(e)&&1===e.nodeType&&!Oa(e)},fn.isEmpty=function(e){if(null==e)return!0;if(ba(e)&&(ya(e)||"string"==typeof e||"function"==typeof e.splice||Ea(e)||La(e)||ma(e)))return!e.length;var t=qo(e);if(t==Q||t==te)return!e.size;if(Jo(e))return!ui(e).length;for(var r in e)if(lt.call(e,r))return!1;return!0},fn.isEqual=function(e,t){return oi(e,t)},fn.isEqualWith=function(e,t,r){var n=(r="function"==typeof r?r:i)?r(e,t):i;return n===i?oi(e,t,i,r):!!n},fn.isError=wa,fn.isFinite=function(e){return"number"==typeof e&&Vr(e)},fn.isFunction=Sa,fn.isInteger=Ta,fn.isLength=Aa,fn.isMap=ka,fn.isMatch=function(e,t){return e===t||si(e,t,Uo(t))},fn.isMatchWith=function(e,t,r){return r="function"==typeof r?r:i,si(e,t,Uo(t),r)},fn.isNaN=function(e){return Ra(e)&&e!=+e},fn.isNative=function(e){if($o(e))throw new Xe(s);return ai(e)},fn.isNil=function(e){return null==e},fn.isNull=function(e){return null===e},fn.isNumber=Ra,fn.isObject=Ia,fn.isObjectLike=Na,fn.isPlainObject=Oa,fn.isRegExp=xa,fn.isSafeInteger=function(e){return Ta(e)&&e>=-B&&e<=B},fn.isSet=Ba,fn.isString=Da,fn.isSymbol=Pa,fn.isTypedArray=La,fn.isUndefined=function(e){return e===i},fn.isWeakMap=function(e){return Na(e)&&qo(e)==oe},fn.isWeakSet=function(e){return Na(e)&&Xn(e)==se},fn.join=function(e,t){return null==e?"":qr.call(e,t)},fn.kebabCase=yc,fn.last=ws,fn.lastIndexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=n;return r!==i&&(o=(o=Va(r))<0?Hr(n+o,0):Gr(o,n-1)),t==t?function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}(e,t,o):or(e,cr,o,!0)},fn.lowerCase=vc,fn.lowerFirst=bc,fn.lt=ja,fn.lte=Ua,fn.max=function(e){return e&&e.length?qn(e,Rc,Zn):i},fn.maxBy=function(e,t){return e&&e.length?qn(e,Lo(t,2),Zn):i},fn.mean=function(e){return ur(e,Rc)},fn.meanBy=function(e,t){return ur(e,Lo(t,2))},fn.min=function(e){return e&&e.length?qn(e,Rc,hi):i},fn.minBy=function(e,t){return e&&e.length?qn(e,Lo(t,2),hi):i},fn.stubArray=qc,fn.stubFalse=Kc,fn.stubObject=function(){return{}},fn.stubString=function(){return""},fn.stubTrue=function(){return!0},fn.multiply=Qc,fn.nth=function(e,t){return e&&e.length?mi(e,Va(t)):i},fn.noConflict=function(){return xt._===this&&(xt._=gt),this},fn.noop=Pc,fn.now=Zs,fn.pad=function(e,t,r){e=Ga(e);var n=(t=Va(t))?kr(e):0;if(!t||n>=t)return e;var i=(t-n)/2;return vo(Ur(i),r)+e+vo(jr(i),r)},fn.padEnd=function(e,t,r){e=Ga(e);var n=(t=Va(t))?kr(e):0;return t&&n<t?e+vo(t-n,r):e},fn.padStart=function(e,t,r){e=Ga(e);var n=(t=Va(t))?kr(e):0;return t&&n<t?vo(t-n,r)+e:e},fn.parseInt=function(e,t,r){return r||null==t?t=0:t&&(t=+t),Wr(Ga(e).replace(De,""),t||0)},fn.random=function(e,t,r){if(r&&"boolean"!=typeof r&&Wo(e,t,r)&&(t=r=i),r===i&&("boolean"==typeof t?(r=t,t=i):"boolean"==typeof e&&(r=e,e=i)),e===i&&t===i?(e=0,t=1):(e=Fa(e),t===i?(t=e,e=0):t=Fa(t)),e>t){var n=e;e=t,t=n}if(r||e%1||t%1){var o=Yr();return Gr(e+o*(t-e+Nt("1e-"+((o+"").length-1))),t)}return Ei(e,t)},fn.reduce=function(e,t,r){var n=ya(e)?er:pr,i=arguments.length<3;return n(e,Lo(t,4),r,i,Mn)},fn.reduceRight=function(e,t,r){var n=ya(e)?tr:pr,i=arguments.length<3;return n(e,Lo(t,4),r,i,Fn)},fn.repeat=function(e,t,r){return t=(r?Wo(e,t,r):t===i)?1:Va(t),Ci(Ga(e),t)},fn.replace=function(){var e=arguments,t=Ga(e[0]);return e.length<3?t:t.replace(e[1],e[2])},fn.result=function(e,t,r){var n=-1,o=(t=zi(t,e)).length;for(o||(o=1,e=i);++n<o;){var s=null==e?i:e[ls(t[n])];s===i&&(n=o,s=r),e=Sa(s)?s.call(e):s}return e},fn.round=$c,fn.runInContext=e,fn.sample=function(e){return(ya(e)?Sn:Si)(e)},fn.size=function(e){if(null==e)return 0;if(ba(e))return Da(e)?kr(e):e.length;var t=qo(e);return t==Q||t==te?e.size:ui(e).length},fn.snakeCase=_c,fn.some=function(e,t,r){var n=ya(e)?rr:Oi;return r&&Wo(e,t,r)&&(t=i),n(e,Lo(t,3))},fn.sortedIndex=function(e,t){return xi(e,t)},fn.sortedIndexBy=function(e,t,r){return Bi(e,t,Lo(r,2))},fn.sortedIndexOf=function(e,t){var r=null==e?0:e.length;if(r){var n=xi(e,t);if(n<r&&fa(e[n],t))return n}return-1},fn.sortedLastIndex=function(e,t){return xi(e,t,!0)},fn.sortedLastIndexBy=function(e,t,r){return Bi(e,t,Lo(r,2),!0)},fn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var r=xi(e,t,!0)-1;if(fa(e[r],t))return r}return-1},fn.startCase=Ec,fn.startsWith=function(e,t,r){return e=Ga(e),r=null==r?0:Dn(Va(r),0,e.length),t=Li(t),e.slice(r,r+t.length)==t},fn.subtract=Jc,fn.sum=function(e){return e&&e.length?fr(e,Rc):0},fn.sumBy=function(e,t){return e&&e.length?fr(e,Lo(t,2)):0},fn.template=function(e,t,r){var n=fn.templateSettings;r&&Wo(e,t,r)&&(t=i),e=Ga(e),t=Ya({},t,n,Ao);var o,s,a=Ya({},t.imports,n.imports,Ao),c=ic(a),u=mr(a,c),l=0,h=t.interpolate||Qe,p="__p += '",f=rt((t.escape||Qe).source+"|"+h.source+"|"+(h===Ie?Ve:Qe).source+"|"+(t.evaluate||Qe).source+"|$","g"),d="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++St+"]")+"\n";e.replace(f,function(t,r,n,i,a,c){return n||(n=i),p+=e.slice(l,c).replace($e,Cr),r&&(o=!0,p+="' +\n__e("+r+") +\n'"),a&&(s=!0,p+="';\n"+a+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=c+t.length,t}),p+="';\n";var g=t.variable;g||(p="with (obj) {\n"+p+"\n}\n"),p=(s?p.replace(ve,""):p).replace(be,"$1").replace(_e,"$1;"),p="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var m=Tc(function(){return Ze(c,d+"return "+p).apply(i,u)});if(m.source=p,wa(m))throw m;return m},fn.times=function(e,t){if((e=Va(e))<1||e>B)return[];var r=L,n=Gr(e,L);t=Lo(t),e-=L;for(var i=dr(n,t);++r<e;)t(r);return i},fn.toFinite=Fa,fn.toInteger=Va,fn.toLength=qa,fn.toLower=function(e){return Ga(e).toLowerCase()},fn.toNumber=Ka,fn.toSafeInteger=function(e){return e?Dn(Va(e),-B,B):0===e?e:0},fn.toString=Ga,fn.toUpper=function(e){return Ga(e).toUpperCase()},fn.trim=function(e,t,r){if((e=Ga(e))&&(r||t===i))return e.replace(Be,"");if(!e||!(t=Li(t)))return e;var n=Rr(e),o=Rr(t);return Yi(n,vr(n,o),br(n,o)+1).join("")},fn.trimEnd=function(e,t,r){if((e=Ga(e))&&(r||t===i))return e.replace(Pe,"");if(!e||!(t=Li(t)))return e;var n=Rr(e);return Yi(n,0,br(n,Rr(t))+1).join("")},fn.trimStart=function(e,t,r){if((e=Ga(e))&&(r||t===i))return e.replace(De,"");if(!e||!(t=Li(t)))return e;var n=Rr(e);return Yi(n,vr(n,Rr(t))).join("")},fn.truncate=function(e,t){var r=A,n=I;if(Ia(t)){var o="separator"in t?t.separator:o;r="length"in t?Va(t.length):r,n="omission"in t?Li(t.omission):n}var s=(e=Ga(e)).length;if(wr(e)){var a=Rr(e);s=a.length}if(r>=s)return e;var c=r-kr(n);if(c<1)return n;var u=a?Yi(a,0,c).join(""):e.slice(0,c);if(o===i)return u+n;if(a&&(c+=u.length-c),xa(o)){if(e.slice(c).search(o)){var l,h=u;for(o.global||(o=rt(o.source,Ga(qe.exec(o))+"g")),o.lastIndex=0;l=o.exec(h);)var p=l.index;u=u.slice(0,p===i?c:p)}}else if(e.indexOf(Li(o),c)!=c){var f=u.lastIndexOf(o);f>-1&&(u=u.slice(0,f))}return u+n},fn.unescape=function(e){return(e=Ga(e))&&we.test(e)?e.replace(Ee,Or):e},fn.uniqueId=function(e){var t=++ht;return Ga(e)+t},fn.upperCase=Cc,fn.upperFirst=wc,fn.each=Gs,fn.eachRight=zs,fn.first=bs,Dc(fn,(Yc={},Wn(fn,function(e,t){lt.call(fn.prototype,t)||(Yc[t]=e)}),Yc),{chain:!1}),fn.VERSION="4.17.11",zt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){fn[e].placeholder=fn}),zt(["drop","take"],function(e,t){yn.prototype[e]=function(r){r=r===i?1:Hr(Va(r),0);var n=this.__filtered__&&!t?new yn(this):this.clone();return n.__filtered__?n.__takeCount__=Gr(r,n.__takeCount__):n.__views__.push({size:Gr(r,L),type:e+(n.__dir__<0?"Right":"")}),n},yn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),zt(["filter","map","takeWhile"],function(e,t){var r=t+1,n=r==R||3==r;yn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Lo(e,3),type:r}),t.__filtered__=t.__filtered__||n,t}}),zt(["head","last"],function(e,t){var r="take"+(t?"Right":"");yn.prototype[e]=function(){return this[r](1).value()[0]}}),zt(["initial","tail"],function(e,t){var r="drop"+(t?"":"Right");yn.prototype[e]=function(){return this.__filtered__?new yn(this):this[r](1)}}),yn.prototype.compact=function(){return this.filter(Rc)},yn.prototype.find=function(e){return this.filter(e).head()},yn.prototype.findLast=function(e){return this.reverse().find(e)},yn.prototype.invokeMap=wi(function(e,t){return"function"==typeof e?new yn(this):this.map(function(r){return ni(r,e,t)})}),yn.prototype.reject=function(e){return this.filter(ca(Lo(e)))},yn.prototype.slice=function(e,t){e=Va(e);var r=this;return r.__filtered__&&(e>0||t<0)?new yn(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==i&&(r=(t=Va(t))<0?r.dropRight(-t):r.take(t-e)),r)},yn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},yn.prototype.toArray=function(){return this.take(L)},Wn(yn.prototype,function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),n=/^(?:head|last)$/.test(t),o=fn[n?"take"+("last"==t?"Right":""):t],s=n||/^find/.test(t);o&&(fn.prototype[t]=function(){var t=this.__wrapped__,a=n?[1]:arguments,c=t instanceof yn,u=a[0],l=c||ya(t),h=function(e){var t=o.apply(fn,Zt([e],a));return n&&p?t[0]:t};l&&r&&"function"==typeof u&&1!=u.length&&(c=l=!1);var p=this.__chain__,f=!!this.__actions__.length,d=s&&!p,g=c&&!f;if(!s&&l){t=g?t:new yn(this);var m=e.apply(t,a);return m.__actions__.push({func:Fs,args:[h],thisArg:i}),new mn(m,p)}return d&&g?e.apply(this,a):(m=this.thru(h),d?n?m.value()[0]:m.value():m)})}),zt(["pop","push","shift","sort","splice","unshift"],function(e){var t=ot[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);fn.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var i=this.value();return t.apply(ya(i)?i:[],e)}return this[r](function(r){return t.apply(ya(r)?r:[],e)})}}),Wn(yn.prototype,function(e,t){var r=fn[t];if(r){var n=r.name+"";(nn[n]||(nn[n]=[])).push({name:t,func:r})}}),nn[fo(i,y).name]=[{name:"wrapper",func:i}],yn.prototype.clone=function(){var e=new yn(this.__wrapped__);return e.__actions__=ro(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ro(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ro(this.__views__),e},yn.prototype.reverse=function(){if(this.__filtered__){var e=new yn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},yn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=ya(e),n=t<0,i=r?e.length:0,o=function(e,t,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=Gr(t,e+s);break;case"takeRight":e=Hr(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,c=a-s,u=n?a:s-1,l=this.__iteratees__,h=l.length,p=0,f=Gr(c,this.__takeCount__);if(!r||!n&&i==c&&f==c)return Vi(e,this.__actions__);var d=[];e:for(;c--&&p<f;){for(var g=-1,m=e[u+=t];++g<h;){var y=l[g],v=y.iteratee,b=y.type,_=v(m);if(b==O)m=_;else if(!_){if(b==R)continue e;break e}}d[p++]=m}return d},fn.prototype.at=Vs,fn.prototype.chain=function(){return Ms(this)},fn.prototype.commit=function(){return new mn(this.value(),this.__chain__)},fn.prototype.next=function(){this.__values__===i&&(this.__values__=Ma(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},fn.prototype.plant=function(e){for(var t,r=this;r instanceof gn;){var n=ps(r);n.__index__=0,n.__values__=i,t?o.__wrapped__=n:t=n;var o=n;r=r.__wrapped__}return o.__wrapped__=e,t},fn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof yn){var t=e;return this.__actions__.length&&(t=new yn(this)),(t=t.reverse()).__actions__.push({func:Fs,args:[Is],thisArg:i}),new mn(t,this.__chain__)}return this.thru(Is)},fn.prototype.toJSON=fn.prototype.valueOf=fn.prototype.value=function(){return Vi(this.__wrapped__,this.__actions__)},fn.prototype.first=fn.prototype.head,nr&&(fn.prototype[nr]=function(){return this}),fn}();xt._=xr,(n=function(){return xr}.call(t,r,t,e))===i||(e.exports=n)}).call(this)}).call(this,r(228)(e))},function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return s});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}Object.assign;function o(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})}function s(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=n[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}},function(e,t,r){var n=r(2);r(52),r(176),r(177),r(5),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},i=new Array(4),o=n.util.createBuffer();function s(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,i,!1),o.putInt32(i[0]),o.putInt32(i[1]),o.putInt32(i[2]),o.putInt32(i[3]),o.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var a=s(),c=null;if("undefined"!=typeof window){var u=window.crypto||window.msCrypto;u&&u.getRandomValues&&(c=function(e){return u.getRandomValues(e)})}if(n.options.usePureJavaScript||!n.util.isNodejs&&!c){if("undefined"==typeof window||window.document,a.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var h in navigator)try{"string"==typeof navigator[h]&&(l+=navigator[h])}catch(e){}a.collect(l),l=null}t&&(t().mousemove(function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)}),t().keypress(function(e){a.collectInt(e.charCode,8)}))}if(n.random)for(var h in a)n.random[h]=a[h];else n.random=a;n.random.createInstance=s,e.exports=n.random}("undefined"!=typeof jQuery?jQuery:null)},function(e,t,r){try{var n=r(4);if("function"!=typeof n.inherits)throw"";e.exports=n.inherits}catch(t){e.exports=r(327)}},function(e,t,r){"use strict";var n=r(1),i=r(83),o={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:("undefined"!=typeof XMLHttpRequest?a=r(84):"undefined"!=typeof process&&(a=r(65)),a),transformRequest:[function(e,t){return i(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],function(e){c.headers[e]={}}),n.forEach(["post","put","patch"],function(e){c.headers[e]=n.merge(o)}),e.exports=c},function(e,t,r){"use strict";var n=r(43);e.exports=function(e,t,r,i,o){var s=new Error(e);return n(s,t,r,i,o)}},function(e,t,r){var n=r(3);r(56),r(239),r(240),r(6),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},i=new Array(4),o=n.util.createBuffer();function s(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,i,!1),o.putInt32(i[0]),o.putInt32(i[1]),o.putInt32(i[2]),o.putInt32(i[3]),o.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var a=s(),c=null;if("undefined"!=typeof window){var u=window.crypto||window.msCrypto;u&&u.getRandomValues&&(c=function(e){return u.getRandomValues(e)})}if(n.options.usePureJavaScript||!n.util.isNodejs&&!c){if("undefined"==typeof window||window.document,a.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var h in navigator)try{"string"==typeof navigator[h]&&(l+=navigator[h])}catch(e){}a.collect(l),l=null}t&&(t().mousemove(function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)}),t().keypress(function(e){a.collectInt(e.charCode,8)}))}if(n.random)for(var h in a)n.random[h]=a[h];else n.random=a;n.random.createInstance=s,e.exports=n.random}("undefined"!=typeof jQuery?jQuery:null)},function(e,t){e.exports=require("https")},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(11);t.renameProperties=function(e,t){Object.keys(t).forEach(function(r){if(r in e){var n=t[r];e[n]=e[r],delete e[r]}})},t.addReadonlyGetter=function(e,t,r){Object.defineProperty(e,t,{value:r,writable:!1,enumerable:!0})},t.getProjectId=function(e){var t=e.options;if(n.isNonEmptyString(t.projectId))return t.projectId;var r=t.credential.getCertificate();if(null!=r&&n.isNonEmptyString(r.projectId))return r.projectId;var i=process.env.GOOGLE_CLOUD_PROJECT||process.env.GCLOUD_PROJECT;return n.isNonEmptyString(i)?i:null},t.toWebSafeBase64=function(e){return e.toString("base64").replace(/\//g,"_").replace(/\+/g,"-")},t.formatString=function(e,t){var r=e;return Object.keys(t||{}).forEach(function(e){r=r.replace(new RegExp("{"+e+"}","g"),t[e])}),r}},function(e,t){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=Buffer.isBuffer},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(59);function i(e,t){return`${e} ${t}`+(1===e?"":"s")}class o{constructor(e){const t=Object.assign({function:n.function,integer:(e,t,r)=>{if(t=n.defined(t)?t:-1/0,r=n.defined(r)?r:1/0,!n.integer(e))return!1;if(e<t||e>r)throw new Error(`Value must be within [${t}, ${r}] inclusive, but was: ${e}`);return!0},number:(e,t,r)=>{if(t=n.defined(t)?t:-1/0,r=n.defined(r)?r:1/0,!n.number(e)||n.nan(e))return!1;if(e<t||e>r)throw new Error(`Value must be within [${t}, ${r}] inclusive, but was: ${e}`);return!0},object:n.object,string:n.string,boolean:n.boolean},e),r=e=>{const r=e.substring(0,1).toUpperCase()+e.substring(1);this[`is${r}`]=((r,...i)=>{let o=!1,s=n.number(r)?`Argument at index ${r} is not a valid ${e}.`:`Argument "${r}" is not a valid ${e}.`;try{o=t[e].call(null,...i)}catch(e){s+=` ${e.message}`}if(!0!==o)throw new Error(s)}),this[`isOptional${r}`]=function(e,t){n.defined(t)&&this[`is${r}`].apply(null,arguments)}};for(const e in t)t.hasOwnProperty(e)&&r(e)}minNumberOfArguments(e,t,r){if(t.length<r)throw new Error(`Function "${e}()" requires at least `+`${i(r,"argument")}.`);return!0}maxNumberOfArguments(e,t,r){if(t.length>r)throw new Error(`Function "${e}()" accepts at most `+`${i(r,"argument")}.`);return!0}}t.Validator=o,t.customObjectError=function(e,t){const r=t?` (found in field ${t.toString()})`:"";if(!n.object(e)||"Object"===e.constructor.name){if(n.object(e))return new Error(`Invalid use of type "${typeof e}" as a Firestore argument${r}.`);throw new Error(`Input is not a plain JavaScript object${r}.`)}{const t=e.constructor.name;switch(t){case"DocumentReference":case"FieldPath":case"FieldValue":case"GeoPoint":case"Timestamp":return new Error(`Detected an object of type "${t}" that doesn't match the `+`expected instance${r}. Please ensure that the `+"Firestore types you are using are from the same NPM package.");default:return new Error(`Couldn't serialize object of type "${t}"${r}. Firestore doesn't support JavaScript `+'objects with custom prototypes (i.e. objects that were created via the "new" operator).')}}},t.createValidator=function(e){return new o(e)}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(59),i=r(26),o=i.createValidator(),s=/^projects\/([^\/]*)\/databases\/([^\/]*)(?:\/documents\/)?([\s\S]*)$/,a=/^[_a-zA-Z][_a-zA-Z0-9]*$/,c=/^[^*~\/[\]]+$/;class u{constructor(e){this.segments=e}get formattedName(){return this.canonicalString()}get size(){return this.segments.length}append(e){return e instanceof u?this.construct(this.segments.concat(e.segments)):this.construct(this.segments.concat(this.split(e)))}parent(){return 0===this.segments.length?null:this.construct(this.segments.slice(0,this.segments.length-1))}isPrefixOf(e){if(e.segments.length<this.segments.length)return!1;for(let t=0;t<this.segments.length;t++)if(this.segments[t]!==e.segments[t])return!1;return!0}toString(){return this.formattedName}compareTo(e){const t=Math.min(this.segments.length,e.segments.length);for(let r=0;r<t;r++){if(this.segments[r]<e.segments[r])return-1;if(this.segments[r]>e.segments[r])return 1}return this.segments.length<e.segments.length?-1:this.segments.length>e.segments.length?1:0}toArray(){return this.segments.slice()}isEqual(e){return this===e||e instanceof this.constructor&&0===this.compareTo(e)}}class l extends u{constructor(e,t,...r){super(r),this.projectId=e,this.databaseId=t}get relativeName(){return this.segments.join("/")}get isDocument(){return this.segments.length>0&&this.segments.length%2==0}get isCollection(){return this.segments.length%2==1}get id(){return this.segments.length>0?this.segments[this.segments.length-1]:null}static validateResourcePath(e){if(!n.string(e)||""===e)throw new Error("Path must be a non-empty string.");if(e.indexOf("//")>=0)throw new Error("Paths must not contain //.");return!0}static fromSlashSeparatedString(e){const t=s.exec(e);if(t){const e=t[1],r=t[2],n=t[3];return new l(e,r).append(n)}throw new Error(`Resource name '${e}' is not valid.`)}split(e){return e.split("/").filter(e=>e.length>0)}canonicalString(){let e=["projects",this.projectId,"databases",this.databaseId];return this.segments.length>0&&(e=e.concat("documents",this.segments)),e.join("/")}construct(e){return new l(this.projectId,this.databaseId,...e)}compareTo(e){if("{{projectId}}"!==this.projectId&&"{{projectId}}"!==e.projectId){if(this.projectId<e.projectId)return-1;if(this.projectId>e.projectId)return 1}return this.databaseId<e.databaseId?-1:this.databaseId>e.databaseId?1:super.compareTo(e)}toProto(){return{referenceValue:this.formattedName}}}t.ResourcePath=l;class h extends u{constructor(...e){o.minNumberOfArguments("FieldPath",arguments,1);const t=n.array(e[0])?e[0]:e;for(let e=0;e<t.length;++e)if(o.isString(e,t[e]),0===t[e].length)throw new Error(`Element at index ${e} should not be an empty string.`);super(t)}static documentId(){return h._DOCUMENT_ID}static validateFieldPath(e){if(!(e instanceof h)){if(void 0===e)throw new Error("Path cannot be omitted.");if(n.object(e)&&"FieldPath"===e.constructor.name)throw i.customObjectError(e);if("string"!=typeof e)throw new Error("Paths can only be specified as strings or via a FieldPath object.");if(e.indexOf("..")>=0)throw new Error('Paths must not contain ".." in them.');if(e.startsWith(".")||e.endsWith("."))throw new Error('Paths must not start or end with ".".');if(!c.test(e))throw new Error('Paths can\'t be empty and must not contain "*~/[]".')}return!0}static fromArgument(e){return e instanceof h?e:new h(...e.split("."))}canonicalString(){return this.segments.map(e=>a.test(e)?e:"`"+e.replace("\\","\\\\").replace("`","\\`")+"`").join(".")}split(e){return e.split(".")}construct(e){return new h(...e)}isEqual(e){return super.isEqual(e)}}h._DOCUMENT_ID=new h("__name__"),t.FieldPath=h},function(e,t,r){"use strict";e.exports=s;var n=r(63);((s.prototype=Object.create(n.prototype)).constructor=s).className="Enum";var i=r(79),o=r(13);function s(e,t,r,i,o){if(n.call(this,e,r),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=o||{},this.reserved=void 0,t)for(var s=Object.keys(t),a=0;a<s.length;++a)"number"==typeof t[s[a]]&&(this.valuesById[this.values[s[a]]=t[s[a]]]=s[a])}s.fromJSON=function(e,t){var r=new s(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},s.prototype.add=function(e,t,r){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=r||null,this},s.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},s.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},s.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("http")},function(e,t,r){var n=r(2);r(5),r(53);var i=e.exports=n.asn1=n.asn1||{};function o(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,o,s){if(n.util.isArray(o)){for(var a=[],c=0;c<o.length;++c)void 0!==o[c]&&a.push(o[c]);o=a}var u={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(o),value:o};return s&&"bitStringContents"in s&&(u.bitStringContents=s.bitStringContents,u.original=i.copy(u)),u},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var o=0;o<e.length;++o)r.push(i.copy(e[o],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var o=0;o<e.length;++o)if(!i.equals(e[o],t[o]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(s=s&&e.bitStringContents===t.bitStringContents),s},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};var s=function(e,t){var r=e.getByte();if(128!==r){var n;if(128&r){var i=127&r;o(e,--t,i),n=e.getInt(i<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}};i.fromDer=function(e,t){return void 0===t&&(t={strict:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=n.util.createBuffer(e)),function e(t,r,n,a){var c;o(t,r,2);var u=t.getByte();r--;var l=192&u;var h=31&u;c=t.length();var p=s(t,r);r-=c-t.length();if(void 0!==p&&p>r){if(a.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=r,f.requested=p,f}p=r}var d;var g;var m=32==(32&u);if(m)if(d=[],void 0===p)for(;;){if(o(t,r,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),r-=2;break}c=t.length(),d.push(e(t,r,n+1,a)),r-=c-t.length()}else for(;p>0;)c=t.length(),d.push(e(t,p,n+1,a)),r-=c-t.length(),p-=c-t.length();void 0===d&&l===i.Class.UNIVERSAL&&h===i.Type.BITSTRING&&(g=t.bytes(p));if(void 0===d&&a.decodeBitStrings&&l===i.Class.UNIVERSAL&&h===i.Type.BITSTRING&&p>1){var y=t.read,v=r,b=0;if(h===i.Type.BITSTRING&&(o(t,r,1),b=t.getByte(),r--),0===b)try{c=t.length();var _={verbose:a.verbose,strict:!0,decodeBitStrings:!0},E=e(t,r,n+1,_),C=c-t.length();r-=C,h==i.Type.BITSTRING&&C++;var w=E.tagClass;C!==p||w!==i.Class.UNIVERSAL&&w!==i.Class.CONTEXT_SPECIFIC||(d=[E])}catch(e){}void 0===d&&(t.read=y,r=v)}if(void 0===d){if(void 0===p){if(a.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=r}if(h===i.Type.BMPSTRING)for(d="";p>0;p-=2)o(t,r,2),d+=String.fromCharCode(t.getInt16()),r-=2;else d=t.getBytes(p)}var S=void 0===g?null:{bitStringContents:g};return i.create(l,h,m,d,S)}(e,e.length(),0,t)},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,o=n.util.createBuffer(),s=!1;if("bitStringContents"in e&&(s=!0,e.original&&(s=i.equals(e,e.original))),s)o.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:o.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&o.putBuffer(i.toDer(e.value[a]))}else if(e.type===i.Type.BMPSTRING)for(a=0;a<e.value.length;++a)o.putInt16(e.value.charCodeAt(a));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?o.putBytes(e.value.substr(1)):o.putBytes(e.value);if(t.putByte(r),o.length()<=127)t.putByte(127&o.length());else{var c=o.length(),u="";do{u+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|u.length);for(a=u.length-1;a>=0;--a)t.putByte(u.charCodeAt(a))}return t.putBuffer(o),t},i.oidToDer=function(e){var t,r,i,o,s=e.split("."),a=n.util.createBuffer();a.putByte(40*parseInt(s[0],10)+parseInt(s[1],10));for(var c=2;c<s.length;++c){t=!0,r=[],i=parseInt(s[c],10);do{o=127&i,i>>>=7,t||(o|=128),r.push(o),t=!1}while(i>0);for(var u=r.length-1;u>=0;--u)a.putByte(r[u])}return a},i.derToOid=function(e){var t;"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var i=0;e.length()>0;)i<<=7,128&(r=e.getByte())?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),o=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),u=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,0),u&&("+"===(c=e.charAt(u))||"-"===c)){var l=60*parseInt(e.substr(u+1,2),10)+parseInt(e.substr(u+4,2),10);l*=6e4,"+"===c?t.setTime(+t-l):t.setTime(+t+l)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,u=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var h=e.length-5,p=e.charAt(h);"+"!==p&&"-"!==p||(u=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10),u*=6e4,"+"===p&&(u*=-1),l=!0);return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,c),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(o,s,a,c)),t},i.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"==typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,o){var s=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)o&&(e.tagClass!==t.tagClass&&o.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&o.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(s=!0,t.value&&n.util.isArray(t.value))for(var a=0,c=0;s&&c<t.value.length;++c)s=t.value[c].optional||!1,e.value[a]&&((s=i.validate(e.value[a],t.value[c],r,o))?++a:t.value[c].optional&&(s=!0)),!s&&o&&o.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(s&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else o&&o.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return s};var a=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var o="";r=r||2,(t=t||0)>0&&(o+="\n");for(var s="",c=0;c<t*r;++c)s+=" ";switch(o+=s+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:o+="Universal:";break;case i.Class.APPLICATION:o+="Application:";break;case i.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case i.Class.PRIVATE:o+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(o+=e.type,e.type){case i.Type.NONE:o+=" (None)";break;case i.Type.BOOLEAN:o+=" (Boolean)";break;case i.Type.INTEGER:o+=" (Integer)";break;case i.Type.BITSTRING:o+=" (Bit string)";break;case i.Type.OCTETSTRING:o+=" (Octet string)";break;case i.Type.NULL:o+=" (Null)";break;case i.Type.OID:o+=" (Object Identifier)";break;case i.Type.ODESC:o+=" (Object Descriptor)";break;case i.Type.EXTERNAL:o+=" (External or Instance of)";break;case i.Type.REAL:o+=" (Real)";break;case i.Type.ENUMERATED:o+=" (Enumerated)";break;case i.Type.EMBEDDED:o+=" (Embedded PDV)";break;case i.Type.UTF8:o+=" (UTF8)";break;case i.Type.ROID:o+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:o+=" (Sequence)";break;case i.Type.SET:o+=" (Set)";break;case i.Type.PRINTABLESTRING:o+=" (Printable String)";break;case i.Type.IA5String:o+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:o+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case i.Type.BMPSTRING:o+=" (BMP String)"}else o+=e.type;if(o+="\n",o+=s+"Constructed: "+e.constructed+"\n",e.composed){var u=0,l="";for(c=0;c<e.value.length;++c)void 0!==e.value[c]&&(u+=1,l+=i.prettyPrint(e.value[c],t+1,r),c+1<e.value.length&&(l+=","));o+=s+"Sub values: "+u+l}else{if(o+=s+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);o+=h,n.pki&&n.pki.oids&&h in n.pki.oids&&(o+=" ("+n.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{o+=i.derToInteger(e.value)}catch(t){o+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?o+="0x"+n.util.bytesToHex(e.value.slice(1)):o+="(none)",e.value.length>0){var p=e.value.charCodeAt(0);1==p?o+=" (1 unused bit shown)":p>1&&(o+=" ("+p+" unused bits shown)")}}else e.type===i.Type.OCTETSTRING?(a.test(e.value)||(o+="("+e.value+") "),o+="0x"+n.util.bytesToHex(e.value)):e.type===i.Type.UTF8?o+=n.util.decodeUtf8(e.value):e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?o+=e.value:a.test(e.value)?o+="0x"+n.util.bytesToHex(e.value):0===e.value.length?o+="[null]":o+=e.value}return o}},function(e,t,r){var n=r(2);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},function(e,t){e.exports=require("crypto")},function(e,t,r){var n=r(35),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),o(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t){e.exports=require("buffer")},function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=r(218),n.base64=r(348),n.EventEmitter=r(349),n.float=r(350),n.inquire=r(219),n.utf8=r(351),n.pool=r(352),n.LongBits=r(353),n.global="undefined"!=typeof window&&window||"undefined"!=typeof global&&global||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isNode=Boolean(n.global.process&&n.global.process.versions&&n.global.process.versions.node),n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},function(e,t,r){var n=r(3);r(6),r(57);var i=e.exports=n.asn1=n.asn1||{};function o(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,o,s){if(n.util.isArray(o)){for(var a=[],c=0;c<o.length;++c)void 0!==o[c]&&a.push(o[c]);o=a}var u={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(o),value:o};return s&&"bitStringContents"in s&&(u.bitStringContents=s.bitStringContents,u.original=i.copy(u)),u},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var o=0;o<e.length;++o)r.push(i.copy(e[o],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var o=0;o<e.length;++o)if(!i.equals(e[o],t[o]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(s=s&&e.bitStringContents===t.bitStringContents),s},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};var s=function(e,t){var r=e.getByte();if(128!==r){var n;if(128&r){var i=127&r;o(e,--t,i),n=e.getInt(i<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}};i.fromDer=function(e,t){return void 0===t&&(t={strict:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=n.util.createBuffer(e)),function e(t,r,n,a){var c;o(t,r,2);var u=t.getByte();r--;var l=192&u;var h=31&u;c=t.length();var p=s(t,r);r-=c-t.length();if(void 0!==p&&p>r){if(a.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=r,f.requested=p,f}p=r}var d;var g;var m=32==(32&u);if(m)if(d=[],void 0===p)for(;;){if(o(t,r,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),r-=2;break}c=t.length(),d.push(e(t,r,n+1,a)),r-=c-t.length()}else for(;p>0;)c=t.length(),d.push(e(t,p,n+1,a)),r-=c-t.length(),p-=c-t.length();void 0===d&&l===i.Class.UNIVERSAL&&h===i.Type.BITSTRING&&(g=t.bytes(p));if(void 0===d&&a.decodeBitStrings&&l===i.Class.UNIVERSAL&&h===i.Type.BITSTRING&&p>1){var y=t.read,v=r,b=0;if(h===i.Type.BITSTRING&&(o(t,r,1),b=t.getByte(),r--),0===b)try{c=t.length();var _={verbose:a.verbose,strict:!0,decodeBitStrings:!0},E=e(t,r,n+1,_),C=c-t.length();r-=C,h==i.Type.BITSTRING&&C++;var w=E.tagClass;C!==p||w!==i.Class.UNIVERSAL&&w!==i.Class.CONTEXT_SPECIFIC||(d=[E])}catch(e){}void 0===d&&(t.read=y,r=v)}if(void 0===d){if(void 0===p){if(a.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=r}if(h===i.Type.BMPSTRING)for(d="";p>0;p-=2)o(t,r,2),d+=String.fromCharCode(t.getInt16()),r-=2;else d=t.getBytes(p)}var S=void 0===g?null:{bitStringContents:g};return i.create(l,h,m,d,S)}(e,e.length(),0,t)},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,o=n.util.createBuffer(),s=!1;if("bitStringContents"in e&&(s=!0,e.original&&(s=i.equals(e,e.original))),s)o.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:o.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&o.putBuffer(i.toDer(e.value[a]))}else if(e.type===i.Type.BMPSTRING)for(a=0;a<e.value.length;++a)o.putInt16(e.value.charCodeAt(a));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?o.putBytes(e.value.substr(1)):o.putBytes(e.value);if(t.putByte(r),o.length()<=127)t.putByte(127&o.length());else{var c=o.length(),u="";do{u+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|u.length);for(a=u.length-1;a>=0;--a)t.putByte(u.charCodeAt(a))}return t.putBuffer(o),t},i.oidToDer=function(e){var t,r,i,o,s=e.split("."),a=n.util.createBuffer();a.putByte(40*parseInt(s[0],10)+parseInt(s[1],10));for(var c=2;c<s.length;++c){t=!0,r=[],i=parseInt(s[c],10);do{o=127&i,i>>>=7,t||(o|=128),r.push(o),t=!1}while(i>0);for(var u=r.length-1;u>=0;--u)a.putByte(r[u])}return a},i.derToOid=function(e){var t;"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var i=0;e.length()>0;)i<<=7,128&(r=e.getByte())?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),o=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),u=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,0),u&&("+"===(c=e.charAt(u))||"-"===c)){var l=60*parseInt(e.substr(u+1,2),10)+parseInt(e.substr(u+4,2),10);l*=6e4,"+"===c?t.setTime(+t-l):t.setTime(+t+l)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,u=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var h=e.length-5,p=e.charAt(h);"+"!==p&&"-"!==p||(u=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10),u*=6e4,"+"===p&&(u*=-1),l=!0);return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,c),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(o,s,a,c)),t},i.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"==typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,o){var s=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)o&&(e.tagClass!==t.tagClass&&o.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&o.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(s=!0,t.value&&n.util.isArray(t.value))for(var a=0,c=0;s&&c<t.value.length;++c)s=t.value[c].optional||!1,e.value[a]&&((s=i.validate(e.value[a],t.value[c],r,o))?++a:t.value[c].optional&&(s=!0)),!s&&o&&o.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(s&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else o&&o.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return s};var a=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var o="";r=r||2,(t=t||0)>0&&(o+="\n");for(var s="",c=0;c<t*r;++c)s+=" ";switch(o+=s+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:o+="Universal:";break;case i.Class.APPLICATION:o+="Application:";break;case i.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case i.Class.PRIVATE:o+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(o+=e.type,e.type){case i.Type.NONE:o+=" (None)";break;case i.Type.BOOLEAN:o+=" (Boolean)";break;case i.Type.INTEGER:o+=" (Integer)";break;case i.Type.BITSTRING:o+=" (Bit string)";break;case i.Type.OCTETSTRING:o+=" (Octet string)";break;case i.Type.NULL:o+=" (Null)";break;case i.Type.OID:o+=" (Object Identifier)";break;case i.Type.ODESC:o+=" (Object Descriptor)";break;case i.Type.EXTERNAL:o+=" (External or Instance of)";break;case i.Type.REAL:o+=" (Real)";break;case i.Type.ENUMERATED:o+=" (Enumerated)";break;case i.Type.EMBEDDED:o+=" (Embedded PDV)";break;case i.Type.UTF8:o+=" (UTF8)";break;case i.Type.ROID:o+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:o+=" (Sequence)";break;case i.Type.SET:o+=" (Set)";break;case i.Type.PRINTABLESTRING:o+=" (Printable String)";break;case i.Type.IA5String:o+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:o+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case i.Type.BMPSTRING:o+=" (BMP String)"}else o+=e.type;if(o+="\n",o+=s+"Constructed: "+e.constructed+"\n",e.composed){var u=0,l="";for(c=0;c<e.value.length;++c)void 0!==e.value[c]&&(u+=1,l+=i.prettyPrint(e.value[c],t+1,r),c+1<e.value.length&&(l+=","));o+=s+"Sub values: "+u+l}else{if(o+=s+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);o+=h,n.pki&&n.pki.oids&&h in n.pki.oids&&(o+=" ("+n.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{o+=i.derToInteger(e.value)}catch(t){o+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?o+="0x"+n.util.bytesToHex(e.value.slice(1)):o+="(none)",e.value.length>0){var p=e.value.charCodeAt(0);1==p?o+=" (1 unused bit shown)":p>1&&(o+=" ("+p+" unused bits shown)")}}else e.type===i.Type.OCTETSTRING?(a.test(e.value)||(o+="("+e.value+") "),o+="0x"+n.util.bytesToHex(e.value)):e.type===i.Type.UTF8?o+=n.util.decodeUtf8(e.value):e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?o+=e.value:a.test(e.value)?o+="0x"+n.util.bytesToHex(e.value):0===e.value.length?o+="[null]":o+=e.value}return o}},function(e,t,r){var n=r(3);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&(e[r]=n(e[r],t[r]));return e}Object.defineProperty(t,"__esModule",{value:!0}),t.deepCopy=function(e){return n(void 0,e)},t.deepExtend=n},function(e,t,r){e.exports=r(80)},function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";var n=r(21);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e}},function(e,t,r){"use strict";var n=r(1);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var s=[];n.forEach(t,function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))}))}),o=s.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},function(e,t,r){var n=r(14),i=r(30),o=r(23),s=r(15),a=r(9).Writable,c=r(89)("follow-redirects"),u={GET:!0,HEAD:!0,OPTIONS:!0,TRACE:!0},l=Object.create(null);function h(e,t){a.call(this),e.headers=e.headers||{},this._options=e,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],e.host&&(e.hostname||(e.hostname=e.host),delete e.host),t&&this.on("response",t);var r=this;if(this._onNativeResponse=function(e){r._processResponse(e)},!e.pathname&&e.path){var n=e.path.indexOf("?");n<0?e.pathname=e.path:(e.pathname=e.path.substring(0,n),e.search=e.path.substring(n))}this._performRequest()}function p(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach(function(i){var o=i+":",a=r[o]=e[i],u=t[i]=Object.create(a);u.request=function(e,i){return"string"==typeof e?(e=n.parse(e)).maxRedirects=t.maxRedirects:e=Object.assign({protocol:o,maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e),e.nativeProtocols=r,s.equal(e.protocol,o,"protocol mismatch"),c("options",e),new h(e,i)},u.get=function(e,t){var r=u.request(e,t);return r.end(),r}}),t}["abort","aborted","error","socket","timeout"].forEach(function(e){l[e]=function(t){this._redirectable.emit(e,t)}}),h.prototype=Object.create(a.prototype),h.prototype.write=function(e,t,r){if(!("string"==typeof e||"object"==typeof e&&"length"in e))throw new Error("data should be a string, Buffer or Uint8Array");"function"==typeof t&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new Error("Request body larger than maxBodyLength limit")),this.abort()):r&&r()},h.prototype.end=function(e,t,r){"function"==typeof e?(r=e,e=t=null):"function"==typeof t&&(r=t,t=null);var n=this._currentRequest;this.write(e||"",t,function(){n.end(null,null,r)})},h.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},h.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},["abort","flushHeaders","getHeader","setNoDelay","setSocketKeepAlive","setTimeout"].forEach(function(e){h.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}}),["aborted","connection","socket"].forEach(function(e){Object.defineProperty(h.prototype,e,{get:function(){return this._currentRequest[e]}})}),h.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var r=e.substr(0,e.length-1);this._options.agent=this._options.agents[r]}var i=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var o in this._currentUrl=n.format(this._options),i._redirectable=this,l)o&&i.on(o,l[o]);if(this._isRedirect){var s=0,a=this._requestBodyBuffers;!function e(){if(s<a.length){var t=a[s++];i.write(t.data,t.encoding,e)}else i.end()}()}}else this.emit("error",new Error("Unsupported protocol "+e))},h.prototype._processResponse=function(e){this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:e.statusCode});var t=e.headers.location;if(t&&!1!==this._options.followRedirects&&e.statusCode>=300&&e.statusCode<400){if(++this._redirectCount>this._options.maxRedirects)return void this.emit("error",new Error("Max redirects exceeded."));var r,i=this._options.headers;if(307!==e.statusCode&&!(this._options.method in u))for(r in this._options.method="GET",this._requestBodyBuffers=[],i)/^content-/i.test(r)&&delete i[r];if(!this._isRedirect)for(r in i)/^host$/i.test(r)&&delete i[r];var o=n.resolve(this._currentUrl,t);c("redirecting to",o),Object.assign(this._options,n.parse(o)),this._isRedirect=!0,this._performRequest(),e.destroy()}else e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),this._requestBodyBuffers=[]},e.exports=p({http:i,https:o}),e.exports.wrap=p},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,i=+new Date,o=i-(r||i);e.diff=o,e.prev=r,e.curr=i,r=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;c++;var i=t.formatters[n];if("function"==typeof i){var o=s[c];r=i.call(e,o),s.splice(c,1),c--}return r}),t.formatArgs.call(e,s),(n.log||t.log||console.log.bind(console)).apply(e,s)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=i,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var o=t.instances[r];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(91),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(t.Status||(t.Status={})),function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.ERROR=2]="ERROR"}(t.LogVerbosity||(t.LogVerbosity={}))},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(39),s=r(10),a=r(11),c=r(30),u=r(23),l=r(14),h=r(12),p=function(){function e(e){this.status=e.status,this.headers=e.headers,this.text=e.data;try{this.parsedData=JSON.parse(e.data)}catch(e){this.parsedData=void 0,this.parseError=e}this.request=e.config.method+" "+e.config.url}return Object.defineProperty(e.prototype,"data",{get:function(){if(this.isJson())return this.parsedData;throw new s.FirebaseAppError(s.AppErrorCodes.UNABLE_TO_PARSE_RESPONSE,'Error while parsing response data: "'+this.parseError.toString()+'". Raw server response: "'+this.text+'". Status code: "'+this.status+'". Outgoing request: "'+this.request+'."')},enumerable:!0,configurable:!0}),e.prototype.isJson=function(){return void 0!==this.parsedData},e}(),f=function(e){function t(r){var n=e.call(this,"Server responded with status "+r.status+".")||this;return n.response=r,Object.setPrototypeOf(n,t.prototype),n}return i(t,e),t}(Error);t.HttpError=f;var d=function(){function e(){}return e.prototype.send=function(e){return this.sendWithRetry(e)},e.prototype.sendWithRetry=function(e,t){var n=this;return void 0===t&&(t=0),function(e){var t=o.deepCopy(e);return new Promise(function(e,n){var i,o=t.headers||{},s=t.url;if(t.data){if("GET"===t.method||"HEAD"===t.method){if(!a.isObject(t.data))return n(g(t.method+" requests cannot have a body",t));var h=new l.URL(s);for(var p in t.data)t.data.hasOwnProperty(p)&&h.searchParams.append(p,t.data[p]);s=h.toString()}else if(a.isObject(t.data))i=Buffer.from(JSON.stringify(t.data),"utf-8"),void 0===o["Content-Type"]&&(o["Content-Type"]="application/json;charset=utf-8");else if(a.isString(t.data))i=Buffer.from(t.data,"utf-8");else{if(!a.isBuffer(t.data))return n(g("Request data must be a string, a Buffer or a json serializable object",t));i=t.data}i&&(o["Content-Length"]=i.length.toString())}var f=l.parse(s),d=f.protocol||"https:",y="https:"===d,v={hostname:f.hostname,port:f.port,path:f.path,method:t.method,headers:o},b=y?u:c,_=b.request(v,function(i){if(!_.aborted){var o=i;if(-1!==["gzip","compress","deflate"].indexOf(i.headers["content-encoding"])){var s=r(51);o=o.pipe(s.createUnzip()),delete i.headers["content-encoding"]}var a={status:i.statusCode,headers:i.headers,request:_,data:void 0,config:t},c=[];o.on("data",function(e){c.push(e)}),o.on("error",function(e){_.aborted||n(m(e,t,null,_))}),o.on("end",function(){var t=Buffer.concat(c).toString();a.data=t,function(e,t,r){r.status>=200&&r.status<300?e(r):t(g("Request failed with status code "+r.status,r.config,null,r.request,r))}(e,n,a)})}});_.on("error",function(e){_.aborted||n(m(e,t,null,_))}),t.timeout&&_.setTimeout(t.timeout,function(){_.abort(),n(g("timeout of "+t.timeout+"ms exceeded",t,"ETIMEDOUT",_))}),_.end(i)})}(e).then(function(e){return new p(e)}).catch(function(r){if(-1!==["ECONNRESET","ETIMEDOUT"].indexOf(r.code)&&0===t)return n.sendWithRetry(e,t+1);if(r.response)throw new f(new p(r.response));if("ETIMEDOUT"===r.code)throw new s.FirebaseAppError(s.AppErrorCodes.NETWORK_TIMEOUT,"Error while making request: "+r.message+".");throw new s.FirebaseAppError(s.AppErrorCodes.NETWORK_ERROR,"Error while making request: "+r.message+". Error code: "+r.code)})},e}();function g(e,t,r,n,i){return m(new Error(e),t,r,n,i)}function m(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e}t.HttpClient=d;var y=function(e){function t(t){var r=e.call(this)||this;return r.app=t,r}return i(t,e),t.prototype.send=function(t){var r=this;return this.app.INTERNAL.getToken().then(function(n){var i=o.deepCopy(t);i.headers=i.headers||{};return i.headers.Authorization="Bearer "+n.accessToken,e.prototype.send.call(r,i)})},t}(d);t.AuthorizedHttpClient=y;var v=function(){function e(e,t){void 0===t&&(t="POST"),this.endpoint=e,this.httpMethod=t,this.setRequestValidator(null).setResponseValidator(null)}return e.prototype.getEndpoint=function(){return this.endpoint},e.prototype.getHttpMethod=function(){return this.httpMethod},e.prototype.setRequestValidator=function(e){return this.requestValidator=e||function(e){},this},e.prototype.getRequestValidator=function(){return this.requestValidator},e.prototype.setResponseValidator=function(e){return this.responseValidator=e||function(e){},this},e.prototype.getResponseValidator=function(){return this.responseValidator},e}();t.ApiSettings=v;var b=function(e){function t(t,r,n){void 0===t&&(t=1e3),void 0===r&&(r=1e4),void 0===n&&(n=6e4);var i=e.call(this)||this;return i.initialPollingDelayMillis=t,i.maxPollingDelayMillis=r,i.masterTimeoutMillis=n,i.numTries=0,i.completed=!1,i}return i(t,e),t.prototype.poll=function(e){var t=this;if(this.pollCallback)throw new Error("poll() can only be called once per instance of ExponentialBackoffPoller");return this.pollCallback=e,this.on("poll",this.repoll),this.masterTimer=setTimeout(function(){t.completed||(t.markCompleted(),t.reject(new Error("ExponentialBackoffPoller deadline exceeded - Master timeout reached")))},this.masterTimeoutMillis),new Promise(function(e,r){t.resolve=e,t.reject=r,t.repoll()})},t.prototype.repoll=function(){var e=this;this.pollCallback().then(function(t){if(!e.completed){if(!t)return e.repollTimer=setTimeout(function(){return e.emit("poll")},e.getPollingDelayMillis()),void e.numTries++;e.markCompleted(),e.resolve(t)}}).catch(function(t){e.completed||(e.markCompleted(),e.reject(t))})},t.prototype.getPollingDelayMillis=function(){var e=Math.pow(2,this.numTries)*this.initialPollingDelayMillis;return Math.min(e,this.maxPollingDelayMillis)},t.prototype.markCompleted=function(){this.completed=!0,this.masterTimer&&clearTimeout(this.masterTimer),this.repollTimer&&clearTimeout(this.repollTimer)},t}(h.EventEmitter);t.ExponentialBackoffPoller=b},function(e,t){e.exports=require("zlib")},function(e,t,r){var n=r(2);function i(e,t){n.cipher.registerAlgorithm(e,function(){return new n.aes.Algorithm(e,t)})}r(131),r(172),r(5),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=g({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=g({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||p();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return d(r._w,e,t,!1)},decrypt:function(e,t){return d(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var o=t.length();if(16===o||24===o||32===o){o>>>=2;for(i=0;i<o;++i)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var s=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(s);this._w=f(r,e.decrypt&&!a),this._init=!0}},n.aes._expandKey=function(e,t){return l||p(),f(e,t)},n.aes._updateBlock=d,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var o,s,a,c,u,l=!1,h=4;function p(){l=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;o=new Array(256),s=new Array(256),c=new Array(4),u=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),u[t]=new Array(256);var r,n,i,h,p,f,d,g=0,m=0;for(t=0;t<256;++t){h=(h=m^m<<1^m<<2^m<<3^m<<4)>>8^255&h^99,o[g]=h,s[h]=g,f=(p=e[h])<<24^h<<16^h<<8^h^p,d=((r=e[g])^(n=e[r])^(i=e[n]))<<24^(g^i)<<16^(g^n^i)<<8^g^r^i;for(var y=0;y<4;++y)c[y][g]=f,u[y][h]=d,f=f<<24|f>>>8,d=d<<24|d>>>8;0===g?g=m=1:(g=r^e[e[e[r^i]]],m^=e[e[m]])}}function f(e,t){for(var r,n=e.slice(0),i=1,s=n.length,c=h*(s+6+1),l=s;l<c;++l)r=n[l-1],l%s==0?(r=o[r>>>16&255]<<24^o[r>>>8&255]<<16^o[255&r]<<8^o[r>>>24]^a[i]<<24,i++):s>6&&l%s==4&&(r=o[r>>>24]<<24^o[r>>>16&255]<<16^o[r>>>8&255]<<8^o[255&r]),n[l]=n[l-s]^r;if(t){for(var p,f=u[0],d=u[1],g=u[2],m=u[3],y=n.slice(0),v=(l=0,(c=n.length)-h);l<c;l+=h,v-=h)if(0===l||l===c-h)y[l]=n[v],y[l+1]=n[v+3],y[l+2]=n[v+2],y[l+3]=n[v+1];else for(var b=0;b<h;++b)p=n[v+b],y[l+(3&-b)]=f[o[p>>>24]]^d[o[p>>>16&255]]^g[o[p>>>8&255]]^m[o[255&p]];n=y}return n}function d(e,t,r,n){var i,a,l,h,p,f,d,g,m,y,v,b,_=e.length/4-1;n?(i=u[0],a=u[1],l=u[2],h=u[3],p=s):(i=c[0],a=c[1],l=c[2],h=c[3],p=o),f=t[0]^e[0],d=t[n?3:1]^e[1],g=t[2]^e[2],m=t[n?1:3]^e[3];for(var E=3,C=1;C<_;++C)y=i[f>>>24]^a[d>>>16&255]^l[g>>>8&255]^h[255&m]^e[++E],v=i[d>>>24]^a[g>>>16&255]^l[m>>>8&255]^h[255&f]^e[++E],b=i[g>>>24]^a[m>>>16&255]^l[f>>>8&255]^h[255&d]^e[++E],m=i[m>>>24]^a[f>>>16&255]^l[d>>>8&255]^h[255&g]^e[++E],f=y,d=v,g=b;r[0]=p[f>>>24]<<24^p[d>>>16&255]<<16^p[g>>>8&255]<<8^p[255&m]^e[++E],r[n?3:1]=p[d>>>24]<<24^p[g>>>16&255]<<16^p[m>>>8&255]<<8^p[255&f]^e[++E],r[2]=p[g>>>24]<<24^p[m>>>16&255]<<16^p[f>>>8&255]<<8^p[255&d]^e[++E],r[n?1:3]=p[m>>>24]<<24^p[f>>>16&255]<<16^p[d>>>8&255]<<8^p[255&g]^e[++E]}function g(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var o=null;r instanceof n.util.ByteBuffer&&(o=r,r={}),(r=r||{}).output=o,r.iv=e,i.call(t,r)},t}},function(e,t,r){var n=r(2);n.pki=n.pki||{};var i=e.exports=n.pki.oids=n.oids=n.oids||{};function o(e,t){i[e]=t,i[t]=e}function s(e,t){i[e]=t}o("1.2.840.113549.1.1.1","rsaEncryption"),o("1.2.840.113549.1.1.4","md5WithRSAEncryption"),o("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),o("1.2.840.113549.1.1.7","RSAES-OAEP"),o("1.2.840.113549.1.1.8","mgf1"),o("1.2.840.113549.1.1.9","pSpecified"),o("1.2.840.113549.1.1.10","RSASSA-PSS"),o("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),o("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),o("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),o("1.2.840.10040.4.3","dsa-with-sha1"),o("1.3.14.3.2.7","desCBC"),o("1.3.14.3.2.26","sha1"),o("2.16.840.1.101.3.4.2.1","sha256"),o("2.16.840.1.101.3.4.2.2","sha384"),o("2.16.840.1.101.3.4.2.3","sha512"),o("1.2.840.113549.2.5","md5"),o("1.2.840.113549.1.7.1","data"),o("1.2.840.113549.1.7.2","signedData"),o("1.2.840.113549.1.7.3","envelopedData"),o("1.2.840.113549.1.7.4","signedAndEnvelopedData"),o("1.2.840.113549.1.7.5","digestedData"),o("1.2.840.113549.1.7.6","encryptedData"),o("1.2.840.113549.1.9.1","emailAddress"),o("1.2.840.113549.1.9.2","unstructuredName"),o("1.2.840.113549.1.9.3","contentType"),o("1.2.840.113549.1.9.4","messageDigest"),o("1.2.840.113549.1.9.5","signingTime"),o("1.2.840.113549.1.9.6","counterSignature"),o("1.2.840.113549.1.9.7","challengePassword"),o("1.2.840.113549.1.9.8","unstructuredAddress"),o("1.2.840.113549.1.9.14","extensionRequest"),o("1.2.840.113549.1.9.20","friendlyName"),o("1.2.840.113549.1.9.21","localKeyId"),o("1.2.840.113549.1.9.22.1","x509Certificate"),o("1.2.840.113549.1.12.10.1.1","keyBag"),o("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),o("1.2.840.113549.1.12.10.1.3","certBag"),o("1.2.840.113549.1.12.10.1.4","crlBag"),o("1.2.840.113549.1.12.10.1.5","secretBag"),o("1.2.840.113549.1.12.10.1.6","safeContentsBag"),o("1.2.840.113549.1.5.13","pkcs5PBES2"),o("1.2.840.113549.1.5.12","pkcs5PBKDF2"),o("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),o("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),o("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),o("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),o("1.2.840.113549.2.7","hmacWithSHA1"),o("1.2.840.113549.2.8","hmacWithSHA224"),o("1.2.840.113549.2.9","hmacWithSHA256"),o("1.2.840.113549.2.10","hmacWithSHA384"),o("1.2.840.113549.2.11","hmacWithSHA512"),o("1.2.840.113549.3.7","des-EDE3-CBC"),o("2.16.840.1.101.3.4.1.2","aes128-CBC"),o("2.16.840.1.101.3.4.1.22","aes192-CBC"),o("2.16.840.1.101.3.4.1.42","aes256-CBC"),o("2.5.4.3","commonName"),o("2.5.4.5","serialName"),o("2.5.4.6","countryName"),o("2.5.4.7","localityName"),o("2.5.4.8","stateOrProvinceName"),o("2.5.4.10","organizationName"),o("2.5.4.11","organizationalUnitName"),o("2.16.840.1.113730.1.1","nsCertType"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),o("2.5.29.14","subjectKeyIdentifier"),o("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),o("2.5.29.17","subjectAltName"),o("2.5.29.18","issuerAltName"),o("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),o("2.5.29.31","cRLDistributionPoints"),o("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),o("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),o("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),o("1.3.6.1.4.1.11129.2.4.2","timestampList"),o("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),o("1.3.6.1.5.5.7.3.1","serverAuth"),o("1.3.6.1.5.5.7.3.2","clientAuth"),o("1.3.6.1.5.5.7.3.3","codeSigning"),o("1.3.6.1.5.5.7.3.4","emailProtection"),o("1.3.6.1.5.5.7.3.8","timeStamping")},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(26).createValidator(),i=1e6;class o{static now(){return o.fromMillis(Date.now())}static fromDate(e){return o.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3);return new o(t,(e-1e3*t)*i)}static fromProto(e){return new o(Number(e.seconds||0),Number(e.nanos||0))}constructor(e,t){n.isInteger("seconds",e),n.isInteger("nanoseconds",t,0,999999999),this._seconds=e,this._nanoseconds=t}get seconds(){return this._seconds}get nanoseconds(){return this._nanoseconds}toDate(){return new Date(1e3*this._seconds+Math.round(this._nanoseconds/i))}toMillis(){return 1e3*this._seconds+Math.floor(this._nanoseconds/i)}isEqual(e){return this===e||e instanceof o&&this._seconds===e.seconds&&this._nanoseconds===e.nanoseconds}toProto(){const e={};return this.seconds&&(e.seconds=this.seconds),this.nanoseconds&&(e.nanos=this.nanoseconds),{timestampValue:e}}}t.Timestamp=o},function(e,t,r){"use strict";e.exports=u;var n=r(63);((u.prototype=Object.create(n.prototype)).constructor=u).className="Field";var i,o=r(28),s=r(64),a=r(13),c=/^required|optional|repeated$/;function u(e,t,r,i,o,u,l){if(a.isObject(i)?(l=o,u=i,i=o=void 0):a.isObject(o)&&(l=u,u=o,o=void 0),n.call(this,e,u),!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(r))throw TypeError("type must be a string");if(void 0!==i&&!c.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!a.isString(o))throw TypeError("extend must be a string");this.rule=i&&"optional"!==i?i:void 0,this.type=r,this.id=t,this.extend=o||void 0,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==s.long[r],this.bytes="bytes"===r,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=l}u.fromJSON=function(e,t){return new u(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(u.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),u.prototype.setOption=function(e,t,r){return"packed"===e&&(this._packed=null),n.prototype.setOption.call(this,e,t,r)},u.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},u.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=s.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},u.d=function(e,t,r,n){return"function"==typeof t?t=a.decorateType(t).name:t&&"object"==typeof t&&(t=a.decorateEnum(t).name),function(i,o){a.decorateType(i.constructor).add(new u(o,e,t,r,{default:n}))}},u._configure=function(e){i=e}},function(e,t,r){var n=r(3);function i(e,t){n.cipher.registerAlgorithm(e,function(){return new n.aes.Algorithm(e,t)})}r(157),r(235),r(6),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=g({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=g({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||p();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return d(r._w,e,t,!1)},decrypt:function(e,t){return d(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var o=t.length();if(16===o||24===o||32===o){o>>>=2;for(i=0;i<o;++i)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var s=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(s);this._w=f(r,e.decrypt&&!a),this._init=!0}},n.aes._expandKey=function(e,t){return l||p(),f(e,t)},n.aes._updateBlock=d,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var o,s,a,c,u,l=!1,h=4;function p(){l=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;o=new Array(256),s=new Array(256),c=new Array(4),u=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),u[t]=new Array(256);var r,n,i,h,p,f,d,g=0,m=0;for(t=0;t<256;++t){h=(h=m^m<<1^m<<2^m<<3^m<<4)>>8^255&h^99,o[g]=h,s[h]=g,f=(p=e[h])<<24^h<<16^h<<8^h^p,d=((r=e[g])^(n=e[r])^(i=e[n]))<<24^(g^i)<<16^(g^n^i)<<8^g^r^i;for(var y=0;y<4;++y)c[y][g]=f,u[y][h]=d,f=f<<24|f>>>8,d=d<<24|d>>>8;0===g?g=m=1:(g=r^e[e[e[r^i]]],m^=e[e[m]])}}function f(e,t){for(var r,n=e.slice(0),i=1,s=n.length,c=h*(s+6+1),l=s;l<c;++l)r=n[l-1],l%s==0?(r=o[r>>>16&255]<<24^o[r>>>8&255]<<16^o[255&r]<<8^o[r>>>24]^a[i]<<24,i++):s>6&&l%s==4&&(r=o[r>>>24]<<24^o[r>>>16&255]<<16^o[r>>>8&255]<<8^o[255&r]),n[l]=n[l-s]^r;if(t){for(var p,f=u[0],d=u[1],g=u[2],m=u[3],y=n.slice(0),v=(l=0,(c=n.length)-h);l<c;l+=h,v-=h)if(0===l||l===c-h)y[l]=n[v],y[l+1]=n[v+3],y[l+2]=n[v+2],y[l+3]=n[v+1];else for(var b=0;b<h;++b)p=n[v+b],y[l+(3&-b)]=f[o[p>>>24]]^d[o[p>>>16&255]]^g[o[p>>>8&255]]^m[o[255&p]];n=y}return n}function d(e,t,r,n){var i,a,l,h,p,f,d,g,m,y,v,b,_=e.length/4-1;n?(i=u[0],a=u[1],l=u[2],h=u[3],p=s):(i=c[0],a=c[1],l=c[2],h=c[3],p=o),f=t[0]^e[0],d=t[n?3:1]^e[1],g=t[2]^e[2],m=t[n?1:3]^e[3];for(var E=3,C=1;C<_;++C)y=i[f>>>24]^a[d>>>16&255]^l[g>>>8&255]^h[255&m]^e[++E],v=i[d>>>24]^a[g>>>16&255]^l[m>>>8&255]^h[255&f]^e[++E],b=i[g>>>24]^a[m>>>16&255]^l[f>>>8&255]^h[255&d]^e[++E],m=i[m>>>24]^a[f>>>16&255]^l[d>>>8&255]^h[255&g]^e[++E],f=y,d=v,g=b;r[0]=p[f>>>24]<<24^p[d>>>16&255]<<16^p[g>>>8&255]<<8^p[255&m]^e[++E],r[n?3:1]=p[d>>>24]<<24^p[g>>>16&255]<<16^p[m>>>8&255]<<8^p[255&f]^e[++E],r[2]=p[g>>>24]<<24^p[m>>>16&255]<<16^p[f>>>8&255]<<8^p[255&d]^e[++E],r[n?1:3]=p[m>>>24]<<24^p[f>>>16&255]<<16^p[d>>>8&255]<<8^p[255&g]^e[++E]}function g(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var o=null;r instanceof n.util.ByteBuffer&&(o=r,r={}),(r=r||{}).output=o,r.iv=e,i.call(t,r)},t}},function(e,t,r){var n=r(3);n.pki=n.pki||{};var i=e.exports=n.pki.oids=n.oids=n.oids||{};function o(e,t){i[e]=t,i[t]=e}function s(e,t){i[e]=t}o("1.2.840.113549.1.1.1","rsaEncryption"),o("1.2.840.113549.1.1.4","md5WithRSAEncryption"),o("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),o("1.2.840.113549.1.1.7","RSAES-OAEP"),o("1.2.840.113549.1.1.8","mgf1"),o("1.2.840.113549.1.1.9","pSpecified"),o("1.2.840.113549.1.1.10","RSASSA-PSS"),o("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),o("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),o("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),o("1.2.840.10040.4.3","dsa-with-sha1"),o("1.3.14.3.2.7","desCBC"),o("1.3.14.3.2.26","sha1"),o("2.16.840.1.101.3.4.2.1","sha256"),o("2.16.840.1.101.3.4.2.2","sha384"),o("2.16.840.1.101.3.4.2.3","sha512"),o("1.2.840.113549.2.5","md5"),o("1.2.840.113549.1.7.1","data"),o("1.2.840.113549.1.7.2","signedData"),o("1.2.840.113549.1.7.3","envelopedData"),o("1.2.840.113549.1.7.4","signedAndEnvelopedData"),o("1.2.840.113549.1.7.5","digestedData"),o("1.2.840.113549.1.7.6","encryptedData"),o("1.2.840.113549.1.9.1","emailAddress"),o("1.2.840.113549.1.9.2","unstructuredName"),o("1.2.840.113549.1.9.3","contentType"),o("1.2.840.113549.1.9.4","messageDigest"),o("1.2.840.113549.1.9.5","signingTime"),o("1.2.840.113549.1.9.6","counterSignature"),o("1.2.840.113549.1.9.7","challengePassword"),o("1.2.840.113549.1.9.8","unstructuredAddress"),o("1.2.840.113549.1.9.14","extensionRequest"),o("1.2.840.113549.1.9.20","friendlyName"),o("1.2.840.113549.1.9.21","localKeyId"),o("1.2.840.113549.1.9.22.1","x509Certificate"),o("1.2.840.113549.1.12.10.1.1","keyBag"),o("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),o("1.2.840.113549.1.12.10.1.3","certBag"),o("1.2.840.113549.1.12.10.1.4","crlBag"),o("1.2.840.113549.1.12.10.1.5","secretBag"),o("1.2.840.113549.1.12.10.1.6","safeContentsBag"),o("1.2.840.113549.1.5.13","pkcs5PBES2"),o("1.2.840.113549.1.5.12","pkcs5PBKDF2"),o("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),o("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),o("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),o("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),o("1.2.840.113549.2.7","hmacWithSHA1"),o("1.2.840.113549.2.8","hmacWithSHA224"),o("1.2.840.113549.2.9","hmacWithSHA256"),o("1.2.840.113549.2.10","hmacWithSHA384"),o("1.2.840.113549.2.11","hmacWithSHA512"),o("1.2.840.113549.3.7","des-EDE3-CBC"),o("2.16.840.1.101.3.4.1.2","aes128-CBC"),o("2.16.840.1.101.3.4.1.22","aes192-CBC"),o("2.16.840.1.101.3.4.1.42","aes256-CBC"),o("2.5.4.3","commonName"),o("2.5.4.5","serialName"),o("2.5.4.6","countryName"),o("2.5.4.7","localityName"),o("2.5.4.8","stateOrProvinceName"),o("2.5.4.10","organizationName"),o("2.5.4.11","organizationalUnitName"),o("2.16.840.1.113730.1.1","nsCertType"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),o("2.5.29.14","subjectKeyIdentifier"),o("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),o("2.5.29.17","subjectAltName"),o("2.5.29.18","issuerAltName"),o("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),o("2.5.29.31","cRLDistributionPoints"),o("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),o("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),o("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),o("1.3.6.1.4.1.11129.2.4.2","timestampList"),o("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),o("1.3.6.1.5.5.7.3.1","serverAuth"),o("1.3.6.1.5.5.7.3.2","clientAuth"),o("1.3.6.1.5.5.7.3.3","codeSigning"),o("1.3.6.1.5.5.7.3.4","emailProtection"),o("1.3.6.1.5.5.7.3.8","timeStamping")},function(e,t,r){var n=r(2);r(5);var i=e.exports=n.pem=n.pem||{};function o(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var o=0,s=-1;for(i=0;i<t.length;++i,++o)if(o>65&&-1!==s){var a=t[s];","===a?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+a+t.substr(s+1),o=i-s-1,s=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(s=i);return t}function s(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var r,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=o(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=o(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),i+=o(r)),e.headers)for(var s=0;s<e.headers.length;++s)i+=o(e.headers[s]);return e.procType&&(i+="\r\n"),i+=n.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n"},i.decode=function(e){for(var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,o=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;t=i.exec(e);){var c={type:t[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(c),t[2]){for(var u=t[2].split(a),l=0;t&&l<u.length;){for(var h=u[l].replace(/\s+$/,""),p=l+1;p<u.length;++p){var f=u[p];if(!/\s/.test(f[0]))break;h+=f,l=p}if(t=h.match(o)){for(var d={name:t[1],values:[]},g=t[2].split(","),m=0;m<g.length;++m)d.values.push(s(g[m]));if(c.procType)if(c.contentDomain||"Content-Domain"!==d.name)if(c.dekInfo||"DEK-Info"!==d.name)c.headers.push(d);else{if(0===d.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:g[0],parameters:g[1]||null}}else c.contentDomain=g[0]||"";else{if("Proc-Type"!==d.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==d.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:g[0],type:g[1]}}}++l}if("ENCRYPTED"===c.procType&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},function(e,t,r){"use strict";
/**!
 * is
 * the definitive JavaScript type testing library
 *
 * @copyright 2013-2014 Enrico Marino / Jordan Harband
 * @license MIT
 */var n,i=Object.prototype,o=i.hasOwnProperty,s=i.toString;"function"==typeof Symbol&&(n=Symbol.prototype.valueOf);var a=function(e){return e!=e},c={boolean:1,number:1,string:1,undefined:1},u=/^([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{4}|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{2}==)$/,l=/^[A-Fa-f0-9]+$/,h={};h.a=h.type=function(e,t){return typeof e===t},h.defined=function(e){return void 0!==e},h.empty=function(e){var t,r=s.call(e);if("[object Array]"===r||"[object Arguments]"===r||"[object String]"===r)return 0===e.length;if("[object Object]"===r){for(t in e)if(o.call(e,t))return!1;return!0}return!e},h.equal=function(e,t){if(e===t)return!0;var r,n=s.call(e);if(n!==s.call(t))return!1;if("[object Object]"===n){for(r in e)if(!(h.equal(e[r],t[r])&&r in t))return!1;for(r in t)if(!(h.equal(e[r],t[r])&&r in e))return!1;return!0}if("[object Array]"===n){if((r=e.length)!==t.length)return!1;for(;r--;)if(!h.equal(e[r],t[r]))return!1;return!0}return"[object Function]"===n?e.prototype===t.prototype:"[object Date]"===n&&e.getTime()===t.getTime()},h.hosted=function(e,t){var r=typeof t[e];return"object"===r?!!t[e]:!c[r]},h.instance=h.instanceof=function(e,t){return e instanceof t},h.nil=h.null=function(e){return null===e},h.undef=h.undefined=function(e){return void 0===e},h.args=h.arguments=function(e){var t="[object Arguments]"===s.call(e),r=!h.array(e)&&h.arraylike(e)&&h.object(e)&&h.fn(e.callee);return t||r},h.array=Array.isArray||function(e){return"[object Array]"===s.call(e)},h.args.empty=function(e){return h.args(e)&&0===e.length},h.array.empty=function(e){return h.array(e)&&0===e.length},h.arraylike=function(e){return!!e&&!h.bool(e)&&o.call(e,"length")&&isFinite(e.length)&&h.number(e.length)&&e.length>=0},h.bool=h.boolean=function(e){return"[object Boolean]"===s.call(e)},h.false=function(e){return h.bool(e)&&!1===Boolean(Number(e))},h.true=function(e){return h.bool(e)&&!0===Boolean(Number(e))},h.date=function(e){return"[object Date]"===s.call(e)},h.date.valid=function(e){return h.date(e)&&!isNaN(Number(e))},h.element=function(e){return void 0!==e&&"undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&1===e.nodeType},h.error=function(e){return"[object Error]"===s.call(e)},h.fn=h.function=function(e){if("undefined"!=typeof window&&e===window.alert)return!0;var t=s.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t||"[object AsyncFunction]"===t},h.number=function(e){return"[object Number]"===s.call(e)},h.infinite=function(e){return e===1/0||e===-1/0},h.decimal=function(e){return h.number(e)&&!a(e)&&!h.infinite(e)&&e%1!=0},h.divisibleBy=function(e,t){var r=h.infinite(e),n=h.infinite(t),i=h.number(e)&&!a(e)&&h.number(t)&&!a(t)&&0!==t;return r||n||i&&e%t==0},h.integer=h.int=function(e){return h.number(e)&&!a(e)&&e%1==0},h.maximum=function(e,t){if(a(e))throw new TypeError("NaN is not a valid value");if(!h.arraylike(t))throw new TypeError("second argument must be array-like");for(var r=t.length;--r>=0;)if(e<t[r])return!1;return!0},h.minimum=function(e,t){if(a(e))throw new TypeError("NaN is not a valid value");if(!h.arraylike(t))throw new TypeError("second argument must be array-like");for(var r=t.length;--r>=0;)if(e>t[r])return!1;return!0},h.nan=function(e){return!h.number(e)||e!=e},h.even=function(e){return h.infinite(e)||h.number(e)&&e==e&&e%2==0},h.odd=function(e){return h.infinite(e)||h.number(e)&&e==e&&e%2!=0},h.ge=function(e,t){if(a(e)||a(t))throw new TypeError("NaN is not a valid value");return!h.infinite(e)&&!h.infinite(t)&&e>=t},h.gt=function(e,t){if(a(e)||a(t))throw new TypeError("NaN is not a valid value");return!h.infinite(e)&&!h.infinite(t)&&e>t},h.le=function(e,t){if(a(e)||a(t))throw new TypeError("NaN is not a valid value");return!h.infinite(e)&&!h.infinite(t)&&e<=t},h.lt=function(e,t){if(a(e)||a(t))throw new TypeError("NaN is not a valid value");return!h.infinite(e)&&!h.infinite(t)&&e<t},h.within=function(e,t,r){if(a(e)||a(t)||a(r))throw new TypeError("NaN is not a valid value");if(!h.number(e)||!h.number(t)||!h.number(r))throw new TypeError("all arguments must be numbers");return h.infinite(e)||h.infinite(t)||h.infinite(r)||e>=t&&e<=r},h.object=function(e){return"[object Object]"===s.call(e)},h.primitive=function(e){return!e||!("object"==typeof e||h.object(e)||h.fn(e)||h.array(e))},h.hash=function(e){return h.object(e)&&e.constructor===Object&&!e.nodeType&&!e.setInterval},h.regexp=function(e){return"[object RegExp]"===s.call(e)},h.string=function(e){return"[object String]"===s.call(e)},h.base64=function(e){return h.string(e)&&(!e.length||u.test(e))},h.hex=function(e){return h.string(e)&&(!e.length||l.test(e))},h.symbol=function(e){return"function"==typeof Symbol&&"[object Symbol]"===s.call(e)&&"symbol"==typeof n.call(e)},e.exports=h},function(e,t,r){"use strict";var n=r(115),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=h;var o=r(25);o.inherits=r(19);var s=r(208),a=r(211);o.inherits(h,s);for(var c=i(a.prototype),u=0;u<c.length;u++){var l=c[u];h.prototype[l]||(h.prototype[l]=a.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(4),i=r(26).createValidator();
/*! The Firestore library version */
let o,s=e=>{};
/*! The external function used to emit logs. */t.logger=function(e,t,r,...i){t=t||"#####";const a=n.format(r,...i),c=(new Date).toISOString();s(`Firestore (${o}) ${c} ${t} [${e}]: `+a)},t.setLogFunction=function(e){i.isFunction("logger",e),s=e},t.setLibVersion=function(e){o=e}},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(27),i=r(78);function o(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let r=0;r<20;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}t.autoId=o,t.requestTag=function(){return o().substr(0,5)},t.parseGetAllArguments=function(e,t){let r,o=void 0;Array.isArray(t[0])?(r=t[0],o=t[1]):t.length>0&&i.isPlainObject(t[t.length-1])?(o=t.pop(),r=t):r=t;for(let t=0;t<r.length;++t)e.isDocumentReference(t,r[t]);return e.isOptionalReadOptions("options",o),{fieldMask:o&&o.fieldMask?o.fieldMask.map(e=>n.FieldPath.fromArgument(e)):null,documents:r}}},function(e,t,r){"use strict";e.exports=o,o.className="ReflectionObject";var n,i=r(13);function o(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof n&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof n&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved?this:(this.root instanceof n&&(this.resolved=!0),this)},o.prototype.getOption=function(e){if(this.options)return this.options[e]},o.prototype.setOption=function(e,t,r){return r&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},o.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)this.setOption(r[n],e[r[n]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){n=e}},function(e,t,r){"use strict";var n=t,i=r(13),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function s(e,t){var r=0,n={};for(t|=0;r<e.length;)n[o[r+t]]=e[r++];return n}n.basic=s([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=s([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),n.long=s([0,0,0,1,1],7),n.mapKey=s([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=s([1,5,0,0,0,5,5,0,0,0,1,1,0])},function(e,t,r){"use strict";var n=r(1),i=r(42),o=r(44),s=r(30),a=r(23),c=r(45).http,u=r(45).https,l=r(14),h=r(51),p=r(94),f=r(21),d=r(43);e.exports=function(e){return new Promise(function(t,r){var g,m=e.data,y=e.headers;if(y["User-Agent"]||y["user-agent"]||(y["User-Agent"]="axios/"+p.version),m&&!n.isStream(m)){if(Buffer.isBuffer(m));else if(n.isArrayBuffer(m))m=new Buffer(new Uint8Array(m));else{if(!n.isString(m))return r(f("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));m=new Buffer(m,"utf-8")}y["Content-Length"]=m.length}var v=void 0;e.auth&&(v=(e.auth.username||"")+":"+(e.auth.password||""));var b=l.parse(e.url),_=b.protocol||"http:";if(!v&&b.auth){var E=b.auth.split(":");v=(E[0]||"")+":"+(E[1]||"")}v&&delete y.Authorization;var C="https:"===_,w=C?e.httpsAgent:e.httpAgent,S={path:o(b.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method,headers:y,agent:w,auth:v};e.socketPath?S.socketPath=e.socketPath:(S.hostname=b.hostname,S.port=b.port);var T,A=e.proxy;if(!A&&!1!==A){var I=_.slice(0,-1)+"_proxy",N=process.env[I]||process.env[I.toUpperCase()];if(N){var k=l.parse(N);if(A={host:k.hostname,port:k.port},k.auth){var R=k.auth.split(":");A.auth={username:R[0],password:R[1]}}}}if(A&&(S.hostname=A.host,S.host=A.host,S.headers.host=b.hostname+(b.port?":"+b.port:""),S.port=A.port,S.path=_+"//"+b.hostname+(b.port?":"+b.port:"")+S.path,A.auth)){var O=new Buffer(A.auth.username+":"+A.auth.password,"utf8").toString("base64");S.headers["Proxy-Authorization"]="Basic "+O}e.transport?T=e.transport:0===e.maxRedirects?T=C?a:s:(e.maxRedirects&&(S.maxRedirects=e.maxRedirects),T=C?u:c),e.maxContentLength&&e.maxContentLength>-1&&(S.maxBodyLength=e.maxContentLength);var x=T.request(S,function(n){if(!x.aborted){clearTimeout(g),g=null;var o=n;switch(n.headers["content-encoding"]){case"gzip":case"compress":case"deflate":o=o.pipe(h.createUnzip()),delete n.headers["content-encoding"]}var s=n.req||x,a={status:n.statusCode,statusText:n.statusMessage,headers:n.headers,config:e,request:s};if("stream"===e.responseType)a.data=o,i(t,r,a);else{var c=[];o.on("data",function(t){c.push(t),e.maxContentLength>-1&&Buffer.concat(c).length>e.maxContentLength&&r(f("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,s))}),o.on("error",function(t){x.aborted||r(d(t,e,null,s))}),o.on("end",function(){var n=Buffer.concat(c);"arraybuffer"!==e.responseType&&(n=n.toString("utf8")),a.data=n,i(t,r,a)})}}});x.on("error",function(t){x.aborted||r(d(t,e,null,x))}),e.timeout&&!g&&(g=setTimeout(function(){x.abort(),r(f("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",x))},e.timeout)),e.cancelToken&&e.cancelToken.promise.then(function(e){x.aborted||(x.abort(),r(e))}),n.isStream(m)?m.pipe(x):x.end(m)})}},function(e,t){e.exports=require("tty")},function(e,t,r){"use strict";const n=r(29),i=r(93),o=process.env;let s;function a(e){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(function(e){if(!1===s)return 0;if(i("color=16m")||i("color=full")||i("color=truecolor"))return 3;if(i("color=256"))return 2;if(e&&!e.isTTY&&!0!==s)return 0;const t=s?1:0;if("win32"===process.platform){const e=n.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in o)||"codeship"===o.CI_NAME?1:t;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)?1:"COLORTERM"in o?1:(o.TERM,t)}(e))}i("no-color")||i("no-colors")||i("color=false")?s=!1:(i("color")||i("colors")||i("color=true")||i("color=always"))&&(s=!0),"FORCE_COLOR"in o&&(s=0===o.FORCE_COLOR.length||0!==parseInt(o.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(154);var i;!function(e){e.WARNING="Warning",e.DEPRECATION="DeprecationWarning"}(i=t.WarningTypes||(t.WarningTypes={})),t.warn=function(e){e.warned||(e.warned=!0,n.satisfies(process.version,">=8")?process.emitWarning(e.message,e):process.emitWarning(e.message,e.type))},t.PROBLEMATIC_CREDENTIALS_WARNING={code:"google-auth-library:00001",type:i.WARNING,message:["Your application has authenticated using end user credentials from Google","Cloud SDK. We recommend that most server applications use service accounts","instead. If your application continues to use end user credentials from",'Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error.',"For more information about service accounts, see","https://cloud.google.com/docs/authentication/."].join(" ")},t.DEFAULT_PROJECT_ID_DEPRECATED={code:"google-auth-library:DEP002",type:i.DEPRECATION,message:["The `getDefaultProjectId` method has been deprecated, and will be removed","in the 3.0 release of google-auth-library. Please use the `getProjectId`","method instead."].join(" ")},t.COMPUTE_CREATE_SCOPED_DEPRECATED={code:"google-auth-library:DEP003",type:i.DEPRECATION,message:["The `createScopedRequired` method on the `Compute` class has been deprecated,","and will be removed in the 3.0 release of google-auth-library."].join(" ")},t.JWT_CREATE_SCOPED_DEPRECATED={code:"google-auth-library:DEP004",type:i.DEPRECATION,message:["The `createScopedRequired` method on the `JWT` class has been deprecated,","and will be removed in the 3.0 release of google-auth-library."].join(" ")},t.IAM_CREATE_SCOPED_DEPRECATED={code:"google-auth-library:DEP005",type:i.DEPRECATION,message:["The `createScopedRequired` method on the `IAM` class has been deprecated,","and will be removed in the 3.0 release of google-auth-library."].join(" ")},t.JWT_ACCESS_CREATE_SCOPED_DEPRECATED={code:"google-auth-library:DEP006",type:i.DEPRECATION,message:["The `createScopedRequired` method on the `JWTAccess` class has been deprecated,","and will be removed in the 3.0 release of google-auth-library."].join(" ")},t.REFRESH_ACCESS_TOKEN_DEPRECATED={code:"google-auth-library:DEP007",type:i.DEPRECATION,message:["The `refreshAccessToken` method has been deprecated, and will be removed","in the 3.0 release of google-auth-library. Please use the `getRequestHeaders`","method instead."].join(" ")},t.OAUTH_GET_REQUEST_METADATA_DEPRECATED={code:"google-auth-library:DEP004",type:i.DEPRECATION,message:["The `getRequestMetadata` method on the `OAuth2` class has been deprecated,","and will be removed in the 3.0 release of google-auth-library. Please use","the `getRequestHeaders` method instead."].join(" ")},t.IAM_GET_REQUEST_METADATA_DEPRECATED={code:"google-auth-library:DEP005",type:i.DEPRECATION,message:["The `getRequestMetadata` method on the `IAM` class has been deprecated,","and will be removed in the 3.0 release of google-auth-library. Please use","the `getRequestHeaders` method instead."].join(" ")},t.JWT_ACCESS_GET_REQUEST_METADATA_DEPRECATED={code:"google-auth-library:DEP006",type:i.DEPRECATION,message:["The `getRequestMetadata` method on the `JWTAccess` class has been deprecated,","and will be removed in the 3.0 release of google-auth-library. Please use","the `getRequestHeaders` method instead."].join(" ")}},function(e,t,r){var n=r(3);r(6);var i=e.exports=n.pem=n.pem||{};function o(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var o=0,s=-1;for(i=0;i<t.length;++i,++o)if(o>65&&-1!==s){var a=t[s];","===a?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+a+t.substr(s+1),o=i-s-1,s=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(s=i);return t}function s(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var r,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=o(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=o(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),i+=o(r)),e.headers)for(var s=0;s<e.headers.length;++s)i+=o(e.headers[s]);return e.procType&&(i+="\r\n"),i+=n.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n"},i.decode=function(e){for(var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,o=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;t=i.exec(e);){var c={type:t[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(c),t[2]){for(var u=t[2].split(a),l=0;t&&l<u.length;){for(var h=u[l].replace(/\s+$/,""),p=l+1;p<u.length;++p){var f=u[p];if(!/\s/.test(f[0]))break;h+=f,l=p}if(t=h.match(o)){for(var d={name:t[1],values:[]},g=t[2].split(","),m=0;m<g.length;++m)d.values.push(s(g[m]));if(c.procType)if(c.contentDomain||"Content-Domain"!==d.name)if(c.dekInfo||"DEK-Info"!==d.name)c.headers.push(d);else{if(0===d.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:g[0],parameters:g[1]||null}}else c.contentDomain=g[0]||"";else{if("Proc-Type"!==d.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==d.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:g[0],type:g[1]}}}++l}if("ENCRYPTED"===c.procType&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},function(e,t,r){"use strict";(function(t){
/**
 * @license
 * Copyright 2016 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
var n,i=r(408),o=r(7),s=i.find(o.resolve(o.join(t,"../package.json")));try{n=r(453)(s)}catch(e){let t,n=r(8),i=o.dirname(o.dirname(s)),a=o.basename(o.dirname(s));try{t=n.readdirSync(i)}catch(t){let r=`The gRPC binary module was not installed. This may be fixed by running "npm rebuild"\nOriginal error: ${e.message}`,n=new Error(r);throw n.code=e.code,n}if(-1===t.indexOf(a)){let r=`Failed to load gRPC binary module because it was not installed for the current system\nExpected directory: ${a}\nFound: [${t.join(", ")}]\nThis problem can often be fixed by running "npm rebuild" on the current system\nOriginal error: ${e.message}`,n=new Error(r);throw n.code=e.code,n}throw e}e.exports=n}).call(this,"/")},function(e,t,r){try{var n=r(4);if("function"!=typeof n.inherits)throw"";e.exports=n.inherits}catch(t){e.exports=r(417)}},function(e,t,r){"use strict";var n=r(124),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=h;var o=r(104);o.inherits=r(71);var s=r(263),a=r(266);o.inherits(h,s);for(var c=i(a.prototype),u=0;u<c.length;u++){var l=c[u];h.prototype[l]||(h.prototype[l]=a.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},function(e,t){
/**
 * @license
 * Copyright 2017 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
t.status={OK:0,CANCELLED:1,UNKNOWN:2,INVALID_ARGUMENT:3,DEADLINE_EXCEEDED:4,NOT_FOUND:5,ALREADY_EXISTS:6,PERMISSION_DENIED:7,RESOURCE_EXHAUSTED:8,FAILED_PRECONDITION:9,ABORTED:10,OUT_OF_RANGE:11,UNIMPLEMENTED:12,INTERNAL:13,UNAVAILABLE:14,DATA_LOSS:15,UNAUTHENTICATED:16},t.propagate={DEADLINE:1,CENSUS_STATS_CONTEXT:2,CENSUS_TRACING_CONTEXT:4,CANCELLATION:8,DEFAULTS:65535};t.callError={OK:0,ERROR:1,NOT_ON_SERVER:2,NOT_ON_CLIENT:3,ALREADY_INVOKED:5,NOT_INVOKED:6,ALREADY_FINISHED:7,TOO_MANY_OPERATIONS:8,INVALID_FLAGS:9,INVALID_METADATA:10,INVALID_MESSAGE:11,NOT_SERVER_COMPLETION_QUEUE:12,BATCH_TOO_BIG:13,PAYLOAD_TYPE_MISMATCH:14},t.writeFlags={BUFFER_HINT:1,NO_COMPRESS:2},t.logVerbosity={DEBUG:0,INFO:1,ERROR:2},t.methodTypes={UNARY:0,CLIENT_STREAMING:1,SERVER_STREAMING:2,BIDI_STREAMING:3},t.connectivityState={IDLE:0,CONNECTING:1,READY:2,TRANSIENT_FAILURE:3,SHUTDOWN:4}},function(e,t,r){var n=r(2);r(32),r(5),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,i=null,o={start:function(o,s){if(null!==o)if("string"==typeof o){if(!((o=o.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+o+'"');t=n.md.algorithms[o].create()}else t=o;if(null===s)s=e;else{if("string"==typeof s)s=n.util.createBuffer(s);else if(n.util.isArray(s)){var a=s;s=n.util.createBuffer();for(var c=0;c<a.length;++c)s.putByte(a[c])}var u=s.length();u>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),u=s.length();for(c=0;c<u;++c){a=s.at(c);r.putByte(54^a),i.putByte(92^a)}if(u<t.blockLength)for(a=t.blockLength-u,c=0;c<a;++c)r.putByte(54),i.putByte(92);e=s,r=r.bytes(),i=i.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return o.digest=o.getMac,o}},function(e,t,r){var n=r(2);r(32),r(5);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){s||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),s=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var c=o.length;i.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=c[1],c[1]=c[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(o),a(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var c,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(c=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(l>>>0),l=c>>>0;s.putInt32(l);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};a(p,r,s);var f=n.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f},i};var o=null,s=!1;function a(e,t,r){for(var n,i,o,s,a,c,u,l=r.length();l>=64;){for(i=e.h0,o=e.h1,s=e.h2,a=e.h3,c=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,n=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o&s|a&(o^s))+c+2400959708+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+3395469782+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+s|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,l-=64}}},function(e,t,r){var n=r(301),i=r(305);t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512"],t.sign=n.sign,t.verify=i.verify,t.decode=i.decode,t.isValid=i.isValid,t.createSign=function(e){return new n(e)},t.createVerify=function(e){return new i(e)}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(15),i=r(141),o=r(59),s=r(116),a=r(27),c=r(78),u=r(54);t.DocumentSnapshotBuilder=class{build(){return n(void 0!==this.fieldsProto==(void 0!==this.createTime),"Create time should be set iff document exists."),n(void 0!==this.fieldsProto==(void 0!==this.updateTime),"Update time should be set iff document exists."),this.fieldsProto?new h(this.ref,this.fieldsProto,this.readTime,this.createTime,this.updateTime):new l(this.ref,void 0,this.readTime)}};class l{constructor(e,t,r,n,i){this._ref=e,this._fieldsProto=t,this._serializer=e.firestore._serializer,this._validator=e.firestore._validator,this._readTime=r,this._createTime=n,this._updateTime=i}static fromObject(e,t){const r=e.firestore._serializer;return new l(e,r.encodeFields(t))}static fromUpdateMap(e,t){const r=e.firestore._serializer;const i={};return t.forEach((e,t)=>{const a=t.toArray();!function e(t,i,a,c){const u=a[c],l=c===a.length-1;if(void 0===t[u]){if(l){if(i instanceof s.FieldTransform)return o.empty(t)?null:t;const e=r.encodeValue(i);return e&&(t[u]=e),t}{const r={mapValue:{fields:{}}},n=e(r.mapValue.fields,i,a,c+1);return n?(r.mapValue.fields=n,t[u]=r,t):o.empty(t)?null:t}}return n(!l,"Can't merge current value into a nested object"),t[u].mapValue.fields=e(t[u].mapValue.fields,i,a,c+1),t}(i,e,a,0)}),new l(e,i)}get exists(){return void 0!==this._fieldsProto}get ref(){return this._ref}get id(){return this._ref.id}get createTime(){return this._createTime}get updateTime(){return this._updateTime}get readTime(){if(void 0===this._readTime)throw new Error("Called 'readTime' on a local document");return this._readTime}data(){const e=this._fieldsProto;if(void 0===e)return;const t={};for(const r in e)e.hasOwnProperty(r)&&(t[r]=this._serializer.decodeValue(e[r]));return t}get(e){this._validator.isFieldPath("field",e);const t=this.protoField(e);if(void 0!==t)return this._serializer.decodeValue(t)}protoField(e){let t=this._fieldsProto;if(void 0===t)return;const r=a.FieldPath.fromArgument(e).toArray();for(;r.length>1;){if(!(t=t[r.shift()])||!t.mapValue)return;t=t.mapValue.fields}return t[r[0]]}get isEmpty(){return o.undefined(this._fieldsProto)||o.empty(this._fieldsProto)}toProto(){return{update:{name:this._ref.formattedName,fields:this._fieldsProto}}}isEqual(e){return this===e||e instanceof l&&this._ref.isEqual(e._ref)&&i(this._fieldsProto,e._fieldsProto,{strict:!0})}}t.DocumentSnapshot=l;class h extends l{constructor(e,t,r,n,i){super(e,t,r,n,i)}get createTime(){return super.createTime}get updateTime(){return super.updateTime}data(){const e=super.data();if(!e)throw new Error("The data in a QueryDocumentSnapshot should always exist.");return e}}t.QueryDocumentSnapshot=h;class p{constructor(e){this._sortedPaths=e,this._sortedPaths.sort((e,t)=>e.compareTo(t))}static fromUpdateMap(e){const t=[];return e.forEach((e,r)=>{e instanceof s.FieldTransform&&!e.includeInDocumentMask||t.push(a.FieldPath.fromArgument(r))}),new p(t)}static fromFieldMask(e){const t=[];for(const r of e)t.push(a.FieldPath.fromArgument(r));return new p(t)}static fromObject(e){const t=[];return function e(r,n){let i=!0;for(const o in r)if(r.hasOwnProperty(o)){i=!1;const u=new a.FieldPath(o),l=n?n.append(u):u,h=r[o];h instanceof s.FieldTransform?h.includeInDocumentMask&&t.push(l):c.isPlainObject(h)?e(h,l):t.push(l)}n&&i&&t.push(n)}(e),new p(t)}get isEmpty(){return 0===this._sortedPaths.length}static removeFromSortedArray(e,t){for(let r=0;r<e.length;){let n=!1;for(const i of t)if(e[r].isEqual(i)){e.splice(r,1),n=!0;break}n||++r}}removeFields(e){p.removeFromSortedArray(this._sortedPaths,e)}contains(e){for(const t of this._sortedPaths){const r=t.compareTo(e);if(0===r)return!0;if(r>0)return!1}return!1}applyTo(e){
/*!
         * Applies this DocumentMask to 'data' and computes the list of field paths
         * that were specified in the mask but are not present in 'data'.
         */
const t=(e=>{const t=this._sortedPaths.slice(0),r=(e,n)=>{let i=null;return Object.keys(e).forEach(s=>{const c=n?n.append(s):new a.FieldPath(s);if(this.contains(c))p.removeFromSortedArray(t,[c]),(i=i||{})[s]=e[s];else if(o.object(e[s])){const t=r(e[s],c);t&&((i=i||{})[s]=t)}}),i};return{filteredData:r(e)||{},remainingPaths:t}})(e);if(0!==t.remainingPaths.length)throw new Error(`Input data is missing for field "${t.remainingPaths[0].toString()}".`);return t.filteredData}toProto(){if(this.isEmpty)return{};const e=[];for(const t of this._sortedPaths)e.push(t.formattedName);return{fieldPaths:e}}}t.DocumentMask=p;class f{constructor(e,t){this._ref=e,this._validator=e.firestore._validator,this._transforms=t}static fromObject(e,t){const r=new Map;for(const e in t)t.hasOwnProperty(e)&&r.set(new a.FieldPath(e),t[e]);return f.fromUpdateMap(e,r)}static fromUpdateMap(e,t){const r=new Map;return t.forEach((e,t)=>{!function e(t,n,i){if(t instanceof s.FieldTransform&&t.includeInDocumentTransform){if(!i)throw new Error(`${t.methodName}() is not supported inside of array values.`);r.set(n,t)}else if(o.array(t))for(let r=0;r<t.length;++r)e(t[r],n.append(String(r)),!1);else if(c.isPlainObject(t))for(const r in t)t.hasOwnProperty(r)&&e(t[r],n.append(new a.FieldPath(r)),i)}(e,a.FieldPath.fromArgument(t),!0)}),new f(e,r)}get isEmpty(){return 0===this._transforms.size}get fields(){return Array.from(this._transforms.keys())}validate(){this._transforms.forEach(e=>e.validate(this._validator))}toProto(e){if(this.isEmpty)return null;const t=[];return this._transforms.forEach((r,n)=>{t.push(r.toProto(e,n))}),{transform:{document:this._ref.formattedName,fieldTransforms:t}}}}t.DocumentTransform=f;t.Precondition=
/*!
 * A Firestore Precondition encapsulates options for database writes.
 *
 * @private
 * @class
 */
class{constructor(e){void 0!==e&&(this._exists=e.exists,this._lastUpdateTime=e.lastUpdateTime)}toProto(){if(this.isEmpty)return null;const e={};return void 0!==this._lastUpdateTime?e.updateTime=this._lastUpdateTime.toProto().timestampValue:e.exists=this._exists,e}get isEmpty(){return void 0===this._exists&&!this._lastUpdateTime}},t.validatePrecondition=function(e,t){if(!o.object(e))throw new Error("Input is not an object.");let r=0;if(void 0!==e.exists){if(++r,!t)throw new Error('"exists" is not an allowed condition.');if(!o.boolean(e.exists))throw new Error('"exists" is not a boolean.')}if(void 0!==e.lastUpdateTime&&(++r,!(e.lastUpdateTime instanceof u.Timestamp)))throw new Error('"lastUpdateTime" is not a Firestore Timestamp.');if(r>1)throw new Error("Input contains more than one condition.");return!0},t.validateSetOptions=function(e){if(!o.object(e))throw new Error("Input is not an object.");if(void 0!==e.merge&&!o.boolean(e.merge))throw new Error('"merge" is not a boolean.');if(void 0!==e.mergeFields){if(!o.array(e.mergeFields))throw new Error('"mergeFields" is not an array.');for(let t=0;t<e.mergeFields.length;++t)try{a.FieldPath.validateFieldPath(e.mergeFields[t])}catch(e){throw new Error(`Element at index ${t} is not a valid FieldPath. ${e.message}`)}}if(void 0!==e.merge&&void 0!==e.mergeFields)throw new Error('You cannot specify both "merge" and "mergeFields".');return!0}},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(59),i=r(54),o=r(116),s=r(26),a=r(27),c=r(140),u=r(142);function l(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}t.Serializer=class{constructor(e){this.createReference=(t=>e.doc(t)),this.timestampsInSnapshots=!!e._settings.timestampsInSnapshots}encodeFields(e){const t={};for(const r in e)if(e.hasOwnProperty(r)){const n=this.encodeValue(e[r]);n&&(t[r]=n)}return t}encodeValue(e){if(e instanceof o.FieldTransform)return null;if(n.string(e))return{stringValue:e};if("boolean"==typeof e)return{booleanValue:e};if("number"==typeof e&&n.integer(e))return{integerValue:e};if(n.number(e))return{doubleValue:e};if(n.date(e)){const t=i.Timestamp.fromDate(e);return{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}if(null===e)return{nullValue:"NULL_VALUE"};if(e instanceof Buffer||e instanceof Uint8Array)return{bytesValue:e};if("object"==typeof e&&"toProto"in e&&"function"==typeof e.toProto)return e.toProto();if(e instanceof Array){const t={arrayValue:{}};if(e.length>0){t.arrayValue.values=[];for(let r=0;r<e.length;++r){const n=this.encodeValue(e[r]);n&&t.arrayValue.values.push(n)}}return t}if("object"==typeof e&&l(e)){const t={mapValue:{}};return!n.empty(e)&&(t.mapValue.fields=this.encodeFields(e),n.empty(t.mapValue.fields))?null:t}throw s.customObjectError(e)}decodeValue(e){switch(c.detectValueType(e)){case"stringValue":return e.stringValue;case"booleanValue":return e.booleanValue;case"integerValue":return Number(e.integerValue);case"doubleValue":return Number(e.doubleValue);case"timestampValue":{const t=i.Timestamp.fromProto(e.timestampValue);return this.timestampsInSnapshots?t:t.toDate()}case"referenceValue":{const t=a.ResourcePath.fromSlashSeparatedString(e.referenceValue);return this.createReference(t.relativeName)}case"arrayValue":{const t=[];if(n.array(e.arrayValue.values))for(const r of e.arrayValue.values)t.push(this.decodeValue(r));return t}case"nullValue":return null;case"mapValue":{const t={},r=e.mapValue.fields;for(const e in r)r.hasOwnProperty(e)&&(t[e]=this.decodeValue(r[e]));return t}case"geoPointValue":return u.GeoPoint.fromProto(e.geoPointValue);case"bytesValue":return e.bytesValue;default:throw new Error("Cannot decode type from Firestore Value: "+JSON.stringify(e))}}},t.isPlainObject=l},function(e,t,r){"use strict";e.exports=l;var n=r(63);((l.prototype=Object.create(n.prototype)).constructor=l).className="Namespace";var i,o,s,a=r(55),c=r(13);function u(e,t){if(e&&e.length){for(var r={},n=0;n<e.length;++n)r[e[n].name]=e[n].toJSON(t);return r}}function l(e,t){n.call(this,e,t),this.nested=void 0,this._nestedArray=null}function h(e){return e._nestedArray=null,e}l.fromJSON=function(e,t){return new l(e,t.options).addJSON(t.nested)},l.arrayToJSON=u,l.isReservedId=function(e,t){if(e)for(var r=0;r<e.length;++r)if("string"!=typeof e[r]&&e[r][0]<=t&&e[r][1]>=t)return!0;return!1},l.isReservedName=function(e,t){if(e)for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1},Object.defineProperty(l.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=c.toArray(this.nested))}}),l.prototype.toJSON=function(e){return c.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},l.prototype.addJSON=function(e){if(e)for(var t,r=Object.keys(e),n=0;n<r.length;++n)t=e[r[n]],this.add((void 0!==t.fields?i.fromJSON:void 0!==t.values?s.fromJSON:void 0!==t.methods?o.fromJSON:void 0!==t.id?a.fromJSON:l.fromJSON)(r[n],t));return this},l.prototype.get=function(e){return this.nested&&this.nested[e]||null},l.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof s)return this.nested[e].values;throw Error("no such enum: "+e)},l.prototype.add=function(e){if(!(e instanceof a&&void 0!==e.extend||e instanceof i||e instanceof s||e instanceof o||e instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof l&&e instanceof l)||t instanceof i||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var r=t.nestedArray,n=0;n<r.length;++n)e.add(r[n]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),h(this)},l.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),h(this)},l.prototype.define=function(e,t){if(c.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var r=this;e.length>0;){var n=e.shift();if(r.nested&&r.nested[n]){if(!((r=r.nested[n])instanceof l))throw Error("path conflicts with non-namespace objects")}else r.add(r=new l(n))}return t&&r.addJSON(t),r},l.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof l?e[t++].resolveAll():e[t++].resolve();return this.resolve()},l.prototype.lookup=function(e,t,r){if("boolean"==typeof t?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),c.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(1===e.length){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof l&&(n=n.lookup(e.slice(1),t,!0)))return n}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof l&&(n=this._nestedArray[i].lookup(e,t,!0)))return n;return null===this.parent||r?null:this.parent.lookup(e,t)},l.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such type: "+e);return t},l.prototype.lookupEnum=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},l.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,s]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},l.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},l._configure=function(e,t,r){i=e,o=t,s=r}},function(e,t,r){"use strict";var n=r(1),i=r(41),o=r(82),s=r(20);function a(e){var t=new o(e),r=i(o.prototype.request,t);return n.extend(r,o.prototype,t),n.extend(r,t),r}var c=a(s);c.Axios=o,c.create=function(e){return a(n.merge(s,e))},c.Cancel=r(48),c.CancelToken=r(100),c.isCancel=r(47),c.all=function(e){return Promise.all(e)},c.spread=r(101),e.exports=c,e.exports.default=c},function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,r){"use strict";var n=r(20),i=r(1),o=r(95),s=r(96);function a(e){this.defaults=e,this.interceptors={request:new o,response:new o}}a.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(n,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[s,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},i.forEach(["delete","get","head","options"],function(e){a.prototype[e]=function(t,r){return this.request(i.merge(r||{},{method:e,url:t}))}}),i.forEach(["post","put","patch"],function(e){a.prototype[e]=function(t,r,n){return this.request(i.merge(n||{},{method:e,url:t,data:r}))}}),e.exports=a},function(e,t,r){"use strict";var n=r(1);e.exports=function(e,t){n.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})}},function(e,t,r){"use strict";var n=r(1),i=r(42),o=r(44),s=r(85),a=r(86),c=r(21),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(87);e.exports=function(e){return new Promise(function(t,l){var h=e.data,p=e.headers;n.isFormData(h)&&delete p["Content-Type"];var f=new XMLHttpRequest,d="onreadystatechange",g=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in f||a(e.url)||(f=new window.XDomainRequest,d="onload",g=!0,f.onprogress=function(){},f.ontimeout=function(){}),e.auth){var m=e.auth.username||"",y=e.auth.password||"";p.Authorization="Basic "+u(m+":"+y)}if(f.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f[d]=function(){if(f&&(4===f.readyState||g)&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:1223===f.status?204:f.status,statusText:1223===f.status?"No Content":f.statusText,headers:r,config:e,request:f};i(t,l,n),f=null}},f.onerror=function(){l(c("Network Error",e,null,f)),f=null},f.ontimeout=function(){l(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var v=r(88),b=(e.withCredentials||a(e.url))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;b&&(p[e.xsrfHeaderName]=b)}if("setRequestHeader"in f&&n.forEach(p,function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete p[t]:f.setRequestHeader(t,e)}),e.withCredentials&&(f.withCredentials=!0),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){f&&(f.abort(),l(e),f=null)}),void 0===h&&(h=null),f.send(h)})}},function(e,t,r){"use strict";var n=r(1),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,s={};return e?(n.forEach(e.split("\n"),function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([r]):s[t]?s[t]+", "+r:r}}),s):s}},function(e,t,r){"use strict";var n=r(1);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},function(e,t,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(){this.message="String contains an invalid character"}i.prototype=new Error,i.prototype.code=5,i.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,r,o=String(e),s="",a=0,c=n;o.charAt(0|a)||(c="=",a%1);s+=c.charAt(63&t>>8-a%1*8)){if((r=o.charCodeAt(a+=.75))>255)throw new i;t=t<<8|r}return s}},function(e,t,r){"use strict";var n=r(1);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,s){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(i)&&a.push("path="+i),n.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){"undefined"==typeof process||"renderer"===process.type?e.exports=r(90):e.exports=r(92)},function(e,t,r){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(46)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())},function(e,t){var r=1e3,n=60*r,i=60*n,o=24*i,s=365.25*o;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var c,u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?a(c=e,o,"day")||a(c,i,"hour")||a(c,n,"minute")||a(c,r,"second")||c+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){var n=r(66),i=r(4);(t=e.exports=r(46)).init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return process.stderr.write(i.format.apply(i,arguments)+"\n")},t.formatArgs=function(e){var r=this.namespace;if(this.useColors){var n=this.color,i="[3"+(n<8?n:"8;5;"+n),o="  "+i+";1m"+r+" [0m";e[0]=o+e[0].split("\n").join("\n"+o),e.push(i+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+r+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=s,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var o=r(67);o&&o.level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}function s(){return process.env.DEBUG}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map(function(e){return e.trim()}).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)},t.enable(s())},function(e,t,r){"use strict";e.exports=((e,t)=>{t=t||process.argv;const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return-1!==n&&(-1===i||n<i)})},function(e){e.exports={_args:[["axios@0.18.0","D:\\Projects\\webhooks"]],_from:"axios@0.18.0",_id:"axios@0.18.0",_inBundle:!1,_integrity:"sha1-MtU+SFHv3AoRmTts0AB4nXDAUQI=",_location:"/axios",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"axios@0.18.0",name:"axios",escapedName:"axios",rawSpec:"0.18.0",saveSpec:null,fetchSpec:"0.18.0"},_requiredBy:["/","/gcp-metadata","/google-auth-library","/google-auto-auth/gcp-metadata","/google-auto-auth/google-auth-library","/gtoken"],_resolved:"http://registry.npmjs.org/axios/-/axios-0.18.0.tgz",_spec:"0.18.0",_where:"D:\\Projects\\webhooks",author:{name:"Matt Zabriskie"},browser:{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},bugs:{url:"https://github.com/axios/axios/issues"},bundlesize:[{path:"./dist/axios.min.js",threshold:"5kB"}],dependencies:{"follow-redirects":"^1.3.0","is-buffer":"^1.1.5"},description:"Promise based HTTP client for the browser and node.js",devDependencies:{bundlesize:"^0.5.7",coveralls:"^2.11.9","es6-promise":"^4.0.5",grunt:"^1.0.1","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.0.0","grunt-contrib-nodeunit":"^1.0.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^19.0.0","grunt-karma":"^2.0.0","grunt-ts":"^6.0.0-beta.3","grunt-webpack":"^1.0.18","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^1.3.0","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.0.0","karma-firefox-launcher":"^1.0.0","karma-jasmine":"^1.0.2","karma-jasmine-ajax":"^0.1.13","karma-opera-launcher":"^1.0.0","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^1.1.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^1.7.0","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",sinon:"^1.17.4",typescript:"^2.0.3","url-search-params":"^0.6.1",webpack:"^1.13.1","webpack-dev-server":"^1.14.1"},homepage:"https://github.com/axios/axios",keywords:["xhr","http","ajax","promise","node"],license:"MIT",main:"index.js",name:"axios",repository:{type:"git",url:"git+https://github.com/axios/axios.git"},scripts:{build:"NODE_ENV=production grunt build",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",examples:"node ./examples/server.js",postversion:"git push && git push --tags",preversion:"npm test",start:"node ./sandbox/server.js",test:"grunt test && bundlesize",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},typings:"./index.d.ts",version:"0.18.0"}},function(e,t,r){"use strict";var n=r(1);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=i},function(e,t,r){"use strict";var n=r(1),i=r(97),o=r(47),s=r(20),a=r(98),c=r(99);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||s.adapter)(e).then(function(t){return u(e),t.data=i(t.data,t.headers,e.transformResponse),t},function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,r){"use strict";var n=r(1);e.exports=function(e,t,r){return n.forEach(r,function(r){e=r(e,t)}),e}},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";var n=r(48);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new n(e),t(r.reason))})}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i(function(t){e=t}),cancel:e}},e.exports=i},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){var n=r(3);r(38),r(6),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,i=null,o={start:function(o,s){if(null!==o)if("string"==typeof o){if(!((o=o.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+o+'"');t=n.md.algorithms[o].create()}else t=o;if(null===s)s=e;else{if("string"==typeof s)s=n.util.createBuffer(s);else if(n.util.isArray(s)){var a=s;s=n.util.createBuffer();for(var c=0;c<a.length;++c)s.putByte(a[c])}var u=s.length();u>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),u=s.length();for(c=0;c<u;++c){a=s.at(c);r.putByte(54^a),i.putByte(92^a)}if(u<t.blockLength)for(a=t.blockLength-u,c=0;c<a;++c)r.putByte(54),i.putByte(92);e=s,r=r.bytes(),i=i.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return o.digest=o.getMac,o}},function(e,t,r){var n=r(3);r(38),r(6);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){s||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),s=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var c=o.length;i.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=c[1],c[1]=c[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(o),a(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var c,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(c=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(l>>>0),l=c>>>0;s.putInt32(l);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};a(p,r,s);var f=n.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f},i};var o=null,s=!1;function a(e,t,r){for(var n,i,o,s,a,c,u,l=r.length();l>=64;){for(i=e.h0,o=e.h1,s=e.h2,a=e.h3,c=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,n=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o&s|a&(o^s))+c+2400959708+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+3395469782+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+s|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,l-=64}}},function(e,t){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=Buffer.isBuffer},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2015 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(16),i=r(70);function o(){this._internal_repr={}}function s(e){if(e=e.toLowerCase(),i.metadataKeyIsLegal(e))return e;throw new Error('Metadata key"'+e+'" contains illegal characters')}function a(e,t){if(i.metadataKeyIsBinary(e)){if(!(t instanceof Buffer))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(!n.isString(t))throw new Error("keys that don't end with '-bin' must have String values");if(!i.metadataNonbinValueIsLegal(t))throw new Error('Metadata string value "'+t+'" contains illegal characters')}}o.prototype.set=function(e,t){a(e=s(e),t),this._internal_repr[e]=[t]},o.prototype.add=function(e,t){a(e=s(e),t),this._internal_repr[e]||(this._internal_repr[e]=[]),this._internal_repr[e].push(t)},o.prototype.remove=function(e){e=s(e),Object.prototype.hasOwnProperty.call(this._internal_repr,e)&&delete this._internal_repr[e]},o.prototype.get=function(e){return e=s(e),Object.prototype.hasOwnProperty.call(this._internal_repr,e)?this._internal_repr[e]:[]},o.prototype.getMap=function(){var e={};return n.forOwn(this._internal_repr,function(t,r){t.length>0&&(e[r]=t[0])}),e},o.prototype.clone=function(){var e=new o;return n.forOwn(this._internal_repr,function(t,r){e._internal_repr[r]=n.clone(t)}),e},o.prototype._getCoreRepresentation=function(){return this._internal_repr},o._fromCoreRepresentation=function(e){var t=new o;return e&&n.forOwn(e,function(e,r){t._internal_repr[r]=n.clone(e)}),t},e.exports=o},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2015 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(16),i=r(73);t.wrapIgnoreNull=function(e){return e?function(t){return null==t?null:e(t)}:n.identity},t.logger=console,t.logVerbosity=0,t.log=function(e,r){e>=t.logVerbosity&&t.logger.error(r)},t.defaultGrpcOptions={convertFieldsToCamelCase:!1,binaryAsBase64:!1,longsAsStrings:!0,enumsAsStrings:!0,deprecatedArgumentOrder:!1},t.createStatusError=function(e){let t=n.invert(i.status)[e.code],r=`${e.code} ${t}: ${e.details}`,o=new Error(r);return o.code=e.code,o.metadata=e.metadata,o.details=e.details,o},t.getMethodType=function(e){return e.requestStream?e.responseStream?i.methodTypes.BIDI_STREAMING:i.methodTypes.CLIENT_STREAMING:e.responseStream?i.methodTypes.SERVER_STREAMING:i.methodTypes.UNARY}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.callback=e,this.completed=!1}cancel(){this.completed||(this.completed=!0,this.cancelFunc?this.cancelFunc():this.callback(new Error("cancelled")))}call(e,t){if(this.completed)return;const r=e(t,(...e)=>{this.completed=!0,e.unshift(this.callback),setImmediate.apply(null,e)});this.cancelFunc=(()=>{r.cancel()})}}t.Canceller=n;class i extends n{constructor(e){super(),this.promise=new e((e,t)=>{this.callback=((r,n,i,o)=>{r?t(r):e([n,i,o])})}),this.promise.cancel=(()=>{this.cancel()})}}function o(e,t,r,n){return function(i,o){const s=new Date,a=r.options||{};a.deadline=new Date(s.getTime()+t);const c=r.metadataBuilder?r.metadataBuilder(n,r.headers||{}):null;return e(i,c,a,o)}}t.PromiseCanceller=i;class s{init(e,t){return t?new n(t):new i(e.promise)}wrap(e){return e}call(e,t,r,n){n.call(e,t)}fail(e,t){e.callback(t)}result(e){if(e.promise)return e.promise}}t.NormalApiCaller=s,t.createApiCall=function(e,t,r){const n=r?r.apiCaller(t):new s;return function(r,i,s){const a=t.merge(i),c=n.init(a,s);return e.then(e=>{e=n.wrap(e);const t=a.retry;return t&&t.retryCodes&&t.retryCodes.length>0?function(e,t,r){const n=t.backoffSettings.retryDelayMultiplier,i=t.backoffSettings.maxRetryDelayMillis,s=t.backoffSettings.rpcTimeoutMultiplier,a=t.backoffSettings.maxRpcTimeoutMillis;let c=t.backoffSettings.initialRetryDelayMillis,u=t.backoffSettings.initialRpcTimeoutMillis;return function(l,h){let p,f,d,g=new Date;t.backoffSettings.totalTimeoutMillis&&(d=g.getTime()+t.backoffSettings.totalTimeoutMillis);let m=0;const y=t.backoffSettings.maxRetries;return y&&d?h(new Error("Cannot set both totalTimeoutMillis and maxRetries in backoffSettings.")):function v(){if(f=null,d&&g.getTime()>=d)return void h(new Error("Retry total timeout exceeded before any response was received"));if(m&&m>=y)return void h(new Error("Exceeded maximum number of retries before any response was received"));m++;const b=o(e,u,r);p=b(l,(e,r,o,l)=>{if(e)if(p=null,t.retryCodes.indexOf(e.code)<0)e.note="Exception occurred in retry method that was not classified as transient",h(e);else{const e=Math.random()*c;f=setTimeout(()=>{g=new Date,c=Math.min(c*n,i),u=Math.min(u*s,a,d-g.getTime()),v()},e)}else h(null,r,o,l)})}(),{cancel(){f&&clearTimeout(f),p?p.cancel():h(new Error("cancelled"))}}}}(e,a.retry,a.otherArgs):o(e,a.timeout,a.otherArgs)}).then(e=>{n.call(e,r,a,c)}).catch(e=>{n.fail(c,e)}),n.result(c)}}},function(e,t,r){const n=r(8),i=r(7);function o(e){console.log(`[dotenv][DEBUG] ${e}`)}function s(e,t){const r=Boolean(t&&t.debug),n={};return e.toString().split("\n").forEach(function(e,t){const i=e.match(/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/);if(null!=i){const e=i[1];let t=i[2]||"";const r=t?t.length:0;r>0&&'"'===t.charAt(0)&&'"'===t.charAt(r-1)&&(t=t.replace(/\\n/gm,"\n")),t=t.replace(/(^['"]|['"]$)/g,"").trim(),n[e]=t}else r&&o(`did not match key and value when parsing line ${t+1}: ${e}`)}),n}function a(e){let t=i.resolve(process.cwd(),".env"),r="utf8",a=!1;e&&(null!=e.path&&(t=e.path),null!=e.encoding&&(r=e.encoding),null!=e.debug&&(a=!0));try{const e=s(n.readFileSync(t,{encoding:r}),{debug:a});return Object.keys(e).forEach(function(t){process.env.hasOwnProperty(t)?a&&o(`"${t}" is already defined in \`process.env\` and will not be overwritten`):process.env[t]=e[t]}),{parsed:e}}catch(e){return{error:e}}}e.exports.config=a,e.exports.load=a,e.exports.parse=s},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(8),o=r(29),s=r(7),a=r(10),c=r(50),u=(n=o.platform())&&n.length>=3&&"win"===n.substring(0,3).toLowerCase()?process.env.APPDATA:process.env.HOME&&s.resolve(process.env.HOME,".config"),l=u&&s.resolve(u,"gcloud/application_default_credentials.json");function h(e,t,r,n){var i=t[r]||t[n];void 0!==i&&(e[r]=i)}var p=function(){function e(e){var t;if(h(this,e,"clientId","client_id"),h(this,e,"clientSecret","client_secret"),h(this,e,"refreshToken","refresh_token"),h(this,e,"type","type"),"string"==typeof this.clientId&&this.clientId?"string"==typeof this.clientSecret&&this.clientSecret?"string"==typeof this.refreshToken&&this.refreshToken?"string"==typeof this.type&&this.type||(t='Refresh token must contain a "type" property.'):t='Refresh token must contain a "refresh_token" property.':t='Refresh token must contain a "client_secret" property.':t='Refresh token must contain a "client_id" property.',void 0!==t)throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,t)}return e.fromPath=function(t){var r;try{r=i.readFileSync(t,"utf8")}catch(e){return null}try{return new e(JSON.parse(r))}catch(e){throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,"Failed to parse refresh token file: "+e)}},e}();t.RefreshToken=p;var f=function(){function e(e){if("object"!=typeof e||null===e)throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,"Certificate object must be an object.");var t;if(h(this,e,"projectId","project_id"),h(this,e,"privateKey","private_key"),h(this,e,"clientEmail","client_email"),"string"==typeof this.privateKey&&this.privateKey?"string"==typeof this.clientEmail&&this.clientEmail||(t='Certificate object must contain a string "client_email" property.'):t='Certificate object must contain a string "private_key" property.',void 0!==t)throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,t);var n=r(291);try{n.pki.privateKeyFromPem(this.privateKey)}catch(e){throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,"Failed to parse private key: "+e)}}return e.fromPath=function(t){if("string"!=typeof t)throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,"Failed to parse certificate key file: TypeError: path must be a string");try{return new e(JSON.parse(i.readFileSync(t,"utf8")))}catch(e){throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,"Failed to parse certificate key file: "+e)}},e}();function d(e,t){return e.send(t).then(function(e){var t=e.data;if(t.error){var r="Error fetching access token: "+t.error;throw t.error_description&&(r+=" ("+t.error_description+")"),new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,r)}if(t.access_token&&t.expires_in)return t;throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,"Unexpected response while fetching access token: "+JSON.stringify(t))}).catch(function(e){throw new a.FirebaseAppError(a.AppErrorCodes.INVALID_CREDENTIAL,"Failed to parse access token response: "+e.toString())})}t.Certificate=f;var g=function(){function e(e){this.certificate="string"==typeof e?f.fromPath(e):new f(e),this.httpClient=new c.HttpClient}return e.prototype.getAccessToken=function(){var e={method:"POST",url:"https://accounts.google.com/o/oauth2/token",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion="+this.createAuthJwt_()};return d(this.httpClient,e)},e.prototype.getCertificate=function(){return this.certificate},e.prototype.createAuthJwt_=function(){var e={scope:["https://www.googleapis.com/auth/cloud-platform","https://www.googleapis.com/auth/firebase.database","https://www.googleapis.com/auth/firebase.messaging","https://www.googleapis.com/auth/identitytoolkit","https://www.googleapis.com/auth/userinfo.email"].join(" ")};return r(187).sign(e,this.certificate.privateKey,{audience:"https://accounts.google.com/o/oauth2/token",expiresIn:3600,issuer:this.certificate.clientEmail,algorithm:"RS256"})},e}();t.CertCredential=g;var m=function(){function e(e){this.refreshToken="string"==typeof e?p.fromPath(e):new p(e),this.httpClient=new c.HttpClient}return e.prototype.getAccessToken=function(){var e={method:"POST",url:"https://www.googleapis.com/oauth2/v4/token",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"client_id="+this.refreshToken.clientId+"&client_secret="+this.refreshToken.clientSecret+"&refresh_token="+this.refreshToken.refreshToken+"&grant_type=refresh_token"};return d(this.httpClient,e)},e.prototype.getCertificate=function(){return null},e}();t.RefreshTokenCredential=m;var y=function(){function e(){this.httpClient=new c.HttpClient}return e.prototype.getAccessToken=function(){var e={method:"GET",url:"http://metadata.google.internal/computeMetadata/v1beta1/instance/service-accounts/default/token"};return d(this.httpClient,e)},e.prototype.getCertificate=function(){return null},e}();t.MetadataServiceCredential=y;var v=function(){function e(){if(process.env.GOOGLE_APPLICATION_CREDENTIALS){var e=f.fromPath(process.env.GOOGLE_APPLICATION_CREDENTIALS);this.credential_=new g(e)}else{var t=p.fromPath(l);this.credential_=t?new m(t):new y}}return e.prototype.getAccessToken=function(){return this.credential_.getAccessToken()},e.prototype.getCertificate=function(){return this.credential_.getCertificate()},e.prototype.getCredential=function(){return this.credential_},e}();t.ApplicationDefaultCredential=v},function(e,t,r){var n=r(2);function i(e,t){n.cipher.registerAlgorithm(e,function(){return new n.des.Algorithm(e,t)})}r(131),r(172),r(5),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return f(r._keys,e,t,!1)},decrypt:function(e,t){return f(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=e.length()>8?3:1,y=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,_=0;_<m;_++){var E=e.getInt32(),C=e.getInt32();E^=(t=252645135&(E>>>4^C))<<4,E^=t=65535&((C^=t)>>>-16^E),E^=(t=858993459&(E>>>2^(C^=t<<-16)))<<2,E^=t=65535&((C^=t)>>>-16^E),E^=(t=1431655765&(E>>>1^(C^=t<<-16)))<<1,E^=t=16711935&((C^=t)>>>8^E),t=(E^=(t=1431655765&(E>>>1^(C^=t<<8)))<<1)<<8|(C^=t)>>>20&240,E=C<<24|C<<8&16711680|C>>>8&65280|C>>>24&240,C=t;for(var w=0;w<v.length;++w){v[w]?(E=E<<2|E>>>26,C=C<<2|C>>>26):(E=E<<1|E>>>27,C=C<<1|C>>>27);var S=r[(E&=-15)>>>28]|n[E>>>24&15]|i[E>>>20&15]|o[E>>>16&15]|s[E>>>12&15]|a[E>>>8&15]|c[E>>>4&15],T=u[(C&=-15)>>>28]|l[C>>>24&15]|h[C>>>20&15]|p[C>>>16&15]|f[C>>>12&15]|d[C>>>8&15]|g[C>>>4&15];t=65535&(T>>>16^S),y[b++]=S^t,y[b++]=T^t<<16}}return y}(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var o=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function f(e,t,r,n){var i,f,d=32===e.length?3:9;i=3===d?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var g=t[0],m=t[1];g^=(f=252645135&(g>>>4^m))<<4,g^=(f=65535&(g>>>16^(m^=f)))<<16,g^=f=858993459&((m^=f)>>>2^g),g^=f=16711935&((m^=f<<2)>>>8^g),g=(g^=(f=1431655765&(g>>>1^(m^=f<<8)))<<1)<<1|g>>>31,m=(m^=f)<<1|m>>>31;for(var y=0;y<d;y+=3){for(var v=i[y+1],b=i[y+2],_=i[y];_!=v;_+=b){var E=m^e[_],C=(m>>>4|m<<28)^e[_+1];f=g,g=m,m=f^(s[E>>>24&63]|c[E>>>16&63]|l[E>>>8&63]|p[63&E]|o[C>>>24&63]|a[C>>>16&63]|u[C>>>8&63]|h[63&C])}f=g,g=m,m=f}m=m>>>1|m<<31,m^=f=1431655765&((g=g>>>1|g<<31)>>>1^m),m^=(f=16711935&(m>>>8^(g^=f<<1)))<<8,m^=(f=858993459&(m>>>2^(g^=f)))<<2,m^=f=65535&((g^=f)>>>16^m),m^=f=252645135&((g^=f<<16)>>>4^m),g^=f<<4,r[0]=g,r[1]=m}function d(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var o=null;r instanceof n.util.ByteBuffer&&(o=r,r={}),(r=r||{}).output=o,r.iv=e,i.call(t,r)},t}},function(e,t,r){var n=r(2);if(r(31),r(112),r(53),r(179),r(180),r(18),r(5),void 0===i)var i=n.jsbn.BigInteger;var o=n.asn1;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var s=n.pki,a=[6,4,2,4,2,4,6,2],c={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},l={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},h=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p=function(e){var t;if(!(e.algorithm in s.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=s.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);a.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),a.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var c=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(c),o.toDer(i).getBytes()},f=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var o;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{o=new i(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(o.compareTo(t.n)>=0||!o.gcd(t.n).equals(i.ONE));for(var s=(e=e.multiply(o.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);s.compareTo(a)<0;)s=s.add(t.p);var c=s.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return c=c.multiply(o.modInverse(t.n)).mod(t.n)};function d(e,t,r){var i=n.util.createBuffer(),o=Math.ceil(t.n.bitLength()/8);if(e.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=o-11,s}i.putByte(0),i.putByte(r);var a,c=o-3-e.length;if(0===r||1===r){a=0===r?0:255;for(var u=0;u<c;++u)i.putByte(a)}else for(;c>0;){var l=0,h=n.random.getBytes(c);for(u=0;u<c;++u)0===(a=h.charCodeAt(u))?++l:i.putByte(a);c=l}return i.putByte(0),i.putBytes(e),i}function g(e,t,r,i){var o=Math.ceil(t.n.bitLength()/8),s=n.util.createBuffer(e),a=s.getByte(),c=s.getByte();if(0!==a||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&void 0===i)throw new Error("Encryption block is invalid.");var u=0;if(0===c){u=o-3-i;for(var l=0;l<u;++l)if(0!==s.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(u=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++u}else if(2===c)for(u=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++u}if(0!==s.getByte()||u!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function m(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function y(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function v(e){return"undefined"!=typeof window&&"object"==typeof window.crypto&&"object"==typeof window.crypto.subtle&&"function"==typeof window.crypto.subtle[e]}function b(e){return"undefined"!=typeof window&&"object"==typeof window.msCrypto&&"object"==typeof window.msCrypto.subtle&&"function"==typeof window.msCrypto.subtle[e]}function _(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}s.rsa.encrypt=function(e,t,r){var o,s=r,a=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(s=2===r,o=d(e,t,r)):(o=n.util.createBuffer()).putBytes(e);for(var c=new i(o.toHex(),16),u=f(c,t,s).toString(16),l=n.util.createBuffer(),h=a-Math.ceil(u.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(u)),l.getBytes()},s.rsa.decrypt=function(e,t,r,o){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=s,a}var c=new i(n.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var u=f(c,t,r).toString(16),l=n.util.createBuffer(),h=s-Math.ceil(u.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(u)),!1!==o?g(l.getBytes(),t,r):l.getBytes()},s.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var o,s=(r=r||{}).prng||n.random,a={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(o={algorithm:c,state:0,bits:e,rng:a,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(o.eInt),o},s.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new i(null);r.fromInt(30);for(var n,o=0,c=function(e,t){return e|t},u=+new Date,l=0;null===e.keys&&(t<=0||l<t);){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,p=h-1;0===e.pqState?(e.num=new i(h,e.rng),e.num.testBit(p)||e.num.bitwiseTo(i.ONE.shiftLeft(p),c,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),o=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(y(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(a[o++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:s.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:s.rsa.setPublicKey(e.n,e.e)}}l+=(n=+new Date)-u,u=n}return null!==e.keys},s.rsa.generateKeyPair=function(e,t,r,a){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(a=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(a=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,a=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(a=r,r=void 0):(a=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&a&&e>=256&&e<=16384&&(65537===t||3===t)){if(v("generateKey")&&v("exportKey"))return window.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(e){return window.crypto.subtle.exportKey("pkcs8",e.privateKey)}).then(void 0,function(e){a(e)}).then(function(e){if(e){var t=s.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(e)));a(null,{privateKey:t,publicKey:s.setRsaPublicKey(t.n,t.e)})}});if(b("generateKey")&&b("exportKey")){var c=window.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return c.oncomplete=function(e){var t=e.target.result,r=window.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=s.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(t)));a(null,{privateKey:r,publicKey:s.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){a(e)}},void(c.onerror=function(e){a(e)})}}var u=s.rsa.createKeyPairGenerationState(e,t,r);if(!a)return s.rsa.stepKeyPairGenerationState(u,0),u.keys;!function(e,t,r){"function"==typeof t&&(r=t,t={});var o={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(o.prng=t.prng);function a(){c(e.pBits,function(t,n){return t?r(t):(e.p=n,null!==e.q?u(t,e.q):void c(e.qBits,u))})}function c(e,t){n.prime.generateProbablePrime(e,o,t)}function u(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var o=e.p;e.p=e.q,e.q=o}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void a();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void c(e.qBits,u);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void a();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void c(e.qBits,u);var l=e.e.modInverse(e.phi);e.keys={privateKey:s.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:s.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}a()}(u,r,a)},s.setRsaPublicKey=s.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,i){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return d(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var o=t.encode(e,r,!0);return s.rsa.encrypt(o,r,!0)},verify:function(e,t,n){"string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){return t=g(t,r,!0),e===o.fromDer(t).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(e,t){return e===(t=g(t,r,!0))}});var i=s.rsa.decrypt(t,r,!0,!1);return n.verify(e,i,r.n.bitLength())}};return r},s.setRsaPrivateKey=s.rsa.setPrivateKey=function(e,t,r,i,o,a,c,u){var l={n:e,e:t,d:r,p:i,q:o,dP:a,dQ:c,qInv:u,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=s.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:g};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,l,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:p},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,l.n.bitLength());return s.rsa.encrypt(n,l,r)}};return l},s.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},s.privateKeyFromAsn1=function(e){var t,r,a,l,h,p,f,d,g={},m=[];if(o.validate(e,c,g,m)&&(e=o.fromDer(n.util.createBuffer(g.privateKey))),g={},m=[],!o.validate(e,u,g,m)){var y=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw y.errors=m,y}return t=n.util.createBuffer(g.privateKeyModulus).toHex(),r=n.util.createBuffer(g.privateKeyPublicExponent).toHex(),a=n.util.createBuffer(g.privateKeyPrivateExponent).toHex(),l=n.util.createBuffer(g.privateKeyPrime1).toHex(),h=n.util.createBuffer(g.privateKeyPrime2).toHex(),p=n.util.createBuffer(g.privateKeyExponent1).toHex(),f=n.util.createBuffer(g.privateKeyExponent2).toHex(),d=n.util.createBuffer(g.privateKeyCoefficient).toHex(),s.setRsaPrivateKey(new i(t,16),new i(r,16),new i(a,16),new i(l,16),new i(h,16),new i(p,16),new i(f,16),new i(d,16))},s.privateKeyToAsn1=s.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.qInv))])},s.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,h,t,r)){var a,c=o.derToOid(t.publicKeyOid);if(c!==s.oids.rsaEncryption)throw(a=new Error("Cannot read public key. Unknown OID.")).oid=c,a;e=t.rsaPublicKey}if(r=[],!o.validate(e,l,t,r))throw(a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,a;var u=n.util.createBuffer(t.publicKeyModulus).toHex(),p=n.util.createBuffer(t.publicKeyExponent).toHex();return s.setRsaPublicKey(new i(u,16),new i(p,16))},s.publicKeyToAsn1=s.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[s.publicKeyToRSAPublicKey(e)])])},s.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.e))])}},function(e,t,r){var n,i=r(2);e.exports=i.jsbn=i.jsbn||{};function o(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function s(){return new o(null)}function a(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var c=16383&this.data[e],u=this.data[e++]>>14,l=a*c+u*s;i=((c=s*c+((16383&l)<<14)+r.data[n]+i)>>28)+(l>>14)+a*u,r.data[n++]=268435455&c}return i}i.jsbn.BigInteger=o,"undefined"==typeof navigator?(o.prototype.am=a,n=28):"Microsoft Internet Explorer"==navigator.appName?(o.prototype.am=function(e,t,r,n,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var c=32767&this.data[e],u=this.data[e++]>>15,l=a*c+u*s;i=((c=s*c+((32767&l)<<15)+r.data[n]+(1073741823&i))>>>30)+(l>>>15)+a*u+(i>>>30),r.data[n++]=1073741823&c}return i},n=30):"Netscape"!=navigator.appName?(o.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=67108863&s}return i},n=26):(o.prototype.am=a,n=28),o.prototype.DB=n,o.prototype.DM=(1<<n)-1,o.prototype.DV=1<<n;o.prototype.FV=Math.pow(2,52),o.prototype.F1=52-n,o.prototype.F2=2*n-52;var c,u,l="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array;for(c="0".charCodeAt(0),u=0;u<=9;++u)h[c++]=u;for(c="a".charCodeAt(0),u=10;u<36;++u)h[c++]=u;for(c="A".charCodeAt(0),u=10;u<36;++u)h[c++]=u;function p(e){return l.charAt(e)}function f(e,t){var r=h[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=s();return t.fromInt(e),t}function g(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function m(e){this.m=e}function y(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function v(e,t){return e&t}function b(e,t){return e|t}function _(e,t){return e^t}function E(e,t){return e&~t}function C(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function w(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function S(){}function T(e){return e}function A(e){this.r2=s(),this.q3=s(),o.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}m.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},m.prototype.revert=function(e){return e},m.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},m.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},m.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},y.prototype.convert=function(e){var t=s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(o.ZERO)>0&&this.m.subTo(t,t),t},y.prototype.revert=function(e){var t=s();return e.copyTo(t),this.reduce(t),t},y.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},y.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},y.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},o.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},o.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},o.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=8==r?255&e[n]:f(e,n);a<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==s?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&o.ZERO.subTo(this,this)},o.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},o.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},o.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},o.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+s+1]=this.data[r]>>i|a,a=(this.data[r]&o)<<n;for(r=s-1;r>=0;--r)t.data[r]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},o.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&o)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},o.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},o.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&o.ZERO.subTo(t,t)},o.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},o.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=s());var a=s(),c=this.s,u=e.s,l=this.DB-g(n.data[n.t-1]);l>0?(n.lShiftTo(l,a),i.lShiftTo(l,r)):(n.copyTo(a),i.copyTo(r));var h=a.t,p=a.data[h-1];if(0!=p){var f=p*(1<<this.F1)+(h>1?a.data[h-2]>>this.F2:0),d=this.FV/f,m=(1<<this.F1)/f,y=1<<this.F2,v=r.t,b=v-h,_=null==t?s():t;for(a.dlShiftTo(b,_),r.compareTo(_)>=0&&(r.data[r.t++]=1,r.subTo(_,r)),o.ONE.dlShiftTo(h,_),_.subTo(a,a);a.t<h;)a.data[a.t++]=0;for(;--b>=0;){var E=r.data[--v]==p?this.DM:Math.floor(r.data[v]*d+(r.data[v-1]+y)*m);if((r.data[v]+=a.am(0,E,r,b,0,h))<E)for(a.dlShiftTo(b,_),r.subTo(_,r);r.data[v]<--E;)r.subTo(_,r)}null!=t&&(r.drShiftTo(h,t),c!=u&&o.ZERO.subTo(t,t)),r.t=h,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&o.ZERO.subTo(r,r)}}},o.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},o.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},o.prototype.exp=function(e,t){if(e>4294967295||e<1)return o.ONE;var r=s(),n=s(),i=t.convert(this),a=g(e)-1;for(i.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,i,r);else{var c=r;r=n,n=c}return t.revert(r)},o.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this.data[s]>>a)>0&&(i=!0,o=p(r));s>=0;)a<t?(r=(this.data[s]&(1<<a)-1)<<t-a,r|=this.data[--s]>>(a+=this.DB-t)):(r=this.data[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=p(r));return i?o:"0"},o.prototype.negate=function(){var e=s();return o.ZERO.subTo(this,e),e},o.prototype.abs=function(){return this.s<0?this.negate():this},o.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},o.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+g(this.data[this.t-1]^this.s&this.DM)},o.prototype.mod=function(e){var t=s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(o.ZERO)>0&&e.subTo(t,t),t},o.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new m(t):new y(t),this.exp(e,r)},o.ZERO=d(0),o.ONE=d(1),S.prototype.convert=T,S.prototype.revert=T,S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},S.prototype.sqrTo=function(e,t){e.squareTo(t)},A.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=s();return e.copyTo(t),this.reduce(t),t},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},A.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],N=(1<<26)/I[I.length-1];o.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},o.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=d(r),i=s(),o=s(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(r+o.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(e)+a},o.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,c=0;c<e.length;++c){var u=f(e,c);u<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(a=t*a+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&o.ZERO.subTo(this,this)},o.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(o.ONE.shiftLeft(e-1),b,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(o.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},o.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},o.prototype.changeBit=function(e,t){var r=o.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},o.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},o.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},o.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},o.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},o.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},o.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},o.prototype.millerRabin=function(e){var t=this.subtract(o.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),s={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},a=0;a<e;++a){do{n=new o(this.bitLength(),s)}while(n.compareTo(o.ONE)<=0||n.compareTo(t)>=0);var c=n.modPow(i,this);if(0!=c.compareTo(o.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(o.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},o.prototype.clone=function(){var e=s();return this.copyTo(e),e},o.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},o.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},o.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},o.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},o.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},o.prototype.equals=function(e){return 0==this.compareTo(e)},o.prototype.min=function(e){return this.compareTo(e)<0?this:e},o.prototype.max=function(e){return this.compareTo(e)>0?this:e},o.prototype.and=function(e){var t=s();return this.bitwiseTo(e,v,t),t},o.prototype.or=function(e){var t=s();return this.bitwiseTo(e,b,t),t},o.prototype.xor=function(e){var t=s();return this.bitwiseTo(e,_,t),t},o.prototype.andNot=function(e){var t=s();return this.bitwiseTo(e,E,t),t},o.prototype.not=function(){for(var e=s(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},o.prototype.shiftLeft=function(e){var t=s();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},o.prototype.shiftRight=function(e){var t=s();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},o.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+C(this.data[e]);return this.s<0?this.t*this.DB:-1},o.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=w(this.data[r]^t);return e},o.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},o.prototype.setBit=function(e){return this.changeBit(e,b)},o.prototype.clearBit=function(e){return this.changeBit(e,E)},o.prototype.flipBit=function(e){return this.changeBit(e,_)},o.prototype.add=function(e){var t=s();return this.addTo(e,t),t},o.prototype.subtract=function(e){var t=s();return this.subTo(e,t),t},o.prototype.multiply=function(e){var t=s();return this.multiplyTo(e,t),t},o.prototype.divide=function(e){var t=s();return this.divRemTo(e,t,null),t},o.prototype.remainder=function(e){var t=s();return this.divRemTo(e,null,t),t},o.prototype.divideAndRemainder=function(e){var t=s(),r=s();return this.divRemTo(e,t,r),new Array(t,r)},o.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=d(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new m(t):t.isEven()?new A(t):new y(t);var a=new Array,c=3,u=r-1,l=(1<<r)-1;if(a[1]=n.convert(this),r>1){var h=s();for(n.sqrTo(a[1],h);c<=l;)a[c]=s(),n.mulTo(h,a[c-2],a[c]),c+=2}var p,f,v=e.t-1,b=!0,_=s();for(i=g(e.data[v])-1;v>=0;){for(i>=u?p=e.data[v]>>i-u&l:(p=(e.data[v]&(1<<i+1)-1)<<u-i,v>0&&(p|=e.data[v-1]>>this.DB+i-u)),c=r;0==(1&p);)p>>=1,--c;if((i-=c)<0&&(i+=this.DB,--v),b)a[p].copyTo(o),b=!1;else{for(;c>1;)n.sqrTo(o,_),n.sqrTo(_,o),c-=2;c>0?n.sqrTo(o,_):(f=o,o=_,_=f),n.mulTo(_,a[p],o)}for(;v>=0&&0==(e.data[v]&1<<i);)n.sqrTo(o,_),f=o,o=_,_=f,--i<0&&(i=this.DB-1,--v)}return n.revert(o)},o.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return o.ZERO;for(var r=e.clone(),n=this.clone(),i=d(1),s=d(0),a=d(0),c=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(c,s)):(n.subTo(r,n),t&&a.subTo(i,a),c.subTo(s,c))}return 0!=n.compareTo(o.ONE)?o.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},o.prototype.pow=function(e){return this.exp(e,new S)},o.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},o.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=I[I.length-1]){for(t=0;t<I.length;++t)if(r.data[0]==I[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<I.length;){for(var n=I[t],i=t+1;i<I.length&&n<N;)n*=I[i++];for(n=r.modInt(n);t<i;)if(n%I[t++]==0)return!1}return r.millerRabin(e)}},function(e,t){var r=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(r.prototype=Object.create(Error.prototype)).constructor=r,e.exports=r},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)r.call(n,i)&&(e[i]=n[i])}return e};var r=Object.prototype.hasOwnProperty},function(e,t,r){"use strict";!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?e.exports={nextTick:function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,s=arguments.length;switch(s){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,r)});case 4:return process.nextTick(function(){e.call(null,t,r,n)});default:for(i=new Array(s-1),o=0;o<i.length;)i[o++]=arguments[o];return process.nextTick(function(){e.apply(null,i)})}}}:e.exports=process},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(141),i=r(26).createValidator();class o{constructor(){}static delete(){return a.DELETE_SENTINEL}static serverTimestamp(){return c.SERVER_TIMESTAMP_SENTINEL}static arrayUnion(...e){return i.minNumberOfArguments("FieldValue.arrayUnion",arguments,1),new u(e)}static arrayRemove(...e){return i.minNumberOfArguments("FieldValue.arrayRemove",arguments,1),new l(e)}isEqual(e){return this===e}}t.FieldValue=o;class s extends o{}t.FieldTransform=s;class a extends s{constructor(){super()}get includeInDocumentMask(){return!0}get includeInDocumentTransform(){return!1}get methodName(){return"FieldValue.delete"}validate(){return!0}toProto(e,t){throw new Error("FieldValue.delete() should not be included in a FieldTransform")}}a.DELETE_SENTINEL=new a,t.DeleteTransform=a;class c extends s{constructor(){super()}get includeInDocumentMask(){return!1}get includeInDocumentTransform(){return!0}get methodName(){return"FieldValue.serverTimestamp"}validate(){return!0}toProto(e,t){return{fieldPath:t.formattedName,setToServerValue:"REQUEST_TIME"}}}c.SERVER_TIMESTAMP_SENTINEL=new c;class u extends s{constructor(e){super(),this.elements=e}get includeInDocumentMask(){return!1}get includeInDocumentTransform(){return!0}get methodName(){return"FieldValue.arrayUnion"}validate(e){let t=!0;for(let r=0;t&&r<this.elements.length;++r)t=e.isArrayElement(r,this.elements[r],{allowDeletes:"none",allowTransforms:!1});return t}toProto(e,t){const r=e.encodeValue(this.elements).arrayValue;return{fieldPath:t.formattedName,appendMissingElements:r}}isEqual(e){return this===e||e instanceof u&&n(this.elements,e.elements,{strict:!0})}}class l extends s{constructor(e){super(),this.elements=e}get includeInDocumentMask(){return!1}get includeInDocumentTransform(){return!0}get methodName(){return"FieldValue.arrayRemove"}validate(e){let t=!0;for(let r=0;t&&r<this.elements.length;++r)t=e.isArrayElement(r,this.elements[r],{allowDeletes:"none",allowTransforms:!1});return t}toProto(e,t){const r=e.encodeValue(this.elements).arrayValue;return{fieldPath:t.formattedName,removeAllFromArray:r}}isEqual(e){return this===e||e instanceof l&&n(this.elements,e.elements,{strict:!0})}}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(203),i=r(141),o=r(137),s=r(59),a=r(138),c=r(336),u=r(61),l=r(77),h=r(143),p=r(337),f=r(118),d=r(54),g=r(27),m=r(62),y=r(26),v=r(78),b={asc:"ASCENDING",ASC:"ASCENDING",desc:"DESCENDING",DESC:"DESCENDING"},_={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL","=":"EQUAL","==":"EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","array-contains":"ARRAY_CONTAINS"};class E{constructor(e,t){this._firestore=e,this._path=t,this._validator=e._validator}get formattedName(){return this._path.formattedName}get firestore(){return this._firestore}get path(){return this._path.relativeName}get id(){return this._path.id}get parent(){return I(this._firestore,this._path.parent())}get(){return this._firestore.getAll(this).then(([e])=>e)}collection(e){this._validator.isResourcePath("collectionPath",e);const t=this._path.append(e);if(!t.isCollection)throw new Error(`Argument "collectionPath" must point to a collection, but was "${e}". Your path does not contain an odd number of components.`);return I(this._firestore,t)}listCollections(){const e={parent:this._path.formattedName};return this._firestore.request("listCollectionIds",e,m.requestTag(),!0).then(e=>{const t=[];e.sort();for(const r of e)t.push(this.collection(r));return t})}getCollections(){return this.listCollections()}create(e){return new f.WriteBatch(this._firestore).create(this,e).commit().then(([e])=>e)}delete(e){return new f.WriteBatch(this._firestore).delete(this,e).commit().then(([e])=>e)}set(e,t){return new f.WriteBatch(this._firestore).set(this,e,t).commit().then(([e])=>e)}update(e,...t){this._validator.minNumberOfArguments("update",arguments,1);const r=new f.WriteBatch(this._firestore);return r.update.apply(r,[this,e].concat(t)).commit().then(([e])=>e)}onSnapshot(e,t){return this._validator.isFunction("onNext",e),this._validator.isOptionalFunction("onError",t),p.Watch.forDocument(this).onSnapshot((t,r,n)=>{for(const t of n())if(t.ref.path===this.path)return void e(t);const i=new l.DocumentSnapshotBuilder;i.ref=new E(this._firestore,this._path),i.readTime=t,e(i.build())},t||console.error)}isEqual(e){return this===e||e instanceof E&&this._firestore===e._firestore&&this._path.isEqual(e._path)}toProto(){return{referenceValue:this.formattedName}}}t.DocumentReference=E;class C{constructor(e,t="ASCENDING"){this.field=e,this.direction=t}toProto(){return{field:{fieldPath:this.field.formattedName},direction:this.direction}}}class w{constructor(e,t,r,n){this.serializer=e,this.field=t,this.op=r,this.value=n}isInequalityFilter(){switch(this.op){case"GREATER_THAN":case"GREATER_THAN_OR_EQUAL":case"LESS_THAN":case"LESS_THAN_OR_EQUAL":return!0;default:return!1}}toProto(){return"number"==typeof this.value&&isNaN(this.value)?{unaryFilter:{field:{fieldPath:this.field.formattedName},op:"IS_NAN"}}:null===this.value?{unaryFilter:{field:{fieldPath:this.field.formattedName},op:"IS_NULL"}}:{fieldFilter:{field:{fieldPath:this.field.formattedName},op:this.op,value:this.serializer.encodeValue(this.value)}}}}class S{constructor(e,t,r,n,i){this._query=e,this._readTime=t,this._size=r,this._materializedDocs=null,this._materializedChanges=null,this._docs=null,this._changes=null,this._validator=e.firestore._validator,this._docs=n,this._changes=i}get query(){return this._query}get docs(){return this._materializedDocs?this._materializedDocs:(this._materializedDocs=this._docs(),this._docs=null,this._materializedDocs)}get empty(){return 0===this._size}get size(){return this._size}get readTime(){return this._readTime}docChanges(){return this._materializedChanges?this._materializedChanges:(this._materializedChanges=this._changes(),this._changes=null,this._materializedChanges)}forEach(e,t){this._validator.isFunction("callback",e);for(const r of this.docs)e.call(t,r)}isEqual(e){return this===e||e instanceof S&&(this._size===e._size&&(!!this._query.isEqual(e._query)&&(this._materializedDocs&&!this._materializedChanges?N(this.docs,e.docs)&&N(this.docChanges(),e.docChanges()):N(this.docChanges(),e.docChanges())&&N(this.docs,e.docs))))}}t.QuerySnapshot=S,["length","forEach","map",..."undefined"!=typeof Symbol?[Symbol.iterator]:[]].forEach(e=>{Object.defineProperty(S.prototype.docChanges,e,{get:()=>(function(){throw new Error('QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')})()})});class T{constructor(e,t,r=[],n=[],i={}){this._firestore=e,this._path=t,this._fieldFilters=r,this._fieldOrders=n,this._queryOptions=i,this._validator=e._validator,this._serializer=new v.Serializer(e)}static _isDocumentSnapshot(e){return 1===e.length&&e[0]instanceof l.DocumentSnapshot}static _extractFieldValues(e,t){const r=[];for(const n of t)if(g.FieldPath.documentId().isEqual(n.field))r.push(e.ref);else{const t=e.get(n.field);if(void 0===t)throw new Error(`Field "${n.field}" is missing in the provided DocumentSnapshot. `+"Please provide a document that contains values for all specified orderBy() and where() constraints.");r.push(t)}return r}get formattedName(){return this._path.formattedName}get firestore(){return this._firestore}where(e,t,r){if(this._validator.isFieldPath("fieldPath",e),this._validator.isQueryComparison("opStr",t,r),this._validator.isQueryValue("value",r,{allowDeletes:"none",allowTransforms:!1}),this._queryOptions.startAt||this._queryOptions.endAt)throw new Error("Cannot specify a where() filter after calling startAt(), startAfter(), endBefore() or endAt().");e=g.FieldPath.fromArgument(e),g.FieldPath.documentId().isEqual(e)&&(r=this.convertReference(r));const n=this._fieldFilters.concat(new w(this._serializer,e,_[t],r));return new T(this._firestore,this._path,n,this._fieldOrders,this._queryOptions)}select(...e){const t=[];if(0===e.length)t.push({fieldPath:g.FieldPath.documentId().formattedName});else for(let r=0;r<e.length;++r)this._validator.isFieldPath(r,e[r]),t.push({fieldPath:g.FieldPath.fromArgument(e[r]).formattedName});const r=o(!0,{},this._queryOptions);return r.projection={fields:t},new T(this._firestore,this._path,this._fieldFilters,this._fieldOrders,r)}orderBy(e,t){if(this._validator.isFieldPath("fieldPath",e),this._validator.isOptionalFieldOrder("directionStr",t),this._queryOptions.startAt||this._queryOptions.endAt)throw new Error("Cannot specify an orderBy() constraint after calling startAt(), startAfter(), endBefore() or endAt().");const r=new C(g.FieldPath.fromArgument(e),b[t||"asc"]),n=this._fieldOrders.concat(r);return new T(this._firestore,this._path,this._fieldFilters,n,this._queryOptions)}limit(e){this._validator.isInteger("limit",e);const t=o(!0,{},this._queryOptions);return t.limit=e,new T(this._firestore,this._path,this._fieldFilters,this._fieldOrders,t)}offset(e){this._validator.isInteger("offset",e);const t=o(!0,{},this._queryOptions);return t.offset=e,new T(this._firestore,this._path,this._fieldFilters,this._fieldOrders,t)}isEqual(e){return this===e||e instanceof T&&this._path.isEqual(e._path)&&i(this._fieldFilters,e._fieldFilters,{strict:!0})&&i(this._fieldOrders,e._fieldOrders,{strict:!0})&&i(this._queryOptions,e._queryOptions,{strict:!0})}createImplicitOrderBy(e){if(!T._isDocumentSnapshot(e))return this._fieldOrders;const t=this._fieldOrders.slice();let r=!1;if(0===t.length){for(const e of this._fieldFilters)if(e.isInequalityFilter()){t.push(new C(e.field));break}}else for(const e of t)g.FieldPath.documentId().isEqual(e.field)&&(r=!0);if(!r){const e=0===t.length?b.ASC:t[t.length-1].direction;t.push(new C(g.FieldPath.documentId(),e))}return t}createCursor(e,t,r){let n;if((n=T._isDocumentSnapshot(t)?T._extractFieldValues(t[0],e):t).length>e.length)throw new Error("Too many cursor values specified. The specified values must match the orderBy() constraints of the query.");const i={values:[]};r&&(i.before=!0);for(let t=0;t<n.length;++t){let r=n[t];g.FieldPath.documentId().isEqual(e[t].field)&&(r=this.convertReference(r)),this._validator.isQueryValue(t,r,{allowDeletes:"none",allowTransforms:!1}),i.values.push(this._serializer.encodeValue(r))}return i}convertReference(e){if("string"==typeof e)e=new E(this._firestore,this._path.append(e));else{if(!(e instanceof E))throw new Error("The corresponding value for FieldPath.documentId() must be a string or a DocumentReference.");if(!this._path.isPrefixOf(e._path))throw new Error(`"${e.path}" is not part of the query result set and `+"cannot be used as a query boundary.")}if(0!==e._path.parent().compareTo(this._path))throw new Error("Only a direct child can be used as a query boundary. "+`Found: "${e.path}".`);return e}startAt(...e){this._validator.minNumberOfArguments("startAt",arguments,1);const t=o(!0,{},this._queryOptions),r=this.createImplicitOrderBy(e);return t.startAt=this.createCursor(r,e,!0),new T(this._firestore,this._path,this._fieldFilters,r,t)}startAfter(...e){this._validator.minNumberOfArguments("startAfter",arguments,1);const t=o(!0,{},this._queryOptions),r=this.createImplicitOrderBy(e);return t.startAt=this.createCursor(r,e,!1),new T(this._firestore,this._path,this._fieldFilters,r,t)}endBefore(...e){this._validator.minNumberOfArguments("endBefore",arguments,1);const t=o(!0,{},this._queryOptions),r=this.createImplicitOrderBy(e);return t.endAt=this.createCursor(r,e,!0),new T(this._firestore,this._path,this._fieldFilters,r,t)}endAt(...e){this._validator.minNumberOfArguments("endAt",arguments,1);const t=o(!0,{},this._queryOptions),r=this.createImplicitOrderBy(e);return t.endAt=this.createCursor(r,e,!1),new T(this._firestore,this._path,this._fieldFilters,r,t)}get(){return this._get()}_get(e){const t=this,r=[];return new Promise((n,i)=>{let o;t._stream(e).on("error",e=>{i(e)}).on("data",e=>{if(o=e.readTime,e.document){const t=e.document;r.push(t)}}).on("end",()=>{n(new S(this,o,r.length,()=>r,()=>{const e=[];for(let t=0;t<r.length;++t)e.push(new h.DocumentChange("added",r[t],-1,t));return e}))})})}stream(){const e=this._stream(),t=a.obj(function(e,t,r){e.document&&this.push(e.document),r()});return n([e,t])}toProto(e){const t={parent:this._path.parent().formattedName,structuredQuery:{from:[{collectionId:this._path.id}]}},r=t.structuredQuery;if(1===this._fieldFilters.length)r.where=this._fieldFilters[0].toProto();else if(this._fieldFilters.length>1){const e=[];for(const t of this._fieldFilters)e.push(t.toProto());r.where={compositeFilter:{op:"AND",filters:e}}}if(this._fieldOrders.length){const e=[];for(const t of this._fieldOrders)e.push(t.toProto());r.orderBy=e}return this._queryOptions.limit&&(r.limit={value:this._queryOptions.limit}),r.offset=this._queryOptions.offset,r.startAt=this._queryOptions.startAt,r.endAt=this._queryOptions.endAt,r.select=this._queryOptions.projection,t.transaction=e,t}_stream(e){const t=this.toProto(e),r=m.requestTag(),n=this,i=a.obj(function(e,t,r){const i=d.Timestamp.fromProto(e.readTime);if(e.document){const t=n.firestore.snapshot_(e.document,e.readTime);this.push({document:t,readTime:i})}else this.push({readTime:i});r()});return this._firestore.readStream("runQuery",t,r,!0).then(e=>{e.on("error",e=>{u.logger("Query._stream",r,"Query failed with stream error:",e),i.destroy(e)}),e.resume(),e.pipe(i)}).catch(e=>{i.destroy(e)}),i}onSnapshot(e,t){return this._validator.isFunction("onNext",e),this._validator.isOptionalFunction("onError",t),p.Watch.forQuery(this).onSnapshot((t,r,n,i)=>{e(new S(this,t,r,n,i))},t||console.error)}comparator(){return(e,t)=>{const r=0===this._fieldOrders.length?b.ASC:this._fieldOrders[this._fieldOrders.length-1].direction,n=this._fieldOrders.concat(new C(g.FieldPath.documentId(),r));for(const r of n){let n;if(g.FieldPath.documentId().isEqual(r.field))n=e.ref._path.compareTo(t.ref._path);else{const i=e.protoField(r.field),o=t.protoField(r.field);if(void 0===i||void 0===o)throw new Error("Trying to compare documents on fields that don't exist. Please include the fields you are ordering on in your select() call.");n=c.compare(i,o)}if(0!==n){return(r.direction===b.ASC?1:-1)*n}}return 0}}}t.Query=T;class A extends T{constructor(e,t){super(e,t)}get id(){return this._path.id}get parent(){return new E(this.firestore,this._path.parent())}get path(){return this._path.relativeName}listDocuments(){const e={parent:this._path.parent().formattedName,collectionId:this.id,showMissing:!0,mask:{fieldPaths:[]}};return this.firestore.request("listDocuments",e,m.requestTag()).then(e=>e.map(e=>{const t=g.ResourcePath.fromSlashSeparatedString(e.name);return this.doc(t.id)}))}doc(e){0===arguments.length?e=m.autoId():this._validator.isResourcePath("documentPath",e);const t=this._path.append(e);if(!t.isDocument)throw new Error(`Argument "documentPath" must point to a document, but was "${e}". Your path does not contain an even number of components.`);return new E(this.firestore,t)}add(e){this._validator.isDocument("data",e,{allowEmpty:!0,allowDeletes:"none",allowTransforms:!0});const t=this.doc();return t.create(e).then(()=>t)}isEqual(e){return this===e||e instanceof A&&super.isEqual(e)}}
/*!
 * Creates a new CollectionReference. Invoked by DocumentReference to avoid
 * invalid declaration order.
 *
 * @param {Firestore} firestore The Firestore Database client.
 * @param {ResourcePath} path The path of this collection.
 * @returns {CollectionReference}
 */
function I(e,t){return new A(e,t)}
/*!
 * Validates the input string as a field order direction.
 *
 * @param {string=} str Order direction to validate.
 * @throws {Error} when the direction is invalid
 */function N(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!e[r].isEqual(t[r]))return!1;return!0}t.CollectionReference=A,t.validateFieldOrder=function(e){if(!s.string(e)||!s.defined(b[e]))throw new Error('Order must be one of "asc" or "desc".');return!0},t.validateComparisonOperator=
/*!
 * Validates the input string as a field comparison operator.
 *
 * @param {string} str Field comparison operator to validate.
 * @param {*} val Value that is used in the filter.
 * @throws {Error} when the comparison operation is invalid
 */
function(e,t){if(s.string(e)&&_[e]){const r=_[e];if("number"==typeof t&&isNaN(t)&&"EQUAL"!==r)throw new Error("Invalid query. You can only perform equals comparisons on NaN.");if(null===t&&"EQUAL"!==r)throw new Error("Invalid query. You can only perform equals comparisons on Null.");return!0}throw new Error('Operator must be one of "<", "<=", "==", ">", or ">=".')},t.validateDocumentReference=
/*!
 * Validates that 'value' is a DocumentReference.
 *
 * @param {*} value The argument to validate.
 * @returns 'true' is value is an instance of DocumentReference.
 */
function(e){if(e instanceof E)return!0;throw y.customObjectError(e)}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(15),i=r(77),o=r(61),s=r(27),a=r(78),c=r(54),u=r(62),l=11e4;class h{constructor(e){this._writeTime=e}get writeTime(){return this._writeTime}isEqual(e){return this===e||e instanceof h&&this._writeTime.isEqual(e._writeTime)}}t.WriteResult=h;t.WriteBatch=class{constructor(e){this._writes=[],this._committed=!1,this._firestore=e,this._validator=e._validator,this._serializer=new a.Serializer(e)}get isEmpty(){return 0===this._writes.length}verifyNotCommitted(){if(this._committed)throw new Error("Cannot modify a WriteBatch that has been committed.")}create(e,t){this._validator.isDocumentReference("documentRef",e),this._validator.isDocument("data",t,{allowEmpty:!0,allowDeletes:"none",allowTransforms:!0}),this.verifyNotCommitted();const r=i.DocumentSnapshot.fromObject(e,t),n=new i.Precondition({exists:!1}),o=i.DocumentTransform.fromObject(e,t);return o.validate(),this._writes.push({write:!r.isEmpty||o.isEmpty?r.toProto():null,transform:o.toProto(this._serializer),precondition:n.toProto()}),this}delete(e,t){this._validator.isDocumentReference("documentRef",e),this._validator.isOptionalDeletePrecondition("precondition",t),this.verifyNotCommitted();const r=new i.Precondition(t);return this._writes.push({write:{delete:e.formattedName},precondition:r.toProto()}),this}set(e,t,r){this._validator.isOptionalSetOptions("options",r);const n=r&&!0===r.merge,o=r&&r.mergeFields;let s;this._validator.isDocumentReference("documentRef",e),this._validator.isDocument("data",t,{allowEmpty:!0,allowDeletes:o||n?"all":"none",allowTransforms:!0}),this.verifyNotCommitted(),o&&(t=(s=i.DocumentMask.fromFieldMask(r.mergeFields)).applyTo(t));const a=i.DocumentTransform.fromObject(e,t);a.validate();const c=i.DocumentSnapshot.fromObject(e,t);o?s.removeFields(a.fields):s=i.DocumentMask.fromObject(t);const u=!c.isEmpty||!s.isEmpty;let l;return o||n?(u||a.isEmpty)&&((l=c.toProto()).updateMask=s.toProto(this._serializer)):l=c.toProto(),this._writes.push({write:l,transform:a.toProto(this._serializer)}),this}update(e,t,...r){this._validator.minNumberOfArguments("update",arguments,2),this._validator.isDocumentReference("documentRef",e),this.verifyNotCommitted();const n=new Map;let a=new i.Precondition({exists:!0});const c="Update() requires either a single JavaScript object or an alternating list of field/value pairs that can be followed by an optional precondition.";if("string"==typeof t||t instanceof s.FieldPath)try{for(let e=1;e<arguments.length;e+=2)if(e===arguments.length-1)this._validator.isUpdatePrecondition(e,arguments[e]),a=new i.Precondition(arguments[e]);else{this._validator.isFieldPath(e,arguments[e]),this._validator.minNumberOfArguments("update",arguments,e+1);const t=s.FieldPath.fromArgument(arguments[e]);this._validator.isFieldValue(e,arguments[e+1],{allowDeletes:"root",allowTransforms:!0},t),n.set(t,arguments[e+1])}}catch(e){throw o.logger("WriteBatch.update",null,"Varargs validation failed:",e),new Error(`${c} ${e.message}`)}else try{this._validator.isDocument("dataOrField",t,{allowEmpty:!1,allowDeletes:"root",allowTransforms:!0}),this._validator.maxNumberOfArguments("update",arguments,3),Object.keys(t).forEach(e=>{this._validator.isFieldPath(e,e),n.set(s.FieldPath.fromArgument(e),t[e])}),r.length>0&&(this._validator.isUpdatePrecondition("preconditionOrValues",r[0]),a=new i.Precondition(r[0]))}catch(e){throw o.logger("WriteBatch.update",null,"Non-varargs validation failed:",e),new Error(`${c} ${e.message}`)}this._validator.isUpdateMap("dataOrField",n);const u=i.DocumentSnapshot.fromUpdateMap(e,n),l=i.DocumentMask.fromUpdateMap(n);let h=null;u.isEmpty&&l.isEmpty||((h=u.toProto()).updateMask=l.toProto());const p=i.DocumentTransform.fromUpdateMap(e,n);return p.validate(),this._writes.push({write:h,transform:p.toProto(this._serializer),precondition:a.toProto()}),this}commit(){return this.commit_()}commit_(e){const t=e&&e.transactionId,r=e&&e.requestTag||u.requestTag(),i={database:this._firestore.formattedName};if(!t&&this._shouldCreateTransaction())return o.logger("WriteBatch.commit",r,"Using transaction for commit"),this._firestore.request("beginTransaction",i,r,!0).then(e=>this.commit_({transactionId:e.transaction}));i.writes=[];for(const e of this._writes)n(e.write||e.transform,"Either a write or transform must be set"),e.precondition&&((e.write||e.transform).currentDocument=e.precondition),e.write&&i.writes.push(e.write),e.transform&&i.writes.push(e.transform);return o.logger("WriteBatch.commit",r,"Sending %d writes",i.writes.length),t&&(i.transaction=t),this._committed=!0,this._firestore.request("commit",i,r,!1).then(e=>{const t=[];if(i.writes.length>0){n(Array.isArray(e.writeResults)&&i.writes.length===e.writeResults.length,`Expected one write result per operation, but got ${e.writeResults.length} results for ${i.writes.length} operations.`);const r=c.Timestamp.fromProto(e.commitTime);let o=0;for(let n=0;n<this._writes.length;++n){const i=this._writes[n];i.write&&i.transform&&++o;const s=e.writeResults[n+o];t.push(new h(s.updateTime?c.Timestamp.fromProto(s.updateTime):r))}}return t})}_shouldCreateTransaction(){return!!this._firestore._preferTransactions&&(!this._firestore._lastSuccessfulRequest||(new Date).getTime()-this._firestore._lastSuccessfulRequest>l)}},t.validateUpdateMap=
/*!
 * Validates that the update data does not contain any ambiguous field
 * definitions (such as 'a.b' and 'a').
 *
 * @param data An update map with field/value pairs.
 * @returns 'true' if the input is a valid update map.
 */
function(e){const t=[];e.forEach((e,r)=>{t.push(r)}),t.sort((e,t)=>e.compareTo(t));for(let e=1;e<t.length;++e)if(t[e-1].isPrefixOf(t[e]))throw new Error(`Field "${t[e-1]}" was specified multiple times.`);return!0}},function(e,t,r){"use strict";e.exports=s;var n=r(63);((s.prototype=Object.create(n.prototype)).constructor=s).className="OneOf";var i=r(55),o=r(13);function s(e,t,r,i){if(Array.isArray(t)||(r=t,t=void 0),n.call(this,e,r),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}s.fromJSON=function(e,t){return new s(e,t.oneof,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},s.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},s.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},s.prototype.onAdd=function(e){n.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var r=e.get(this.oneof[t]);r&&!r.partOf&&(r.partOf=this,this.fieldsArray.push(r))}a(this)},s.prototype.onRemove=function(e){for(var t,r=0;r<this.fieldsArray.length;++r)(t=this.fieldsArray[r]).parent&&t.parent.remove(t);n.prototype.onRemove.call(this,e)},s.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,r){o.decorateType(t.constructor).add(new s(r,e)),Object.defineProperty(t,r,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(33),o=r(233),s=r(9),a=r(68),c=r(376),u=r(377),l=r(378);!function(e){e.Plain="plain",e.S256="S256"}(t.CodeChallengeMethod||(t.CodeChallengeMethod={}));class h extends u.AuthClient{constructor(e,t,r){super(),this.certificateExpiry=null,this.refreshTokenPromises=new Map;const n=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,redirectUri:r};this._clientId=n.clientId,this._clientSecret=n.clientSecret,this.redirectUri=n.redirectUri,this.eagerRefreshThresholdMillis=n.eagerRefreshThresholdMillis||3e5}generateAuthUrl(e={}){if(e.code_challenge_method&&!e.code_challenge)throw new Error("If a code_challenge_method is provided, code_challenge must be included.");return e.response_type=e.response_type||"code",e.client_id=e.client_id||this._clientId,e.redirect_uri=e.redirect_uri||this.redirectUri,e.scope instanceof Array&&(e.scope=e.scope.join(" ")),h.GOOGLE_OAUTH2_AUTH_BASE_URL_+"?"+o.stringify(e)}generateCodeVerifier(){const e=i.randomBytes(96).toString("base64").replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-");return{codeVerifier:e,codeChallenge:i.createHash("sha256").update(e).digest("base64").split("=")[0].replace(/\+/g,"-").replace(/\//g,"_")}}getToken(e,t){const r="string"==typeof e?{code:e}:e;if(!t)return this.getTokenAsync(r);this.getTokenAsync(r).then(e=>t(null,e.tokens,e.res),e=>t(e,null,e.response))}getTokenAsync(e){return n(this,void 0,void 0,function*(){const t=h.GOOGLE_OAUTH2_TOKEN_URL_,r={code:e.code,client_id:e.client_id||this._clientId,client_secret:this._clientSecret,redirect_uri:e.redirect_uri||this.redirectUri,grant_type:"authorization_code",code_verifier:e.codeVerifier},n=yield this.transporter.request({method:"POST",url:t,data:o.stringify(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}),i=n.data;return n.data&&n.data.expires_in&&(i.expiry_date=(new Date).getTime()+1e3*n.data.expires_in,delete i.expires_in),this.emit("tokens",i),{tokens:i,res:n}})}refreshToken(e){return n(this,void 0,void 0,function*(){if(!e)return this.refreshTokenNoCache(e);if(this.refreshTokenPromises.has(e))return this.refreshTokenPromises.get(e);const t=this.refreshTokenNoCache(e).then(t=>(this.refreshTokenPromises.delete(e),t),t=>{throw this.refreshTokenPromises.delete(e),t});return this.refreshTokenPromises.set(e,t),t})}refreshTokenNoCache(e){return n(this,void 0,void 0,function*(){const t=h.GOOGLE_OAUTH2_TOKEN_URL_,r={refresh_token:e,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"},n=yield this.transporter.request({method:"POST",url:t,data:o.stringify(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}),i=n.data;return n.data&&n.data.expires_in&&(i.expiry_date=(new Date).getTime()+1e3*n.data.expires_in,delete i.expires_in),this.emit("tokens",i),{tokens:i,res:n}})}refreshAccessToken(e){if(a.warn(a.REFRESH_ACCESS_TOKEN_DEPRECATED),!e)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(t=>e(null,t.credentials,t.res),e)}refreshAccessTokenAsync(){return n(this,void 0,void 0,function*(){if(!this.credentials.refresh_token)throw new Error("No refresh token is set.");const e=yield this.refreshToken(this.credentials.refresh_token),t=e.tokens;return t.refresh_token=this.credentials.refresh_token,this.credentials=t,{credentials:this.credentials,res:e.res}})}getAccessToken(e){if(!e)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(t=>e(null,t.token,t.res),e)}getAccessTokenAsync(){return n(this,void 0,void 0,function*(){if((!this.credentials.access_token||this.isTokenExpiring())&&this.credentials.refresh_token){if(!this.credentials.refresh_token)throw new Error("No refresh token is set.");const e=yield this.refreshAccessTokenAsync();if(!e.credentials||e.credentials&&!e.credentials.access_token)throw new Error("Could not refresh access token.");return{token:e.credentials.access_token,res:e.res}}return{token:this.credentials.access_token}})}getRequestMetadata(e,t){if(a.warn(a.OAUTH_GET_REQUEST_METADATA_DEPRECATED),!t)return this.getRequestMetadataAsync();this.getRequestMetadataAsync(e).then(e=>t(null,e.headers,e.res),t)}getRequestHeaders(e){return n(this,void 0,void 0,function*(){return(yield this.getRequestMetadataAsync(e)).headers})}getRequestMetadataAsync(e){return n(this,void 0,void 0,function*(){const e=this.credentials;if(!e.access_token&&!e.refresh_token&&!this.apiKey)throw new Error("No access, refresh token or API key is set.");if(e.access_token&&!this.isTokenExpiring()){return e.token_type=e.token_type||"Bearer",{headers:{Authorization:e.token_type+" "+e.access_token}}}if(this.apiKey)return{headers:{}};let t=null,r=null;try{r=(t=yield this.refreshToken(e.refresh_token)).tokens}catch(e){const t=e;throw!t.response||403!==t.response.status&&404!==t.response.status||(t.message="Could not refresh access token."),t}const n=this.credentials;return n.token_type=n.token_type||"Bearer",r.refresh_token=n.refresh_token,this.credentials=r,{headers:{Authorization:n.token_type+" "+r.access_token},res:t.res}})}revokeToken(e,t){const r={url:h.GOOGLE_OAUTH2_REVOKE_URL_+"?"+o.stringify({token:e})};if(!t)return this.transporter.request(r);this.transporter.request(r).then(e=>t(null,e),t)}revokeCredentials(e){if(!e)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(t=>e(null,t),e)}revokeCredentialsAsync(){return n(this,void 0,void 0,function*(){const e=this.credentials.access_token;if(this.credentials={},e)return this.revokeToken(e);throw new Error("No access token to revoke.")})}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}requestAsync(e,t=!1){return n(this,void 0,void 0,function*(){let r;try{const n=yield this.getRequestMetadataAsync(e.url);n.headers&&n.headers.Authorization&&(e.headers=e.headers||{},e.headers.Authorization=n.headers.Authorization),this.apiKey&&(e.params=Object.assign(e.params||{},{key:this.apiKey})),r=yield this.transporter.request(e)}catch(r){const n=r.response;if(n){const r=n.status,i=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&!this.credentials.expiry_date,o=n.config.data instanceof s.Readable,a=401===r||403===r;if(!t&&a&&!o&&i)return yield this.refreshAccessTokenAsync(),this.requestAsync(e,!0)}throw r}return r})}verifyIdToken(e,t){if(t&&"function"!=typeof t)throw new Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!t)return this.verifyIdTokenAsync(e);this.verifyIdTokenAsync(e).then(e=>t(null,e),t)}verifyIdTokenAsync(e){return n(this,void 0,void 0,function*(){if(!e.idToken)throw new Error("The verifyIdToken method requires an ID Token");const t=yield this.getFederatedSignonCertsAsync();return this.verifySignedJwtWithCerts(e.idToken,t.certs,e.audience,h.ISSUERS_,e.maxExpiry)})}getTokenInfo(e){return n(this,void 0,void 0,function*(){const{data:t}=yield this.transporter.request({method:"GET",url:h.GOOGLE_TOKEN_INFO_URL,params:{access_token:e}}),r=Object.assign({expiry_date:(new Date).getTime()+1e3*t.expires_in,scopes:t.scope.split(" ")},t);return delete r.expires_in,delete r.scope,r})}getFederatedSignonCerts(e){if(!e)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(t=>e(null,t.certs,t.res),e)}getFederatedSignonCertsAsync(){return n(this,void 0,void 0,function*(){const e=(new Date).getTime();if(this.certificateExpiry&&e<this.certificateExpiry.getTime())return{certs:this.certificateCache};let t;try{t=yield this.transporter.request({url:h.GOOGLE_OAUTH2_FEDERATED_SIGNON_CERTS_URL_})}catch(e){throw new Error("Failed to retrieve verification certificates: "+e)}const r=t?t.headers["cache-control"]:void 0;let n=-1;if(r){const e=new RegExp("max-age=([0-9]*)").exec(r);e&&2===e.length&&(n=1e3*Number(e[1]))}const i=new Date;return this.certificateExpiry=-1===n?null:new Date(i.getTime()+n),this.certificateCache=t.data,{certs:t.data,res:t}})}verifySignedJwtWithCerts(e,t,r,n,i){i||(i=h.MAX_TOKEN_LIFETIME_SECS_);const o=e.split(".");if(3!==o.length)throw new Error("Wrong number of segments in token: "+e);const s=o[0]+"."+o[1],a=o[2];let u,p;try{u=JSON.parse(this.decodeBase64(o[0]))}catch(e){throw new Error("Can't parse token envelope: "+o[0])}if(!u)throw new Error("Can't parse token envelope: "+o[0]);try{p=JSON.parse(this.decodeBase64(o[1]))}catch(e){throw new Error("Can't parse token payload: "+o[0])}if(!p)throw new Error("Can't parse token payload: "+o[1]);if(!t.hasOwnProperty(u.kid))throw new Error("No pem found for envelope: "+JSON.stringify(u));const f=t[u.kid];if(!(new c.PemVerifier).verify(f,s,a,"base64"))throw new Error("Invalid token signature: "+e);if(!p.iat)throw new Error("No issue time in token: "+JSON.stringify(p));if(!p.exp)throw new Error("No expiration time in token: "+JSON.stringify(p));const d=Number(p.iat);if(isNaN(d))throw new Error("iat field using invalid format");const g=Number(p.exp);if(isNaN(g))throw new Error("exp field using invalid format");const m=(new Date).getTime()/1e3;if(g>=m+i)throw new Error("Expiration time too far in future: "+JSON.stringify(p));const y=d-h.CLOCK_SKEW_SECS_,v=g+h.CLOCK_SKEW_SECS_;if(m<y)throw new Error("Token used too early, "+m+" < "+y+": "+JSON.stringify(p));if(m>v)throw new Error("Token used too late, "+m+" > "+v+": "+JSON.stringify(p));if(n&&n.indexOf(p.iss)<0)throw new Error("Invalid issuer, expected one of ["+n+"], but got "+p.iss);if(null!=r){const e=p.aud;let t=!1;if(!(t=r.constructor===Array?r.indexOf(e)>-1:e===r))throw new Error("Wrong recipient, payload audience != requiredAudience")}return new l.LoginTicket(u,p)}decodeBase64(e){return Buffer.from(e,"base64").toString("utf8")}isTokenExpiring(){const e=this.credentials.expiry_date;return!!e&&e<=(new Date).getTime()+this.eagerRefreshThresholdMillis}}h.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo",h.GOOGLE_OAUTH2_AUTH_BASE_URL_="https://accounts.google.com/o/oauth2/v2/auth",h.GOOGLE_OAUTH2_TOKEN_URL_="https://oauth2.googleapis.com/token",h.GOOGLE_OAUTH2_REVOKE_URL_="https://oauth2.googleapis.com/revoke",h.GOOGLE_OAUTH2_FEDERATED_SIGNON_CERTS_URL_="https://www.googleapis.com/oauth2/v1/certs",h.CLOCK_SKEW_SECS_=300,h.MAX_TOKEN_LIFETIME_SECS_=86400,h.ISSUERS_=["accounts.google.com","https://accounts.google.com"],t.OAuth2Client=h},function(e,t,r){var n=r(3);function i(e,t){n.cipher.registerAlgorithm(e,function(){return new n.des.Algorithm(e,t)})}r(157),r(235),r(6),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return f(r._keys,e,t,!1)},decrypt:function(e,t){return f(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=e.length()>8?3:1,y=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,_=0;_<m;_++){var E=e.getInt32(),C=e.getInt32();E^=(t=252645135&(E>>>4^C))<<4,E^=t=65535&((C^=t)>>>-16^E),E^=(t=858993459&(E>>>2^(C^=t<<-16)))<<2,E^=t=65535&((C^=t)>>>-16^E),E^=(t=1431655765&(E>>>1^(C^=t<<-16)))<<1,E^=t=16711935&((C^=t)>>>8^E),t=(E^=(t=1431655765&(E>>>1^(C^=t<<8)))<<1)<<8|(C^=t)>>>20&240,E=C<<24|C<<8&16711680|C>>>8&65280|C>>>24&240,C=t;for(var w=0;w<v.length;++w){v[w]?(E=E<<2|E>>>26,C=C<<2|C>>>26):(E=E<<1|E>>>27,C=C<<1|C>>>27);var S=r[(E&=-15)>>>28]|n[E>>>24&15]|i[E>>>20&15]|o[E>>>16&15]|s[E>>>12&15]|a[E>>>8&15]|c[E>>>4&15],T=u[(C&=-15)>>>28]|l[C>>>24&15]|h[C>>>20&15]|p[C>>>16&15]|f[C>>>12&15]|d[C>>>8&15]|g[C>>>4&15];t=65535&(T>>>16^S),y[b++]=S^t,y[b++]=T^t<<16}}return y}(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var o=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function f(e,t,r,n){var i,f,d=32===e.length?3:9;i=3===d?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var g=t[0],m=t[1];g^=(f=252645135&(g>>>4^m))<<4,g^=(f=65535&(g>>>16^(m^=f)))<<16,g^=f=858993459&((m^=f)>>>2^g),g^=f=16711935&((m^=f<<2)>>>8^g),g=(g^=(f=1431655765&(g>>>1^(m^=f<<8)))<<1)<<1|g>>>31,m=(m^=f)<<1|m>>>31;for(var y=0;y<d;y+=3){for(var v=i[y+1],b=i[y+2],_=i[y];_!=v;_+=b){var E=m^e[_],C=(m>>>4|m<<28)^e[_+1];f=g,g=m,m=f^(s[E>>>24&63]|c[E>>>16&63]|l[E>>>8&63]|p[63&E]|o[C>>>24&63]|a[C>>>16&63]|u[C>>>8&63]|h[63&C])}f=g,g=m,m=f}m=m>>>1|m<<31,m^=f=1431655765&((g=g>>>1|g<<31)>>>1^m),m^=(f=16711935&(m>>>8^(g^=f<<1)))<<8,m^=(f=858993459&(m>>>2^(g^=f)))<<2,m^=f=65535&((g^=f)>>>16^m),m^=f=252645135&((g^=f<<16)>>>4^m),g^=f<<4,r[0]=g,r[1]=m}function d(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var o=null;r instanceof n.util.ByteBuffer&&(o=r,r={}),(r=r||{}).output=o,r.iv=e,i.call(t,r)},t}},function(e,t,r){var n=r(3);if(r(37),r(123),r(57),r(242),r(243),r(22),r(6),void 0===i)var i=n.jsbn.BigInteger;var o=n.asn1;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var s=n.pki,a=[6,4,2,4,2,4,6,2],c={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},l={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},h=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p=function(e){var t;if(!(e.algorithm in s.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=s.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);a.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),a.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var c=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(c),o.toDer(i).getBytes()},f=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var o;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{o=new i(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(o.compareTo(t.n)>=0||!o.gcd(t.n).equals(i.ONE));for(var s=(e=e.multiply(o.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);s.compareTo(a)<0;)s=s.add(t.p);var c=s.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return c=c.multiply(o.modInverse(t.n)).mod(t.n)};function d(e,t,r){var i=n.util.createBuffer(),o=Math.ceil(t.n.bitLength()/8);if(e.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=o-11,s}i.putByte(0),i.putByte(r);var a,c=o-3-e.length;if(0===r||1===r){a=0===r?0:255;for(var u=0;u<c;++u)i.putByte(a)}else for(;c>0;){var l=0,h=n.random.getBytes(c);for(u=0;u<c;++u)0===(a=h.charCodeAt(u))?++l:i.putByte(a);c=l}return i.putByte(0),i.putBytes(e),i}function g(e,t,r,i){var o=Math.ceil(t.n.bitLength()/8),s=n.util.createBuffer(e),a=s.getByte(),c=s.getByte();if(0!==a||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&void 0===i)throw new Error("Encryption block is invalid.");var u=0;if(0===c){u=o-3-i;for(var l=0;l<u;++l)if(0!==s.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(u=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++u}else if(2===c)for(u=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++u}if(0!==s.getByte()||u!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function m(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function y(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function v(e){return"undefined"!=typeof window&&"object"==typeof window.crypto&&"object"==typeof window.crypto.subtle&&"function"==typeof window.crypto.subtle[e]}function b(e){return"undefined"!=typeof window&&"object"==typeof window.msCrypto&&"object"==typeof window.msCrypto.subtle&&"function"==typeof window.msCrypto.subtle[e]}function _(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}s.rsa.encrypt=function(e,t,r){var o,s=r,a=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(s=2===r,o=d(e,t,r)):(o=n.util.createBuffer()).putBytes(e);for(var c=new i(o.toHex(),16),u=f(c,t,s).toString(16),l=n.util.createBuffer(),h=a-Math.ceil(u.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(u)),l.getBytes()},s.rsa.decrypt=function(e,t,r,o){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=s,a}var c=new i(n.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var u=f(c,t,r).toString(16),l=n.util.createBuffer(),h=s-Math.ceil(u.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(u)),!1!==o?g(l.getBytes(),t,r):l.getBytes()},s.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var o,s=(r=r||{}).prng||n.random,a={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(o={algorithm:c,state:0,bits:e,rng:a,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(o.eInt),o},s.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new i(null);r.fromInt(30);for(var n,o=0,c=function(e,t){return e|t},u=+new Date,l=0;null===e.keys&&(t<=0||l<t);){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,p=h-1;0===e.pqState?(e.num=new i(h,e.rng),e.num.testBit(p)||e.num.bitwiseTo(i.ONE.shiftLeft(p),c,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),o=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(y(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(a[o++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:s.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:s.rsa.setPublicKey(e.n,e.e)}}l+=(n=+new Date)-u,u=n}return null!==e.keys},s.rsa.generateKeyPair=function(e,t,r,a){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(a=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(a=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,a=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(a=r,r=void 0):(a=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&a&&e>=256&&e<=16384&&(65537===t||3===t)){if(v("generateKey")&&v("exportKey"))return window.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(e){return window.crypto.subtle.exportKey("pkcs8",e.privateKey)}).then(void 0,function(e){a(e)}).then(function(e){if(e){var t=s.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(e)));a(null,{privateKey:t,publicKey:s.setRsaPublicKey(t.n,t.e)})}});if(b("generateKey")&&b("exportKey")){var c=window.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return c.oncomplete=function(e){var t=e.target.result,r=window.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=s.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(t)));a(null,{privateKey:r,publicKey:s.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){a(e)}},void(c.onerror=function(e){a(e)})}}var u=s.rsa.createKeyPairGenerationState(e,t,r);if(!a)return s.rsa.stepKeyPairGenerationState(u,0),u.keys;!function(e,t,r){"function"==typeof t&&(r=t,t={});var o={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(o.prng=t.prng);function a(){c(e.pBits,function(t,n){return t?r(t):(e.p=n,null!==e.q?u(t,e.q):void c(e.qBits,u))})}function c(e,t){n.prime.generateProbablePrime(e,o,t)}function u(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var o=e.p;e.p=e.q,e.q=o}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void a();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void c(e.qBits,u);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void a();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void c(e.qBits,u);var l=e.e.modInverse(e.phi);e.keys={privateKey:s.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:s.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}a()}(u,r,a)},s.setRsaPublicKey=s.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,i){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return d(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var o=t.encode(e,r,!0);return s.rsa.encrypt(o,r,!0)},verify:function(e,t,n){"string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){return t=g(t,r,!0),e===o.fromDer(t).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(e,t){return e===(t=g(t,r,!0))}});var i=s.rsa.decrypt(t,r,!0,!1);return n.verify(e,i,r.n.bitLength())}};return r},s.setRsaPrivateKey=s.rsa.setPrivateKey=function(e,t,r,i,o,a,c,u){var l={n:e,e:t,d:r,p:i,q:o,dP:a,dQ:c,qInv:u,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=s.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:g};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,l,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:p},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,l.n.bitLength());return s.rsa.encrypt(n,l,r)}};return l},s.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},s.privateKeyFromAsn1=function(e){var t,r,a,l,h,p,f,d,g={},m=[];if(o.validate(e,c,g,m)&&(e=o.fromDer(n.util.createBuffer(g.privateKey))),g={},m=[],!o.validate(e,u,g,m)){var y=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw y.errors=m,y}return t=n.util.createBuffer(g.privateKeyModulus).toHex(),r=n.util.createBuffer(g.privateKeyPublicExponent).toHex(),a=n.util.createBuffer(g.privateKeyPrivateExponent).toHex(),l=n.util.createBuffer(g.privateKeyPrime1).toHex(),h=n.util.createBuffer(g.privateKeyPrime2).toHex(),p=n.util.createBuffer(g.privateKeyExponent1).toHex(),f=n.util.createBuffer(g.privateKeyExponent2).toHex(),d=n.util.createBuffer(g.privateKeyCoefficient).toHex(),s.setRsaPrivateKey(new i(t,16),new i(r,16),new i(a,16),new i(l,16),new i(h,16),new i(p,16),new i(f,16),new i(d,16))},s.privateKeyToAsn1=s.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.qInv))])},s.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,h,t,r)){var a,c=o.derToOid(t.publicKeyOid);if(c!==s.oids.rsaEncryption)throw(a=new Error("Cannot read public key. Unknown OID.")).oid=c,a;e=t.rsaPublicKey}if(r=[],!o.validate(e,l,t,r))throw(a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,a;var u=n.util.createBuffer(t.publicKeyModulus).toHex(),p=n.util.createBuffer(t.publicKeyExponent).toHex();return s.setRsaPublicKey(new i(u,16),new i(p,16))},s.publicKeyToAsn1=s.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[s.publicKeyToRSAPublicKey(e)])])},s.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,m(e.e))])}},function(e,t,r){var n,i=r(3);e.exports=i.jsbn=i.jsbn||{};function o(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function s(){return new o(null)}function a(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var c=16383&this.data[e],u=this.data[e++]>>14,l=a*c+u*s;i=((c=s*c+((16383&l)<<14)+r.data[n]+i)>>28)+(l>>14)+a*u,r.data[n++]=268435455&c}return i}i.jsbn.BigInteger=o,"undefined"==typeof navigator?(o.prototype.am=a,n=28):"Microsoft Internet Explorer"==navigator.appName?(o.prototype.am=function(e,t,r,n,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var c=32767&this.data[e],u=this.data[e++]>>15,l=a*c+u*s;i=((c=s*c+((32767&l)<<15)+r.data[n]+(1073741823&i))>>>30)+(l>>>15)+a*u+(i>>>30),r.data[n++]=1073741823&c}return i},n=30):"Netscape"!=navigator.appName?(o.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=67108863&s}return i},n=26):(o.prototype.am=a,n=28),o.prototype.DB=n,o.prototype.DM=(1<<n)-1,o.prototype.DV=1<<n;o.prototype.FV=Math.pow(2,52),o.prototype.F1=52-n,o.prototype.F2=2*n-52;var c,u,l="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array;for(c="0".charCodeAt(0),u=0;u<=9;++u)h[c++]=u;for(c="a".charCodeAt(0),u=10;u<36;++u)h[c++]=u;for(c="A".charCodeAt(0),u=10;u<36;++u)h[c++]=u;function p(e){return l.charAt(e)}function f(e,t){var r=h[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=s();return t.fromInt(e),t}function g(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function m(e){this.m=e}function y(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function v(e,t){return e&t}function b(e,t){return e|t}function _(e,t){return e^t}function E(e,t){return e&~t}function C(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function w(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function S(){}function T(e){return e}function A(e){this.r2=s(),this.q3=s(),o.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}m.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},m.prototype.revert=function(e){return e},m.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},m.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},m.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},y.prototype.convert=function(e){var t=s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(o.ZERO)>0&&this.m.subTo(t,t),t},y.prototype.revert=function(e){var t=s();return e.copyTo(t),this.reduce(t),t},y.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},y.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},y.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},o.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},o.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},o.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=8==r?255&e[n]:f(e,n);a<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==s?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&o.ZERO.subTo(this,this)},o.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},o.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},o.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},o.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+s+1]=this.data[r]>>i|a,a=(this.data[r]&o)<<n;for(r=s-1;r>=0;--r)t.data[r]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},o.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&o)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},o.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},o.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&o.ZERO.subTo(t,t)},o.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},o.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=s());var a=s(),c=this.s,u=e.s,l=this.DB-g(n.data[n.t-1]);l>0?(n.lShiftTo(l,a),i.lShiftTo(l,r)):(n.copyTo(a),i.copyTo(r));var h=a.t,p=a.data[h-1];if(0!=p){var f=p*(1<<this.F1)+(h>1?a.data[h-2]>>this.F2:0),d=this.FV/f,m=(1<<this.F1)/f,y=1<<this.F2,v=r.t,b=v-h,_=null==t?s():t;for(a.dlShiftTo(b,_),r.compareTo(_)>=0&&(r.data[r.t++]=1,r.subTo(_,r)),o.ONE.dlShiftTo(h,_),_.subTo(a,a);a.t<h;)a.data[a.t++]=0;for(;--b>=0;){var E=r.data[--v]==p?this.DM:Math.floor(r.data[v]*d+(r.data[v-1]+y)*m);if((r.data[v]+=a.am(0,E,r,b,0,h))<E)for(a.dlShiftTo(b,_),r.subTo(_,r);r.data[v]<--E;)r.subTo(_,r)}null!=t&&(r.drShiftTo(h,t),c!=u&&o.ZERO.subTo(t,t)),r.t=h,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&o.ZERO.subTo(r,r)}}},o.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},o.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},o.prototype.exp=function(e,t){if(e>4294967295||e<1)return o.ONE;var r=s(),n=s(),i=t.convert(this),a=g(e)-1;for(i.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,i,r);else{var c=r;r=n,n=c}return t.revert(r)},o.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this.data[s]>>a)>0&&(i=!0,o=p(r));s>=0;)a<t?(r=(this.data[s]&(1<<a)-1)<<t-a,r|=this.data[--s]>>(a+=this.DB-t)):(r=this.data[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=p(r));return i?o:"0"},o.prototype.negate=function(){var e=s();return o.ZERO.subTo(this,e),e},o.prototype.abs=function(){return this.s<0?this.negate():this},o.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},o.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+g(this.data[this.t-1]^this.s&this.DM)},o.prototype.mod=function(e){var t=s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(o.ZERO)>0&&e.subTo(t,t),t},o.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new m(t):new y(t),this.exp(e,r)},o.ZERO=d(0),o.ONE=d(1),S.prototype.convert=T,S.prototype.revert=T,S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},S.prototype.sqrTo=function(e,t){e.squareTo(t)},A.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=s();return e.copyTo(t),this.reduce(t),t},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},A.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],N=(1<<26)/I[I.length-1];o.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},o.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=d(r),i=s(),o=s(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(r+o.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(e)+a},o.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,c=0;c<e.length;++c){var u=f(e,c);u<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(a=t*a+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&o.ZERO.subTo(this,this)},o.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(o.ONE.shiftLeft(e-1),b,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(o.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},o.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},o.prototype.changeBit=function(e,t){var r=o.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},o.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},o.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},o.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},o.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},o.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},o.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},o.prototype.millerRabin=function(e){var t=this.subtract(o.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),s={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},a=0;a<e;++a){do{n=new o(this.bitLength(),s)}while(n.compareTo(o.ONE)<=0||n.compareTo(t)>=0);var c=n.modPow(i,this);if(0!=c.compareTo(o.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(o.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},o.prototype.clone=function(){var e=s();return this.copyTo(e),e},o.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},o.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},o.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},o.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},o.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},o.prototype.equals=function(e){return 0==this.compareTo(e)},o.prototype.min=function(e){return this.compareTo(e)<0?this:e},o.prototype.max=function(e){return this.compareTo(e)>0?this:e},o.prototype.and=function(e){var t=s();return this.bitwiseTo(e,v,t),t},o.prototype.or=function(e){var t=s();return this.bitwiseTo(e,b,t),t},o.prototype.xor=function(e){var t=s();return this.bitwiseTo(e,_,t),t},o.prototype.andNot=function(e){var t=s();return this.bitwiseTo(e,E,t),t},o.prototype.not=function(){for(var e=s(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},o.prototype.shiftLeft=function(e){var t=s();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},o.prototype.shiftRight=function(e){var t=s();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},o.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+C(this.data[e]);return this.s<0?this.t*this.DB:-1},o.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=w(this.data[r]^t);return e},o.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},o.prototype.setBit=function(e){return this.changeBit(e,b)},o.prototype.clearBit=function(e){return this.changeBit(e,E)},o.prototype.flipBit=function(e){return this.changeBit(e,_)},o.prototype.add=function(e){var t=s();return this.addTo(e,t),t},o.prototype.subtract=function(e){var t=s();return this.subTo(e,t),t},o.prototype.multiply=function(e){var t=s();return this.multiplyTo(e,t),t},o.prototype.divide=function(e){var t=s();return this.divRemTo(e,t,null),t},o.prototype.remainder=function(e){var t=s();return this.divRemTo(e,null,t),t},o.prototype.divideAndRemainder=function(e){var t=s(),r=s();return this.divRemTo(e,t,r),new Array(t,r)},o.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=d(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new m(t):t.isEven()?new A(t):new y(t);var a=new Array,c=3,u=r-1,l=(1<<r)-1;if(a[1]=n.convert(this),r>1){var h=s();for(n.sqrTo(a[1],h);c<=l;)a[c]=s(),n.mulTo(h,a[c-2],a[c]),c+=2}var p,f,v=e.t-1,b=!0,_=s();for(i=g(e.data[v])-1;v>=0;){for(i>=u?p=e.data[v]>>i-u&l:(p=(e.data[v]&(1<<i+1)-1)<<u-i,v>0&&(p|=e.data[v-1]>>this.DB+i-u)),c=r;0==(1&p);)p>>=1,--c;if((i-=c)<0&&(i+=this.DB,--v),b)a[p].copyTo(o),b=!1;else{for(;c>1;)n.sqrTo(o,_),n.sqrTo(_,o),c-=2;c>0?n.sqrTo(o,_):(f=o,o=_,_=f),n.mulTo(_,a[p],o)}for(;v>=0&&0==(e.data[v]&1<<i);)n.sqrTo(o,_),f=o,o=_,_=f,--i<0&&(i=this.DB-1,--v)}return n.revert(o)},o.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return o.ZERO;for(var r=e.clone(),n=this.clone(),i=d(1),s=d(0),a=d(0),c=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(c,s)):(n.subTo(r,n),t&&a.subTo(i,a),c.subTo(s,c))}return 0!=n.compareTo(o.ONE)?o.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},o.prototype.pow=function(e){return this.exp(e,new S)},o.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},o.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=I[I.length-1]){for(t=0;t<I.length;++t)if(r.data[0]==I[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<I.length;){for(var n=I[t],i=t+1;i<I.length&&n<N;)n*=I[i++];for(n=r.modInt(n);t<i;)if(n%I[t++]==0)return!1}return r.millerRabin(e)}},function(e,t,r){"use strict";!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?e.exports={nextTick:function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,s=arguments.length;switch(s){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,r)});case 4:return process.nextTick(function(){e.call(null,t,r,n)});default:for(i=new Array(s-1),o=0;o<i.length;)i[o++]=arguments[o];return process.nextTick(function(){e.apply(null,i)})}}}:e.exports=process},function(e,t,r){var n=r(35),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),o(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,r){"use strict";var n=r(270),i=r(433),o=r(434);e.exports=function(e){if("string"!=typeof e||0===e.length)return 0;var t=0;e=n(e);for(var r=0;r<e.length;r++){var s=i(e,r);s<=31||s>=127&&s<=159||(s>=65536&&r++,o(s)?t+=2:t++)}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RetryOptions=class{constructor(e,t){this.retryCodes=e,this.backoffSettings=t}};class n{constructor(e){e=e||{},this.timeout=e.timeout||3e4,this.retry=e.retry,this.autoPaginate=!("autoPaginate"in e)||e.autoPaginate,this.pageToken=e.pageToken,this.maxResults=e.maxResults,this.otherArgs=e.otherArgs||{},this.bundleOptions=e.bundleOptions,this.isBundling=!("isBundling"in e)||e.isBundling,this.longrunning="longrunning"in e?e.longrunning:null,this.promise="promise"in e?e.promise:Promise}merge(e){if(!e)return new n(this);let t=this.timeout,r=this.retry,i=this.autoPaginate,o=this.pageToken,s=this.maxResults,a=this.otherArgs,c=this.isBundling,u=this.longrunning,l=this.promise;if("timeout"in e&&(t=e.timeout),"retry"in e&&(r=e.retry),"autoPaginate"in e&&!e.autoPaginate&&(i=!1),"pageToken"in e&&(i=!1,o=e.pageToken),"maxResults"in e&&(s=e.maxResults),"otherArgs"in e){a={};for(const e in this.otherArgs)a[e]=this.otherArgs[e];for(const t in e.otherArgs)a[t]=e.otherArgs[t]}return"isBundling"in e&&(c=e.isBundling),"maxRetries"in e&&(r.backoffSettings.maxRetries=e.maxRetries,delete r.backoffSettings.totalTimeoutMillis),"longrunning"in e&&(u=e.longrunning),"promise"in e&&(l=e.promise),new n({timeout:t,retry:r,bundleOptions:this.bundleOptions,longrunning:u,autoPaginate:i,pageToken:o,maxResults:s,otherArgs:a,isBundling:c,promise:l})}}function i(e,t){return{retryCodes:e,backoffSettings:t}}function o(e,t,r,n,i,o,s){return{initialRetryDelayMillis:e,retryDelayMultiplier:t,maxRetryDelayMillis:r,initialRpcTimeoutMillis:n,rpcTimeoutMultiplier:i,maxRpcTimeoutMillis:o,totalTimeoutMillis:s}}function s(e){["element_count_threshold","element_count_limit","request_byte_threshold","request_byte_limit","delay_threshold_millis"].forEach(t=>{if(t in e&&"number"!=typeof e[t])throw new Error(`${t} should be a number`)});const t=e.element_count_threshold||0,r=e.element_count_limit||0,n=e.request_byte_threshold||0,i=e.request_byte_limit||0,o=e.delay_threshold_millis||0;if(0===t&&0===n&&0===o)throw new Error("one threshold should be > 0");return{elementCountThreshold:t,elementCountLimit:r,requestByteThreshold:n,requestByteLimit:i,delayThreshold:o}}function a(e,t,r,n){if(!e)return null;let s=null;if(t&&"retry_codes_name"in e){s=(t[e.retry_codes_name]||[]).map(e=>Number(n[e]))}let a=null;if(r&&"retry_params_name"in e){const t=r[e.retry_params_name];a=o(t.initial_retry_delay_millis,t.retry_delay_multiplier,t.max_retry_delay_millis,t.initial_rpc_timeout_millis,t.rpc_timeout_multiplier,t.max_rpc_timeout_millis,t.total_timeout_millis)}return i(s,a)}function c(e,t){if(!t)return null;if(!t.retryCodes&&!t.backoffSettings)return e;let r=e.retryCodes;t.retryCodes&&(r=t.retryCodes);let n=e.backoffSettings;return t.backoffSettings&&(n=t.backoffSettings),i(r,n)}t.CallSettings=n,t.createRetryOptions=i,t.createBackoffSettings=o,t.createMaxRetriesBackoffSettings=function(e,t,r,n,i,o,s){return{initialRetryDelayMillis:e,retryDelayMultiplier:t,maxRetryDelayMillis:r,initialRpcTimeoutMillis:n,rpcTimeoutMultiplier:i,maxRpcTimeoutMillis:o,maxRetries:s}},t.createBundleOptions=s,t.constructSettings=function(e,t,r,i,o,u){o=o||{};const l={},h=(t.interfaces||{})[e];if(!h)return null;const p=(r.interfaces||{})[e]||{},f=h.methods,d=p.methods||{};for(const e in f){const t=f[e],r=e[0].toLowerCase()+e.slice(1);let g=a(t,h.retry_codes,h.retry_params,i),m=t.bundling,y=t.timeout_millis;if(e in d){const t=d[e];t&&("bundling"in t&&(m=t.bundling),"timeout_millis"in t&&(y=t.timeout_millis)),g=c(g,a(t,p.retry_codes,p.retry_params,i))}l[r]=new n({timeout:y,retry:g,bundleOptions:m?s(m):null,otherArgs:o,promise:u||Promise})}return l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(16),i=/^[0-9a-z_.-]+$/,o=/^[ -~]*$/;function s(e){return e.endsWith("-bin")}function a(e){return e.toLowerCase()}function c(e,t){if(!function(e){return i.test(e)}(e))throw new Error('Metadata key "'+e+'" contains illegal characters');if(null!=t)if(s(e)){if(!(t instanceof Buffer))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(t instanceof Buffer)throw new Error("keys that don't end with '-bin' must have String values");if(!function(e){return o.test(e)}(t))throw new Error('Metadata string value "'+t+'" contains illegal characters')}}class u{constructor(){this.internalRepr={}}set(e,t){c(e=a(e),t),this.internalRepr[e]=[t]}add(e,t){c(e=a(e),t),this.internalRepr[e]?this.internalRepr[e].push(t):this.internalRepr[e]=[t]}remove(e){c(e=a(e)),Object.prototype.hasOwnProperty.call(this.internalRepr,e)&&delete this.internalRepr[e]}get(e){return c(e=a(e)),Object.prototype.hasOwnProperty.call(this.internalRepr,e)?this.internalRepr[e]:[]}getMap(){const e={};return n.forOwn(this.internalRepr,(t,r)=>{if(t.length>0){const n=t[0];e[r]=n instanceof Buffer?n.slice():n}}),e}clone(){const e=new u;return e.internalRepr=function(e){const t={};return n.forOwn(e,(e,r)=>{t[r]=e.map(e=>e instanceof Buffer?Buffer.from(e):e)}),t}(this.internalRepr),e}merge(e){n.forOwn(e.internalRepr,(e,t)=>{this.internalRepr[t]=(this.internalRepr[t]||[]).concat(e)})}toHttp2Headers(){const e={};return n.forOwn(this.internalRepr,(t,r)=>{e[r]=t.map(e=>e instanceof Buffer?e.toString("base64"):e)}),e}_getCoreRepresentation(){return this.internalRepr}static fromHttp2Headers(e){const t=new u;return n.forOwn(e,(e,r)=>{":"!==r.charAt(0)&&(s(r)?Array.isArray(e)?e.forEach(e=>{t.add(r,Buffer.from(e,"base64"))}):void 0!==e&&e.split(",").forEach(e=>{t.add(r,Buffer.from(e.trim(),"base64"))}):Array.isArray(e)?e.forEach(e=>{t.add(r,e)}):void 0!==e&&e.split(",").forEach(e=>t.add(r,e.trim())))}),t}}t.Metadata=u},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});t.BaseFilter=class{sendMetadata(e){return n(this,void 0,void 0,function*(){return e})}receiveMetadata(e){return n(this,void 0,void 0,function*(){return e})}sendMessage(e){return n(this,void 0,void 0,function*(){return e})}receiveMessage(e){return n(this,void 0,void 0,function*(){return e})}receiveTrailers(e){return n(this,void 0,void 0,function*(){return e})}}},function(e,t,r){"use strict";var n=r(0),i=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o="[DEFAULT]",s=[],a=function(){function e(e,t,r){this.firebase_=r,this.isDeleted_=!1,this.services_={},this.name_=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled||!1,this.options_=Object(n.l)(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){s.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){s=s.filter(function(t){return t!==e})}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed_(),this._automaticDataCollectionEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){e.firebase_.INTERNAL.removeApp(e.name_);var t=[];return Object.keys(e.services_).forEach(function(r){Object.keys(e.services_[r]).forEach(function(n){t.push(e.services_[r][n])})}),Promise.all(t.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=!0,e.services_={}})},e.prototype._getService=function(e,t){if(void 0===t&&(t=o),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var r=t!==o?t:void 0,n=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),r);this.services_[e][t]=n}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;Object(n.m)(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(s.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),s=[])},e.prototype.checkDestroyed_=function(){this.isDeleted_&&c("app-deleted",{name:this.name_})},e}();function c(e,t){throw u.create(e,t)}a.prototype.name&&a.prototype.options||a.prototype.delete||console.log("dc");var u=new n.c("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."}),l=function e(){var t={},r={},s={},u={__esModule:!0,initializeApp:function(e,r){if(void 0===r&&(r={}),"object"!=typeof r||null===r){var n=r;r={name:n}}var s=r;void 0===s.name&&(s.name=o);var l=s.name;"string"==typeof l&&l||c("bad-app-name",{name:l+""}),i(t,l)&&c("duplicate-app",{name:l});var h=new a(e,s,u);return t[l]=h,p(h,"create"),h},app:l,apps:null,Promise:Promise,SDK_VERSION:"5.5.9",INTERNAL:{registerService:function(e,t,i,o,p){r[e]&&c("duplicate-service",{name:e}),r[e]=t,o&&(s[e]=o,h().forEach(function(e){o("create",e)}));var f=function(t){return void 0===t&&(t=l()),"function"!=typeof t[e]&&c("invalid-app-argument",{name:e}),t[e]()};return void 0!==i&&Object(n.m)(f,i),u[e]=f,a.prototype[e]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this._getService.bind(this,e).apply(this,p?t:[])},f},createFirebaseNamespace:e,extendNamespace:function(e){Object(n.m)(u,e)},createSubscribe:n.k,ErrorFactory:n.c,removeApp:function(e){p(t[e],"delete"),delete t[e]},factories:r,useAsService:f,Promise:Promise,deepExtend:n.m}};function l(e){return i(t,e=e||o)||c("no-app",{name:e}),t[e]}function h(){return Object.keys(t).map(function(e){return t[e]})}function p(e,t){Object.keys(r).forEach(function(r){var n=f(e,r);null!==n&&s[n]&&s[n](t,e)})}function f(e,t){if("serverAuth"===t)return null;var r=t;return e.options,r}return Object(n.D)(u,"default",u),Object.defineProperty(u,"apps",{get:h}),Object(n.D)(l,"App",a),u}();t.a=l},function(e,t,r){var n=r(2);r(5),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},function(e,t,r){var n=r(2);r(32),r(5);var i=e.exports=n.md5=n.md5||{};n.md.md5=n.md.algorithms.md5=i,i.create=function(){u||function(){o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],a=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],c=new Array(64);for(var e=0;e<64;++e)c[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));u=!0}();var e=null,t=n.util.createBuffer(),r=new Array(16),i={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var a=o.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=a[1],a[1]=a[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(o),l(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var a=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-a));for(var c,u=0,h=i.fullMessageLength.length-1;h>=0;--h)u=(c=8*i.fullMessageLength[h]+u)/4294967296>>>0,s.putInt32Le(c>>>0);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};l(p,r,s);var f=n.util.createBuffer();return f.putInt32Le(p.h0),f.putInt32Le(p.h1),f.putInt32Le(p.h2),f.putInt32Le(p.h3),f},i};var o=null,s=null,a=null,c=null,u=!1;function l(e,t,r){for(var n,i,o,u,l,h,p,f=r.length();f>=64;){for(i=e.h0,o=e.h1,u=e.h2,l=e.h3,p=0;p<16;++p)t[p]=r.getInt32Le(),n=i+(l^o&(u^l))+c[p]+t[p],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;for(;p<32;++p)n=i+(u^l&(o^u))+c[p]+t[s[p]],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;for(;p<48;++p)n=i+(o^u^l)+c[p]+t[s[p]],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;for(;p<64;++p)n=i+(u^(o|~l))+c[p]+t[s[p]],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+u|0,e.h3=e.h3+l|0,f-=64}}},function(e,t,r){var n=r(2);r(74),r(32),r(5);var i,o=n.pkcs5=n.pkcs5||{};n.util.isNodejs&&!n.options.usePureJavaScript&&(i=r(33)),e.exports=n.pbkdf2=o.pbkdf2=function(e,t,r,o,s,a){if("function"==typeof s&&(a=s,s=null),n.util.isNodejs&&!n.options.usePureJavaScript&&i.pbkdf2&&(null===s||"object"!=typeof s)&&(i.pbkdf2Sync.length>4||!s||"sha1"===s))return"string"!=typeof s&&(s="sha1"),e=new Buffer(e,"binary"),t=new Buffer(t,"binary"),a?4===i.pbkdf2Sync.length?i.pbkdf2(e,t,r,o,function(e,t){if(e)return a(e);a(null,t.toString("binary"))}):i.pbkdf2(e,t,r,o,s,function(e,t){if(e)return a(e);a(null,t.toString("binary"))}):4===i.pbkdf2Sync.length?i.pbkdf2Sync(e,t,r,o).toString("binary"):i.pbkdf2Sync(e,t,r,o,s).toString("binary");if(null==s&&(s="sha1"),"string"==typeof s){if(!(s in n.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=n.md[s].create()}var c=s.digestLength;if(o>4294967295*c){var u=new Error("Derived key is too long.");if(a)return a(u);throw u}var l=Math.ceil(o/c),h=o-(l-1)*c,p=n.hmac.create();p.start(s,e);var f,d,g,m="";if(!a){for(var y=1;y<=l;++y){p.start(null,null),p.update(t),p.update(n.util.int32ToBytes(y)),f=g=p.digest().getBytes();for(var v=2;v<=r;++v)p.start(null,null),p.update(g),d=p.digest().getBytes(),f=n.util.xorBytes(f,d,c),g=d;m+=y<l?f:f.substr(0,h)}return m}y=1;function b(){if(y>l)return a(null,m);p.start(null,null),p.update(t),p.update(n.util.int32ToBytes(y)),f=g=p.digest().getBytes(),v=2,_()}function _(){if(v<=r)return p.start(null,null),p.update(g),d=p.digest().getBytes(),f=n.util.xorBytes(f,d,c),g=d,++v,n.util.setImmediate(_);m+=y<l?f:f.substr(0,h),++y,b()}b()}},function(e,t,r){var n=r(2);r(52),r(31),r(110),r(32),r(294),r(53),r(58),r(135),r(111),r(5);var i=n.asn1,o=e.exports=n.pki=n.pki||{},s=o.oids,a={};a.CN=s.commonName,a.commonName="CN",a.C=s.countryName,a.countryName="C",a.L=s.localityName,a.localityName="L",a.ST=s.stateOrProvinceName,a.stateOrProvinceName="ST",a.O=s.organizationName,a.organizationName="O",a.OU=s.organizationalUnitName,a.organizationalUnitName="OU",a.E=s.emailAddress,a.emailAddress="E";var c=n.pki.rsa.publicKeyValidator,u={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},p={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function f(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],t.type&&t.type===r.type?n=r:t.name&&t.name===r.name?n=r:t.shortName&&t.shortName===r.shortName&&(n=r);return n}o.RDNAttributesAsArray=function(e,t){for(var r,n,o,c=[],u=0;u<e.value.length;++u){r=e.value[u];for(var l=0;l<r.value.length;++l)o={},n=r.value[l],o.type=i.derToOid(n.value[0].value),o.value=n.value[1].value,o.valueTagClass=n.value[1].type,o.type in s&&(o.name=s[o.type],o.name in a&&(o.shortName=a[o.name])),t&&(t.update(o.type),t.update(o.value)),c.push(o)}return c},o.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],c=i.derToOid(n.value[0].value),u=n.value[1].value,l=0;l<u.length;++l){var h={};if(h.type=c,h.value=u[l].value,h.valueTagClass=u[l].type,h.type in s&&(h.name=s[h.type],h.name in a&&(h.shortName=a[h.name])),h.type===s.extensionRequest){h.extensions=[];for(var p=0;p<h.value.length;++p)h.extensions.push(o.certificateExtensionFromAsn1(h.value[p]))}t.push(h)}return t};var d=function(e,t,r){var n={};if(e!==s["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:s.sha1},mgf:{algorithmOid:s.mgf1,hash:{algorithmOid:s.sha1}},saltLength:20});var o={},a=[];if(!i.validate(t,l,o,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==o.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=i.derToOid(o.hashOid)),void 0!==o.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=i.derToOid(o.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=i.derToOid(o.maskGenHashOid)),void 0!==o.saltLength&&(n.saltLength=o.saltLength.charCodeAt(0)),n};function g(e){for(var t,r,o=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),s=e.attributes,a=0;a<s.length;++a){var c=(t=s[a]).value,u=i.Type.PRINTABLESTRING;"valueTagClass"in t&&(u=t.valueTagClass)===i.Type.UTF8&&(c=n.util.encodeUtf8(c)),r=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.type).getBytes()),i.create(i.Class.UNIVERSAL,u,!1,c)])]),o.value.push(r)}return o}function m(e){for(var t,r=0;r<e.length;++r){if(void 0===(t=e[r]).name&&(t.type&&t.type in o.oids?t.name=o.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=o.oids[a[t.shortName]])),void 0===t.type){if(!(t.name&&t.name in o.oids))throw(c=new Error("Attribute type not specified.")).attribute=t,c;t.type=o.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===s.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=i.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(o.certificateExtensionToAsn1(y(t.extensions[n])))}var c;if(void 0===t.value)throw(c=new Error("Attribute value not specified.")).attribute=t,c}}function y(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in o.oids&&(e.name=o.oids[e.id]),void 0===e.id){if(!(e.name&&e.name in o.oids))throw(E=new Error("Extension ID not specified.")).extension=e,E;e.id=o.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var r=0,a=0,c=0;e.digitalSignature&&(a|=128,r=7),e.nonRepudiation&&(a|=64,r=6),e.keyEncipherment&&(a|=32,r=5),e.dataEncipherment&&(a|=16,r=4),e.keyAgreement&&(a|=8,r=3),e.keyCertSign&&(a|=4,r=2),e.cRLSign&&(a|=2,r=1),e.encipherOnly&&(a|=1,r=0),e.decipherOnly&&(c|=128,r=7);var u=String.fromCharCode(r);0!==c?u+=String.fromCharCode(a)+String.fromCharCode(c):0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var l=e.value.value;for(var h in e)!0===e[h]&&(h in s?l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s[h]).getBytes())):-1!==h.indexOf(".")&&l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(h).getBytes())))}else if("nsCertType"===e.name){r=0,a=0;e.client&&(a|=128,r=7),e.server&&(a|=64,r=6),e.email&&(a|=32,r=5),e.objsign&&(a|=16,r=4),e.reserved&&(a|=8,r=3),e.sslCA&&(a|=4,r=2),e.emailCA&&(a|=2,r=1),e.objCA&&(a|=1,r=0);u=String.fromCharCode(r);0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var p=0;p<e.altNames.length;++p){u=(v=e.altNames[p]).value;if(7===v.type&&v.ip){if(null===(u=n.util.bytesFromIP(v.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===v.type&&(u=v.oid?i.oidToDer(i.oidToDer(v.oid)):i.oidToDer(u));e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,v.type,!1,u))}}else if("subjectKeyIdentifier"===e.name&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,f.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;if(e.keyIdentifier){var d=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,d))}if(e.authorityCertIssuer){var m=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[g(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];l.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,m))}if(e.serialNumber){var y=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);l.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,y))}}else if("cRLDistributionPoints"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;var v,b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),_=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(p=0;p<e.altNames.length;++p){u=(v=e.altNames[p]).value;if(7===v.type&&v.ip){if(null===(u=n.util.bytesFromIP(v.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===v.type&&(u=v.oid?i.oidToDer(i.oidToDer(v.oid)):i.oidToDer(u));_.value.push(i.create(i.Class.CONTEXT_SPECIFIC,v.type,!1,u))}b.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[_])),l.push(b)}var E;if(void 0===e.value)throw(E=new Error("Extension value not specified.")).extension=e,E;return e}function v(e,t){switch(e){case s["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,r);default:return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}}function b(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,o=0;o<r.length;++o){var s=r[o],a=s.value,c=i.Type.UTF8;"valueTagClass"in s&&(c=s.valueTagClass),c===i.Type.UTF8&&(a=n.util.encodeUtf8(a));var u=!1;"valueConstructed"in s&&(u=s.valueConstructed);var l=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,c,u,a)])]);t.value.push(l)}return t}o.certificateFromPem=function(e,t,r){var s=n.pem.decode(e)[0];if("CERTIFICATE"!==s.type&&"X509 CERTIFICATE"!==s.type&&"TRUSTED CERTIFICATE"!==s.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=s.type,a}if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=i.fromDer(s.body,r);return o.certificateFromAsn1(c,t)},o.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:i.toDer(o.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.publicKeyFromAsn1(s)},o.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:i.toDer(o.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:i.toDer(o.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.getPublicKeyFingerprint=function(e,t){var r,s=(t=t||{}).md||n.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=i.toDer(o.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=i.toDer(o.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}s.start(),s.update(r);var a=s.digest();if("hex"===t.encoding){var c=a.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a},o.certificationRequestFromPem=function(e,t,r){var s=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==s.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=s.type,a}if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=i.fromDer(s.body,r);return o.certificationRequestFromAsn1(c,t)},o.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:i.toDer(o.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return f(e.issuer,t)},e.issuer.addField=function(t){m([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){m([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){m(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){m(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)y(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,i=0;null===n&&i<e.extensions.length;++i)r=e.extensions[i],t.id&&r.id===t.id?n=r:t.name&&r.name===t.name&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=s[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=o.getTBSCertificate(e);var u=i.toDer(e.tbsCertificate);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var a=t.issuer,c=e.subject;throw(g=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.")).expectedIssuer=a.attributes,g.actualIssuer=c.attributes,g}var u=t.md;if(null===u){if(t.signatureOid in s)switch(s[t.signatureOid]){case"sha1WithRSAEncryption":u=n.md.sha1.create();break;case"md5WithRSAEncryption":u=n.md.md5.create();break;case"sha256WithRSAEncryption":u=n.md.sha256.create();break;case"sha384WithRSAEncryption":u=n.md.sha384.create();break;case"sha512WithRSAEncryption":u=n.md.sha512.create();break;case"RSASSA-PSS":u=n.md.sha256.create()}if(null===u)throw(g=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=t.signatureOid,g;var l=t.tbsCertificate||o.getTBSCertificate(t),h=i.toDer(l);u.update(h.getBytes())}if(null!==u){var p;switch(t.signatureOid){case s.sha1WithRSAEncryption:p=void 0;break;case s["RSASSA-PSS"]:var f,d,g;if(void 0===(f=s[t.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[f])throw(g=new Error("Unsupported MGF hash function.")).oid=t.signatureParameters.mgf.hash.algorithmOid,g.name=f,g;if(void 0===(d=s[t.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[d])throw(g=new Error("Unsupported MGF function.")).oid=t.signatureParameters.mgf.algorithmOid,g.name=d,g;if(d=n.mgf[d].create(n.md[f].create()),void 0===(f=s[t.signatureParameters.hash.algorithmOid])||void 0===n.md[f])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:f};p=n.pss.create(n.md[f].create(),d,t.signatureParameters.saltLength)}r=e.publicKey.verify(u.digest().getBytes(),t.signature,p)}return r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){var o,s;r=!0;for(var a=0;r&&a<n.attributes.length;++a)o=n.attributes[a],s=i.attributes[a],o.type===s.type&&o.value===s.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return o.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=s.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var o=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(i.subjectKeyIdentifier)===o}}return!1},e},o.certificateFromAsn1=function(e,t){var r={},a=[];if(!i.validate(e,u,r,a))throw(p=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.")).errors=a,p;if(i.derToOid(r.publicKeyOid)!==o.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=o.createCertificate();c.version=r.certVersion?r.certVersion.charCodeAt(0):0;var l=n.util.createBuffer(r.certSerialNumber);c.serialNumber=l.toHex(),c.signatureOid=n.asn1.derToOid(r.certSignatureOid),c.signatureParameters=d(c.signatureOid,r.certSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),c.siginfo.parameters=d(c.siginfo.algorithmOid,r.certinfoSignatureParams,!1),c.signature=r.certSignature;var h=[];if(void 0!==r.certValidity1UTCTime&&h.push(i.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&h.push(i.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity4GeneralizedTime)),h.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(h.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(c.validity.notBefore=h[0],c.validity.notAfter=h[1],c.tbsCertificate=r.tbsCertificate,t){var p;if(c.md=null,c.signatureOid in s)switch(s[c.signatureOid]){case"sha1WithRSAEncryption":c.md=n.md.sha1.create();break;case"md5WithRSAEncryption":c.md=n.md.md5.create();break;case"sha256WithRSAEncryption":c.md=n.md.sha256.create();break;case"sha384WithRSAEncryption":c.md=n.md.sha384.create();break;case"sha512WithRSAEncryption":c.md=n.md.sha512.create();break;case"RSASSA-PSS":c.md=n.md.sha256.create()}if(null===c.md)throw(p=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=c.signatureOid,p;var g=i.toDer(c.tbsCertificate);c.md.update(g.getBytes())}var y=n.md.sha1.create();c.issuer.getField=function(e){return f(c.issuer,e)},c.issuer.addField=function(e){m([e]),c.issuer.attributes.push(e)},c.issuer.attributes=o.RDNAttributesAsArray(r.certIssuer,y),r.certIssuerUniqueId&&(c.issuer.uniqueId=r.certIssuerUniqueId),c.issuer.hash=y.digest().toHex();var v=n.md.sha1.create();return c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){m([e]),c.subject.attributes.push(e)},c.subject.attributes=o.RDNAttributesAsArray(r.certSubject,v),r.certSubjectUniqueId&&(c.subject.uniqueId=r.certSubjectUniqueId),c.subject.hash=v.digest().toHex(),r.certExtensions?c.extensions=o.certificateExtensionsFromAsn1(r.certExtensions):c.extensions=[],c.publicKey=o.publicKeyFromAsn1(r.subjectPublicKeyInfo),c},o.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(o.certificateExtensionFromAsn1(n.value[i]));return t},o.certificateExtensionFromAsn1=function(e){var t={};if(t.id=i.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===i.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in s)if(t.name=s[t.id],"keyUsage"===t.name){var r=0,o=0;(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1),o=c.value.length>2?c.value.charCodeAt(2):0),t.digitalSignature=128==(128&r),t.nonRepudiation=64==(64&r),t.keyEncipherment=32==(32&r),t.dataEncipherment=16==(16&r),t.keyAgreement=8==(8&r),t.keyCertSign=4==(4&r),t.cRLSign=2==(2&r),t.encipherOnly=1==(1&r),t.decipherOnly=128==(128&o)}else if("basicConstraints"===t.name){(c=i.fromDer(t.value)).value.length>0&&c.value[0].type===i.Type.BOOLEAN?t.cA=0!==c.value[0].value.charCodeAt(0):t.cA=!1;var a=null;c.value.length>0&&c.value[0].type===i.Type.INTEGER?a=c.value[0].value:c.value.length>1&&(a=c.value[1].value),null!==a&&(t.pathLenConstraint=i.derToInteger(a))}else if("extKeyUsage"===t.name)for(var c=i.fromDer(t.value),u=0;u<c.value.length;++u){var l=i.derToOid(c.value[u].value);l in s?t[s[l]]=!0:t[l]=!0}else if("nsCertType"===t.name){r=0;(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1)),t.client=128==(128&r),t.server=64==(64&r),t.email=32==(32&r),t.objsign=16==(16&r),t.reserved=8==(8&r),t.sslCA=4==(4&r),t.emailCA=2==(2&r),t.objCA=1==(1&r)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var h;t.altNames=[];c=i.fromDer(t.value);for(var p=0;p<c.value.length;++p){var f={type:(h=c.value[p]).type,value:h.value};switch(t.altNames.push(f),h.type){case 1:case 2:case 6:break;case 7:f.ip=n.util.bytesToIP(h.value);break;case 8:f.oid=i.derToOid(h.value)}}}else if("subjectKeyIdentifier"===t.name){c=i.fromDer(t.value);t.subjectKeyIdentifier=n.util.bytesToHex(c.value)}return t},o.certificationRequestFromAsn1=function(e,t){var r={},a=[];if(!i.validate(e,p,r,a))throw(u=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.")).errors=a,u;if(i.derToOid(r.publicKeyOid)!==o.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=o.createCertificationRequest();if(c.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,c.signatureOid=n.asn1.derToOid(r.csrSignatureOid),c.signatureParameters=d(c.signatureOid,r.csrSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),c.siginfo.parameters=d(c.siginfo.algorithmOid,r.csrSignatureParams,!1),c.signature=r.csrSignature,c.certificationRequestInfo=r.certificationRequestInfo,t){var u;if(c.md=null,c.signatureOid in s)switch(s[c.signatureOid]){case"sha1WithRSAEncryption":c.md=n.md.sha1.create();break;case"md5WithRSAEncryption":c.md=n.md.md5.create();break;case"sha256WithRSAEncryption":c.md=n.md.sha256.create();break;case"sha384WithRSAEncryption":c.md=n.md.sha384.create();break;case"sha512WithRSAEncryption":c.md=n.md.sha512.create();break;case"RSASSA-PSS":c.md=n.md.sha256.create()}if(null===c.md)throw(u=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=c.signatureOid,u;var l=i.toDer(c.certificationRequestInfo);c.md.update(l.getBytes())}var h=n.md.sha1.create();return c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){m([e]),c.subject.attributes.push(e)},c.subject.attributes=o.RDNAttributesAsArray(r.certificationRequestInfoSubject,h),c.subject.hash=h.digest().toHex(),c.publicKey=o.publicKeyFromAsn1(r.subjectPublicKeyInfo),c.getAttribute=function(e){return f(c,e)},c.addAttribute=function(e){m([e]),c.attributes.push(e)},c.attributes=o.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),c},o.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){m([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return f(e,t)},e.addAttribute=function(t){m([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){m(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){m(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=s[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=o.getCertificationRequestInfo(e);var u=i.toDer(e.certificationRequestInfo);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){if(e.signatureOid in s)switch(s[e.signatureOid]){case"sha1WithRSAEncryption":r=n.md.sha1.create();break;case"md5WithRSAEncryption":r=n.md.md5.create();break;case"sha256WithRSAEncryption":r=n.md.sha256.create();break;case"sha384WithRSAEncryption":r=n.md.sha384.create();break;case"sha512WithRSAEncryption":r=n.md.sha512.create();break;case"RSASSA-PSS":r=n.md.sha256.create()}if(null===r)throw(p=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=e.signatureOid,p;var a=e.certificationRequestInfo||o.getCertificationRequestInfo(e),c=i.toDer(a);r.update(c.getBytes())}if(null!==r){var u;switch(e.signatureOid){case s.sha1WithRSAEncryption:break;case s["RSASSA-PSS"]:var l,h,p;if(void 0===(l=s[e.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[l])throw(p=new Error("Unsupported MGF hash function.")).oid=e.signatureParameters.mgf.hash.algorithmOid,p.name=l,p;if(void 0===(h=s[e.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[h])throw(p=new Error("Unsupported MGF function.")).oid=e.signatureParameters.mgf.algorithmOid,p.name=h,p;if(h=n.mgf[h].create(n.md[l].create()),void 0===(l=s[e.signatureParameters.hash.algorithmOid])||void 0===n.md[l])throw(p=new Error("Unsupported RSASSA-PSS hash function.")).oid=e.signatureParameters.hash.algorithmOid,p.name=l,p;u=n.pss.create(n.md[l].create(),h,e.signatureParameters.saltLength)}t=e.publicKey.verify(r.digest().getBytes(),e.signature,u)}return t},e},o.getTBSCertificate=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.siginfo.algorithmOid).getBytes()),v(e.siginfo.algorithmOid,e.siginfo.parameters)]),g(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e.validity.notBefore)),i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e.validity.notAfter))]),g(e.subject),o.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&t.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&t.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&t.value.push(o.certificateExtensionsToAsn1(e.extensions)),t},o.getCertificationRequestInfo=function(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),g(e.subject),o.publicKeyToAsn1(e.publicKey),b(e)])},o.distinguishedNameToAsn1=function(e){return g(e)},o.certificateToAsn1=function(e){var t=e.tbsCertificate||o.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},o.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),r=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(o.certificateExtensionToAsn1(e[n]));return t},o.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.id).getBytes())),e.critical&&t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=i.toDer(r).getBytes()),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)),t},o.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||o.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},o.createCaStore=function(e){var t={certs:{}};function r(e){return s(e),t.certs[e.hash]||null}function s(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=o.RDNAttributesAsArray(g(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),s(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var s=i.toDer(o.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){if(s===i.toDer(o.certificateToAsn1(t[a])).getBytes())return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var i=t.certs[r];if(n.util.isArray(i))for(var o=0;o<i.length;++o)e.push(i[o]);else e.push(i)}return e},t.removeCertificate=function(e){var a;if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),s(e.subject),!t.hasCertificate(e))return null;var c=r(e.subject);if(!n.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var u=i.toDer(o.certificateToAsn1(e)).getBytes(),l=0;l<c.length;++l){u===i.toDer(o.certificateToAsn1(c[l])).getBytes()&&(a=c[l],c.splice(l,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},o.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},o.verifyCertificateChain=function(e,t,r){var i=(t=t.slice(0)).slice(0),s=new Date,a=!0,c=null,u=0;do{var l=t.shift(),h=null,p=!1;if((s<l.validity.notBefore||s>l.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:o.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:s}),null===c){if(null===(h=t[0]||e.getIssuer(l))&&l.isIssuer(l)&&(p=!0,h=l),h){var f=h;n.util.isArray(f)||(f=[f]);for(var d=!1;!d&&f.length>0;){h=f.shift();try{d=h.verify(l)}catch(e){}}d||(c={message:"Certificate signature is invalid.",error:o.certificateError.bad_certificate})}null!==c||h&&!p||e.hasCertificate(l)||(c={message:"Certificate is not trusted.",error:o.certificateError.unknown_ca})}if(null===c&&h&&!l.isIssuer(h)&&(c={message:"Certificate issuer is invalid.",error:o.certificateError.bad_certificate}),null===c)for(var g={keyUsage:!0,basicConstraints:!0},m=0;null===c&&m<l.extensions.length;++m){var y=l.extensions[m];!y.critical||y.name in g||(c={message:"Certificate has an unsupported critical extension.",error:o.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!h||p))){var v=l.getExtension("basicConstraints"),b=l.getExtension("keyUsage");if(null!==b&&(b.keyCertSign&&null!==v||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:o.certificateError.bad_certificate})),null!==c||null===v||v.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:o.certificateError.bad_certificate}),null===c&&null!==b&&"pathLenConstraint"in v)u-1>v.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:o.certificateError.bad_certificate})}var _=null===c||c.error,E=r?r(_,u,i):_;if(!0!==E)throw!0===_&&(c={message:"The application rejected the certificate.",error:o.certificateError.bad_certificate}),(E||0===E)&&("object"!=typeof E||n.util.isArray(E)?"string"==typeof E&&(c.error=E):(E.message&&(c.message=E.message),E.error&&(c.error=E.error))),c;c=null,a=!1,++u}while(t.length>0);return!0}},function(e,t,r){var n=r(2);r(18),r(5),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,i=e.mgf,o=r.digestLength,s=e.salt||null;if("string"==typeof s&&(s=n.util.createBuffer(s)),"saltLength"in e)t=e.saltLength;else{if(null===s)throw new Error("Salt length not specified or specific salt not given.");t=s.length()}if(null!==s&&s.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||n.random,c={encode:function(e,c){var u,l,h=c-1,p=Math.ceil(h/8),f=e.digest().getBytes();if(p<o+t+2)throw new Error("Message is too long to encrypt.");l=null===s?a.getBytesSync(t):s.bytes();var d=new n.util.ByteBuffer;d.fillWithByte(0,8),d.putBytes(f),d.putBytes(l),r.start(),r.update(d.getBytes());var g=r.digest().getBytes(),m=new n.util.ByteBuffer;m.fillWithByte(0,p-t-o-2),m.putByte(1),m.putBytes(l);var y=m.getBytes(),v=p-o-1,b=i.generate(g,v),_="";for(u=0;u<v;u++)_+=String.fromCharCode(y.charCodeAt(u)^b.charCodeAt(u));var E=65280>>8*p-h&255;return(_=String.fromCharCode(_.charCodeAt(0)&~E)+_.substr(1))+g+String.fromCharCode(188)},verify:function(e,s,a){var c,u=a-1,l=Math.ceil(u/8);if(s=s.substr(-l),l<o+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==s.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var h=l-o-1,p=s.substr(0,h),f=s.substr(h,o),d=65280>>8*l-u&255;if(0!=(p.charCodeAt(0)&d))throw new Error("Bits beyond keysize not zero as expected.");var g=i.generate(f,h),m="";for(c=0;c<h;c++)m+=String.fromCharCode(p.charCodeAt(c)^g.charCodeAt(c));m=String.fromCharCode(m.charCodeAt(0)&~d)+m.substr(1);var y=l-o-t-2;for(c=0;c<y;c++)if(0!==m.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==m.charCodeAt(y))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var v=m.substr(-t),b=new n.util.ByteBuffer;return b.fillWithByte(0,8),b.putBytes(e),b.putBytes(v),r.start(),r.update(b.getBytes()),f===r.digest().getBytes()}};return c}},function(e,t,r){e.exports=a;var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t},i=r(25);i.inherits=r(19);var o=r(204),s=r(206);function a(e){if(!(this instanceof a))return new a(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}i.inherits(a,o),function(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}(n(s.prototype),function(e){a.prototype[e]||(a.prototype[e]=s.prototype[e])})},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===i.call(e)},c=function(e){if(!e||"[object Object]"!==i.call(e))return!1;var t,r=n.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!o)return!1;for(t in e);return void 0===t||n.call(e,t)},u=function(e,t){o&&"__proto__"===t.name?o(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,t){if("__proto__"===t){if(!n.call(e,t))return;if(s)return s(e,t).value}return e[t]};e.exports=function e(){var t,r,n,i,o,s,h=arguments[0],p=1,f=arguments.length,d=!1;for("boolean"==typeof h&&(d=h,h=arguments[1]||{},p=2),(null==h||"object"!=typeof h&&"function"!=typeof h)&&(h={});p<f;++p)if(null!=(t=arguments[p]))for(r in t)n=l(h,r),h!==(i=l(t,r))&&(d&&i&&(c(i)||(o=a(i)))?(o?(o=!1,s=n&&a(n)?n:[]):s=n&&c(n)?n:{},u(h,{name:r,newValue:e(d,s,i)})):void 0!==i&&u(h,{name:r,newValue:i}));return h}},function(e,t,r){var n=r(139).Transform,i=r(4).inherits,o=r(114);function s(e){n.call(this,e),this._destroyed=!1}function a(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=a),"function"!=typeof n&&(n=null),e(t,r,n)}}i(s,n),s.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;process.nextTick(function(){e&&t.emit("error",e),t.emit("close")})}},e.exports=c(function(e,t,r){var n=new s(e);return n._transform=t,r&&(n._flush=r),n}),e.exports.ctor=c(function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=o(e,t),s.call(this,this.options)}return i(n,s),n.prototype._transform=t,r&&(n.prototype._flush=r),n}),e.exports.obj=c(function(e,t,r){var n=new s(o({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n})},function(e,t,r){var n=r(9);"disable"===process.env.READABLE_STREAM&&n?(e.exports=n,(t=e.exports=n.Readable).Readable=n.Readable,t.Writable=n.Writable,t.Duplex=n.Duplex,t.Transform=n.Transform,t.PassThrough=n.PassThrough,t.Stream=n):((t=e.exports=r(208)).Stream=n||t,t.Readable=t,t.Writable=r(211),t.Duplex=r(60),t.Transform=r(213),t.PassThrough=r(332))},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(26).createValidator();
/*!
 * @module firestore/convert
 * @private
 *
 * This module contains utility functions to convert
 * `firestore.v1beta1.Documents` from Proto3 JSON to their equivalent
 * representation in Protobuf JS. Protobuf JS is the only encoding supported by
 * this client, and dependencies that use Proto3 JSON (such as the Google Cloud
 * Functions SDK) are supported through this conversion and its usage in
 * {@see Firestore#snapshot_}.
 */
function i(e,t){let r;if("string"==typeof e){const n=new Date(e),i=Math.floor(n.getTime()/1e3);let o=0;if(e.length>20){const t=e.substring(20,e.length-1),r=9-t.length;o=Number(t)*Math.pow(10,r)}if(isNaN(i)||isNaN(o))throw t=t||"timestampValue",new Error(`Specify a valid ISO 8601 timestamp for "${t}".`);r={seconds:i||void 0,nanos:o||void 0}}else void 0!==e&&(n.isObject("timestampValue",e),r={seconds:e.seconds||void 0,nanos:e.nanos||void 0});return r}function o(e){if(e.valueType)return e.valueType;const t=[];if(void 0!==e.stringValue&&t.push("stringValue"),void 0!==e.booleanValue&&t.push("booleanValue"),void 0!==e.integerValue&&t.push("integerValue"),void 0!==e.doubleValue&&t.push("doubleValue"),void 0!==e.timestampValue&&t.push("timestampValue"),void 0!==e.referenceValue&&t.push("referenceValue"),void 0!==e.arrayValue&&t.push("arrayValue"),void 0!==e.nullValue&&t.push("nullValue"),void 0!==e.mapValue&&t.push("mapValue"),void 0!==e.geoPointValue&&t.push("geoPointValue"),void 0!==e.bytesValue&&t.push("bytesValue"),1!==t.length)throw new Error(`Unable to infer type value fom '${JSON.stringify(e)}'.`);return t[0]}function s(e){switch(o(e)){case"timestampValue":return{timestampValue:i(e.timestampValue)};case"bytesValue":return{bytesValue:(t=e.bytesValue,"string"==typeof t?Buffer.from(t,"base64"):t)};case"integerValue":return{integerValue:Number(e.integerValue)};case"doubleValue":return{doubleValue:Number(e.doubleValue)};case"arrayValue":{const t=[];if(Array.isArray(e.arrayValue.values))for(const r of e.arrayValue.values)t.push(s(r));return{arrayValue:{values:t}}}case"mapValue":{const t={};for(const r in e.mapValue.fields)e.mapValue.fields.hasOwnProperty(r)&&(t[r]=s(e.mapValue.fields[r]));return{mapValue:{fields:t}}}default:return e}var t}t.timestampFromJson=i,t.detectValueType=o,t.valueFromJson=s,t.documentFromJson=function(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[r]=s(e[r]));return t}},function(e,t,r){var n=Array.prototype.slice,i=r(333),o=r(334),s=e.exports=function(e,t,r){return r||(r={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=typeof e&&"object"!=typeof t?r.strict?e===t:e==t:function(e,t,r){var u,l;if(a(e)||a(t))return!1;if(e.prototype!==t.prototype)return!1;if(o(e))return!!o(t)&&(e=n.call(e),t=n.call(t),s(e,t,r));if(c(e)){if(!c(t))return!1;if(e.length!==t.length)return!1;for(u=0;u<e.length;u++)if(e[u]!==t[u])return!1;return!0}try{var h=i(e),p=i(t)}catch(e){return!1}if(h.length!=p.length)return!1;for(h.sort(),p.sort(),u=h.length-1;u>=0;u--)if(h[u]!=p[u])return!1;for(u=h.length-1;u>=0;u--)if(l=h[u],!s(e[l],t[l],r))return!1;return typeof e==typeof t}(e,t,r))};function a(e){return null==e}function c(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(26).createValidator();class i{constructor(e,t){n.isNumber("latitude",e,-90,90),n.isNumber("longitude",t,-180,180),this._latitude=e,this._longitude=t}get latitude(){return this._latitude}get longitude(){return this._longitude}isEqual(e){return this===e||e instanceof i&&this.latitude===e.latitude&&this.longitude===e.longitude}toProto(){return{geoPointValue:{latitude:this.latitude,longitude:this.longitude}}}static fromProto(e){return new i(e.latitude||0,e.longitude||0)}}t.GeoPoint=i},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t,r,n){this._type=e,this._document=t,this._oldIndex=r,this._newIndex=n}get type(){return this._type}get doc(){return this._document}get oldIndex(){return this._oldIndex}get newIndex(){return this._newIndex}isEqual(e){return this===e||e instanceof n&&this._type===e._type&&this._oldIndex===e._oldIndex&&this._newIndex===e._newIndex&&this._document.isEqual(e._document)}}t.DocumentChange=n},function(e,t,r){"use strict";e.exports=r(345)},function(e,t,r){"use strict";e.exports=h;var n,i=r(36),o=i.LongBits,s=i.base64,a=i.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}function p(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function d(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=i.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h},h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(d,10,o.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=o.from(e);return this._push(d,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(d,t.length(),t)},h.prototype.bool=function(e){return this._push(p,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=o.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var m=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(i.isString(e)){var r=h.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){n=e}},function(e,t,r){"use strict";e.exports=c;var n,i=r(36),o=i.LongBits,s=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l,c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e;var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},function(e,t,r){"use strict";e.exports=v;var n=r(79);((v.prototype=Object.create(n.prototype)).constructor=v).className="Type";var i=r(28),o=r(119),s=r(55),a=r(148),c=r(149),u=r(151),l=r(146),h=r(145),p=r(13),f=r(222),d=r(223),g=r(224),m=r(225),y=r(226);function v(e,t){n.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var r=this.fields[e[t]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=p.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=p.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof u||((e.prototype=new u).constructor=e,p.merge(e.prototype,t)),e.$type=e.prototype.$type=this,p.merge(e,u,!0),this._ctor=e;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:p.oneOfGetter(this._oneofsArray[r].oneof),set:p.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(e.prototype,n)}}}),v.generateConstructor=function(e){for(var t,r=p.codegen(["p"],e.name),n=0;n<e.fieldsArray.length;++n)(t=e._fieldsArray[n]).map?r("this%s={}",p.safeProp(t.name)):t.repeated&&r("this%s=[]",p.safeProp(t.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},v.fromJSON=function(e,t){var r=new v(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var u=Object.keys(t.fields),l=0;l<u.length;++l)r.add((void 0!==t.fields[u[l]].keyType?a.fromJSON:s.fromJSON)(u[l],t.fields[u[l]]));if(t.oneofs)for(u=Object.keys(t.oneofs),l=0;l<u.length;++l)r.add(o.fromJSON(u[l],t.oneofs[u[l]]));if(t.nested)for(u=Object.keys(t.nested),l=0;l<u.length;++l){var h=t.nested[u[l]];r.add((void 0!==h.id?s.fromJSON:void 0!==h.fields?v.fromJSON:void 0!==h.values?i.fromJSON:void 0!==h.methods?c.fromJSON:n.fromJSON)(u[l],h))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r},v.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return p.toObject(["options",t&&t.options||void 0,"oneofs",n.arrayToJSON(this.oneofsArray,e),"fields",n.arrayToJSON(this.fieldsArray.filter(function(e){return!e.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},v.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var r=this.oneofsArray;for(t=0;t<r.length;)r[t++].resolve();return n.prototype.resolveAll.call(this)},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof s&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):n.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof s&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return n.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=f(this)({Writer:h,types:t,util:p}),this.decode=d(this)({Reader:l,types:t,util:p}),this.verify=g(this)({types:t,util:p}),this.fromObject=m.fromObject(this)({types:t,util:p}),this.toObject=m.toObject(this)({types:t,util:p});var n=y[e];if(n){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(i),i.toObject=this.toObject,this.toObject=n.toObject.bind(i)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof l||(e=l.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){p.decorateType(t,e)}}},function(e,t,r){"use strict";e.exports=s;var n=r(55);((s.prototype=Object.create(n.prototype)).constructor=s).className="MapField";var i=r(64),o=r(13);function s(e,t,r,i,s,a){if(n.call(this,e,t,i,void 0,void 0,s,a),!o.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}s.fromJSON=function(e,t){return new s(e,t.id,t.keyType,t.type,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},s.d=function(e,t,r){return"function"==typeof r?r=o.decorateType(r).name:r&&"object"==typeof r&&(r=o.decorateEnum(r).name),function(n,i){o.decorateType(n.constructor).add(new s(i,e,t,r))}}},function(e,t,r){"use strict";e.exports=a;var n=r(79);((a.prototype=Object.create(n.prototype)).constructor=a).className="Service";var i=r(150),o=r(13),s=r(220);function a(e,t){n.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}a.fromJSON=function(e,t){var r=new a(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),o=0;o<n.length;++o)r.add(i.fromJSON(n[o],t.methods[n[o]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r},a.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||void 0,"methods",n.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||n.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return n.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,c(this)):n.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return n.prototype.remove.call(this,e)},a.prototype.create=function(e,t,r){for(var n,i=new s.Service(e,t,r),a=0;a<this.methodsArray.length;++a){var c=o.lcFirst((n=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");i[c]=o.codegen(["r","c"],o.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:n,q:n.resolvedRequestType.ctor,s:n.resolvedResponseType.ctor})}return i}},function(e,t,r){"use strict";e.exports=o;var n=r(63);((o.prototype=Object.create(n.prototype)).constructor=o).className="Method";var i=r(13);function o(e,t,r,o,s,a,c,u){if(i.isObject(s)?(c=s,s=a=void 0):i.isObject(a)&&(c=a,a=void 0),void 0!==t&&!i.isString(t))throw TypeError("type must be a string");if(!i.isString(r))throw TypeError("requestType must be a string");if(!i.isString(o))throw TypeError("responseType must be a string");n.call(this,e,c),this.type=t||"rpc",this.requestType=r,this.requestStream=!!s||void 0,this.responseType=o,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=u}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))}},function(e,t,r){"use strict";e.exports=i;var n=r(36);function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,n.toJSONOptions)}},function(e,t,r){"use strict";e.exports=h;var n=r(79);((h.prototype=Object.create(n.prototype)).constructor=h).className="Root";var i,o,s,a=r(55),c=r(28),u=r(119),l=r(13);function h(e){n.call(this,"",e),this.deferred=[],this.files=[]}function p(){}h.fromJSON=function(e,t){return t||(t=new h),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},h.prototype.resolvePath=l.path.resolve,h.prototype.load=function e(t,r,n){"function"==typeof r&&(n=r,r=void 0);var i=this;if(!n)return l.asPromise(e,i,t,r);var a=n===p;function c(e,t){if(n){var r=n;if(n=null,a)throw e;r(e,t)}}function u(e,t){try{if(l.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),l.isString(t)){o.filename=e;var n,s=o(t,i,r),u=0;if(s.imports)for(;u<s.imports.length;++u)(n=i.resolvePath(e,s.imports[u]))&&h(n);if(s.weakImports)for(u=0;u<s.weakImports.length;++u)(n=i.resolvePath(e,s.weakImports[u]))&&h(n,!0)}else i.setOptions(t.options).addJSON(t.nested)}catch(e){c(e)}a||f||c(null,i)}function h(e,t){var r=e.lastIndexOf("google/protobuf/");if(r>-1){var o=e.substring(r);o in s&&(e=o)}if(!(i.files.indexOf(e)>-1))if(i.files.push(e),e in s)a?u(e,s[e]):(++f,setTimeout(function(){--f,u(e,s[e])}));else if(a){var h;try{h=l.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||c(e))}u(e,h)}else++f,l.fetch(e,function(r,o){--f,n&&(r?t?f||c(null,i):c(r):u(e,o))})}var f=0;l.isString(t)&&(t=[t]);for(var d,g=0;g<t.length;++g)(d=i.resolvePath("",t[g]))&&h(d);if(a)return i;f||c(null,i)},h.prototype.loadSync=function(e,t){if(!l.isNode)throw Error("not supported");return this.load(e,t,p)},h.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return n.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function d(e,t){var r=t.parent.lookup(t.extend);if(r){var n=new a(t.fullName,t.id,t.type,t.rule,void 0,t.options);return n.declaringField=t,t.extensionField=n,r.add(n),!0}return!1}h.prototype._handleAdd=function(e){if(e instanceof a)void 0===e.extend||e.extensionField||d(0,e)||this.deferred.push(e);else if(e instanceof c)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof u)){if(e instanceof i)for(var t=0;t<this.deferred.length;)d(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);f.test(e.name)&&(e.parent[e.name]=e)}},h.prototype._handleRemove=function(e){if(e instanceof a){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof n){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);f.test(e.name)&&delete e.parent[e.name]}},h._configure=function(e,t,r){i=e,o=t,s=r}},function(e,t,r){"use strict";var n,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var c=s(r(40)),u=s(r(137)),l=a(r(363));function h(e,r,n){return void 0===n&&(n=3),i(this,void 0,void 0,function(){var i,s,a,h;return o(this,function(o){return"string"==typeof(r=r||{})&&(r={property:r}),i="","object"==typeof r&&r.property&&(i="/"+r.property),function(e){for(var t=0,r=[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}];t<r.length;t++){var n=r[t];if(e[n.invalid]){var i="'"+n.invalid+"' is not a valid configuration option. Please use '"+n.expected+"' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.";throw new Error(i)}}}(r),s=c.default.create(),l.attach(s),a={url:t.BASE_URL+"/"+e+i,headers:Object.assign({},t.HEADERS),raxConfig:{noResponseRetries:n,instance:s}},delete(h=u.default(!0,a,r)).property,[2,s.request(h).then(function(e){if(e.headers[t.HEADER_NAME.toLowerCase()]!==t.HEADER_VALUE)throw new Error("Invalid response from metadata service: incorrect "+t.HEADER_NAME+" header.");if(!e.data)throw new Error("Invalid response from the metadata service");return e}).catch(function(e){throw e.response&&200!==e.response.status&&(e.message="Unsuccessful response status code. "+e.message),e})]})})}t.HOST_ADDRESS="http://metadata.google.internal",t.BASE_PATH="/computeMetadata/v1",t.BASE_URL=t.HOST_ADDRESS+t.BASE_PATH,t.HEADER_NAME="Metadata-Flavor",t.HEADER_VALUE="Google",t.HEADERS=Object.freeze(((n={})[t.HEADER_NAME]=t.HEADER_VALUE,n)),t.instance=function(e){return h("instance",e)},t.project=function(e){return h("project",e)},t.isAvailable=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,h("instance",void 0,0)];case 1:return t.sent(),[2,!0];case 2:if((e=t.sent()).code&&("ENOTFOUND"===e.code||"ENOENT"===e.code))return[2,!1];throw e;case 3:return[2]}})})}},function(e,t){var r;t=e.exports=W,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=t.re=[],s=t.src=[],a=0,c=a++;s[c]="0|[1-9]\\d*";var u=a++;s[u]="[0-9]+";var l=a++;s[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var h=a++;s[h]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var p=a++;s[p]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var f=a++;s[f]="(?:"+s[c]+"|"+s[l]+")";var d=a++;s[d]="(?:"+s[u]+"|"+s[l]+")";var g=a++;s[g]="(?:-("+s[f]+"(?:\\."+s[f]+")*))";var m=a++;s[m]="(?:-?("+s[d]+"(?:\\."+s[d]+")*))";var y=a++;s[y]="[0-9A-Za-z-]+";var v=a++;s[v]="(?:\\+("+s[y]+"(?:\\."+s[y]+")*))";var b=a++,_="v?"+s[h]+s[g]+"?"+s[v]+"?";s[b]="^"+_+"$";var E="[v=\\s]*"+s[p]+s[m]+"?"+s[v]+"?",C=a++;s[C]="^"+E+"$";var w=a++;s[w]="((?:<|>)?=?)";var S=a++;s[S]=s[u]+"|x|X|\\*";var T=a++;s[T]=s[c]+"|x|X|\\*";var A=a++;s[A]="[v=\\s]*("+s[T]+")(?:\\.("+s[T]+")(?:\\.("+s[T]+")(?:"+s[g]+")?"+s[v]+"?)?)?";var I=a++;s[I]="[v=\\s]*("+s[S]+")(?:\\.("+s[S]+")(?:\\.("+s[S]+")(?:"+s[m]+")?"+s[v]+"?)?)?";var N=a++;s[N]="^"+s[w]+"\\s*"+s[A]+"$";var k=a++;s[k]="^"+s[w]+"\\s*"+s[I]+"$";var R=a++;s[R]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var O=a++;s[O]="(?:~>?)";var x=a++;s[x]="(\\s*)"+s[O]+"\\s+",o[x]=new RegExp(s[x],"g");var B=a++;s[B]="^"+s[O]+s[A]+"$";var D=a++;s[D]="^"+s[O]+s[I]+"$";var P=a++;s[P]="(?:\\^)";var L=a++;s[L]="(\\s*)"+s[P]+"\\s+",o[L]=new RegExp(s[L],"g");var j=a++;s[j]="^"+s[P]+s[A]+"$";var U=a++;s[U]="^"+s[P]+s[I]+"$";var M=a++;s[M]="^"+s[w]+"\\s*("+E+")$|^$";var F=a++;s[F]="^"+s[w]+"\\s*("+_+")$|^$";var V=a++;s[V]="(\\s*)"+s[w]+"\\s*("+E+"|"+s[A]+")",o[V]=new RegExp(s[V],"g");var q=a++;s[q]="^\\s*("+s[A]+")\\s+-\\s+("+s[A]+")\\s*$";var K=a++;s[K]="^\\s*("+s[I]+")\\s+-\\s+("+s[I]+")\\s*$";var H=a++;s[H]="(<|>)?=?\\s*\\*";for(var G=0;G<35;G++)r(G,s[G]),o[G]||(o[G]=new RegExp(s[G]));function z(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof W)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?o[C]:o[b]).test(e))return null;try{return new W(e,t)}catch(e){return null}}function W(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof W){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof W))return new W(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var s=e.trim().match(t.loose?o[C]:o[b]);if(!s)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}t.parse=z,t.valid=function(e,t){var r=z(e,t);return r?r.version:null},t.clean=function(e,t){var r=z(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=W,W.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},W.prototype.toString=function(){return this.version},W.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof W||(e=new W(e,this.options)),this.compareMain(e)||this.comparePre(e)},W.prototype.compareMain=function(e){return e instanceof W||(e=new W(e,this.options)),Q(this.major,e.major)||Q(this.minor,e.minor)||Q(this.patch,e.patch)},W.prototype.comparePre=function(e){if(e instanceof W||(e=new W(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return Q(n,i)}while(++t)},W.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new W(e,r).inc(t,n).version}catch(e){return null}},t.diff=function(e,t){if(Z(e,t))return null;var r=z(e),n=z(t);if(r.prerelease.length||n.prerelease.length){for(var i in r)if(("major"===i||"minor"===i||"patch"===i)&&r[i]!==n[i])return"pre"+i;return"prerelease"}for(var i in r)if(("major"===i||"minor"===i||"patch"===i)&&r[i]!==n[i])return i},t.compareIdentifiers=Q;var Y=/^[0-9]+$/;function Q(e,t){var r=Y.test(e),n=Y.test(t);return r&&n&&(e=+e,t=+t),r&&!n?-1:n&&!r?1:e<t?-1:e>t?1:0}function $(e,t,r){return new W(e,r).compare(new W(t,r))}function J(e,t,r){return $(e,t,r)>0}function X(e,t,r){return $(e,t,r)<0}function Z(e,t,r){return 0===$(e,t,r)}function ee(e,t,r){return 0!==$(e,t,r)}function te(e,t,r){return $(e,t,r)>=0}function re(e,t,r){return $(e,t,r)<=0}function ne(e,t,r,n){var i;switch(t){case"===":"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),i=e===r;break;case"!==":"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),i=e!==r;break;case"":case"=":case"==":i=Z(e,r,n);break;case"!=":i=ee(e,r,n);break;case">":i=J(e,r,n);break;case">=":i=te(e,r,n);break;case"<":i=X(e,r,n);break;case"<=":i=re(e,r,n);break;default:throw new TypeError("Invalid operator: "+t)}return i}function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ie))return new ie(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return Q(t,e)},t.major=function(e,t){return new W(e,t).major},t.minor=function(e,t){return new W(e,t).minor},t.patch=function(e,t){return new W(e,t).patch},t.compare=$,t.compareLoose=function(e,t){return $(e,t,!0)},t.rcompare=function(e,t,r){return $(t,e,r)},t.sort=function(e,r){return e.sort(function(e,n){return t.compare(e,n,r)})},t.rsort=function(e,r){return e.sort(function(e,n){return t.rcompare(e,n,r)})},t.gt=J,t.lt=X,t.eq=Z,t.neq=ee,t.gte=te,t.lte=re,t.cmp=ne,t.Comparator=ie;var oe={};function se(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof se)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new se(e.raw,t);if(e instanceof ie)return new se(e.value,t);if(!(this instanceof se))return new se(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ce(e,t,r,n,i,o,s,a,c,u,l,h,p){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(i)?">="+r+"."+n+".0":">="+t)+" "+(a=ae(c)?"":ae(u)?"<"+(+c+1)+".0.0":ae(l)?"<"+c+"."+(+u+1)+".0":h?"<="+c+"."+u+"."+l+"-"+h:"<="+a)).trim()}function ue(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(n||(n={}),t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==oe&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new se(t,r)}catch(e){return!1}return t.test(e)}function he(e,t,r,n){var i,o,s,a,c;switch(e=new W(e,n),t=new se(t,n),r){case">":i=J,o=re,s=X,a=">",c=">=";break;case"<":i=X,o=te,s=J,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],h=null,p=null;if(l.forEach(function(e){e.semver===oe&&(e=new ie(">=0.0.0")),h=h||e,p=p||e,i(e.semver,h.semver,n)?h=e:s(e.semver,p.semver,n)&&(p=e)}),h.operator===a||h.operator===c)return!1;if((!p.operator||p.operator===a)&&o(e,p.semver))return!1;if(p.operator===c&&s(e,p.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?o[M]:o[F],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new W(r[2],this.options.loose):this.semver=oe},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new W(e,this.options)),ne(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new se(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new se(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=ne(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=ne(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&s||a||c},t.Range=se,se.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},se.prototype.toString=function(){return this.range},se.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[K]:o[q];e=e.replace(n,ce),r("hyphen replace",e),e=e.replace(o[V],"$1$2$3"),r("comparator trim",e,o[V]),e=(e=(e=e.replace(o[x],"$1~")).replace(o[L],"$1^")).split(/\s+/).join(" ");var i=t?o[M]:o[F],s=e.split(" ").map(function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){r("caret",e,t),t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1});var n=t.loose?o[U]:o[j];return e.replace(n,function(t,n,i,o,s){var a;return r("caret",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":s?(r("replaceCaret pr",s),"-"!==s.charAt(0)&&(s="-"+s),a="0"===n?"0"===i?">="+n+"."+i+"."+o+s+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+s+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+s+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",a),a})}(e,t)}).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1});var n=t.loose?o[D]:o[B];return e.replace(n,function(t,n,i,o,s){var a;return r("tilde",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":s?(r("replaceTilde pr",s),"-"!==s.charAt(0)&&(s="-"+s),a=">="+n+"."+i+"."+o+s+" <"+n+"."+(+i+1)+".0"):a=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",a),a})}(e,t)}).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map(function(e){return function(e,t){e=e.trim(),t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1});var n=t.loose?o[k]:o[N];return e.replace(n,function(t,n,i,o,s,a){r("xRange",e,t,n,i,o,s,a);var c=ae(i),u=c||ae(o),l=u||ae(s),h=l;return"="===n&&h&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&h?(u&&(o=0),l&&(s=0),">"===n?(n=">=",u?(i=+i+1,o=0,s=0):l&&(o=+o+1,s=0)):"<="===n&&(n="<",u?i=+i+1:o=+o+1),t=n+i+"."+o+"."+s):u?t=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(t=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),r("xRange return",t),t})}(e,t)}).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[H],"")}(e,t),r("stars",e),e}(e,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(s=s.filter(function(e){return!!e.match(i)})),s=s.map(function(e){return new ie(e,this.options)},this)},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(r){return e.set.some(function(e){return e.every(function(e){return r.intersects(e,t)})})})})},t.toComparators=function(e,t){return new se(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})},se.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new W(e,this.options));for(var t=0;t<this.set.length;t++)if(ue(this.set[t],e,this.options))return!0;return!1},t.satisfies=le,t.maxSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(n&&-1!==i.compare(e)||(i=new W(n=e,r)))}),n},t.minSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(n&&1!==i.compare(e)||(i=new W(n=e,r)))}),n},t.validRange=function(e,t){try{return new se(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,r){return he(e,t,"<",r)},t.gtr=function(e,t,r){return he(e,t,">",r)},t.outside=he,t.prerelease=function(e,t){var r=z(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new se(e,r),t=new se(t,r),e.intersects(t)},t.coerce=function(e){if(e instanceof W)return e;if("string"!=typeof e)return null;var t=e.match(o[R]);return null==t?null:z((t[1]||"0")+"."+(t[2]||"0")+"."+(t[3]||"0"))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(40),i=r(364),o=r(365),s=r(375),a="google-api-nodejs-client";n.default.defaults.adapter=r(65);class c{configure(e={}){e.headers=e.headers||{};const t=e.headers["User-Agent"];return t?t.includes(`${a}/`)||(e.headers["User-Agent"]=`${t} ${c.USER_AGENT}`):e.headers["User-Agent"]=c.USER_AGENT,e}request(e,t){e=this.configure(e);try{i.validate(e)}catch(e){if(t)return t(e);throw e}const r=process.env.HTTPS_PROXY||process.env.https_proxy;if(r&&(e.httpsAgent=new o(r),e.proxy=!1),!t)return n.default(e).catch(e=>{throw this.processError(e)});n.default(e).then(e=>{t(null,e)},e=>{t(this.processError(e))})}processError(e){const t=e.response,r=e,n=t?t.data:null;return t&&n&&n.error&&200!==t.status?"string"==typeof n.error?(r.message=n.error,r.code=t.status.toString()):Array.isArray(n.error.errors)?(r.message=n.error.errors.map(e=>e.message).join("\n"),r.code=n.error.code,r.errors=n.error.errors):(r.message=n.error.message,r.code=n.error.code||t.status):t&&t.status>=400&&(r.message=n,r.code=t.status.toString()),r}}c.USER_AGENT=`${a}/${s.version}`,t.DefaultTransporter=c},function(e,t){e.exports=require("tls")},function(e,t,r){var n=r(3);r(6),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},function(e,t,r){var n=r(3);r(38),r(6);var i=e.exports=n.md5=n.md5||{};n.md.md5=n.md.algorithms.md5=i,i.create=function(){u||function(){o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],a=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],c=new Array(64);for(var e=0;e<64;++e)c[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));u=!0}();var e=null,t=n.util.createBuffer(),r=new Array(16),i={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var a=o.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=a[1],a[1]=a[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(o),l(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var a=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-a));for(var c,u=0,h=i.fullMessageLength.length-1;h>=0;--h)u=(c=8*i.fullMessageLength[h]+u)/4294967296>>>0,s.putInt32Le(c>>>0);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};l(p,r,s);var f=n.util.createBuffer();return f.putInt32Le(p.h0),f.putInt32Le(p.h1),f.putInt32Le(p.h2),f.putInt32Le(p.h3),f},i};var o=null,s=null,a=null,c=null,u=!1;function l(e,t,r){for(var n,i,o,u,l,h,p,f=r.length();f>=64;){for(i=e.h0,o=e.h1,u=e.h2,l=e.h3,p=0;p<16;++p)t[p]=r.getInt32Le(),n=i+(l^o&(u^l))+c[p]+t[p],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;for(;p<32;++p)n=i+(u^l&(o^u))+c[p]+t[s[p]],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;for(;p<48;++p)n=i+(o^u^l)+c[p]+t[s[p]],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;for(;p<64;++p)n=i+(u^(o|~l))+c[p]+t[s[p]],i=l,l=u,u=o,o+=n<<(h=a[p])|n>>>32-h;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+u|0,e.h3=e.h3+l|0,f-=64}}},function(e,t,r){var n=r(3);r(102),r(38),r(6);var i,o=n.pkcs5=n.pkcs5||{};n.util.isNodejs&&!n.options.usePureJavaScript&&(i=r(33)),e.exports=n.pbkdf2=o.pbkdf2=function(e,t,r,o,s,a){if("function"==typeof s&&(a=s,s=null),n.util.isNodejs&&!n.options.usePureJavaScript&&i.pbkdf2&&(null===s||"object"!=typeof s)&&(i.pbkdf2Sync.length>4||!s||"sha1"===s))return"string"!=typeof s&&(s="sha1"),e=new Buffer(e,"binary"),t=new Buffer(t,"binary"),a?4===i.pbkdf2Sync.length?i.pbkdf2(e,t,r,o,function(e,t){if(e)return a(e);a(null,t.toString("binary"))}):i.pbkdf2(e,t,r,o,s,function(e,t){if(e)return a(e);a(null,t.toString("binary"))}):4===i.pbkdf2Sync.length?i.pbkdf2Sync(e,t,r,o).toString("binary"):i.pbkdf2Sync(e,t,r,o,s).toString("binary");if(null==s&&(s="sha1"),"string"==typeof s){if(!(s in n.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=n.md[s].create()}var c=s.digestLength;if(o>4294967295*c){var u=new Error("Derived key is too long.");if(a)return a(u);throw u}var l=Math.ceil(o/c),h=o-(l-1)*c,p=n.hmac.create();p.start(s,e);var f,d,g,m="";if(!a){for(var y=1;y<=l;++y){p.start(null,null),p.update(t),p.update(n.util.int32ToBytes(y)),f=g=p.digest().getBytes();for(var v=2;v<=r;++v)p.start(null,null),p.update(g),d=p.digest().getBytes(),f=n.util.xorBytes(f,d,c),g=d;m+=y<l?f:f.substr(0,h)}return m}y=1;function b(){if(y>l)return a(null,m);p.start(null,null),p.update(t),p.update(n.util.int32ToBytes(y)),f=g=p.digest().getBytes(),v=2,_()}function _(){if(v<=r)return p.start(null,null),p.update(g),d=p.digest().getBytes(),f=n.util.xorBytes(f,d,c),g=d,++v,n.util.setImmediate(_);m+=y<l?f:f.substr(0,h),++y,b()}b()}},function(e,t,r){var n=r(3);r(56),r(37),r(121),r(38),r(390),r(57),r(69),r(161),r(122),r(6);var i=n.asn1,o=e.exports=n.pki=n.pki||{},s=o.oids,a={};a.CN=s.commonName,a.commonName="CN",a.C=s.countryName,a.countryName="C",a.L=s.localityName,a.localityName="L",a.ST=s.stateOrProvinceName,a.stateOrProvinceName="ST",a.O=s.organizationName,a.organizationName="O",a.OU=s.organizationalUnitName,a.organizationalUnitName="OU",a.E=s.emailAddress,a.emailAddress="E";var c=n.pki.rsa.publicKeyValidator,u={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},p={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function f(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],t.type&&t.type===r.type?n=r:t.name&&t.name===r.name?n=r:t.shortName&&t.shortName===r.shortName&&(n=r);return n}o.RDNAttributesAsArray=function(e,t){for(var r,n,o,c=[],u=0;u<e.value.length;++u){r=e.value[u];for(var l=0;l<r.value.length;++l)o={},n=r.value[l],o.type=i.derToOid(n.value[0].value),o.value=n.value[1].value,o.valueTagClass=n.value[1].type,o.type in s&&(o.name=s[o.type],o.name in a&&(o.shortName=a[o.name])),t&&(t.update(o.type),t.update(o.value)),c.push(o)}return c},o.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],c=i.derToOid(n.value[0].value),u=n.value[1].value,l=0;l<u.length;++l){var h={};if(h.type=c,h.value=u[l].value,h.valueTagClass=u[l].type,h.type in s&&(h.name=s[h.type],h.name in a&&(h.shortName=a[h.name])),h.type===s.extensionRequest){h.extensions=[];for(var p=0;p<h.value.length;++p)h.extensions.push(o.certificateExtensionFromAsn1(h.value[p]))}t.push(h)}return t};var d=function(e,t,r){var n={};if(e!==s["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:s.sha1},mgf:{algorithmOid:s.mgf1,hash:{algorithmOid:s.sha1}},saltLength:20});var o={},a=[];if(!i.validate(t,l,o,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==o.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=i.derToOid(o.hashOid)),void 0!==o.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=i.derToOid(o.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=i.derToOid(o.maskGenHashOid)),void 0!==o.saltLength&&(n.saltLength=o.saltLength.charCodeAt(0)),n};function g(e){for(var t,r,o=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),s=e.attributes,a=0;a<s.length;++a){var c=(t=s[a]).value,u=i.Type.PRINTABLESTRING;"valueTagClass"in t&&(u=t.valueTagClass)===i.Type.UTF8&&(c=n.util.encodeUtf8(c)),r=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.type).getBytes()),i.create(i.Class.UNIVERSAL,u,!1,c)])]),o.value.push(r)}return o}function m(e){for(var t,r=0;r<e.length;++r){if(void 0===(t=e[r]).name&&(t.type&&t.type in o.oids?t.name=o.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=o.oids[a[t.shortName]])),void 0===t.type){if(!(t.name&&t.name in o.oids))throw(c=new Error("Attribute type not specified.")).attribute=t,c;t.type=o.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===s.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=i.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(o.certificateExtensionToAsn1(y(t.extensions[n])))}var c;if(void 0===t.value)throw(c=new Error("Attribute value not specified.")).attribute=t,c}}function y(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in o.oids&&(e.name=o.oids[e.id]),void 0===e.id){if(!(e.name&&e.name in o.oids))throw(E=new Error("Extension ID not specified.")).extension=e,E;e.id=o.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var r=0,a=0,c=0;e.digitalSignature&&(a|=128,r=7),e.nonRepudiation&&(a|=64,r=6),e.keyEncipherment&&(a|=32,r=5),e.dataEncipherment&&(a|=16,r=4),e.keyAgreement&&(a|=8,r=3),e.keyCertSign&&(a|=4,r=2),e.cRLSign&&(a|=2,r=1),e.encipherOnly&&(a|=1,r=0),e.decipherOnly&&(c|=128,r=7);var u=String.fromCharCode(r);0!==c?u+=String.fromCharCode(a)+String.fromCharCode(c):0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var l=e.value.value;for(var h in e)!0===e[h]&&(h in s?l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s[h]).getBytes())):-1!==h.indexOf(".")&&l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(h).getBytes())))}else if("nsCertType"===e.name){r=0,a=0;e.client&&(a|=128,r=7),e.server&&(a|=64,r=6),e.email&&(a|=32,r=5),e.objsign&&(a|=16,r=4),e.reserved&&(a|=8,r=3),e.sslCA&&(a|=4,r=2),e.emailCA&&(a|=2,r=1),e.objCA&&(a|=1,r=0);u=String.fromCharCode(r);0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var p=0;p<e.altNames.length;++p){u=(v=e.altNames[p]).value;if(7===v.type&&v.ip){if(null===(u=n.util.bytesFromIP(v.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===v.type&&(u=v.oid?i.oidToDer(i.oidToDer(v.oid)):i.oidToDer(u));e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,v.type,!1,u))}}else if("subjectKeyIdentifier"===e.name&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,f.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;if(e.keyIdentifier){var d=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,d))}if(e.authorityCertIssuer){var m=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[g(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];l.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,m))}if(e.serialNumber){var y=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);l.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,y))}}else if("cRLDistributionPoints"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;var v,b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),_=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(p=0;p<e.altNames.length;++p){u=(v=e.altNames[p]).value;if(7===v.type&&v.ip){if(null===(u=n.util.bytesFromIP(v.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===v.type&&(u=v.oid?i.oidToDer(i.oidToDer(v.oid)):i.oidToDer(u));_.value.push(i.create(i.Class.CONTEXT_SPECIFIC,v.type,!1,u))}b.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[_])),l.push(b)}var E;if(void 0===e.value)throw(E=new Error("Extension value not specified.")).extension=e,E;return e}function v(e,t){switch(e){case s["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,r);default:return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}}function b(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,o=0;o<r.length;++o){var s=r[o],a=s.value,c=i.Type.UTF8;"valueTagClass"in s&&(c=s.valueTagClass),c===i.Type.UTF8&&(a=n.util.encodeUtf8(a));var u=!1;"valueConstructed"in s&&(u=s.valueConstructed);var l=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,c,u,a)])]);t.value.push(l)}return t}o.certificateFromPem=function(e,t,r){var s=n.pem.decode(e)[0];if("CERTIFICATE"!==s.type&&"X509 CERTIFICATE"!==s.type&&"TRUSTED CERTIFICATE"!==s.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=s.type,a}if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=i.fromDer(s.body,r);return o.certificateFromAsn1(c,t)},o.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:i.toDer(o.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.publicKeyFromAsn1(s)},o.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:i.toDer(o.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:i.toDer(o.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.getPublicKeyFingerprint=function(e,t){var r,s=(t=t||{}).md||n.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=i.toDer(o.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=i.toDer(o.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}s.start(),s.update(r);var a=s.digest();if("hex"===t.encoding){var c=a.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a},o.certificationRequestFromPem=function(e,t,r){var s=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==s.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=s.type,a}if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=i.fromDer(s.body,r);return o.certificationRequestFromAsn1(c,t)},o.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:i.toDer(o.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return f(e.issuer,t)},e.issuer.addField=function(t){m([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){m([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){m(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){m(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)y(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,i=0;null===n&&i<e.extensions.length;++i)r=e.extensions[i],t.id&&r.id===t.id?n=r:t.name&&r.name===t.name&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=s[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=o.getTBSCertificate(e);var u=i.toDer(e.tbsCertificate);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var a=t.issuer,c=e.subject;throw(g=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.")).expectedIssuer=a.attributes,g.actualIssuer=c.attributes,g}var u=t.md;if(null===u){if(t.signatureOid in s)switch(s[t.signatureOid]){case"sha1WithRSAEncryption":u=n.md.sha1.create();break;case"md5WithRSAEncryption":u=n.md.md5.create();break;case"sha256WithRSAEncryption":u=n.md.sha256.create();break;case"sha384WithRSAEncryption":u=n.md.sha384.create();break;case"sha512WithRSAEncryption":u=n.md.sha512.create();break;case"RSASSA-PSS":u=n.md.sha256.create()}if(null===u)throw(g=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=t.signatureOid,g;var l=t.tbsCertificate||o.getTBSCertificate(t),h=i.toDer(l);u.update(h.getBytes())}if(null!==u){var p;switch(t.signatureOid){case s.sha1WithRSAEncryption:p=void 0;break;case s["RSASSA-PSS"]:var f,d,g;if(void 0===(f=s[t.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[f])throw(g=new Error("Unsupported MGF hash function.")).oid=t.signatureParameters.mgf.hash.algorithmOid,g.name=f,g;if(void 0===(d=s[t.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[d])throw(g=new Error("Unsupported MGF function.")).oid=t.signatureParameters.mgf.algorithmOid,g.name=d,g;if(d=n.mgf[d].create(n.md[f].create()),void 0===(f=s[t.signatureParameters.hash.algorithmOid])||void 0===n.md[f])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:f};p=n.pss.create(n.md[f].create(),d,t.signatureParameters.saltLength)}r=e.publicKey.verify(u.digest().getBytes(),t.signature,p)}return r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){var o,s;r=!0;for(var a=0;r&&a<n.attributes.length;++a)o=n.attributes[a],s=i.attributes[a],o.type===s.type&&o.value===s.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return o.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=s.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var o=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(i.subjectKeyIdentifier)===o}}return!1},e},o.certificateFromAsn1=function(e,t){var r={},a=[];if(!i.validate(e,u,r,a))throw(p=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.")).errors=a,p;if(i.derToOid(r.publicKeyOid)!==o.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=o.createCertificate();c.version=r.certVersion?r.certVersion.charCodeAt(0):0;var l=n.util.createBuffer(r.certSerialNumber);c.serialNumber=l.toHex(),c.signatureOid=n.asn1.derToOid(r.certSignatureOid),c.signatureParameters=d(c.signatureOid,r.certSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),c.siginfo.parameters=d(c.siginfo.algorithmOid,r.certinfoSignatureParams,!1),c.signature=r.certSignature;var h=[];if(void 0!==r.certValidity1UTCTime&&h.push(i.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&h.push(i.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity4GeneralizedTime)),h.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(h.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(c.validity.notBefore=h[0],c.validity.notAfter=h[1],c.tbsCertificate=r.tbsCertificate,t){var p;if(c.md=null,c.signatureOid in s)switch(s[c.signatureOid]){case"sha1WithRSAEncryption":c.md=n.md.sha1.create();break;case"md5WithRSAEncryption":c.md=n.md.md5.create();break;case"sha256WithRSAEncryption":c.md=n.md.sha256.create();break;case"sha384WithRSAEncryption":c.md=n.md.sha384.create();break;case"sha512WithRSAEncryption":c.md=n.md.sha512.create();break;case"RSASSA-PSS":c.md=n.md.sha256.create()}if(null===c.md)throw(p=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=c.signatureOid,p;var g=i.toDer(c.tbsCertificate);c.md.update(g.getBytes())}var y=n.md.sha1.create();c.issuer.getField=function(e){return f(c.issuer,e)},c.issuer.addField=function(e){m([e]),c.issuer.attributes.push(e)},c.issuer.attributes=o.RDNAttributesAsArray(r.certIssuer,y),r.certIssuerUniqueId&&(c.issuer.uniqueId=r.certIssuerUniqueId),c.issuer.hash=y.digest().toHex();var v=n.md.sha1.create();return c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){m([e]),c.subject.attributes.push(e)},c.subject.attributes=o.RDNAttributesAsArray(r.certSubject,v),r.certSubjectUniqueId&&(c.subject.uniqueId=r.certSubjectUniqueId),c.subject.hash=v.digest().toHex(),r.certExtensions?c.extensions=o.certificateExtensionsFromAsn1(r.certExtensions):c.extensions=[],c.publicKey=o.publicKeyFromAsn1(r.subjectPublicKeyInfo),c},o.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(o.certificateExtensionFromAsn1(n.value[i]));return t},o.certificateExtensionFromAsn1=function(e){var t={};if(t.id=i.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===i.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in s)if(t.name=s[t.id],"keyUsage"===t.name){var r=0,o=0;(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1),o=c.value.length>2?c.value.charCodeAt(2):0),t.digitalSignature=128==(128&r),t.nonRepudiation=64==(64&r),t.keyEncipherment=32==(32&r),t.dataEncipherment=16==(16&r),t.keyAgreement=8==(8&r),t.keyCertSign=4==(4&r),t.cRLSign=2==(2&r),t.encipherOnly=1==(1&r),t.decipherOnly=128==(128&o)}else if("basicConstraints"===t.name){(c=i.fromDer(t.value)).value.length>0&&c.value[0].type===i.Type.BOOLEAN?t.cA=0!==c.value[0].value.charCodeAt(0):t.cA=!1;var a=null;c.value.length>0&&c.value[0].type===i.Type.INTEGER?a=c.value[0].value:c.value.length>1&&(a=c.value[1].value),null!==a&&(t.pathLenConstraint=i.derToInteger(a))}else if("extKeyUsage"===t.name)for(var c=i.fromDer(t.value),u=0;u<c.value.length;++u){var l=i.derToOid(c.value[u].value);l in s?t[s[l]]=!0:t[l]=!0}else if("nsCertType"===t.name){r=0;(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1)),t.client=128==(128&r),t.server=64==(64&r),t.email=32==(32&r),t.objsign=16==(16&r),t.reserved=8==(8&r),t.sslCA=4==(4&r),t.emailCA=2==(2&r),t.objCA=1==(1&r)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var h;t.altNames=[];c=i.fromDer(t.value);for(var p=0;p<c.value.length;++p){var f={type:(h=c.value[p]).type,value:h.value};switch(t.altNames.push(f),h.type){case 1:case 2:case 6:break;case 7:f.ip=n.util.bytesToIP(h.value);break;case 8:f.oid=i.derToOid(h.value)}}}else if("subjectKeyIdentifier"===t.name){c=i.fromDer(t.value);t.subjectKeyIdentifier=n.util.bytesToHex(c.value)}return t},o.certificationRequestFromAsn1=function(e,t){var r={},a=[];if(!i.validate(e,p,r,a))throw(u=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.")).errors=a,u;if(i.derToOid(r.publicKeyOid)!==o.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=o.createCertificationRequest();if(c.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,c.signatureOid=n.asn1.derToOid(r.csrSignatureOid),c.signatureParameters=d(c.signatureOid,r.csrSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),c.siginfo.parameters=d(c.siginfo.algorithmOid,r.csrSignatureParams,!1),c.signature=r.csrSignature,c.certificationRequestInfo=r.certificationRequestInfo,t){var u;if(c.md=null,c.signatureOid in s)switch(s[c.signatureOid]){case"sha1WithRSAEncryption":c.md=n.md.sha1.create();break;case"md5WithRSAEncryption":c.md=n.md.md5.create();break;case"sha256WithRSAEncryption":c.md=n.md.sha256.create();break;case"sha384WithRSAEncryption":c.md=n.md.sha384.create();break;case"sha512WithRSAEncryption":c.md=n.md.sha512.create();break;case"RSASSA-PSS":c.md=n.md.sha256.create()}if(null===c.md)throw(u=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=c.signatureOid,u;var l=i.toDer(c.certificationRequestInfo);c.md.update(l.getBytes())}var h=n.md.sha1.create();return c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){m([e]),c.subject.attributes.push(e)},c.subject.attributes=o.RDNAttributesAsArray(r.certificationRequestInfoSubject,h),c.subject.hash=h.digest().toHex(),c.publicKey=o.publicKeyFromAsn1(r.subjectPublicKeyInfo),c.getAttribute=function(e){return f(c,e)},c.addAttribute=function(e){m([e]),c.attributes.push(e)},c.attributes=o.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),c},o.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){m([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return f(e,t)},e.addAttribute=function(t){m([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){m(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){m(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=s[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=o.getCertificationRequestInfo(e);var u=i.toDer(e.certificationRequestInfo);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){if(e.signatureOid in s)switch(s[e.signatureOid]){case"sha1WithRSAEncryption":r=n.md.sha1.create();break;case"md5WithRSAEncryption":r=n.md.md5.create();break;case"sha256WithRSAEncryption":r=n.md.sha256.create();break;case"sha384WithRSAEncryption":r=n.md.sha384.create();break;case"sha512WithRSAEncryption":r=n.md.sha512.create();break;case"RSASSA-PSS":r=n.md.sha256.create()}if(null===r)throw(p=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=e.signatureOid,p;var a=e.certificationRequestInfo||o.getCertificationRequestInfo(e),c=i.toDer(a);r.update(c.getBytes())}if(null!==r){var u;switch(e.signatureOid){case s.sha1WithRSAEncryption:break;case s["RSASSA-PSS"]:var l,h,p;if(void 0===(l=s[e.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[l])throw(p=new Error("Unsupported MGF hash function.")).oid=e.signatureParameters.mgf.hash.algorithmOid,p.name=l,p;if(void 0===(h=s[e.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[h])throw(p=new Error("Unsupported MGF function.")).oid=e.signatureParameters.mgf.algorithmOid,p.name=h,p;if(h=n.mgf[h].create(n.md[l].create()),void 0===(l=s[e.signatureParameters.hash.algorithmOid])||void 0===n.md[l])throw(p=new Error("Unsupported RSASSA-PSS hash function.")).oid=e.signatureParameters.hash.algorithmOid,p.name=l,p;u=n.pss.create(n.md[l].create(),h,e.signatureParameters.saltLength)}t=e.publicKey.verify(r.digest().getBytes(),e.signature,u)}return t},e},o.getTBSCertificate=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.siginfo.algorithmOid).getBytes()),v(e.siginfo.algorithmOid,e.siginfo.parameters)]),g(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e.validity.notBefore)),i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e.validity.notAfter))]),g(e.subject),o.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&t.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&t.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&t.value.push(o.certificateExtensionsToAsn1(e.extensions)),t},o.getCertificationRequestInfo=function(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),g(e.subject),o.publicKeyToAsn1(e.publicKey),b(e)])},o.distinguishedNameToAsn1=function(e){return g(e)},o.certificateToAsn1=function(e){var t=e.tbsCertificate||o.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},o.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),r=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(o.certificateExtensionToAsn1(e[n]));return t},o.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.id).getBytes())),e.critical&&t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=i.toDer(r).getBytes()),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)),t},o.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||o.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},o.createCaStore=function(e){var t={certs:{}};function r(e){return s(e),t.certs[e.hash]||null}function s(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=o.RDNAttributesAsArray(g(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),s(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var s=i.toDer(o.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){if(s===i.toDer(o.certificateToAsn1(t[a])).getBytes())return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var i=t.certs[r];if(n.util.isArray(i))for(var o=0;o<i.length;++o)e.push(i[o]);else e.push(i)}return e},t.removeCertificate=function(e){var a;if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),s(e.subject),!t.hasCertificate(e))return null;var c=r(e.subject);if(!n.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var u=i.toDer(o.certificateToAsn1(e)).getBytes(),l=0;l<c.length;++l){u===i.toDer(o.certificateToAsn1(c[l])).getBytes()&&(a=c[l],c.splice(l,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},o.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},o.verifyCertificateChain=function(e,t,r){var i=(t=t.slice(0)).slice(0),s=new Date,a=!0,c=null,u=0;do{var l=t.shift(),h=null,p=!1;if((s<l.validity.notBefore||s>l.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:o.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:s}),null===c){if(null===(h=t[0]||e.getIssuer(l))&&l.isIssuer(l)&&(p=!0,h=l),h){var f=h;n.util.isArray(f)||(f=[f]);for(var d=!1;!d&&f.length>0;){h=f.shift();try{d=h.verify(l)}catch(e){}}d||(c={message:"Certificate signature is invalid.",error:o.certificateError.bad_certificate})}null!==c||h&&!p||e.hasCertificate(l)||(c={message:"Certificate is not trusted.",error:o.certificateError.unknown_ca})}if(null===c&&h&&!l.isIssuer(h)&&(c={message:"Certificate issuer is invalid.",error:o.certificateError.bad_certificate}),null===c)for(var g={keyUsage:!0,basicConstraints:!0},m=0;null===c&&m<l.extensions.length;++m){var y=l.extensions[m];!y.critical||y.name in g||(c={message:"Certificate has an unsupported critical extension.",error:o.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!h||p))){var v=l.getExtension("basicConstraints"),b=l.getExtension("keyUsage");if(null!==b&&(b.keyCertSign&&null!==v||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:o.certificateError.bad_certificate})),null!==c||null===v||v.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:o.certificateError.bad_certificate}),null===c&&null!==b&&"pathLenConstraint"in v)u-1>v.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:o.certificateError.bad_certificate})}var _=null===c||c.error,E=r?r(_,u,i):_;if(!0!==E)throw!0===_&&(c={message:"The application rejected the certificate.",error:o.certificateError.bad_certificate}),(E||0===E)&&("object"!=typeof E||n.util.isArray(E)?"string"==typeof E&&(c.error=E):(E.message&&(c.message=E.message),E.error&&(c.error=E.error))),c;c=null,a=!1,++u}while(t.length>0);return!0}},function(e,t,r){var n=r(3);r(22),r(6),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,i=e.mgf,o=r.digestLength,s=e.salt||null;if("string"==typeof s&&(s=n.util.createBuffer(s)),"saltLength"in e)t=e.saltLength;else{if(null===s)throw new Error("Salt length not specified or specific salt not given.");t=s.length()}if(null!==s&&s.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||n.random,c={encode:function(e,c){var u,l,h=c-1,p=Math.ceil(h/8),f=e.digest().getBytes();if(p<o+t+2)throw new Error("Message is too long to encrypt.");l=null===s?a.getBytesSync(t):s.bytes();var d=new n.util.ByteBuffer;d.fillWithByte(0,8),d.putBytes(f),d.putBytes(l),r.start(),r.update(d.getBytes());var g=r.digest().getBytes(),m=new n.util.ByteBuffer;m.fillWithByte(0,p-t-o-2),m.putByte(1),m.putBytes(l);var y=m.getBytes(),v=p-o-1,b=i.generate(g,v),_="";for(u=0;u<v;u++)_+=String.fromCharCode(y.charCodeAt(u)^b.charCodeAt(u));var E=65280>>8*p-h&255;return(_=String.fromCharCode(_.charCodeAt(0)&~E)+_.substr(1))+g+String.fromCharCode(188)},verify:function(e,s,a){var c,u=a-1,l=Math.ceil(u/8);if(s=s.substr(-l),l<o+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==s.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var h=l-o-1,p=s.substr(0,h),f=s.substr(h,o),d=65280>>8*l-u&255;if(0!=(p.charCodeAt(0)&d))throw new Error("Bits beyond keysize not zero as expected.");var g=i.generate(f,h),m="";for(c=0;c<h;c++)m+=String.fromCharCode(p.charCodeAt(c)^g.charCodeAt(c));m=String.fromCharCode(m.charCodeAt(0)&~d)+m.substr(1);var y=l-o-t-2;for(c=0;c<y;c++)if(0!==m.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==m.charCodeAt(y))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var v=m.substr(-t),b=new n.util.ByteBuffer;return b.fillWithByte(0,8),b.putBytes(e),b.putBytes(v),r.start(),r.update(b.getBytes()),f===r.digest().getBytes()}};return c}},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2015 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(16),i=r(407),o=r(70),s=r(106),a=r(105),c=r(73),u=r(12).EventEmitter,l=r(9),h=l.Readable,p=l.Writable,f=l.Duplex,d=c.methodTypes,g=r(4);r(274).version;function m(e){u.call(this),this.call=e}function y(e){p.call(this,{objectMode:!0}),this.call=e;var t=this;this.on("finish",function(){t.call.halfClose()})}function v(e,t,r){var n=this;if(this.writeFailed)setImmediate(r);else{var i={encoding:t,callback:function(e,t){e&&(n.writeFailed=!0),r()}};this.call.sendMessageWithContext(i,e)}}function b(e){h.call(this,{objectMode:!0}),this.call=e,this.finished=!1,this.reading=!1,this.read_status=null,this.received_status=null}function _(e){e||(e={code:c.status.OK,details:"OK"}),e.code!==c.status.OK&&this.call.cancelWithStatus(e.code,e.details),this.finished=!0,this.read_status=e,this._emitStatusIfDone()}function E(e){this.received_status=e,this._emitStatusIfDone()}function C(){var e;if(this.read_status&&this.received_status){if((e=this.read_status.code!==c.status.OK?this.read_status:this.received_status).code===c.status.OK)this.push(null);else{var t=s.createStatusError(e);this.emit("error",t)}this.emit("status",e)}}function w(e){if(this.finished)this.push(null);else if(!this.reading){this.reading=!0;var t={stream:this};this.call.recvMessageWithContext(t)}}function S(e){f.call(this,{objectMode:!0}),this.call=e,this.read_status=null,this.received_status=null;var t=this;this.on("finish",function(){t.call.halfClose()})}function T(){this.call.cancel()}function A(){return this.call.getPeer()}function I(e,t,r){var s=this;if(r||(r={}),n.isArray(r.interceptor_providers)&&n.isArray(r.interceptors))throw new i.InterceptorConfigurationError("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");s.$interceptors=r.interceptors||[],s.$interceptor_providers=r.interceptor_providers||[],n.each(s.$method_definitions,function(e,t){s[t].interceptors=i.resolveInterceptorProviders(s.$interceptor_providers,e).concat(s.$interceptors)}),this.$callInvocationTransformer=r.callInvocationTransformer;let a=r.channelOverride,c=r.channelFactoryOverride;var u=n.omit(r,["interceptors","interceptor_providers","channelOverride","channelFactoryOverride","callInvocationTransformer"]);this.$channel=a?r.channelOverride:c?c(e,t,u):new o.Channel(e,t,u)}g.inherits(m,u),g.inherits(y,p),y.prototype._write=v,g.inherits(b,h),b.prototype._readsDone=_,b.prototype._receiveStatus=E,b.prototype._emitStatusIfDone=C,b.prototype._read=w,g.inherits(S,f),S.prototype._readsDone=_,S.prototype._receiveStatus=E,S.prototype._emitStatusIfDone=C,S.prototype._read=w,S.prototype._write=v,m.prototype.cancel=T,b.prototype.cancel=T,y.prototype.cancel=T,S.prototype.cancel=T,m.prototype.getPeer=A,b.prototype.getPeer=A,y.prototype.getPeer=A,S.prototype.getPeer=A,t.Client=I,I.prototype.resolveCallInterceptors=function(e,t,r){if(n.isArray(t)&&n.isArray(r))throw new i.InterceptorConfigurationError("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");return n.isArray(t)||n.isArray(r)?(t=t||[],r=r||[],i.resolveInterceptorProviders(r,e).concat(t)):i.resolveInterceptorProviders(this.$interceptor_providers,e).concat(this.$interceptors)},I.prototype.makeUnaryRequest=function(e,t,r,o,s,c,u){if(n.isFunction(c)?(u=c,s instanceof a?c={}:(c=s,s=new a)):n.isFunction(s)&&(u=s,s=new a,c={}),s||(s=new a),c||(c={}),!(s instanceof a&&c instanceof Object&&n.isFunction(u)))throw new Error("Argument mismatch in makeUnaryRequest");var l=c.method_definition={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:r},h={argument:o,metadata:s=s.clone(),call:new m,channel:this.$channel,methodDefinition:l,callOptions:c,callback:u};this.$callInvocationTransformer&&(h=this.$callInvocationTransformer(h));var p=h.callOptions,f=h.methodDefinition,d=I.prototype.resolveCallInterceptors.call(this,f,p.interceptors,p.interceptor_providers),g=i.getInterceptingCall(f,p,d,h.channel,h.callback),y=h.call;y.call=g;var v=i.getLastListener(f,y,h.callback);return g.start(h.metadata,v),g.sendMessage(h.argument),g.halfClose(),y},I.prototype.makeClientStreamRequest=function(e,t,r,o,s,c){if(n.isFunction(s)?(c=s,o instanceof a?s={}:(s=o,o=new a)):n.isFunction(o)&&(c=o,o=new a,s={}),o||(o=new a),s||(s={}),!(o instanceof a&&s instanceof Object&&n.isFunction(c)))throw new Error("Argument mismatch in makeClientStreamRequest");var u=s.method_definition={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:r},l={metadata:o=o.clone(),call:new y,channel:this.$channel,methodDefinition:u,callOptions:s,callback:c};this.$callInvocationTransformer&&(l=this.$callInvocationTransformer(l));var h=l.callOptions,p=l.methodDefinition,f=I.prototype.resolveCallInterceptors.call(this,p,h.interceptors,h.interceptor_providers),d=i.getInterceptingCall(p,h,f,l.channel,l.callback),g=l.call;g.call=d;var m=i.getLastListener(p,g,l.callback);return d.start(l.metadata,m),g},I.prototype.makeServerStreamRequest=function(e,t,r,n,o,s){if(o instanceof a||(s=o,o=new a),s instanceof Object||(s={}),!(o instanceof a&&s instanceof Object))throw new Error("Argument mismatch in makeServerStreamRequest");var c=s.method_definition={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:r},u={argument:n,metadata:o=o.clone(),call:new b,channel:this.$channel,methodDefinition:c,callOptions:s};this.$callInvocationTransformer&&(u=this.$callInvocationTransformer(u));var l=u.callOptions,h=u.methodDefinition,p=I.prototype.resolveCallInterceptors.call(this,h,l.interceptors,l.interceptor_providers),f=u.call,d=i.getInterceptingCall(h,l,p,u.channel,f);f.call=d;var g=i.getLastListener(h,f);return d.start(u.metadata,g),d.sendMessage(u.argument),d.halfClose(),f},I.prototype.makeBidiStreamRequest=function(e,t,r,n,o){if(n instanceof a||(o=n,n=new a),o instanceof Object||(o={}),!(n instanceof a&&o instanceof Object))throw new Error("Argument mismatch in makeBidiStreamRequest");var s=o.method_definition={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:r},c={metadata:n=n.clone(),call:new S,channel:this.$channel,methodDefinition:s,callOptions:o};this.$callInvocationTransformer&&(c=this.$callInvocationTransformer(c));var u=c.callOptions,l=c.methodDefinition,h=I.prototype.resolveCallInterceptors.call(this,l,u.interceptors,u.interceptor_providers),p=c.call,f=i.getInterceptingCall(l,u,h,c.channel,p);p.call=f;var d=i.getLastListener(l,p);return f.start(c.metadata,d),p},I.prototype.close=function(){this.$channel.close()},I.prototype.getChannel=function(){return this.$channel},I.prototype.waitForReady=function(e,t){var r=this,n=function(i){if(i)t(new Error("Failed to connect before the deadline"));else{var s;try{s=r.$channel.getConnectivityState(!0)}catch(e){return void t(new Error("The channel has been closed"))}if(s===o.connectivityState.READY)t();else if(s===o.connectivityState.FATAL_FAILURE)t(new Error("Failed to connect to server"));else try{r.$channel.watchConnectivityState(s,e,n)}catch(e){t(new Error("The channel has been closed"))}}};o.forcePoll(),setImmediate(n)};var N={[d.UNARY]:I.prototype.makeUnaryRequest,[d.CLIENT_STREAMING]:I.prototype.makeClientStreamRequest,[d.SERVER_STREAMING]:I.prototype.makeServerStreamRequest,[d.BIDI_STREAMING]:I.prototype.makeBidiStreamRequest};function k(e,t){var r={};return r.metadata=e||new a,r.options=t||{},r}var R={[d.UNARY]:function(e){return function(t,r,n,i){var o=k(n,i);return e.call(this,t,o.metadata,o.options,r)}},[d.CLIENT_STREAMING]:function(e){return function(t,r,n){var i=k(r,n);return e.call(this,i.metadata,i.options,t)}},[d.SERVER_STREAMING]:n.identity,[d.BIDI_STREAMING]:n.identity};t.makeClientConstructor=function(e,t,r){function i(e,t,r){I.call(this,e,t,r)}return r||(r={}),g.inherits(i,I),i.prototype.$method_definitions=e,i.prototype.$method_names={},n.each(e,function(e,t){if(n.startsWith(t,"$"))throw new Error("Method names cannot start with $");var o=s.getMethodType(e),a=n.partial(N[o],e.path,e.requestSerialize,e.responseDeserialize);r.deprecatedArgumentOrder?i.prototype[t]=R[o](a):i.prototype[t]=a,i.prototype.$method_names[e.path]=t,n.assign(i.prototype[t],e),e.originalName&&(i.prototype[e.originalName]=i.prototype[t])}),i.service=e,i},t.getClientChannel=function(e){return I.prototype.getChannel.call(e)},t.getClientInterceptors=function(e){return n.mapValues(e.$method_definitions,function(t,r){return e[r].interceptors})},t.waitForClientReady=function(e,t,r){I.prototype.waitForReady.call(e,t,r)},t.StatusBuilder=i.StatusBuilder,t.ListenerBuilder=i.ListenerBuilder,t.RequesterBuilder=i.RequesterBuilder,t.InterceptingCall=i.InterceptingCall},function(e,t,r){e.exports=d,d.Minimatch=g;var n={sep:"/"};try{n=r(7)}catch(e){}var i=d.GLOBSTAR=g.GLOBSTAR={},o=r(414),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="[^/]",c=a+"*?",u="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",l="(?:(?!(?:\\/|^)\\.).)*?",h="().*{}+?[]^$\\!".split("").reduce(function(e,t){return e[t]=!0,e},{});var p=/\/+/;function f(e,t){e=e||{},t=t||{};var r={};return Object.keys(t).forEach(function(e){r[e]=t[e]}),Object.keys(e).forEach(function(t){r[t]=e[t]}),r}function d(e,t,r){if("string"!=typeof t)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new g(t,r).match(e))}function g(e,t){if(!(this instanceof g))return new g(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==n.sep&&(e=e.split(n.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function m(e,t){if(t||(t=this instanceof g?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:o(e)}d.filter=function(e,t){return t=t||{},function(r,n,i){return d(r,e,t)}},d.defaults=function(e){if(!e||!Object.keys(e).length)return d;var t=d,r=function(r,n,i){return t.minimatch(r,n,f(e,i))};return r.Minimatch=function(r,n){return new t.Minimatch(r,f(e,n))},r},g.defaults=function(e){return e&&Object.keys(e).length?d.defaults(e).Minimatch:g},g.prototype.debug=function(){},g.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map(function(e){return e.split(p)}),this.debug(this.pattern,r),r=r.map(function(e,t,r){return e.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(e){return-1===e.indexOf(!1)}),this.debug(this.pattern,r),this.set=r},g.prototype.parseNegate=function(){var e=this.pattern,t=!1,r=this.options,n=0;if(r.nonegate)return;for(var i=0,o=e.length;i<o&&"!"===e.charAt(i);i++)t=!t,n++;n&&(this.pattern=e.substr(n));this.negate=t},d.braceExpand=function(e,t){return m(e,t)},g.prototype.braceExpand=m,g.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===e)return i;if(""===e)return"";var n,o="",u=!!r.nocase,l=!1,p=[],f=[],d=!1,g=-1,m=-1,v="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",b=this;function _(){if(n){switch(n){case"*":o+=c,u=!0;break;case"?":o+=a,u=!0;break;default:o+="\\"+n}b.debug("clearStateChar %j %j",n,o),n=!1}}for(var E,C=0,w=e.length;C<w&&(E=e.charAt(C));C++)if(this.debug("%s\t%s %s %j",e,C,o,E),l&&h[E])o+="\\"+E,l=!1;else switch(E){case"/":return!1;case"\\":_(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,C,o,E),d){this.debug("  in class"),"!"===E&&C===m+1&&(E="^"),o+=E;continue}b.debug("call clearStateChar %j",n),_(),n=E,r.noext&&_();continue;case"(":if(d){o+="(";continue}if(!n){o+="\\(";continue}p.push({type:n,start:C-1,reStart:o.length,open:s[n].open,close:s[n].close}),o+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,o),n=!1;continue;case")":if(d||!p.length){o+="\\)";continue}_(),u=!0;var S=p.pop();o+=S.close,"!"===S.type&&f.push(S),S.reEnd=o.length;continue;case"|":if(d||!p.length||l){o+="\\|",l=!1;continue}_(),o+="|";continue;case"[":if(_(),d){o+="\\"+E;continue}d=!0,m=C,g=o.length,o+=E;continue;case"]":if(C===m+1||!d){o+="\\"+E,l=!1;continue}if(d){var T=e.substring(m+1,C);try{RegExp("["+T+"]")}catch(e){var A=this.parse(T,y);o=o.substr(0,g)+"\\["+A[0]+"\\]",u=u||A[1],d=!1;continue}}u=!0,d=!1,o+=E;continue;default:_(),l?l=!1:!h[E]||"^"===E&&d||(o+="\\"),o+=E}d&&(T=e.substr(m+1),A=this.parse(T,y),o=o.substr(0,g)+"\\["+A[0],u=u||A[1]);for(S=p.pop();S;S=p.pop()){var I=o.slice(S.reStart+S.open.length);this.debug("setting tail",o,S),I=I.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(e,t,r){return r||(r="\\"),t+t+r+"|"}),this.debug("tail=%j\n   %s",I,I,S,o);var N="*"===S.type?c:"?"===S.type?a:"\\"+S.type;u=!0,o=o.slice(0,S.reStart)+N+"\\("+I}_(),l&&(o+="\\\\");var k=!1;switch(o.charAt(0)){case".":case"[":case"(":k=!0}for(var R=f.length-1;R>-1;R--){var O=f[R],x=o.slice(0,O.reStart),B=o.slice(O.reStart,O.reEnd-8),D=o.slice(O.reEnd-8,O.reEnd),P=o.slice(O.reEnd);D+=P;var L=x.split("(").length-1,j=P;for(C=0;C<L;C++)j=j.replace(/\)[+*?]?/,"");var U="";""===(P=j)&&t!==y&&(U="$");var M=x+B+P+U+D;o=M}""!==o&&u&&(o="(?=.)"+o);k&&(o=v+o);if(t===y)return[o,u];if(!u)return e.replace(/\\(.)/g,"$1");var F=r.nocase?"i":"";try{var V=new RegExp("^"+o+"$",F)}catch(e){return new RegExp("$.")}return V._glob=e,V._src=o,V};var y={};d.makeRe=function(e,t){return new g(e,t||{}).makeRe()},g.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?c:t.dot?u:l,n=t.nocase?"i":"",o=e.map(function(e){return e.map(function(e){return e===i?r:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src}).join("\\/")}).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,n)}catch(e){this.regexp=!1}return this.regexp},d.match=function(e,t,r){var n=new g(t,r=r||{});return e=e.filter(function(e){return n.match(e)}),n.options.nonull&&!e.length&&e.push(t),e},g.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var r=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/"));e=e.split(p),this.debug(this.pattern,"split",e);var i,o,s=this.set;for(this.debug(this.pattern,"set",s),o=e.length-1;o>=0&&!(i=e[o]);o--);for(o=0;o<s.length;o++){var a=s[o],c=e;r.matchBase&&1===a.length&&(c=[i]);var u=this.matchOne(c,a,t);if(u)return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},g.prototype.matchOne=function(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,s=0,a=e.length,c=t.length;o<a&&s<c;o++,s++){this.debug("matchOne loop");var u,l=t[s],h=e[o];if(this.debug(t,l,h),!1===l)return!1;if(l===i){this.debug("GLOBSTAR",[t,l,h]);var p=o,f=s+1;if(f===c){for(this.debug("** at the end");o<a;o++)if("."===e[o]||".."===e[o]||!n.dot&&"."===e[o].charAt(0))return!1;return!0}for(;p<a;){var d=e[p];if(this.debug("\nglobstar while",e,p,t,f,d),this.matchOne(e.slice(p),t.slice(f),r))return this.debug("globstar found match!",p,a,d),!0;if("."===d||".."===d||!n.dot&&"."===d.charAt(0)){this.debug("dot detected!",e,p,t,f);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!r||(this.debug("\n>>> no match, partial?",e,p,t,f),p!==a))}if("string"==typeof l?(u=n.nocase?h.toLowerCase()===l.toLowerCase():h===l,this.debug("string match",l,h,u)):(u=h.match(l),this.debug("pattern match",l,h,u)),!u)return!1}if(o===a&&s===c)return!0;if(o===a)return r;if(s===c)return o===a-1&&""===e[o];throw new Error("wtf?")}},function(e,t,r){"use strict";function n(e){return"/"===e.charAt(0)}function i(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),r=t[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(t[2]||n)}e.exports="win32"===process.platform?i:n,e.exports.posix=n,e.exports.win32=i},function(e,t,r){"use strict";var n=r(4),i=r(261),o=e.exports=function(e,t){i.call(this,e),this.workDone=0,this.workTodo=t||0};n.inherits(o,i),o.prototype.completed=function(){return 0===this.workTodo?0:this.workDone/this.workTodo},o.prototype.addWork=function(e){this.workTodo+=e,this.emit("change",this.name,this.completed(),this)},o.prototype.completeWork=function(e){this.workDone+=e,this.workDone>this.workTodo&&(this.workDone=this.workTodo),this.emit("change",this.name,this.completed(),this)},o.prototype.finish=function(){this.workTodo=this.workDone=1,this.emit("change",this.name,1,this)}},function(e,t,r){"use strict";t.up=function(e){return"["+(e||"")+"A"},t.down=function(e){return"["+(e||"")+"B"},t.forward=function(e){return"["+(e||"")+"C"},t.back=function(e){return"["+(e||"")+"D"},t.nextLine=function(e){return"["+(e||"")+"E"},t.previousLine=function(e){return"["+(e||"")+"F"},t.horizontalAbsolute=function(e){if(null==e)throw new Error("horizontalAboslute requires a column to position to");return"["+e+"G"},t.eraseData=function(){return"[J"},t.eraseLine=function(){return"[K"},t.goto=function(e,t){return"["+t+";"+e+"H"},t.gotoSOL=function(){return"\r"},t.beep=function(){return""},t.hideCursor=function(){return"[?25l"},t.showCursor=function(){return"[?25h"};var n={reset:0,bold:1,italic:3,underline:4,inverse:7,stopBold:22,stopItalic:23,stopUnderline:24,stopInverse:27,white:37,black:30,blue:34,cyan:36,green:32,magenta:35,red:31,yellow:33,bgWhite:47,bgBlack:40,bgBlue:44,bgCyan:46,bgGreen:42,bgMagenta:45,bgRed:41,bgYellow:43,grey:90,brightBlack:90,brightRed:91,brightGreen:92,brightYellow:93,brightBlue:94,brightMagenta:95,brightCyan:96,brightWhite:97,bgGrey:100,bgBrightBlack:100,bgBrightRed:101,bgBrightGreen:102,bgBrightYellow:103,bgBrightBlue:104,bgBrightMagenta:105,bgBrightCyan:106,bgBrightWhite:107};function i(e){if(null!=n[e])return n[e];throw new Error("Unknown color or style name: "+e)}t.color=function(e){return 1===arguments.length&&Array.isArray(e)||(e=Array.prototype.slice.call(arguments)),"["+e.map(i).join(";")+"m"}},function(e,t,r){"use strict";var n={"*":{label:"any",check:function(){return!0}},A:{label:"array",check:function(e){return Array.isArray(e)||function(e){return null!=e&&"object"==typeof e&&e.hasOwnProperty("callee")}(e)}},S:{label:"string",check:function(e){return"string"==typeof e}},N:{label:"number",check:function(e){return"number"==typeof e}},F:{label:"function",check:function(e){return"function"==typeof e}},O:{label:"object",check:function(e){return"object"==typeof e&&null!=e&&!n.A.check(e)&&!n.E.check(e)}},B:{label:"boolean",check:function(e){return"boolean"==typeof e}},E:{label:"error",check:function(e){return e instanceof Error}},Z:{label:"null",check:function(e){return null==e}}};function i(e,t){var r=t[e.length]=t[e.length]||[];-1===r.indexOf(e)&&r.push(e)}var o=e.exports=function(e,t){if(2!==arguments.length)throw l(["SA"],arguments.length);if(!e)throw s(0);if(!t)throw s(1);if(!n.S.check(e))throw c(0,["string"],e);if(!n.A.check(t))throw c(1,["array"],t);var r=e.split("|"),o={};r.forEach(function(e){for(var t=0;t<e.length;++t){var r=e[t];if(!n[r])throw a(t,r)}if(/E.*E/.test(e))throw function(e){return h("ETOOMANYERRORTYPES",'Only one error type per argument signature is allowed, more than one found in "'+e+'"')}(e);i(e,o),/E/.test(e)&&(i(e.replace(/E.*$/,"E"),o),i(e.replace(/E/,"Z"),o),1===e.length&&i("",o))});var u=o[t.length];if(!u)throw l(Object.keys(o),t.length);for(var p=0;p<t.length;++p){var f=u.filter(function(e){var r=e[p];return(0,n[r].check)(t[p])});if(!f.length){var d=u.map(function(e){return n[e[p]].label}).filter(function(e){return null!=e});throw c(p,d,t[p])}u=f}};function s(e){return h("EMISSINGARG","Missing required argument #"+(e+1))}function a(e,t){return h("EUNKNOWNTYPE","Unknown type "+t+" in argument #"+(e+1))}function c(e,t,r){var i;return Object.keys(n).forEach(function(e){n[e].check(r)&&(i=n[e].label)}),h("EINVALIDTYPE","Argument #"+(e+1)+": Expected "+u(t)+" but got "+i)}function u(e){return e.join(", ").replace(/, ([^,]+)$/," or $1")}function l(e,t){return h("EWRONGARGCOUNT","Expected "+u(e)+" "+(e.every(function(e){return 1===e.length})?"argument":"arguments")+" but got "+t)}function h(e,t){var r=new Error(t);return r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,o),r}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(16),o=r(128);class s{static createFromMetadataGenerator(e){return new c(e)}static createEmpty(){return new u}}t.CallCredentials=s;class a extends s{constructor(e){super(),this.creds=e}generateMetadata(e){return n(this,void 0,void 0,function*(){const t=new o.Metadata,r=yield Promise.all(i.map(this.creds,t=>t.generateMetadata(e)));for(const e of r)t.merge(e);return t})}compose(e){return new a(this.creds.concat([e]))}}class c extends s{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,r)=>{this.metadataGenerator(e,(e,n)=>{void 0!==n?t(n):r(e)})})}compose(e){return new a([this,e])}}class u extends s{generateMetadata(e){return Promise.resolve(new o.Metadata)}compose(e){return e}}},function(e,t){e.exports=require("http2")},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(50),i=r(10),o=r(11),s="firebase.googleapis.com:443",a="/v1/",c="/v1beta1/",u={"X-Client-Version":"Node/Admin/6.3.0"},l={sha1:"SHA_1",sha256:"SHA_256"};function h(e,t,r){if(!e)throw new i.FirebaseProjectManagementError("invalid-server-response",r+" Response data: "+JSON.stringify(t,null,2))}t.assertServerResponse=h;var p=function(){function e(e){this.baseUrl="https://"+s+a,this.baseBetaUrl="https://"+s+c,this.httpClient=new n.AuthorizedHttpClient(e)}return e.wrapAndRethrowHttpError=function(e,t){var r,n;switch(e){case 400:r="invalid-argument",n="Invalid argument provided.";break;case 401:case 403:r="authentication-error",n="An error occurred when trying to authenticate. Make sure the credential used to authenticate this SDK has the proper permissions. See https://firebase.google.com/docs/admin/setup for setup instructions.";break;case 404:r="not-found",n="The specified entity could not be found.";break;case 409:r="already-exists",n="The specified entity already exists.";break;case 500:r="internal-error",n="An internal error has occurred. Please retry the request.";break;case 503:r="service-unavailable",n="The server could not process the request in time. See the error documentation for more details.";break;default:r="unknown-error",n="An unknown server error was returned."}throw new i.FirebaseProjectManagementError(r,n+" Status code: "+e+'. Raw server response: "'+t+'".')},e.prototype.listAndroidApps=function(e){return this.invokeRequestHandler("GET","projects/"+e+"/androidApps?page_size=100",null,"v1beta1")},e.prototype.listIosApps=function(e){return this.invokeRequestHandler("GET","projects/"+e+"/iosApps?page_size=100",null,"v1beta1")},e.prototype.createAndroidApp=function(e,t,r){var n=this,i={packageName:t};return o.isNonEmptyString(r)&&(i.displayName=r),this.invokeRequestHandler("POST","projects/"+e+"/androidApps",i,"v1beta1").then(function(e){return h(o.isNonNullObject(e),e,"createAndroidApp's responseData must be a non-null object."),h(o.isNonEmptyString(e.name),e,"createAndroidApp's responseData.name must be a non-empty string."),n.pollRemoteOperationWithExponentialBackoff(e.name)})},e.prototype.createIosApp=function(e,t,r){var n=this,i={bundleId:t};return o.isNonEmptyString(r)&&(i.displayName=r),this.invokeRequestHandler("POST","projects/"+e+"/iosApps",i,"v1beta1").then(function(e){return h(o.isNonNullObject(e),e,"createIosApp's responseData must be a non-null object."),h(o.isNonEmptyString(e.name),e,"createIosApp's responseData.name must be a non-empty string."),n.pollRemoteOperationWithExponentialBackoff(e.name)})},e.prototype.getAndroidMetadata=function(e){return this.invokeRequestHandler("GET","projects/-/androidApps/"+e,null,"v1beta1")},e.prototype.getIosMetadata=function(e){return this.invokeRequestHandler("GET","projects/-/iosApps/"+e,null,"v1beta1")},e.prototype.setAndroidDisplayName=function(e,t){var r={displayName:t};return this.invokeRequestHandler("PATCH","projects/-/androidApps/"+e+"?update_mask=display_name",r,"v1beta1").then(function(){return null})},e.prototype.setIosDisplayName=function(e,t){var r={displayName:t};return this.invokeRequestHandler("PATCH","projects/-/iosApps/"+e+"?update_mask=display_name",r,"v1beta1").then(function(){return null})},e.prototype.getAndroidShaCertificates=function(e){return this.invokeRequestHandler("GET","projects/-/androidApps/"+e+"/sha",null,"v1beta1")},e.prototype.addAndroidShaCertificate=function(e,t){var r={shaHash:t.shaHash,certType:l[t.certType]};return this.invokeRequestHandler("POST","projects/-/androidApps/"+e+"/sha",r,"v1beta1").then(function(){return null})},e.prototype.deleteAndroidShaCertificate=function(e){return this.invokeRequestHandler("DELETE",e.resourceName,null,"v1beta1").then(function(){return null})},e.prototype.getAndroidConfig=function(e){return this.invokeRequestHandler("GET","projects/-/androidApps/"+e+"/config",null,"v1beta1")},e.prototype.getIosConfig=function(e){return this.invokeRequestHandler("GET","projects/-/iosApps/"+e+"/config",null,"v1beta1")},e.prototype.pollRemoteOperationWithExponentialBackoff=function(t){var r=this;return(new n.ExponentialBackoffPoller).poll(function(){return r.invokeRequestHandler("GET",t,null).then(function(t){if(t.error){var r=t.error.code||500,n=t.error.message||JSON.stringify(t.error);e.wrapAndRethrowHttpError(r,n)}return t.done?t.response:null})})},e.prototype.invokeRequestHandler=function(t,r,i,o){void 0===o&&(o="v1");var s={method:t,url:""+("v1"===o?this.baseUrl:this.baseBetaUrl)+r,headers:u,data:i,timeout:1e4};return this.httpClient.send(s).then(function(e){if(!e.isJson())throw new n.HttpError(e);return e.data}).catch(function(t){throw t instanceof n.HttpError&&e.wrapAndRethrowHttpError(t.response.status,t.response.text),t})},e}();t.ProjectManagementRequestHandler=p},function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"a",function(){return n});var n,i=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(n||(n={}));var o=n.INFO,s=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(!(t<e.logLevel)){var o=(new Date).toISOString();switch(t){case n.DEBUG:case n.VERBOSE:console.log.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;case n.INFO:console.info.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;case n.WARN:console.warn.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;case n.ERROR:console.error.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},a=function(){function e(e){this.name=e,this._logLevel=o,this._logHandler=s,i.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in n))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,n.DEBUG].concat(e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,n.VERBOSE].concat(e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,n.INFO].concat(e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,n.WARN].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,n.ERROR].concat(e))},e}()},function(e,t,r){var n=r(2);r(5),n.cipher=n.cipher||{};var i=e.exports=n.cipher.modes=n.cipher.modes||{};function o(e){if("string"==typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var t=e;e=n.util.createBuffer();for(var r=0;r<t.length;++r)e.putByte(t[r])}return n.util.isArray(e)||(e=[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]),e}function s(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*i)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=a(8*t.length());var o=t.length()%this.blockSize;for(o&&t.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(0===o||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],c=(n-1-s%n)*t;a[s/n|0]=1<<t-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,e),t)}return o},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],c=i[s];i[o+s]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var u=i[o^n];i[o]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i}},function(e,t,r){var n=r(2);r(31),r(74),r(132),r(58),r(174),r(18),r(75),r(5);var i=function(e,t,r,i){var o=n.util.createBuffer(),s=e.length>>1,a=s+(1&e.length),c=e.substr(0,a),u=e.substr(s,a),l=n.util.createBuffer(),h=n.hmac.create();r=t+r;var p=Math.ceil(i/16),f=Math.ceil(i/20);h.start("MD5",c);var d=n.util.createBuffer();l.putBytes(r);for(var g=0;g<p;++g)h.start(null,null),h.update(l.getBytes()),l.putBuffer(h.digest()),h.start(null,null),h.update(l.bytes()+r),d.putBuffer(h.digest());h.start("SHA1",u);var m=n.util.createBuffer();l.clear(),l.putBytes(r);for(g=0;g<f;++g)h.start(null,null),h.update(l.getBytes()),l.putBuffer(h.digest()),h.start(null,null),h.update(l.bytes()+r),m.putBuffer(h.digest());return o.putBytes(n.util.xorBytes(d.getBytes(),m.getBytes(),i)),o},o=function(e,t,r){var i=!1;try{var o=e.deflate(t.fragment.getBytes());t.fragment=n.util.createBuffer(o),t.length=o.length,i=!0}catch(e){}return i},s=function(e,t,r){var i=!1;try{var o=e.inflate(t.fragment.getBytes());t.fragment=n.util.createBuffer(o),t.length=o.length,i=!0}catch(e){}return i},a=function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32()}return n.util.createBuffer(e.getBytes(r))},c=function(e,t,r){e.putInt(r.length(),t<<3),e.putBuffer(r)},u={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}}};u.SupportedVersions=[u.Versions.TLS_1_1,u.Versions.TLS_1_0],u.Version=u.SupportedVersions[0],u.MaxFragment=15360,u.ConnectionEnd={server:0,client:1},u.PRFAlgorithm={tls_prf_sha256:0},u.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},u.CipherType={stream:0,block:1,aead:2},u.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},u.CompressionMethod={none:0,deflate:1},u.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},u.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},u.Alert={},u.Alert.Level={warning:1,fatal:2},u.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},u.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},u.CipherSuites={},u.getCipherSuite=function(e){var t=null;for(var r in u.CipherSuites){var n=u.CipherSuites[r];if(n.id[0]===e.charCodeAt(0)&&n.id[1]===e.charCodeAt(1)){t=n;break}}return t},u.handleUnexpected=function(e,t){!e.open&&e.entity===u.ConnectionEnd.client||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})},u.handleHelloRequest=function(e,t,r){!e.handshaking&&e.handshakes>0&&(u.queue(e,u.createAlert(e,{level:u.Alert.Level.warning,description:u.Alert.Description.no_renegotiation})),u.flush(e)),e.process()},u.parseHelloMessage=function(e,t,r){var i=null,o=e.entity===u.ConnectionEnd.client;if(r<38)e.error(e,{message:o?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});else{var s=t.fragment,c=s.length();if(i={version:{major:s.getByte(),minor:s.getByte()},random:n.util.createBuffer(s.getBytes(32)),session_id:a(s,1),extensions:[]},o?(i.cipher_suite=s.getBytes(2),i.compression_method=s.getByte()):(i.cipher_suites=a(s,2),i.compression_methods=a(s,1)),(c=r-(c-s.length()))>0){for(var l=a(s,2);l.length()>0;)i.extensions.push({type:[l.getByte(),l.getByte()],data:a(l,2)});if(!o)for(var h=0;h<i.extensions.length;++h){var p=i.extensions[h];if(0===p.type[0]&&0===p.type[1])for(var f=a(p.data,2);f.length()>0;){if(0!==f.getByte())break;e.session.extensions.server_name.serverNameList.push(a(f,2).getBytes())}}}if(e.session.version&&(i.version.major!==e.session.version.major||i.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});if(o)e.session.cipherSuite=u.getCipherSuite(i.cipher_suite);else for(var d=n.util.createBuffer(i.cipher_suites.bytes());d.length()>0&&(e.session.cipherSuite=u.getCipherSuite(d.getBytes(2)),null===e.session.cipherSuite););if(null===e.session.cipherSuite)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure},cipherSuite:n.util.bytesToHex(i.cipher_suite)});e.session.compressionMethod=o?i.compression_method:u.CompressionMethod.none}return i},u.createSecurityParameters=function(e,t){var r=e.entity===u.ConnectionEnd.client,n=t.random.bytes(),i=r?e.session.sp.client_random:n,o=r?n:u.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:u.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:o}},u.handleServerHello=function(e,t,r){var n=u.parseHelloMessage(e,t,r);if(!e.fail){if(!(n.version.minor<=e.version.minor))return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});e.version.minor=n.version.minor,e.session.version=e.version;var i=n.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=d,e.session.resuming=!0,e.session.sp.server_random=n.random.bytes()):(e.expect=l,e.session.resuming=!1,u.createSecurityParameters(e,n)),e.session.id=i,e.process()}},u.handleClientHello=function(e,t,r){var i=u.parseHelloMessage(e,t,r);if(!e.fail){var o=i.session_id.bytes(),s=null;if(e.sessionCache&&(null===(s=e.sessionCache.getSession(o))?o="":(s.version.major!==i.version.major||s.version.minor>i.version.minor)&&(s=null,o="")),0===o.length&&(o=n.random.getBytes(32)),e.session.id=o,e.session.clientHelloVersion=i.version,e.session.sp={},s)e.version=e.session.version=s.version,e.session.sp=s.sp;else{for(var a,c=1;c<u.SupportedVersions.length&&!((a=u.SupportedVersions[c]).minor<=i.version.minor);++c);e.version={major:a.major,minor:a.minor},e.session.version=e.version}null!==s?(e.expect=E,e.session.resuming=!0,e.session.sp.client_random=i.random.bytes()):(e.expect=!1!==e.verifyClient?v:b,e.session.resuming=!1,u.createSecurityParameters(e,i)),e.open=!0,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHello(e)})),e.session.resuming?(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))):(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)})),e.fail||(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerKeyExchange(e)})),!1!==e.verifyClient&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateRequest(e)})),u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHelloDone(e)})))),u.flush(e),e.process()}},u.handleCertificate=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var i,o,s=t.fragment,c={certificate_list:a(s,3)},l=[];try{for(;c.certificate_list.length()>0;)i=a(c.certificate_list,3),o=n.asn1.fromDer(i),i=n.pki.certificateFromAsn1(o,!0),l.push(i)}catch(t){return e.error(e,{message:"Could not parse certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var p=e.entity===u.ConnectionEnd.client;!p&&!0!==e.verifyClient||0!==l.length?0===l.length?e.expect=p?h:b:(p?e.session.serverCertificate=l[0]:e.session.clientCertificate=l[0],u.verifyCertificateChain(e,l)&&(e.expect=p?h:b)):e.error(e,{message:p?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}}),e.process()},u.handleServerKeyExchange=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});e.expect=p,e.process()},u.handleClientKeyExchange=function(e,t,r){if(r<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});var i=t.fragment,o={enc_pre_master_secret:a(i,2).getBytes()},s=null;if(e.getPrivateKey)try{s=e.getPrivateKey(e,e.session.serverCertificate),s=n.pki.privateKeyFromPem(s)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}if(null===s)return e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}});try{var c=e.session.sp;c.pre_master_secret=s.decrypt(o.enc_pre_master_secret);var l=e.session.clientHelloVersion;if(l.major!==c.pre_master_secret.charCodeAt(0)||l.minor!==c.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(e){c.pre_master_secret=n.random.getBytes(48)}e.expect=E,null!==e.session.clientCertificate&&(e.expect=_),e.process()},u.handleCertificateRequest=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_types:a(n,1),certificate_authorities:a(n,2)};e.session.certificateRequest=i,e.expect=f,e.process()},u.handleCertificateVerify=function(e,t,r){if(r<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var i=t.fragment;i.read-=4;var o=i.bytes();i.read+=4;var s={signature:a(i,2).getBytes()},c=n.util.createBuffer();c.putBuffer(e.session.md5.digest()),c.putBuffer(e.session.sha1.digest()),c=c.getBytes();try{if(!e.session.clientCertificate.publicKey.verify(c,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(o),e.session.sha1.update(o)}catch(t){return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure}})}e.expect=E,e.process()},u.handleServerHelloDone=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.record_overflow}});if(null===e.serverCertificate){var i={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.insufficient_security}},o=e.verify(e,i.alert.description,0,[]);if(!0!==o)return(o||0===o)&&("object"!=typeof o||n.util.isArray(o)?"number"==typeof o&&(i.alert.description=o):(o.message&&(i.message=o.message),o.alert&&(i.alert.description=o.alert))),e.error(e,i)}null!==e.session.certificateRequest&&(t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)}),u.queue(e,t)),t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createClientKeyExchange(e)}),u.queue(e,t),e.expect=y;var s=function(e,t){null!==e.session.certificateRequest&&null!==e.session.clientCertificate&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateVerify(e,t)})),u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)})),e.expect=d,u.flush(e),e.process()};if(null===e.session.certificateRequest||null===e.session.clientCertificate)return s(e,null);u.getClientSignature(e,s)},u.handleChangeCipherSpec=function(e,t){if(1!==t.fragment.getByte())return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var r=e.entity===u.ConnectionEnd.client;(e.session.resuming&&r||!e.session.resuming&&!r)&&(e.state.pending=u.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&r||e.session.resuming&&!r)&&(e.state.pending=null),e.expect=r?g:C,e.process()},u.handleFinished=function(e,t,r){var o=t.fragment;o.read-=4;var s=o.bytes();o.read+=4;var a=t.fragment.getBytes();(o=n.util.createBuffer()).putBuffer(e.session.md5.digest()),o.putBuffer(e.session.sha1.digest());var c=e.entity===u.ConnectionEnd.client,l=c?"server finished":"client finished",h=e.session.sp;if((o=i(h.master_secret,l,o.getBytes(),12)).getBytes()!==a)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decrypt_error}});e.session.md5.update(s),e.session.sha1.update(s),(e.session.resuming&&c||!e.session.resuming&&!c)&&(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))),e.expect=c?m:w,e.handshaking=!1,++e.handshakes,e.peerCertificate=c?e.session.serverCertificate:e.session.clientCertificate,u.flush(e),e.isConnected=!0,e.connected(e),e.process()},u.handleAlert=function(e,t){var r,n=t.fragment,i={level:n.getByte(),description:n.getByte()};switch(i.description){case u.Alert.Description.close_notify:r="Connection closed.";break;case u.Alert.Description.unexpected_message:r="Unexpected message.";break;case u.Alert.Description.bad_record_mac:r="Bad record MAC.";break;case u.Alert.Description.decryption_failed:r="Decryption failed.";break;case u.Alert.Description.record_overflow:r="Record overflow.";break;case u.Alert.Description.decompression_failure:r="Decompression failed.";break;case u.Alert.Description.handshake_failure:r="Handshake failure.";break;case u.Alert.Description.bad_certificate:r="Bad certificate.";break;case u.Alert.Description.unsupported_certificate:r="Unsupported certificate.";break;case u.Alert.Description.certificate_revoked:r="Certificate revoked.";break;case u.Alert.Description.certificate_expired:r="Certificate expired.";break;case u.Alert.Description.certificate_unknown:r="Certificate unknown.";break;case u.Alert.Description.illegal_parameter:r="Illegal parameter.";break;case u.Alert.Description.unknown_ca:r="Unknown certificate authority.";break;case u.Alert.Description.access_denied:r="Access denied.";break;case u.Alert.Description.decode_error:r="Decode error.";break;case u.Alert.Description.decrypt_error:r="Decrypt error.";break;case u.Alert.Description.export_restriction:r="Export restriction.";break;case u.Alert.Description.protocol_version:r="Unsupported protocol version.";break;case u.Alert.Description.insufficient_security:r="Insufficient security.";break;case u.Alert.Description.internal_error:r="Internal error.";break;case u.Alert.Description.user_canceled:r="User canceled.";break;case u.Alert.Description.no_renegotiation:r="Renegotiation not supported.";break;default:r="Unknown error."}if(i.description===u.Alert.Description.close_notify)return e.close();e.error(e,{message:r,send:!1,origin:e.entity===u.ConnectionEnd.client?"server":"client",alert:i}),e.process()},u.handleHandshake=function(e,t){var r=t.fragment,i=r.getByte(),o=r.getInt24();if(o>r.length())return e.fragmented=t,t.fragment=n.util.createBuffer(),r.read-=4,e.process();e.fragmented=null,r.read-=4;var s=r.bytes(o+4);r.read+=4,i in U[e.entity][e.expect]?(e.entity!==u.ConnectionEnd.server||e.open||e.fail||(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:n.md.md5.create(),sha1:n.md.sha1.create()}),i!==u.HandshakeType.hello_request&&i!==u.HandshakeType.certificate_verify&&i!==u.HandshakeType.finished&&(e.session.md5.update(s),e.session.sha1.update(s)),U[e.entity][e.expect][i](e,t,o)):u.handleUnexpected(e,t)},u.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()},u.handleHeartbeat=function(e,t){var r=t.fragment,i=r.getByte(),o=r.getInt16(),s=r.getBytes(o);if(i===u.HeartbeatMessageType.heartbeat_request){if(e.handshaking||o>s.length)return e.process();u.queue(e,u.createRecord(e,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_response,s)})),u.flush(e)}else if(i===u.HeartbeatMessageType.heartbeat_response){if(s!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,n.util.createBuffer(s))}e.process()};var l=1,h=2,p=3,f=4,d=5,g=6,m=7,y=8,v=1,b=2,_=3,E=4,C=5,w=6,S=u.handleUnexpected,T=u.handleChangeCipherSpec,A=u.handleAlert,I=u.handleHandshake,N=u.handleApplicationData,k=u.handleHeartbeat,R=[];R[u.ConnectionEnd.client]=[[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[T,A,S,S,k],[S,A,I,S,k],[S,A,I,N,k],[S,A,I,S,k]],R[u.ConnectionEnd.server]=[[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[T,A,S,S,k],[S,A,I,S,k],[S,A,I,N,k],[S,A,I,S,k]];var O=u.handleHelloRequest,x=u.handleServerHello,B=u.handleCertificate,D=u.handleServerKeyExchange,P=u.handleCertificateRequest,L=u.handleServerHelloDone,j=u.handleFinished,U=[];U[u.ConnectionEnd.client]=[[S,S,x,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,B,D,P,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,D,P,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,P,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,j],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]];var M=u.handleClientHello,F=u.handleClientKeyExchange,V=u.handleCertificateVerify;U[u.ConnectionEnd.server]=[[S,M,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,B,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,F,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,V,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,j],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]],u.generateKeys=function(e,t){var r=i,n=t.client_random+t.server_random;e.session.resuming||(t.master_secret=r(t.pre_master_secret,"master secret",n,48).bytes(),t.pre_master_secret=null),n=t.server_random+t.client_random;var o=2*t.mac_key_length+2*t.enc_key_length,s=e.version.major===u.Versions.TLS_1_0.major&&e.version.minor===u.Versions.TLS_1_0.minor;s&&(o+=2*t.fixed_iv_length);var a=r(t.master_secret,"key expansion",n,o),c={client_write_MAC_key:a.getBytes(t.mac_key_length),server_write_MAC_key:a.getBytes(t.mac_key_length),client_write_key:a.getBytes(t.enc_key_length),server_write_key:a.getBytes(t.enc_key_length)};return s&&(c.client_write_IV=a.getBytes(t.fixed_iv_length),c.server_write_IV=a.getBytes(t.fixed_iv_length)),c},u.createConnectionState=function(e){var t=e.entity===u.ConnectionEnd.client,r=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return!0},compressionState:null,compressFunction:function(e){return!0},updateSequenceNumber:function(){4294967295===e.sequenceNumber[1]?(e.sequenceNumber[1]=0,++e.sequenceNumber[0]):++e.sequenceNumber[1]}};return e},n={read:r(),write:r()};if(n.read.update=function(e,t){return n.read.cipherFunction(t,n.read)?n.read.compressFunction(e,t,n.read)||e.error(e,{message:"Could not decompress record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decompression_failure}}):e.error(e,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_record_mac}}),!e.fail},n.write.update=function(e,t){return n.write.compressFunction(e,t,n.write)?n.write.cipherFunction(t,n.write)||e.error(e,{message:"Could not encrypt record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):e.error(e,{message:"Could not compress record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}),!e.fail},e.session){var i=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(i),i.keys=u.generateKeys(e,i),n.read.macKey=t?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,n.write.macKey=t?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(n,e,i),i.compression_algorithm){case u.CompressionMethod.none:break;case u.CompressionMethod.deflate:n.read.compressFunction=s,n.write.compressFunction=o;break;default:throw new Error("Unsupported compression algorithm.")}}return n},u.createRandom=function(){var e=new Date,t=+e+6e4*e.getTimezoneOffset(),r=n.util.createBuffer();return r.putInt32(t),r.putBytes(n.random.getBytes(28)),r},u.createRecord=function(e,t){return t.data?{type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data}:null},u.createAlert=function(e,t){var r=n.util.createBuffer();return r.putByte(t.level),r.putByte(t.description),u.createRecord(e,{type:u.ContentType.alert,data:r})},u.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=n.util.createBuffer(),r=0;r<e.cipherSuites.length;++r){var i=e.cipherSuites[r];t.putByte(i.id[0]),t.putByte(i.id[1])}var o=t.length(),s=n.util.createBuffer();s.putByte(u.CompressionMethod.none);var a=s.length(),l=n.util.createBuffer();if(e.virtualHost){var h=n.util.createBuffer();h.putByte(0),h.putByte(0);var p=n.util.createBuffer();p.putByte(0),c(p,2,n.util.createBuffer(e.virtualHost));var f=n.util.createBuffer();c(f,2,p),c(h,2,f),l.putBuffer(h)}var d=l.length();d>0&&(d+=2);var g=e.session.id,m=g.length+1+2+4+28+2+o+1+a+d,y=n.util.createBuffer();return y.putByte(u.HandshakeType.client_hello),y.putInt24(m),y.putByte(e.version.major),y.putByte(e.version.minor),y.putBytes(e.session.sp.client_random),c(y,1,n.util.createBuffer(g)),c(y,2,t),c(y,1,s),d>0&&c(y,2,l),y},u.createServerHello=function(e){var t=e.session.id,r=t.length+1+2+4+28+2+1,i=n.util.createBuffer();return i.putByte(u.HandshakeType.server_hello),i.putInt24(r),i.putByte(e.version.major),i.putByte(e.version.minor),i.putBytes(e.session.sp.server_random),c(i,1,n.util.createBuffer(t)),i.putByte(e.session.cipherSuite.id[0]),i.putByte(e.session.cipherSuite.id[1]),i.putByte(e.session.compressionMethod),i},u.createCertificate=function(e){var t,r=e.entity===u.ConnectionEnd.client,i=null;e.getCertificate&&(t=r?e.session.certificateRequest:e.session.extensions.server_name.serverNameList,i=e.getCertificate(e,t));var o=n.util.createBuffer();if(null!==i)try{n.util.isArray(i)||(i=[i]);for(var s=null,a=0;a<i.length;++a){var l=n.pem.decode(i[a])[0];if("CERTIFICATE"!==l.type&&"X509 CERTIFICATE"!==l.type&&"TRUSTED CERTIFICATE"!==l.type){var h=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw h.headerType=l.type,h}if(l.procType&&"ENCRYPTED"===l.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var p=n.util.createBuffer(l.body);null===s&&(s=n.asn1.fromDer(p.bytes(),!1));var f=n.util.createBuffer();c(f,3,p),o.putBuffer(f)}i=n.pki.certificateFromAsn1(s),r?e.session.clientCertificate=i:e.session.serverCertificate=i}catch(t){return e.error(e,{message:"Could not send certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var d=3+o.length(),g=n.util.createBuffer();return g.putByte(u.HandshakeType.certificate),g.putInt24(d),c(g,3,o),g},u.createClientKeyExchange=function(e){var t=n.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(n.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var i=(t=e.session.serverCertificate.publicKey.encrypt(r.pre_master_secret)).length+2,o=n.util.createBuffer();return o.putByte(u.HandshakeType.client_key_exchange),o.putInt24(i),o.putInt16(t.length),o.putBytes(t),o},u.createServerKeyExchange=function(e){var t=n.util.createBuffer();return t},u.getClientSignature=function(e,t){var r=n.util.createBuffer();r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest()),r=r.getBytes(),e.getSignature=e.getSignature||function(e,t,r){var i=null;if(e.getPrivateKey)try{i=e.getPrivateKey(e,e.session.clientCertificate),i=n.pki.privateKeyFromPem(i)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}null===i?e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):t=i.sign(t,null),r(e,t)},e.getSignature(e,r,t)},u.createCertificateVerify=function(e,t){var r=t.length+2,i=n.util.createBuffer();return i.putByte(u.HandshakeType.certificate_verify),i.putInt24(r),i.putInt16(t.length),i.putBytes(t),i},u.createCertificateRequest=function(e){var t=n.util.createBuffer();t.putByte(1);var r=n.util.createBuffer();for(var i in e.caStore.certs){var o=e.caStore.certs[i],s=n.pki.distinguishedNameToAsn1(o.subject),a=n.asn1.toDer(s);r.putInt16(a.length()),r.putBuffer(a)}var l=1+t.length()+2+r.length(),h=n.util.createBuffer();return h.putByte(u.HandshakeType.certificate_request),h.putInt24(l),c(h,1,t),c(h,2,r),h},u.createServerHelloDone=function(e){var t=n.util.createBuffer();return t.putByte(u.HandshakeType.server_hello_done),t.putInt24(0),t},u.createChangeCipherSpec=function(){var e=n.util.createBuffer();return e.putByte(1),e},u.createFinished=function(e){var t=n.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var r=e.entity===u.ConnectionEnd.client,o=e.session.sp,s=r?"client finished":"server finished";t=i(o.master_secret,s,t.getBytes(),12);var a=n.util.createBuffer();return a.putByte(u.HandshakeType.finished),a.putInt24(t.length()),a.putBuffer(t),a},u.createHeartbeat=function(e,t,r){void 0===r&&(r=t.length);var i=n.util.createBuffer();i.putByte(e),i.putInt16(r),i.putBytes(t);var o=i.length(),s=Math.max(16,o-r-3);return i.putBytes(n.random.getBytes(s)),i},u.queue=function(e,t){if(t&&(0!==t.fragment.length()||t.type!==u.ContentType.handshake&&t.type!==u.ContentType.alert&&t.type!==u.ContentType.change_cipher_spec)){if(t.type===u.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r),e.session.sha1.update(r),r=null}var i;if(t.fragment.length()<=u.MaxFragment)i=[t];else{i=[];for(var o=t.fragment.bytes();o.length>u.MaxFragment;)i.push(u.createRecord(e,{type:t.type,data:n.util.createBuffer(o.slice(0,u.MaxFragment))})),o=o.slice(u.MaxFragment);o.length>0&&i.push(u.createRecord(e,{type:t.type,data:n.util.createBuffer(o)}))}for(var s=0;s<i.length&&!e.fail;++s){var a=i[s];e.state.current.write.update(e,a)&&e.records.push(a)}}},u.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type),e.tlsData.putByte(r.version.major),e.tlsData.putByte(r.version.minor),e.tlsData.putInt16(r.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var q=function(e){switch(e){case!0:return!0;case n.pki.certificateError.bad_certificate:return u.Alert.Description.bad_certificate;case n.pki.certificateError.unsupported_certificate:return u.Alert.Description.unsupported_certificate;case n.pki.certificateError.certificate_revoked:return u.Alert.Description.certificate_revoked;case n.pki.certificateError.certificate_expired:return u.Alert.Description.certificate_expired;case n.pki.certificateError.certificate_unknown:return u.Alert.Description.certificate_unknown;case n.pki.certificateError.unknown_ca:return u.Alert.Description.unknown_ca;default:return u.Alert.Description.bad_certificate}};for(var K in u.verifyCertificateChain=function(e,t){try{n.pki.verifyCertificateChain(e.caStore,t,function(t,r,i){q(t);var o=e.verify(e,t,r,i);if(!0!==o){if("object"==typeof o&&!n.util.isArray(o)){var s=new Error("The application rejected the certificate.");throw s.send=!0,s.alert={level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate},o.message&&(s.message=o.message),o.alert&&(s.alert.description=o.alert),s}o!==t&&(o=function(e){switch(e){case!0:return!0;case u.Alert.Description.bad_certificate:return n.pki.certificateError.bad_certificate;case u.Alert.Description.unsupported_certificate:return n.pki.certificateError.unsupported_certificate;case u.Alert.Description.certificate_revoked:return n.pki.certificateError.certificate_revoked;case u.Alert.Description.certificate_expired:return n.pki.certificateError.certificate_expired;case u.Alert.Description.certificate_unknown:return n.pki.certificateError.certificate_unknown;case u.Alert.Description.unknown_ca:return n.pki.certificateError.unknown_ca;default:return n.pki.certificateError.bad_certificate}}(o))}return o})}catch(t){var r=t;("object"!=typeof r||n.util.isArray(r))&&(r={send:!0,alert:{level:u.Alert.Level.fatal,description:q(t)}}),"send"in r||(r.send=!0),"alert"in r||(r.alert={level:u.Alert.Level.fatal,description:q(r.error)}),e.error(e,r)}return!e.fail},u.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order)r=e;else{for(var i in(r={}).cache=e||{},r.capacity=Math.max(t||100,1),r.order=[],e)r.order.length<=t?r.order.push(i):delete e[i];r.getSession=function(e){var t=null,i=null;if(e?i=n.util.bytesToHex(e):r.order.length>0&&(i=r.order[0]),null!==i&&i in r.cache)for(var o in t=r.cache[i],delete r.cache[i],r.order)if(r.order[o]===i){r.order.splice(o,1);break}return t},r.setSession=function(e,t){if(r.order.length===r.capacity){var i=r.order.shift();delete r.cache[i]}i=n.util.bytesToHex(e);r.order.push(i),r.cache[i]=t}}return r},u.createConnection=function(e){var t=null;t=e.caStore?n.util.isArray(e.caStore)?n.pki.createCaStore(e.caStore):e.caStore:n.pki.createCaStore();var r=e.cipherSuites||null;if(null===r)for(var i in r=[],u.CipherSuites)r.push(u.CipherSuites[i]);var o=e.server?u.ConnectionEnd.server:u.ConnectionEnd.client,s=e.sessionCache?u.createSessionCache(e.sessionCache):null,a={version:{major:u.Version.major,minor:u.Version.minor},entity:o,sessionId:e.sessionId,caStore:t,sessionCache:s,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(e,t,r,n){return t},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:n.util.createBuffer(),tlsData:n.util.createBuffer(),data:n.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(t,r){r.origin=r.origin||(t.entity===u.ConnectionEnd.client?"client":"server"),r.send&&(u.queue(t,u.createAlert(t,r.alert)),u.flush(t));var n=!1!==r.fatal;n&&(t.fail=!0),e.error(t,r),n&&t.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null,reset:function(e){a.version={major:u.Version.major,minor:u.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=(a.entity,u.ConnectionEnd.client,0),a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(e||void 0===e),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=u.createConnectionState(a)}};a.reset();return a.handshake=function(e){if(a.entity!==u.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&0===a.handshakes&&(a.fail=!1),a.handshaking=!0;var t=null;(e=e||"").length>0&&(a.sessionCache&&(t=a.sessionCache.getSession(e)),null===t&&(e="")),0===e.length&&a.sessionCache&&null!==(t=a.sessionCache.getSession())&&(e=t.id),a.session={id:e,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:n.md.md5.create(),sha1:n.md.sha1.create()},t&&(a.version=t.version,a.session.sp=t.sp),a.session.sp.client_random=u.createRandom().getBytes(),a.open=!0,u.queue(a,u.createRecord(a,{type:u.ContentType.handshake,data:u.createClientHello(a)})),u.flush(a)}},a.process=function(e){var t=0;return e&&a.input.putBytes(e),a.fail||(null!==a.record&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),null===a.record&&(t=function(e){var t=0,r=e.input,i=r.length();if(i<5)t=5-i;else{e.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:n.util.createBuffer(),ready:!1};var o=e.record.version.major===e.version.major;o&&e.session&&e.session.version&&(o=e.record.version.minor===e.version.minor),o||e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}})}return t}(a)),a.fail||null===a.record||a.record.ready||(t=function(e){var t=0,r=e.input,n=r.length();n<e.record.length?t=e.record.length-n:(e.record.fragment.putBytes(r.getBytes(e.record.length)),r.compact(),e.state.current.read.update(e,e.record)&&(null!==e.fragmented&&(e.fragmented.type===e.record.type?(e.fragmented.fragment.putBuffer(e.record.fragment),e.record=e.fragmented):e.error(e,{message:"Invalid fragmented record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})),e.record.ready=!0));return t}(a)),!a.fail&&null!==a.record&&a.record.ready&&function(e,t){var r=t.type-u.ContentType.change_cipher_spec,n=R[e.entity][e.expect];r in n?n[r](e,t):u.handleUnexpected(e,t)}(a,a.record)),t},a.prepare=function(e){return u.queue(a,u.createRecord(a,{type:u.ContentType.application_data,data:n.util.createBuffer(e)})),u.flush(a)},a.prepareHeartbeatRequest=function(e,t){return e instanceof n.util.ByteBuffer&&(e=e.bytes()),void 0===t&&(t=e.length),a.expectedHeartbeatPayload=e,u.queue(a,u.createRecord(a,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_request,e,t)})),u.flush(a)},a.close=function(e){if(!a.fail&&a.sessionCache&&a.session){var t={id:a.session.id,version:a.session.version,sp:a.session.sp};t.sp.keys=null,a.sessionCache.setSession(t.id,t)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,u.queue(a,u.createAlert(a,{level:u.Alert.Level.warning,description:u.Alert.Description.close_notify})),u.flush(a)),a.closed(a)),a.reset(e)},a},e.exports=n.tls=n.tls||{},u)"function"!=typeof u[K]&&(n.tls[K]=u[K]);n.tls.prf_tls1=i,n.tls.hmac_sha1=function(e,t,r){var i=n.hmac.create();i.start("SHA1",e);var o=n.util.createBuffer();return o.putInt32(t[0]),o.putInt32(t[1]),o.putByte(r.type),o.putByte(r.version.major),o.putByte(r.version.minor),o.putInt16(r.length),o.putBytes(r.fragment.bytes()),i.update(o.getBytes()),i.digest().getBytes()},n.tls.createSessionCache=u.createSessionCache,n.tls.createConnection=u.createConnection},function(e,t,r){var n=r(2);r(31),r(53),r(175),r(58),r(133),r(181),r(135),r(111),r(5),r(134);var i=n.asn1,o=e.exports=n.pki=n.pki||{};o.pemToDer=function(e){var t=n.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(t.body)},o.privateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.privateKeyFromAsn1(s)},o.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:i.toDer(o.privateKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:i.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})}},function(e,t,r){var n=r(2);if(r(52),r(31),r(110),r(32),r(53),r(133),r(58),r(18),r(178),r(111),r(5),void 0===i)var i=n.jsbn.BigInteger;var o=n.asn1,s=n.pki=n.pki||{};e.exports=s.pbe=n.pbe=n.pbe||{};var a=s.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},u={name:"PBES2Algorithms",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function p(e){var t;if(e){if(!(t=s.oids[o.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return f(t)}function f(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!(t&&e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}s.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i,c,u,l=n.random.getBytesSync(r.saltSize),h=r.count,p=o.integerToDer(h);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var d,g,m;switch(r.algorithm){case"aes128":i=16,d=16,g=a["aes128-CBC"],m=n.aes.createEncryptionCipher;break;case"aes192":i=24,d=16,g=a["aes192-CBC"],m=n.aes.createEncryptionCipher;break;case"aes256":i=32,d=16,g=a["aes256-CBC"],m=n.aes.createEncryptionCipher;break;case"des":i=8,d=8,g=a.desCBC,m=n.des.createEncryptionCipher;break;default:throw(C=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,C}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),v=f(y),b=n.pkcs5.pbkdf2(t,l,h,i,v),_=n.random.getBytesSync(d);(w=m(b)).start(_),w.update(o.toDer(e)),w.finish(),u=w.output.getBytes();var E=function(e,t,r,i){var a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==i&&a.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids[i]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]));return a}(l,p,i,y);c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBES2).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBKDF2).getBytes()),E]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(g).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,_)])])])}else{var C;if("3des"!==r.algorithm)throw(C=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,C;i=24;var w,S=new n.util.ByteBuffer(l);b=s.pbe.generatePkcs12Key(t,S,1,h,i),_=s.pbe.generatePkcs12Key(t,S,2,h,i);(w=n.des.createEncryptionCipher(b)).start(_),w.update(o.toDer(e)),w.finish(),u=w.output.getBytes(),c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,l),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,p.getBytes())])])}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[c,o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,u)])},s.decryptPrivateKeyInfo=function(e,t){var r=null,i={},a=[];if(!o.validate(e,c,i,a)){var u=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw u.errors=a,u}var l=o.derToOid(i.encryptionOid),h=s.pbe.getCipher(l,i.encryptionParams,t),p=n.util.createBuffer(i.encryptedData);return h.update(p),h.finish()&&(r=o.fromDer(h.output)),r},s.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:o.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},s.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return o.fromDer(t.body)},s.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var i=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));return i=s.encryptPrivateKeyInfo(i,t,r),s.encryptedPrivateKeyToPem(i)}var a,c,u,l;switch(r.algorithm){case"aes128":a="AES-128-CBC",u=16,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",u=24,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",u=32,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",u=24,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;case"des":a="DES-CBC",u=8,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw h.algorithm=r.algorithm,h}var p=l(n.pbe.opensslDeriveBytes(t,c.substr(0,8),u));p.start(c),p.update(o.toDer(s.privateKeyToAsn1(e))),p.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:n.util.bytesToHex(c).toUpperCase()},body:p.output.getBytes()};return n.pem.encode(f)},s.decryptRsaPrivateKey=function(e,t){var r=null,i=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type)throw(u=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=u,u;if(i.procType&&"ENCRYPTED"===i.procType.type){var a,c;switch(i.dekInfo.algorithm){case"DES-CBC":a=8,c=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,c=n.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,c=n.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,c=n.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,c=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,c=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":a=8,c=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":a=16,c=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var u;throw(u=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".')).algorithm=i.dekInfo.algorithm,u}var l=n.util.hexToBytes(i.dekInfo.parameters),h=c(n.pbe.opensslDeriveBytes(t,l.substr(0,8),a));if(h.start(l),h.update(n.util.createBuffer(i.body)),!h.finish())return r;r=h.output.getBytes()}else r=i.body;return null!==(r="ENCRYPTED PRIVATE KEY"===i.type?s.decryptPrivateKeyInfo(o.fromDer(r),t):o.fromDer(r))&&(r=s.privateKeyFromAsn1(r)),r},s.pbe.generatePkcs12Key=function(e,t,r,i,o,s){var a,c;if(null==s){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');s=n.md.sha1.create()}var u=s.digestLength,l=s.blockLength,h=new n.util.ByteBuffer,p=new n.util.ByteBuffer;if(null!=e){for(c=0;c<e.length;c++)p.putInt16(e.charCodeAt(c));p.putInt16(0)}var f=p.length(),d=t.length(),g=new n.util.ByteBuffer;g.fillWithByte(r,l);var m=l*Math.ceil(d/l),y=new n.util.ByteBuffer;for(c=0;c<m;c++)y.putByte(t.at(c%d));var v=l*Math.ceil(f/l),b=new n.util.ByteBuffer;for(c=0;c<v;c++)b.putByte(p.at(c%f));var _=y;_.putBuffer(b);for(var E=Math.ceil(o/u),C=1;C<=E;C++){var w=new n.util.ByteBuffer;w.putBytes(g.bytes()),w.putBytes(_.bytes());for(var S=0;S<i;S++)s.start(),s.update(w.getBytes()),w=s.digest();var T=new n.util.ByteBuffer;for(c=0;c<l;c++)T.putByte(w.at(c%u));var A=Math.ceil(d/l)+Math.ceil(f/l),I=new n.util.ByteBuffer;for(a=0;a<A;a++){var N=new n.util.ByteBuffer(_.getBytes(l)),k=511;for(c=T.length()-1;c>=0;c--)k>>=8,k+=T.at(c)+N.at(c),N.setAt(c,255&k);I.putBuffer(N)}_=I,h.putBuffer(w)}return h.truncate(h.length()-o),h},s.pbe.getCipher=function(e,t,r){switch(e){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(e,t,r);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},s.pbe.getCipherForPBES2=function(e,t,r){var i,a={},c=[];if(!o.validate(t,u,a,c))throw(i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=c,i;if((e=o.derToOid(a.kdfOid))!==s.oids.pkcs5PBKDF2)throw(i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,i.supportedOids=["pkcs5PBKDF2"],i;if((e=o.derToOid(a.encOid))!==s.oids["aes128-CBC"]&&e!==s.oids["aes192-CBC"]&&e!==s.oids["aes256-CBC"]&&e!==s.oids["des-EDE3-CBC"]&&e!==s.oids.desCBC)throw(i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i;var l,h,f=a.kdfSalt,d=n.util.createBuffer(a.kdfIterationCount);switch(d=d.getInt(d.length()<<3),s.oids[e]){case"aes128-CBC":l=16,h=n.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,h=n.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,h=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,h=n.des.createDecryptionCipher;break;case"desCBC":l=8,h=n.des.createDecryptionCipher}var g=p(a.prfOid),m=n.pkcs5.pbkdf2(r,f,d,l,g),y=a.encIv,v=h(m);return v.start(y),v},s.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={},a=[];if(!o.validate(t,l,i,a))throw(g=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=a,g;var c,u,h,f=n.util.createBuffer(i.salt),d=n.util.createBuffer(i.iterations);switch(d=d.getInt(d.length()<<3),e){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,h=n.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,h=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var g;throw(g=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,g}var m=p(i.prfOid),y=s.pbe.generatePkcs12Key(r,f,1,d,c,m);return m.start(),h(y,s.pbe.generatePkcs12Key(r,f,2,d,u,m))},s.pbe.opensslDeriveBytes=function(e,t,r,i){if(null==i){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');i=n.md.md5.create()}null===t&&(t="");for(var o=[h(i,e+t)],s=16,a=1;s<r;++a,s+=16)o.push(h(i,o[a-1]+e+t));return o.join("").substr(0,r)}},function(e,t,r){var n=r(2);r(32),r(5);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){s||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var a=o.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=a[1],a[1]=a[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(o),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var a,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(a=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(l>>>0),l=a>>>0;s.putInt32(l);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(p,r,s);var f=n.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f.putInt32(p.h5),f.putInt32(p.h6),f.putInt32(p.h7),f},i};var o=null,s=!1,a=null;function c(e,t,r){for(var n,i,o,s,c,u,l,h,p,f,d,g,m,y=r.length();y>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=((n=t[c-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=((i=t[c-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,l=e.h1,h=e.h2,p=e.h3,f=e.h4,d=e.h5,g=e.h6,m=e.h7,c=0;c<64;++c)o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),s=u&l|h&(u^l),n=m+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(g^f&(d^g))+a[c]+t[c],m=g,g=d,d=f,f=p+n>>>0,p=h,h=l,l=u,u=n+(i=o+s)>>>0;e.h0=e.h0+u|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+p|0,e.h4=e.h4+f|0,e.h5=e.h5+d|0,e.h6=e.h6+g|0,e.h7=e.h7+m|0,y-=64}}},function(e,t,r){var n=r(2);r(5);var i=null;!n.util.isNodejs||n.options.usePureJavaScript||process.versions["node-webkit"]||(i=r(33)),(e.exports=n.prng=n.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,o=new Array(32),s=0;s<32;++s)o[s]=r.create();function a(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r==0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function u(e){var t=null;if("undefined"!=typeof window){var r=window.crypto||window.msCrypto;r&&r.getRandomValues&&(t=function(e){return r.getRandomValues(e)})}var i=n.util.createBuffer();if(t)for(;i.length()<e;){var o=Math.max(1,Math.min(e-i.length(),65536)/4),s=new Uint32Array(Math.floor(o));try{t(s);for(var a=0;a<s.length;++a)i.putInt32(s[a])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(i.length()<e)for(var c,u,l,h=Math.floor(65536*Math.random());i.length()<e;){u=16807*(65535&h),u+=(32767&(c=16807*(h>>16)))<<16,h=4294967295&(u=(2147483647&(u+=c>>15))+(u>>31));for(a=0;a<3;++a)l=h>>>(a<<3),l^=Math.floor(256*Math.random()),i.putByte(String.fromCharCode(255&l))}return i.getBytes(e)}return t.pools=o,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var i=t.plugin.cipher,o=t.plugin.increment,s=t.plugin.formatKey,a=t.plugin.formatSeed,u=n.util.createBuffer();t.key=null,function l(h){if(h)return r(h);if(u.length()>=e)return r(null,u.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return n.util.nextTick(function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,function(r,n){if(r)return e(r);t.collect(n),c(),e()})}(l)});var p=i(t.key,t.seed);t.generated+=p.length;u.putBytes(p);t.key=s(i(t.key,o(t.seed)));t.seed=a(i(t.key,t.seed));n.util.setImmediate(l)}()},t.generateSync=function(e){var r=t.plugin.cipher,i=t.plugin.increment,o=t.plugin.formatKey,s=t.plugin.formatSeed;t.key=null;for(var c=n.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&a();var u=r(t.key,t.seed);t.generated+=u.length,c.putBytes(u),t.key=o(r(t.key,i(t.seed))),t.seed=s(r(t.key,t.seed))}return c.getBytes(e)},i?(t.seedFile=function(e,t){i.randomBytes(e,function(e,r){if(e)return t(e);t(null,r.toString())})},t.seedFileSync=function(e){return i.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,u(e))}catch(e){t(e)}},t.seedFileSync=u),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))}),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})})})}},t}},function(e,t,r){var n=r(2);r(5);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],o=[1,2,3,5];e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"==typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,o=e,s=e.length(),a=t,c=Math.ceil(a/8),u=255>>(7&a);for(r=s;r<128;r++)o.putByte(i[o.at(r-1)+o.at(r-s)&255]);for(o.setAt(128-c,i[o.at(128-c)&u]),r=127-c;r>=0;r--)o.setAt(r,i[o.at(r+1)^o.at(r+c)]);return o};var s=function(e,t,r){var i,s,a,c,u=!1,l=null,h=null,p=null,f=[];for(e=n.rc2.expandKey(e,t),a=0;a<64;a++)f.push(e.getInt16Le());r?(i=function(e){for(a=0;a<4;a++)e[a]+=f[c]+(e[(a+3)%4]&e[(a+2)%4])+(~e[(a+3)%4]&e[(a+1)%4]),e[a]=(t=e[a])<<(r=o[a])&65535|(65535&t)>>16-r,c++;var t,r},s=function(e){for(a=0;a<4;a++)e[a]+=f[63&e[(a+3)%4]]}):(i=function(e){for(a=3;a>=0;a--)e[a]=(65535&(t=e[a]))>>(r=o[a])|t<<16-r&65535,e[a]-=f[c]+(e[(a+3)%4]&e[(a+2)%4])+(~e[(a+3)%4]&e[(a+1)%4]),c--;var t,r},s=function(e){for(a=3;a>=0;a--)e[a]-=f[63&e[(a+3)%4]]});var d=function(e){var t=[];for(a=0;a<4;a++){var n=l.getInt16Le();null!==p&&(r?n^=p.getInt16Le():p.putInt16Le(n)),t.push(65535&n)}c=r?0:63;for(var i=0;i<e.length;i++)for(var o=0;o<e[i][0];o++)e[i][1](t);for(a=0;a<4;a++)null!==p&&(r?p.putInt16Le(t[a]):t[a]^=p.getInt16Le()),h.putInt16Le(t[a])},g=null;return g={start:function(e,t){e&&"string"==typeof e&&(e=n.util.createBuffer(e)),u=!1,l=n.util.createBuffer(),h=t||new n.util.createBuffer,p=e,g.output=h},update:function(e){for(u||l.putBuffer(e);l.length()>=8;)d([[5,i],[1,s],[6,i],[1,s],[5,i]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,l,!r);else{var n=8===l.length()?8:8-l.length();l.fillWithByte(n,n)}if(t&&(u=!0,g.update()),!r&&(t=0===l.length()))if(e)t=e(8,h,!r);else{var i=h.length(),o=h.at(i-1);o>i?t=!1:h.truncate(o)}return t}}};n.rc2.startEncrypting=function(e,t,r){var i=n.rc2.createEncryptionCipher(e,128);return i.start(t,r),i},n.rc2.createEncryptionCipher=function(e,t){return s(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var i=n.rc2.createDecryptionCipher(e,128);return i.start(t,r),i},n.rc2.createDecryptionCipher=function(e,t){return s(e,t,!1)}},function(e,t,r){var n=r(2);r(5),r(18),r(75);var i=e.exports=n.pkcs1=n.pkcs1||{};function o(e,t,r){r||(r=n.md.sha1.create());for(var i="",o=Math.ceil(t/r.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);r.start(),r.update(e+a),i+=r.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,r){var i,s,a,c;"string"==typeof r?(i=r,s=arguments[3]||void 0,a=arguments[4]||void 0):r&&(i=r.label||void 0,s=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),a?a.start():a=n.md.sha1.create(),c||(c=a);var u=Math.ceil(e.n.bitLength()/8),l=u-2*a.digestLength-2;if(t.length>l)throw(m=new Error("RSAES-OAEP input message length is too long.")).length=t.length,m.maxLength=l,m;i||(i=""),a.update(i,"raw");for(var h=a.digest(),p="",f=l-t.length,d=0;d<f;d++)p+="\0";var g=h.getBytes()+p+""+t;if(s){if(s.length!==a.digestLength){var m;throw(m=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=s.length,m.digestLength=a.digestLength,m}}else s=n.random.getBytes(a.digestLength);var y=o(s,u-a.digestLength-1,c),v=n.util.xorBytes(g,y,g.length),b=o(v,a.digestLength,c);return"\0"+n.util.xorBytes(s,b,s.length)+v},i.decode_rsa_oaep=function(e,t,r){var i,s,a;"string"==typeof r?(i=r,s=arguments[3]||void 0):r&&(i=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(y=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,y.expectedLength=c,y;if(void 0===s?s=n.md.sha1.create():s.start(),a||(a=s),c<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),s.update(i,"raw");for(var u=s.digest().getBytes(),l=t.charAt(0),h=t.substring(1,s.digestLength+1),p=t.substring(1+s.digestLength),f=o(p,s.digestLength,a),d=o(n.util.xorBytes(h,f,h.length),c-s.digestLength-1,a),g=n.util.xorBytes(p,d,p.length),m=g.substring(0,s.digestLength),y="\0"!==l,v=0;v<s.digestLength;++v)y|=u.charAt(v)!==m.charAt(v);for(var b=1,_=s.digestLength,E=s.digestLength;E<g.length;E++){var C=g.charCodeAt(E);y|=C&(b?65534:0),_+=b&=1&C^1}if(y||1!==g.charCodeAt(_))throw new Error("Invalid RSAES-OAEP padding.");return g.substring(_+1)}},function(e,t,r){var n=r(2);r(5),r(112),r(18),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],o=new r(null);o.fromInt(30);var s=function(e,t){return e|t};t.generateProbablePrime=function(e,t,i){"function"==typeof t&&(i=t,t={});var o=(t=t||{}).algorithm||"PRIMEINC";"string"==typeof o&&(o={name:o}),o.options=o.options||{};var s=t.prng||n.random,u={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===o.name)return function(e,t,i,o){if("workers"in i)return function(e,t,i,o){if("undefined"==typeof Worker)return a(e,t,i,o);var s=c(e,t),u=i.workers,l=i.workLoad||100,h=30*l/8,p=i.workerScript||"forge/prime.worker.js";if(-1===u)return n.util.estimateCores(function(e,t){e&&(t=2),u=t-1,f()});function f(){u=Math.max(1,u);for(var n=[],i=0;i<u;++i)n[i]=new Worker(p);for(var i=0;i<u;++i)n[i].addEventListener("message",f);var a=!1;function f(i){if(!a){0;var u=i.data;if(u.found){for(var p=0;p<n.length;++p)n[p].terminate();return a=!0,o(null,new r(u.prime,16))}s.bitLength()>e&&(s=c(e,t));var f=s.toString(16);i.target.postMessage({hex:f,workLoad:l}),s.dAddOffset(h,0)}}}f()}(e,t,i,o);return a(e,t,i,o)}(e,u,o.options,i);throw new Error("Invalid prime generation algorithm: "+o.name)}}function a(e,t,r,o){var s=c(e,t),a=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(s.bitLength());"millerRabinTests"in r&&(a=r.millerRabinTests);var u=10;"maxBlockTime"in r&&(u=r.maxBlockTime),function e(t,r,o,s,a,u,l){var h=+new Date;do{if(t.bitLength()>r&&(t=c(r,o)),t.isProbablePrime(a))return l(null,t);t.dAddOffset(i[s++%8],0)}while(u<0||+new Date-h<u);n.util.setImmediate(function(){e(t,r,o,s,a,u,l)})}(s,e,t,0,a,u,o)}function c(e,t){var n=new r(e,t),i=e-1;return n.testBit(i)||n.bitwiseTo(r.ONE.shiftLeft(i),s,n),n.dAddOffset(31-n.mod(o).byteValue(),0),n}}()},function(e,t,r){var n=r(2);r(31),r(74),r(53),r(182),r(175),r(18),r(111),r(75),r(5),r(134);var i=n.asn1,o=n.pki,s=e.exports=n.pkcs12=n.pkcs12||{},a={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},a,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},u={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},l={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function p(e,t,r,n){for(var i=[],o=0;o<e.length;o++)for(var s=0;s<e[o].safeBags.length;s++){var a=e[o].safeBags[s];void 0!==n&&a.type!==n||(null!==t?void 0!==a.attributes[t]&&a.attributes[t].indexOf(r)>=0&&i.push(a):i.push(a))}return i}function f(e){if(e.composed||e.constructed){for(var t=n.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function d(e,t){var r={},s=[];if(!i.validate(e,n.pkcs7.asn1.encryptedDataValidator,r,s))throw(a=new Error("Cannot read EncryptedContentInfo.")).errors=s,a;var a,c=i.derToOid(r.contentType);if(c!==o.oids.data)throw(a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=c,a;c=i.derToOid(r.encAlgorithm);var u=o.pbe.getCipher(c,r.encParameter,t),l=f(r.encryptedContentAsn1),h=n.util.createBuffer(l.value);if(u.update(h),!u.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return u.output.getBytes()}function g(e,t,r){if(!t&&0===e.length)return[];if((e=i.fromDer(e,t)).tagClass!==i.Class.UNIVERSAL||e.type!==i.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],s=0;s<e.value.length;s++){var a=e.value[s],c={},l=[];if(!i.validate(a,u,c,l))throw(y=new Error("Cannot read SafeBag.")).errors=l,y;var p,f,d={type:i.derToOid(c.bagId),attributes:m(c.bagAttributes)};n.push(d);var g=c.bagValue.value[0];switch(d.type){case o.oids.pkcs8ShroudedKeyBag:if(null===(g=o.decryptPrivateKeyInfo(g,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case o.oids.keyBag:try{d.key=o.privateKeyFromAsn1(g)}catch(e){d.key=null,d.asn1=g}continue;case o.oids.certBag:p=h,f=function(){if(i.derToOid(c.certId)!==o.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=i.derToOid(c.certId),e}var r=i.fromDer(c.cert,t);try{d.cert=o.certificateFromAsn1(r,!0)}catch(e){d.cert=null,d.asn1=r}};break;default:var y;throw(y=new Error("Unsupported PKCS#12 SafeBag type.")).oid=d.type,y}if(void 0!==p&&!i.validate(g,p,c,l))throw(y=new Error("Cannot read PKCS#12 "+p.name)).errors=l,y;f()}return n}function m(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},s=[];if(!i.validate(e[r],l,n,s)){var a=new Error("Cannot read PKCS#12 BagAttribute.");throw a.errors=s,a}var c=i.derToOid(n.oid);if(void 0!==o.oids[c]){t[o.oids[c]]=[];for(var u=0;u<n.values.length;++u)t[o.oids[c]].push(n.values[u].value)}}return t}s.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var u={};if(!i.validate(e,c,u,[]))throw(l=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=l,l;var l,h={version:u.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=n.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=p(h.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=p(h.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=p(h.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return p(h.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return p(h.safeContents,"localKeyId",e,t)}};if(3!==u.version.charCodeAt(0))throw(l=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=u.version.charCodeAt(0),l;if(i.derToOid(u.contentType)!==o.oids.data)throw(l=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=i.derToOid(u.contentType),l;var m=u.content.value[0];if(m.tagClass!==i.Class.UNIVERSAL||m.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(m=f(m),u.mac){var y=null,v=0,b=i.derToOid(u.macAlgorithm);switch(b){case o.oids.sha1:y=n.md.sha1.create(),v=20;break;case o.oids.sha256:y=n.md.sha256.create(),v=32;break;case o.oids.sha384:y=n.md.sha384.create(),v=48;break;case o.oids.sha512:y=n.md.sha512.create(),v=64;break;case o.oids.md5:y=n.md.md5.create(),v=16}if(null===y)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+b);var _=new n.util.ByteBuffer(u.macSalt),E="macIterations"in u?parseInt(n.util.bytesToHex(u.macIterations),16):1,C=s.generateKey(r,_,3,E,v,y),w=n.hmac.create();if(w.start(y,C),w.update(m.value),w.getMac().getBytes()!==u.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if((t=i.fromDer(t,r)).tagClass!==i.Class.UNIVERSAL||t.type!==i.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var s=0;s<t.value.length;s++){var c=t.value[s],u={},l=[];if(!i.validate(c,a,u,l)){var h=new Error("Cannot read ContentInfo.");throw h.errors=l,h}var p={encrypted:!1},m=null,y=u.content.value[0];switch(i.derToOid(u.contentType)){case o.oids.data:if(y.tagClass!==i.Class.UNIVERSAL||y.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");m=f(y).value;break;case o.oids.encryptedData:m=d(y,n),p.encrypted=!0;break;default:var h=new Error("Unsupported PKCS#12 contentType.");throw h.contentType=i.derToOid(u.contentType),h}p.safeBags=g(m,r,n),e.safeContents.push(p)}}(h,m.value,t,r),h},s.toPkcs12Asn1=function(e,t,r,a){(a=a||{}).saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||a.encAlgorithm||"aes128","useMac"in a||(a.useMac=!0),"localKeyId"in a||(a.localKeyId=null),"generateLocalKeyId"in a||(a.generateLocalKeyId=!0);var c,u=a.localKeyId;if(null!==u)u=n.util.hexToBytes(u);else if(a.generateLocalKeyId)if(t){var l=n.util.isArray(t)?t[0]:t;"string"==typeof l&&(l=o.certificateFromPem(l)),(I=n.md.sha1.create()).update(i.toDer(o.certificateToAsn1(l)).getBytes()),u=I.digest().getBytes()}else u=n.random.getBytes(20);var h=[];null!==u&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,u)])])),"friendlyName"in a&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,!1,a.friendlyName)])])),h.length>0&&(c=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,h));var p=[],f=[];null!==t&&(f=n.util.isArray(t)?t:[t]);for(var d=[],g=0;g<f.length;++g){"string"==typeof(t=f[g])&&(t=o.certificateFromPem(t));var m=0===g?c:void 0,y=o.certificateToAsn1(t),v=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(y).getBytes())])])]),m]);d.push(v)}if(d.length>0){var b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,d),_=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(b).getBytes())])]);p.push(_)}var E=null;if(null!==e){var C=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));E=null===r?i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[C]),c]):i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[o.encryptPrivateKeyInfo(C,r,a)]),c]);var w=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[E]),S=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(w).getBytes())])]);p.push(S)}var T,A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,p);if(a.useMac){var I=n.md.sha1.create(),N=new n.util.ByteBuffer(n.random.getBytes(a.saltSize)),k=a.count,R=(e=s.generateKey(r,N,3,k,20),n.hmac.create());R.start(I,e),R.update(i.toDer(A).getBytes());var O=R.getMac();T=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,O.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,N.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(k).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(A).getBytes())])]),T])},s.generateKey=n.pbe.generatePkcs12Key},function(e,t,r){var n=r(2);r(31),r(5);var i=n.asn1,o=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=o;var s={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};o.contentInfoValidator=s;var a={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};o.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},o.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};o.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},o.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},function(e,t,r){var n=r(2);r(5),n.mgf=n.mgf||{},(e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{}).create=function(e){return{generate:function(t,r){for(var i=new n.util.ByteBuffer,o=Math.ceil(r/e.digestLength),s=0;s<o;s++){var a=new n.util.ByteBuffer;a.putInt32(s),e.start(),e.update(t+a.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}}}},function(e,t,r){var n=r(2);e.exports=n.debug=n.debug||{},n.debug.storage={},n.debug.get=function(e,t){var r;return void 0===e?r=n.debug.storage:e in n.debug.storage&&(r=void 0===t?n.debug.storage[e]:n.debug.storage[e][t]),r},n.debug.set=function(e,t,r){e in n.debug.storage||(n.debug.storage[e]={}),n.debug.storage[e][t]=r},n.debug.clear=function(e,t){void 0===e?n.debug.storage={}:e in n.debug.storage&&(void 0===t?delete n.debug.storage[e]:delete n.debug.storage[e][t])}},function(e,t,r){var n=r(2);r(32),r(5);var i=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=i;var o=n.sha384=n.sha512.sha384=n.sha512.sha384||{};o.create=function(){return i.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=o,n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,i.create=function(e){if(a||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(u={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0),void 0===e&&(e="SHA-512"),!(e in u))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=u[e],r=null,i=n.util.createBuffer(),o=new Array(80),h=0;h<80;++h)o[h]=new Array(2);var p=64;switch(e){case"SHA-384":p=48;break;case"SHA-512/256":p=32;break;case"SHA-512/224":p=28}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:p,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,o=0;o<e;++o)f.fullMessageLength.push(0);i=n.util.createBuffer(),r=new Array(t.length);for(o=0;o<t.length;++o)r[o]=t[o].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var s=e.length;f.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=f.fullMessageLength.length-1;a>=0;--a)f.fullMessageLength[a]+=s[1],s[1]=s[0]+(f.fullMessageLength[a]/4294967296>>>0),f.fullMessageLength[a]=f.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return i.putBytes(e),l(r,o,i),(i.read>2048||0===i.length())&&i.compact(),f},f.digest=function(){var t=n.util.createBuffer();t.putBytes(i.bytes());var a,c=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1;t.putBytes(s.substr(0,f.blockLength-c));for(var u=8*f.fullMessageLength[0],h=0;h<f.fullMessageLength.length-1;++h)u+=(a=8*f.fullMessageLength[h+1])/4294967296>>>0,t.putInt32(u>>>0),u=a>>>0;t.putInt32(u);var p=new Array(r.length);for(h=0;h<r.length;++h)p[h]=r[h].slice(0);l(p,o,t);var d,g=n.util.createBuffer();d="SHA-512"===e?p.length:"SHA-384"===e?p.length-2:p.length-4;for(h=0;h<d;++h)g.putInt32(p[h][0]),h===d-1&&"SHA-512/224"===e||g.putInt32(p[h][1]);return g},f};var s=null,a=!1,c=null,u=null;function l(e,t,r){for(var n,i,o,s,a,u,l,h,p,f,d,g,m,y,v,b,_,E,C,w,S,T,A,I,N,k,R,O,x,B,D,P,L,j=r.length();j>=128;){for(R=0;R<16;++R)t[R][0]=r.getInt32()>>>0,t[R][1]=r.getInt32()>>>0;for(;R<80;++R)n=(((O=(B=t[R-2])[0])>>>19|(x=B[1])<<13)^(x>>>29|O<<3)^O>>>6)>>>0,i=((O<<13|x>>>19)^(x<<3|O>>>29)^(O<<26|x>>>6))>>>0,o=(((O=(P=t[R-15])[0])>>>1|(x=P[1])<<31)^(O>>>8|x<<24)^O>>>7)>>>0,s=((O<<31|x>>>1)^(O<<24|x>>>8)^(O<<25|x>>>7))>>>0,D=t[R-7],L=t[R-16],x=i+D[1]+s+L[1],t[R][0]=n+D[0]+o+L[0]+(x/4294967296>>>0)>>>0,t[R][1]=x>>>0;for(d=e[0][0],g=e[0][1],m=e[1][0],y=e[1][1],v=e[2][0],b=e[2][1],_=e[3][0],E=e[3][1],C=e[4][0],w=e[4][1],S=e[5][0],T=e[5][1],A=e[6][0],I=e[6][1],N=e[7][0],k=e[7][1],R=0;R<80;++R)l=((C>>>14|w<<18)^(C>>>18|w<<14)^(w>>>9|C<<23))>>>0,h=(A^C&(S^A))>>>0,a=((d>>>28|g<<4)^(g>>>2|d<<30)^(g>>>7|d<<25))>>>0,u=((d<<4|g>>>28)^(g<<30|d>>>2)^(g<<25|d>>>7))>>>0,p=(d&m|v&(d^m))>>>0,f=(g&y|b&(g^y))>>>0,x=k+(((C<<18|w>>>14)^(C<<14|w>>>18)^(w<<23|C>>>9))>>>0)+((I^w&(T^I))>>>0)+c[R][1]+t[R][1],n=N+l+h+c[R][0]+t[R][0]+(x/4294967296>>>0)>>>0,i=x>>>0,o=a+p+((x=u+f)/4294967296>>>0)>>>0,s=x>>>0,N=A,k=I,A=S,I=T,S=C,T=w,C=_+n+((x=E+i)/4294967296>>>0)>>>0,w=x>>>0,_=v,E=b,v=m,b=y,m=d,y=g,d=n+o+((x=i+s)/4294967296>>>0)>>>0,g=x>>>0;x=e[0][1]+g,e[0][0]=e[0][0]+d+(x/4294967296>>>0)>>>0,e[0][1]=x>>>0,x=e[1][1]+y,e[1][0]=e[1][0]+m+(x/4294967296>>>0)>>>0,e[1][1]=x>>>0,x=e[2][1]+b,e[2][0]=e[2][0]+v+(x/4294967296>>>0)>>>0,e[2][1]=x>>>0,x=e[3][1]+E,e[3][0]=e[3][0]+_+(x/4294967296>>>0)>>>0,e[3][1]=x>>>0,x=e[4][1]+w,e[4][0]=e[4][0]+C+(x/4294967296>>>0)>>>0,e[4][1]=x>>>0,x=e[5][1]+T,e[5][0]=e[5][0]+S+(x/4294967296>>>0)>>>0,e[5][1]=x>>>0,x=e[6][1]+I,e[6][0]=e[6][0]+A+(x/4294967296>>>0)>>>0,e[6][1]=x>>>0,x=e[7][1]+k,e[7][0]=e[7][0]+N+(x/4294967296>>>0)>>>0,e[7][1]=x>>>0,j-=128}}},function(e,t,r){var n=r(2);r(5),e.exports=n.log=n.log||{},n.log.levels=["none","error","warning","info","debug","verbose","max"];var i={},o=[],s=null;n.log.LEVEL_LOCKED=2,n.log.NO_LEVEL_CHECK=4,n.log.INTERPOLATE=8;for(var a=0;a<n.log.levels.length;++a){var c=n.log.levels[a];i[c]={index:a,name:c.toUpperCase()}}n.log.logMessage=function(e){for(var t=i[e.level].index,r=0;r<o.length;++r){var s=o[r];if(s.flags&n.log.NO_LEVEL_CHECK)s.f(e);else t<=i[s.level].index&&s.f(s,e)}},n.log.prepareStandard=function(e){"standard"in e||(e.standard=i[e.level].name+" ["+e.category+"] "+e.message)},n.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]||!1),e.full=n.util.format.apply(this,t)}},n.log.prepareStandardFull=function(e){"standardFull"in e||(n.log.prepareStandard(e),e.standardFull=e.standard)};var u=["error","warning","info","debug","verbose"];for(a=0;a<u.length;++a)!function(e){n.log[e]=function(t,r){var i=Array.prototype.slice.call(arguments).slice(2),o={timestamp:new Date,level:e,category:t,message:r,arguments:i};n.log.logMessage(o)}}(u[a]);if(n.log.makeLogger=function(e){var t={flags:0,f:e};return n.log.setLevel(t,"none"),t},n.log.setLevel=function(e,t){var r=!1;if(e&&!(e.flags&n.log.LEVEL_LOCKED))for(var i=0;i<n.log.levels.length;++i){if(t==n.log.levels[i]){e.level=t,r=!0;break}}return r},n.log.lock=function(e,t){void 0===t||t?e.flags|=n.log.LEVEL_LOCKED:e.flags&=~n.log.LEVEL_LOCKED},n.log.addLogger=function(e){o.push(e)},"undefined"!=typeof console&&"log"in console){var l;if(console.error&&console.warn&&console.info&&console.debug){var h={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},p=function(e,t){n.log.prepareStandard(t);var r=h[t.level],i=[t.standard];i=i.concat(t.arguments.slice()),r.apply(console,i)};l=n.log.makeLogger(p)}else{p=function(e,t){n.log.prepareStandardFull(t),console.log(t.standardFull)};l=n.log.makeLogger(p)}n.log.setLevel(l,"debug"),n.log.addLogger(l),s=l}else console={log:function(){}};if(null!==s){var f=n.util.getQueryVariables();if("console.level"in f&&n.log.setLevel(s,f["console.level"].slice(-1)[0]),"console.lock"in f)"true"==f["console.lock"].slice(-1)[0]&&n.log.lock(s)}n.log.consoleLogger=s},function(e,t,r){e.exports={decode:r(188),verify:r(306),sign:r(307),JsonWebTokenError:r(113),NotBeforeError:r(192),TokenExpiredError:r(193)}},function(e,t,r){var n=r(76);e.exports=function(e,t){t=t||{};var r=n.decode(e,t);if(!r)return null;var i=r.payload;if("string"==typeof i)try{var o=JSON.parse(i);"object"==typeof o&&(i=o)}catch(e){}return!0===t.complete?{header:r.header,payload:i,signature:r.signature}:i}},function(e,t,r){var n=r(34).Buffer,i=r(9);function o(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=n.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=n.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}r(4).inherits(o,i),o.prototype.write=function(e){this.buffer=n.concat([this.buffer,n.from(e)]),this.emit("data",e)},o.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=o},function(e,t,r){var n=r(302),i=r(34).Buffer,o=r(33),s=r(303),a=r(4),c="secret must be a string or buffer",u="key must be a string or a buffer",l="key must be a string, a buffer or an object";function h(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function p(e){var t=[].slice.call(arguments,1),r=a.format.bind(a,e).apply(null,t);return new TypeError(r)}function f(e){return i.isBuffer(e)||"string"==typeof e}function d(e){return f(e)||(e=JSON.stringify(e)),e}function g(e){return function(t,r){if(!f(r))throw p(c);t=d(t);var n=o.createHmac("sha"+e,r);return h((n.update(t),n.digest("base64")))}}function m(e){return function(t,r,o){var s=g(e)(t,o);return n(i.from(r),i.from(s))}}function y(e){return function(t,r){if(!f(r)&&"object"!=typeof r)throw p(l);t=d(t);var n=o.createSign("RSA-SHA"+e);return h((n.update(t),n.sign(r,"base64")))}}function v(e){return function(t,r,n){if(!f(n))throw p(u);t=d(t),r=function(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}(r);var i=o.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function b(e){var t=y(e);return function(){var r=t.apply(null,arguments);return r=s.derToJose(r,"ES"+e)}}function _(e){var t=v(e);return function(r,n,i){return n=s.joseToDer(n,"ES"+e).toString("base64"),t(r,n,i)}}function E(){return function(){return""}}function C(){return function(e,t){return""===t}}e.exports=function(e){var t={hs:g,rs:y,es:b,none:E},r={hs:m,rs:v,es:_,none:C},n=e.match(/^(RS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw p('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512" and "none".',e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:t[i](o),verify:r[i](o)}}},function(e,t,r){var n=r(35).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||n.isBuffer(e)?e.toString():JSON.stringify(e)}},function(e,t,r){var n=r(113),i=function(e,t){n.call(this,e),this.name="NotBeforeError",this.date=t};(i.prototype=Object.create(n.prototype)).constructor=i,e.exports=i},function(e,t,r){var n=r(113),i=function(e,t){n.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};(i.prototype=Object.create(n.prototype)).constructor=i,e.exports=i},function(e,t,r){var n=r(195);e.exports=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var i=n(e);if(void 0===i)return;return Math.floor(r+i/1e3)}return"number"==typeof e?r+e:void 0}},function(e,t){var r=1e3,n=60*r,i=60*n,o=24*i,s=7*o,a=365.25*o;function c(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return c(e,t,o,"day");if(t>=i)return c(e,t,i,"hour");if(t>=n)return c(e,t,n,"minute");if(t>=r)return c(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){var r="[object String]",n=Object.prototype.toString,i=Array.isArray;e.exports=function(e){return"string"==typeof e||!i(e)&&function(e){return!!e&&"object"==typeof e}(e)&&n.call(e)==r}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(314),s=r(315),a=r(316),c=r(10),u=r(24),l=r(11),h=r(319),p=function(){function e(){}return e.prototype.delete=function(){return Promise.resolve(void 0)},e}(),f=function(e){function t(r){var n=e.call(this,t.getProjectId(r),new a.FirebaseAuthRequestHandler(r),s.cryptoSignerFromApp(r))||this;return n.INTERNAL=new p,n.app_=r,n}return i(t,e),t.getProjectId=function(e){if("object"!=typeof e||null===e||!("options"in e))throw new c.FirebaseAuthError(c.AuthClientErrorCode.INVALID_ARGUMENT,"First argument passed to admin.auth() must be a valid Firebase app instance.");return u.getProjectId(e)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),t}(function(){function e(e,t,r){this.projectId=e,this.authRequestHandler=t,this.tokenGenerator=new s.FirebaseTokenGenerator(r),this.sessionCookieVerifier=h.createSessionCookieVerifier(e),this.idTokenVerifier=h.createIdTokenVerifier(e)}return e.prototype.createCustomToken=function(e,t){return this.tokenGenerator.createCustomToken(e,t)},e.prototype.verifyIdToken=function(e,t){var r=this;return void 0===t&&(t=!1),this.idTokenVerifier.verifyJWT(e).then(function(e){return t?r.verifyDecodedJWTNotRevoked(e,c.AuthClientErrorCode.ID_TOKEN_REVOKED):e})},e.prototype.getUser=function(e){return this.authRequestHandler.getAccountInfoByUid(e).then(function(e){return new o.UserRecord(e.users[0])})},e.prototype.getUserByEmail=function(e){return this.authRequestHandler.getAccountInfoByEmail(e).then(function(e){return new o.UserRecord(e.users[0])})},e.prototype.getUserByPhoneNumber=function(e){return this.authRequestHandler.getAccountInfoByPhoneNumber(e).then(function(e){return new o.UserRecord(e.users[0])})},e.prototype.listUsers=function(e,t){return this.authRequestHandler.downloadAccount(e,t).then(function(e){var t=[];e.users.forEach(function(e){t.push(new o.UserRecord(e))});var r={users:t,pageToken:e.nextPageToken};return void 0===r.pageToken&&delete r.pageToken,r})},e.prototype.createUser=function(e){var t=this;return this.authRequestHandler.createNewAccount(e).then(function(e){return t.getUser(e)}).catch(function(e){if("auth/user-not-found"===e.code)throw new c.FirebaseAuthError(c.AuthClientErrorCode.INTERNAL_ERROR,"Unable to create the user record provided.");throw e})},e.prototype.deleteUser=function(e){return this.authRequestHandler.deleteAccount(e).then(function(e){})},e.prototype.updateUser=function(e,t){var r=this;return this.authRequestHandler.updateExistingAccount(e,t).then(function(e){return r.getUser(e)})},e.prototype.setCustomUserClaims=function(e,t){return this.authRequestHandler.setCustomUserClaims(e,t).then(function(e){})},e.prototype.revokeRefreshTokens=function(e){return this.authRequestHandler.revokeRefreshTokens(e).then(function(e){})},e.prototype.importUsers=function(e,t){return this.authRequestHandler.uploadAccount(e,t)},e.prototype.createSessionCookie=function(e,t){return l.isNonNullObject(t)&&l.isNumber(t.expiresIn)?this.authRequestHandler.createSessionCookie(e,t.expiresIn):Promise.reject(new c.FirebaseAuthError(c.AuthClientErrorCode.INVALID_SESSION_COOKIE_DURATION))},e.prototype.verifySessionCookie=function(e,t){var r=this;return void 0===t&&(t=!1),this.sessionCookieVerifier.verifyJWT(e).then(function(e){return t?r.verifyDecodedJWTNotRevoked(e,c.AuthClientErrorCode.SESSION_COOKIE_REVOKED):e})},e.prototype.generatePasswordResetLink=function(e,t){return this.authRequestHandler.getEmailActionLink("PASSWORD_RESET",e,t)},e.prototype.generateEmailVerificationLink=function(e,t){return this.authRequestHandler.getEmailActionLink("VERIFY_EMAIL",e,t)},e.prototype.generateSignInWithEmailLink=function(e,t){return this.authRequestHandler.getEmailActionLink("EMAIL_SIGNIN",e,t)},e.prototype.verifyDecodedJWTNotRevoked=function(e,t){return this.getUser(e.sub).then(function(r){if(r.tokensValidAfterTime&&1e3*e.auth_time<new Date(r.tokensValidAfterTime).getTime())throw new c.FirebaseAuthError(t);return e})},e}());t.Auth=f},function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"registerDatabase",function(){return vr}),r.d(t,"Database",function(){return lr}),r.d(t,"Query",function(){return Je}),r.d(t,"Reference",function(){return ir}),r.d(t,"enableLogging",function(){return b}),r.d(t,"ServerValue",function(){return yr}),r.d(t,"DataSnapshot",function(){return ze}),r.d(t,"OnDisconnect",function(){return he});var n,i=r(0),o=r(171),s=r(17),a=r(130),c=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Object(i.I)(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Object(i.B)(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),u=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Object(i.j)(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),l=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new c(t)}}catch(e){}return new u},h=l("localStorage"),p=l("sessionStorage"),f=new o.b("@firebase/database"),d=(n=1,function(){return n++}),g=function(e){var t=Object(i.H)(e),r=new i.d;r.update(t);var n=r.digest();return i.g.encodeByteArray(n)},m=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r="",n=0;n<e.length;n++)Array.isArray(e[n])||e[n]&&"object"==typeof e[n]&&"number"==typeof e[n].length?r+=m.apply(null,e[n]):"object"==typeof e[n]?r+=Object(i.I)(e[n]):r+=e[n],r+=" ";return r},y=null,v=!0,b=function(e,t){Object(i.e)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(f.logLevel=o.a.VERBOSE,y=f.log.bind(f),t&&p.set("logging_enabled",!0)):"function"==typeof e?y=e:(y=null,p.remove("logging_enabled"))},_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===v&&(v=!1,null===y&&!0===p.get("logging_enabled")&&b(!0)),y){var r=m.apply(null,e);y(r)}},E=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];_.apply(void 0,[e].concat(t))}},C=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE INTERNAL ERROR: "+m.apply(void 0,e);f.error(r)},w=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE FATAL ERROR: "+m.apply(void 0,e);throw f.error(r),new Error(r)},S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE WARNING: "+m.apply(void 0,e);f.warn(r)},T=function(e){return"number"==typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)},A="[MIN_NAME]",I="[MAX_NAME]",N=function(e,t){if(e===t)return 0;if(e===A||t===I)return-1;if(t===A||e===I)return 1;var r=L(e),n=L(t);return null!==r?null!==n?r-n==0?e.length-t.length:r-n:-1:null!==n?1:e<t?-1:1},k=function(e,t){return e===t?0:e<t?-1:1},R=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Object(i.I)(t))},O=function(e){if("object"!=typeof e||null===e)return Object(i.I)(e);var t=[];for(var r in e)t.push(r);t.sort();for(var n="{",o=0;o<t.length;o++)0!==o&&(n+=","),n+=Object(i.I)(t[o]),n+=":",n+=O(e[t[o]]);return n+="}"},x=function(e,t){var r=e.length;if(r<=t)return[e];for(var n=[],i=0;i<r;i+=t)i+t>r?n.push(e.substring(i,r)):n.push(e.substring(i,i+t));return n},B=function(e,t){if(Array.isArray(e))for(var r=0;r<e.length;++r)t(r,e[r]);else Object(i.r)(e,function(e,r){return t(r,e)})},D=function(e){Object(i.e)(!T(e),"Invalid JSON number");var t,r,n,o,s,a,c;for(0===e?(r=0,n=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=(o=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,n=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(r=0,n=Math.round(e/Math.pow(2,-1074)))),a=[],s=52;s;s-=1)a.push(n%2?1:0),n=Math.floor(n/2);for(s=11;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(t?1:0),a.reverse(),c=a.join("");var u="";for(s=0;s<64;s+=8){var l=parseInt(c.substr(s,8),2).toString(16);1===l.length&&(l="0"+l),u+=l}return u.toLowerCase()},P=new RegExp("^-?\\d{1,10}$"),L=function(e){if(P.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},j=function(e){try{e()}catch(e){setTimeout(function(){var t=e.stack||"";throw S("Exception was thrown by user callback.",t),e},Math.floor(0))}},U=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},M=function(e,t){var r=setTimeout(e,t);return"object"==typeof r&&r.unref&&r.unref(),r},F=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var r=0,n=0;n<this.pieces_.length;n++)this.pieces_[n].length>0&&(this.pieces_[r]=this.pieces_[n],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],r=this.pieceNum_;r<this.pieces_.length-1;r++)t.push(this.pieces_[r]);return new e(t,0)},e.prototype.child=function(t){for(var r=[],n=this.pieceNum_;n<this.pieces_.length;n++)r.push(this.pieces_[n]);if(t instanceof e)for(n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);else{var i=t.split("/");for(n=0;n<i.length;n++)i[n].length>0&&r.push(i[n])}return new e(r,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,r){var n=t.getFront(),i=r.getFront();if(null===n)return r;if(n===i)return e.relativePath(t.popFront(),r.popFront());throw new Error("INTERNAL ERROR: innerPath ("+r+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var r=e.slice(),n=t.slice(),i=0;i<r.length&&i<n.length;i++){var o=N(r[i],n[i]);if(0!==o)return o}return r.length===n.length?0:r.length<n.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,r=e.pieceNum_;t<=this.pieces_.length;t++,r++)if(this.pieces_[t]!==e.pieces_[r])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,r=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0},e}(),V=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=Object(i.G)(this.parts_[r]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=Object(i.G)(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=Object(i.G)(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),q="long_polling",K=function(){function e(e,t,r,n,i){void 0===i&&(i=""),this.secure=t,this.namespace=r,this.webSocketOnly=n,this.persistenceKey=i,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=h.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&h.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var r;if(Object(i.e)("string"==typeof e,"typeof type must == string"),Object(i.e)("object"==typeof t,"typeof params must == object"),"websocket"===e)r=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==q)throw new Error("Unknown connection type: "+e);r=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var n=[];return Object(i.r)(t,function(e,t){n.push(e+"="+t)}),r+n.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}();var H,G,z,W,Y,Q=function(e){var t=$(e),r=t.subdomain;"firebase"===t.domain&&w(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!=r||"localhost"===t.domain||w("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var n="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new K(t.host,t.secure,r,n),path:new F(t.pathString)}},$=function(e){var t="",r="",n="",i="",o=!0,s="https",a=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var u=e.indexOf("/");-1===u&&(u=e.length);var l=e.indexOf("?");-1===l&&(l=e.length),t=e.substring(0,Math.min(u,l)),u<l&&(i=function(e){for(var t="",r=e.split("/"),n=0;n<r.length;n++)if(r[n].length>0){var i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(u,l)));var h=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));for(var r=0,n=e.split("&");r<n.length;r++){var i=n[r];if(0!==i.length){var o=i.split("=");2===o.length?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):S("Invalid query segment '"+i+"' in query '"+e+"'")}}return t}(e.substring(Math.min(e.length,l)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,a=parseInt(t.substring(c+1),10)):c=e.length;var p=t.split(".");3===p.length?(r=p[1],n=p[0].toLowerCase()):2===p.length?r=p[0]:"localhost"===p[0].slice(0,c).toLowerCase()&&(r="localhost"),""===n&&"ns"in h&&(n=h.ns)}return{host:t,port:a,domain:r,subdomain:n,secure:o,scheme:s,pathString:i}},J=/[\[\].#$\/\u0000-\u001F\u007F]/,X=/[\[\].#$\u0000-\u001F\u007F]/,Z=function(e){return"string"==typeof e&&0!==e.length&&!J.test(e)},ee=function(e){return"string"==typeof e&&0!==e.length&&!X.test(e)},te=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!T(e)||e&&"object"==typeof e&&Object(i.j)(e,".sv")},re=function(e,t,r,n,o){o&&void 0===r||ne(Object(i.n)(e,t,o),r,n)},ne=function(e,t,r){var n=r instanceof F?new V(r,e):r;if(void 0===t)throw new Error(e+"contains undefined "+n.toErrorString());if("function"==typeof t)throw new Error(e+"contains a function "+n.toErrorString()+" with contents = "+t.toString());if(T(t))throw new Error(e+"contains "+t.toString()+" "+n.toErrorString());if("string"==typeof t&&t.length>10485760/3&&Object(i.G)(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+n.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var o=!1,s=!1;if(Object(i.r)(t,function(t,r){if(".value"===t)o=!0;else if(".priority"!==t&&".sv"!==t&&(s=!0,!Z(t)))throw new Error(e+" contains an invalid key ("+t+") "+n.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');n.push(t),ne(e,r,n),n.pop()}),o&&s)throw new Error(e+' contains ".value" child '+n.toErrorString()+" in addition to actual children.")}},ie=function(e,t,r,n,o){if(!o||void 0!==r){var s=Object(i.n)(e,t,o);if(!r||"object"!=typeof r||Array.isArray(r))throw new Error(s+" must be an object containing the children to replace.");var a=[];Object(i.r)(r,function(e,t){var r=new F(e);if(ne(s,t,n.child(r)),".priority"===r.getBack()&&!te(t))throw new Error(s+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),function(e,t){var r,n;for(r=0;r<t.length;r++)for(var i=(n=t[r]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Z(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+n.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(F.comparePaths);var s=null;for(r=0;r<t.length;r++){if(n=t[r],null!==s&&s.contains(n))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+n.toString());s=n}}(s,a)}},oe=function(e,t,r,n){if(!n||void 0!==r){if(T(r))throw new Error(Object(i.n)(e,t,n)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!te(r))throw new Error(Object(i.n)(e,t,n)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},se=function(e,t,r,n){if(!n||void 0!==r)switch(r){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(i.n)(e,t,n)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},ae=function(e,t,r,n){if(!(n&&void 0===r||Z(r)))throw new Error(Object(i.n)(e,t,n)+'was an invalid key = "'+r+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ce=function(e,t,r,n){if(!(n&&void 0===r||ee(r)))throw new Error(Object(i.n)(e,t,n)+'was an invalid path = "'+r+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ue=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},le=function(e,t,r){var n=r.path.toString();if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!Z(r.repoInfo.namespace)&&"localhost"!==r.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),ee(e)}(n))throw new Error(Object(i.n)(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},he=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){Object(i.J)("OnDisconnect.cancel",0,1,arguments.length),Object(i.K)("OnDisconnect.cancel",1,e,!0);var t=new i.b;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){Object(i.J)("OnDisconnect.remove",0,1,arguments.length),ue("OnDisconnect.remove",this.path_),Object(i.K)("OnDisconnect.remove",1,e,!0);var t=new i.b;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){Object(i.J)("OnDisconnect.set",1,2,arguments.length),ue("OnDisconnect.set",this.path_),re("OnDisconnect.set",1,e,this.path_,!1),Object(i.K)("OnDisconnect.set",2,t,!0);var r=new i.b;return this.repo_.onDisconnectSet(this.path_,e,r.wrapCallback(t)),r.promise},e.prototype.setWithPriority=function(e,t,r){Object(i.J)("OnDisconnect.setWithPriority",2,3,arguments.length),ue("OnDisconnect.setWithPriority",this.path_),re("OnDisconnect.setWithPriority",1,e,this.path_,!1),oe("OnDisconnect.setWithPriority",2,t,!1),Object(i.K)("OnDisconnect.setWithPriority",3,r,!0);var n=new i.b;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,n.wrapCallback(r)),n.promise},e.prototype.update=function(e,t){if(Object(i.J)("OnDisconnect.update",1,2,arguments.length),ue("OnDisconnect.update",this.path_),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ie("OnDisconnect.update",1,e,this.path_,!1),Object(i.K)("OnDisconnect.update",2,t,!0);var o=new i.b;return this.repo_.onDisconnectUpdate(this.path_,e,o.wrapCallback(t)),o.promise},e}(),pe=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return Object(i.J)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),fe=(H="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",G=0,z=[],function(e){var t,r=e===G;G=e;var n=new Array(8);for(t=7;t>=0;t--)n[t]=H.charAt(e%64),e=Math.floor(e/64);Object(i.e)(0===e,"Cannot push at time == 0");var o=n.join("");if(r){for(t=11;t>=0&&63===z[t];t--)z[t]=0;z[t]++}else for(t=0;t<12;t++)z[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)o+=H.charAt(z[t]);return Object(i.e)(20===o.length,"nextPushId: Length should be 20."),o}),de=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,r){return new e(t,r)},e}(),ge=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var r=new de(A,e),n=new de(A,t);return 0!==this.compare(r,n)},e.prototype.minPost=function(){return de.MIN},e}(),me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.b)(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return W},set:function(e){W=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return N(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Object(i.f)("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return de.MIN},t.prototype.maxPost=function(){return new de(I,W)},t.prototype.makePost=function(e,t){return Object(i.e)("string"==typeof e,"KeyIndex indexValue must always be a string."),new de(e,W)},t.prototype.toString=function(){return".key"},t}(ge),ye=new me;var ve,be,_e,Ee=function(e){return"number"==typeof e?"number:"+D(e):"string:"+e},Ce=function(e){if(e.isLeafNode()){var t=e.val();Object(i.e)("string"==typeof t||"number"==typeof t||"object"==typeof t&&Object(i.j)(t,".sv"),"Priority must be a string or number.")}else Object(i.e)(e===Y||e.isEmpty(),"priority of unexpected type.");Object(i.e)(e===Y||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},we=function(){function e(t,r){void 0===r&&(r=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=r,this.lazyHash_=null,Object(i.e)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ce(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return ve},set:function(e){ve=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,r){var n=t.getFront();return null===n?r:r.isEmpty()&&".priority"!==n?this:(Object(i.e)(".priority"!==n||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),r)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ee(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?D(this.value_):this.value_,this.lazyHash_=g(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Object(i.e)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var r=typeof t.value_,n=typeof this.value_,o=e.VALUE_TYPE_ORDER.indexOf(r),s=e.VALUE_TYPE_ORDER.indexOf(n);return Object(i.e)(o>=0,"Unknown leaf type: "+r),Object(i.e)(s>=0,"Unknown leaf type: "+n),o===s?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-o},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();var Se,Te,Ae=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.b)(t,e),t.prototype.compare=function(e,t){var r=e.node.getPriority(),n=t.node.getPriority(),i=r.compareTo(n);return 0===i?N(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return de.MIN},t.prototype.maxPost=function(){return new de(I,new we("[PRIORITY-POST]",_e))},t.prototype.makePost=function(e,t){var r=be(e);return new de(t,new we("[PRIORITY-POST]",r))},t.prototype.toString=function(){return".priority"},t}(ge)),Ie=function(){function e(e,t,r,n,i){void 0===i&&(i=null),this.isReverse_=n,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,n&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Ne=function(){function e(t,r,n,i,o){this.key=t,this.value=r,this.color=null!=n?n:e.RED,this.left=null!=i?i:Re.EMPTY_NODE,this.right=null!=o?o:Re.EMPTY_NODE}return e.prototype.copy=function(t,r,n,i,o){return new e(null!=t?t:this.key,null!=r?r:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,r){var n,i;return(i=(n=r(e,(i=this).key))<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===n?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return Re.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var r,n;if(t(e,(r=this).key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return Re.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){var e;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((e=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),ke=function(){function e(){}return e.prototype.copy=function(e,t,r,n,i){return this},e.prototype.insert=function(e,t,r){return new Ne(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),Re=function(){function e(t,r){void 0===r&&(r=e.EMPTY_NODE),this.comparator_=t,this.root_=r}return e.prototype.insert=function(t,r){return new e(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,Ne.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Ne.BLACK,null,null))},e.prototype.get=function(e){for(var t,r=this.root_;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key)))return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,r=this.root_,n=null;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key))){if(r.left.isEmpty())return n?n.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(n=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Ie(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Ie(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Ie(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Ie(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new ke,e}(),Oe=Math.log(2),xe=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Oe,10)),this.current_=this.count-1;var r,n=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=e+1&n}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Be=function(e,t,r,n){e.sort(t);var i=function(t,n){var o,s,a=n-t;if(0==a)return null;if(1==a)return o=e[t],s=r?r(o):o,new Ne(s,o.node,Ne.BLACK,null,null);var c=parseInt(a/2,10)+t,u=i(t,c),l=i(c+1,n);return o=e[c],s=r?r(o):o,new Ne(s,o.node,Ne.BLACK,u,l)},o=function(t){for(var n=null,o=null,s=e.length,a=function(t,n){var o=s-t,a=s;s-=t;var u=i(o+1,a),l=e[o],h=r?r(l):l;c(new Ne(h,l.node,n,null,u))},c=function(e){n?(n.left=e,n=e):(o=e,n=e)},u=0;u<t.count;++u){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(u+1));l?a(h,Ne.BLACK):(a(h,Ne.BLACK),a(h,Ne.RED))}return o}(new xe(e.length));return new Re(n||t,o)},De={},Pe=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return Object(i.e)(De&&Ae,"ChildrenNode.ts has not been loaded"),Se=Se||new e({".priority":De},{".priority":Ae})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=Object(i.F)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t===De?null:t},e.prototype.hasIndex=function(e){return Object(i.j)(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,r){Object(i.e)(t!==ye,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,o=[],s=!1,a=r.getIterator(de.Wrap),c=a.getNext();c;)s=s||t.isDefinedOn(c.node),o.push(c),c=a.getNext();n=s?Be(o,t.getCompare()):De;var u=t.toString(),l=Object(i.i)(this.indexSet_);l[u]=t;var h=Object(i.i)(this.indexes_);return h[u]=n,new e(h,l)},e.prototype.addToIndexes=function(t,r){var n=this;return new e(Object(i.C)(this.indexes_,function(e,o){var s=Object(i.F)(n.indexSet_,o);if(Object(i.e)(s,"Missing index implementation for "+o),e===De){if(s.isDefinedOn(t.node)){for(var a=[],c=r.getIterator(de.Wrap),u=c.getNext();u;)u.name!=t.name&&a.push(u),u=c.getNext();return a.push(t),Be(a,s.getCompare())}return De}var l=r.get(t.name),h=e;return l&&(h=h.remove(new de(t.name,l))),h.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,r){return new e(Object(i.C)(this.indexes_,function(e){if(e===De)return e;var n=r.get(t.name);return n?e.remove(new de(t.name,n)):e}),this.indexSet_)},e}();function Le(e,t){return N(e.name,t.name)}function je(e,t){return N(e,t)}var Ue=function(){function e(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Ce(this.priorityNode_),this.children_.isEmpty()&&Object(i.e)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return Te||(Te=new e(new Re(je),null,Pe.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||Te},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Te:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,r){if(Object(i.e)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);var n,o=new de(t,r),s=void 0,a=void 0;return r.isEmpty()?(s=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(o,this.children_)):(s=this.children_.insert(t,r),a=this.indexMap_.addToIndexes(o,this.children_)),n=s.isEmpty()?Te:this.priorityNode_,new e(s,n,a)},e.prototype.updateChild=function(e,t){var r=e.getFront();if(null===r)return t;Object(i.e)(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var n=this.getImmediateChild(r).updateChild(e.popFront(),t);return this.updateImmediateChild(r,n)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var r={},n=0,i=0,o=!0;if(this.forEachChild(Ae,function(s,a){r[s]=a.val(t),n++,o&&e.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1}),!t&&o&&i<2*n){var s=[];for(var a in r)s[a]=r[a];return s}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Ee(this.getPriority().val())+":"),this.forEachChild(Ae,function(t,r){var n=r.hash();""!==n&&(e+=":"+t+":"+n)}),this.lazyHash_=""===e?"":g(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,r){var n=this.resolveIndex_(r);if(n){var i=n.getPredecessorKey(new de(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.minKey();return r&&r.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new de(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.maxKey();return r&&r.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new de(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var r=this.resolveIndex_(e);return r?r.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,function(e){return e});for(var n=this.children_.getIteratorFrom(e.name,de.Wrap),i=n.peek();null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,function(e){return e});for(var n=this.children_.getReverseIteratorFrom(e.name,de.Wrap),i=n.peek();null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Me?-1:0},e.prototype.withIndex=function(t){if(t===ye||this.indexMap_.hasIndex(t))return this;var r=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,r)},e.prototype.isIndexed=function(e){return e===ye||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var r=this.getIterator(Ae),n=t.getIterator(Ae),i=r.getNext(),o=n.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=n.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===ye?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Me=new(function(e){function t(){return e.call(this,new Re(je),Ue.EMPTY_NODE,Pe.Default)||this}return Object(s.b)(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return Ue.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(Ue));Object.defineProperties(de,{MIN:{value:new de(A,Ue.EMPTY_NODE)},MAX:{value:new de(I,Me)}}),me.__EMPTY_NODE=Ue.EMPTY_NODE,we.__childrenNodeConstructor=Ue,Y=Me,function(e){_e=e}(Me);var Fe=!0;function Ve(e,t){if(void 0===t&&(t=null),null===e)return Ue.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Object(i.e)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new we(e,Ve(t));if(e instanceof Array||!Fe){var r=Ue.EMPTY_NODE,n=e;return Object(i.r)(n,function(e,t){if(Object(i.j)(n,e)&&"."!==e.substring(0,1)){var o=Ve(t);!o.isLeafNode()&&o.isEmpty()||(r=r.updateImmediateChild(e,o))}}),r.updatePriority(Ve(t))}var o=[],s=!1,a=e;if(Object(i.r)(a,function(e,t){if("string"!=typeof e||"."!==e.substring(0,1)){var r=Ve(a[e]);r.isEmpty()||(s=s||!r.getPriority().isEmpty(),o.push(new de(e,r)))}}),0==o.length)return Ue.EMPTY_NODE;var c=Be(o,Le,function(e){return e.name},je);if(s){var u=Be(o,Ae.getCompare());return new Ue(c,Ve(t),new Pe({".priority":u},{".priority":Ae}))}return new Ue(c,Ve(t),Pe.Default)}!function(e){be=e}(Ve);var qe,Ke,He=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.b)(t,e),t.prototype.compare=function(e,t){var r=e.node.compareTo(t.node);return 0===r?N(e.name,t.name):r},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return de.MIN},t.prototype.maxPost=function(){return de.MAX},t.prototype.makePost=function(e,t){var r=Ve(e);return new de(t,r)},t.prototype.toString=function(){return".value"},t}(ge)),Ge=function(e){function t(t){var r=e.call(this)||this;return r.indexPath_=t,Object(i.e)(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),r}return Object(s.b)(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var r=this.extractChild(e.node),n=this.extractChild(t.node),i=r.compareTo(n);return 0===i?N(e.name,t.name):i},t.prototype.makePost=function(e,t){var r=Ve(e),n=Ue.EMPTY_NODE.updateChild(this.indexPath_,r);return new de(t,n)},t.prototype.maxPost=function(){var e=Ue.EMPTY_NODE.updateChild(this.indexPath_,Me);return new de(I,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(ge),ze=function(){function e(e,t,r){this.node_=e,this.ref_=t,this.index_=r}return e.prototype.val=function(){return Object(i.J)("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return Object(i.J)("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return Object(i.J)("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return Object(i.J)("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){Object(i.J)("DataSnapshot.child",0,1,arguments.length),t=String(t),ce("DataSnapshot.child",1,t,!1);var r=new F(t),n=this.ref_.child(r);return new e(this.node_.getChild(r),n,Ae)},e.prototype.hasChild=function(e){Object(i.J)("DataSnapshot.hasChild",1,1,arguments.length),ce("DataSnapshot.hasChild",1,e,!1);var t=new F(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return Object(i.J)("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var r=this;return Object(i.J)("DataSnapshot.forEach",1,1,arguments.length),Object(i.K)("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(n,i){return t(new e(i,r.ref_.child(n),Ae))})},e.prototype.hasChildren=function(){return Object(i.J)("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return Object(i.J)("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return Object(i.J)("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),We=function(){function e(e,t,r,n){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=n}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(i.I)(this.snapshot.exportVal())},e}(),Ye=function(){function e(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),Qe=function(){function e(e,t,r){this.callback_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var r=t.getQueryParams().getIndex();return new We("value",this,new ze(e.snapshotNode,t.getRef(),r))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){Object(i.e)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callback_;return function(){n.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Ye(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),$e=function(){function e(e,t,r){this.callbacks_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,Object(i.j)(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Ye(this,e,t):null},e.prototype.createEvent=function(e,t){Object(i.e)(null!=e.childName,"Child events should have a childName.");var r=t.getRef().child(e.childName),n=t.getQueryParams().getIndex();return new We(e.type,this,new ze(e.snapshotNode,r,n),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){Object(i.e)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callbacks_[e.eventType];return function(){n.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var r=Object(i.t)(t.callbacks_);if(r===Object(i.t)(this.callbacks_)){if(1===r){var n=Object(i.s)(t.callbacks_),o=Object(i.s)(this.callbacks_);return!(o!==n||t.callbacks_[n]&&this.callbacks_[o]&&t.callbacks_[n]!==this.callbacks_[o])}return Object(i.o)(this.callbacks_,function(e,r){return t.callbacks_[e]===r})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}(),Je=function(){function e(e,t,r,n){this.repo=e,this.path=t,this.queryParams_=r,this.orderByCalled_=n}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return Object(i.e)(qe,"Reference.ts has not been loaded"),qe},set:function(e){qe=e},enumerable:!0,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,r=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(r=e.getIndexEndValue()),e.getIndex()===ye){var n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!=A)throw new Error(n);if("string"!=typeof t)throw new Error(o)}if(e.hasEnd()){if(e.getIndexEndName()!=I)throw new Error(n);if("string"!=typeof r)throw new Error(o)}}else if(e.getIndex()===Ae){if(null!=t&&!te(t)||null!=r&&!te(r))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(i.e)(e.getIndex()instanceof Ge||e.getIndex()===He,"unknown index type."),null!=t&&"object"==typeof t||null!=r&&"object"==typeof r)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return Object(i.J)("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,r,n,o){Object(i.J)("Query.on",2,4,arguments.length),se("Query.on",1,t,!1),Object(i.K)("Query.on",2,r,!1);var s=e.getCancelAndContextArgs_("Query.on",n,o);if("value"===t)this.onValueEvent(r,s.cancel,s.context);else{var a={};a[t]=r,this.onChildEvent(a,s.cancel,s.context)}return r},e.prototype.onValueEvent=function(e,t,r){var n=new Qe(e,t||null,r||null);this.repo.addEventCallbackForQuery(this,n)},e.prototype.onChildEvent=function(e,t,r){var n=new $e(e,t,r);this.repo.addEventCallbackForQuery(this,n)},e.prototype.off=function(e,t,r){Object(i.J)("Query.off",0,3,arguments.length),se("Query.off",1,e,!0),Object(i.K)("Query.off",2,t,!0),Object(i.L)("Query.off",3,r,!0);var n=null,o=null;"value"===e?n=new Qe(t||null,null,r||null):e&&(t&&((o={})[e]=t),n=new $e(o,null,r||null));this.repo.removeEventCallbackForQuery(this,n)},e.prototype.once=function(t,r,n,o){var s=this;Object(i.J)("Query.once",1,4,arguments.length),se("Query.once",1,t,!1),Object(i.K)("Query.once",2,r,!0);var a=e.getCancelAndContextArgs_("Query.once",n,o),c=!0,u=new i.b;u.promise.catch(function(){});var l=function(e){c&&(c=!1,s.off(t,l),r&&r.bind(a.context)(e),u.resolve(e))};return this.on(t,l,function(e){s.off(t,l),a.cancel&&a.cancel.bind(a.context)(e),u.reject(e)}),u.promise},e.prototype.limitToFirst=function(t){if(Object(i.J)("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(Object(i.J)("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(Object(i.J)("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');ce("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var r=new F(t);if(r.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new Ge(r),o=this.queryParams_.orderBy(n);return e.validateQueryEndpoints_(o),new e(this.repo,this.path,o,!0)},e.prototype.orderByKey=function(){Object(i.J)("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(ye);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){Object(i.J)("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(Ae);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){Object(i.J)("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(He);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,r){void 0===t&&(t=null),Object(i.J)("Query.startAt",0,2,arguments.length),re("Query.startAt",1,t,this.path,!0),ae("Query.startAt",2,r,!0);var n=this.queryParams_.startAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,r=null),new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.endAt=function(t,r){void 0===t&&(t=null),Object(i.J)("Query.endAt",0,2,arguments.length),re("Query.endAt",1,t,this.path,!0),ae("Query.endAt",2,r,!0);var n=this.queryParams_.endAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(Object(i.J)("Query.equalTo",1,2,arguments.length),re("Query.equalTo",1,e,this.path,!1),ae("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return Object(i.J)("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return Object(i.J)("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=O(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(Object(i.J)("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var r=this.repo===t.repo,n=this.path.equals(t.path),o=this.queryIdentifier()===t.queryIdentifier();return r&&n&&o},e.getCancelAndContextArgs_=function(e,t,r){var n={cancel:null,context:null};if(t&&r)n.cancel=t,Object(i.K)(e,3,n.cancel,!0),n.context=r,Object(i.L)(e,4,n.context,!0);else if(t)if("object"==typeof t&&null!==t)n.context=t;else{if("function"!=typeof t)throw new Error(Object(i.n)(e,3,!0)+" must either be a cancel callback or a context object.");n.cancel=t}return n},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),Xe=function(){function e(){this.set={}}return e.prototype.add=function(e,t){this.set[e]=null===t||t},e.prototype.contains=function(e){return Object(i.j)(this.set,e)},e.prototype.get=function(e){return this.contains(e)?this.set[e]:void 0},e.prototype.remove=function(e){delete this.set[e]},e.prototype.clear=function(){this.set={}},e.prototype.isEmpty=function(){return Object(i.w)(this.set)},e.prototype.count=function(){return Object(i.t)(this.set)},e.prototype.each=function(e){Object(i.r)(this.set,function(t,r){return e(t,r)})},e.prototype.keys=function(){var e=[];return Object(i.r)(this.set,function(t){e.push(t)}),e},e}(),Ze=function(){function e(){this.value_=null,this.children_=null}return e.prototype.find=function(e){if(null!=this.value_)return this.value_.getChild(e);if(e.isEmpty()||null==this.children_)return null;var t=e.getFront();return e=e.popFront(),this.children_.contains(t)?this.children_.get(t).find(e):null},e.prototype.remember=function(t,r){if(t.isEmpty())this.value_=r,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(t,r);else{null==this.children_&&(this.children_=new Xe);var n=t.getFront();this.children_.contains(n)||this.children_.add(n,new e);var i=this.children_.get(n);t=t.popFront(),i.remember(t,r)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var t=this.value_;this.value_=null;var r=this;return t.forEachChild(Ae,function(e,t){r.remember(new F(e),t)}),this.forget(e)}if(null!==this.children_){var n=e.getFront();if(e=e.popFront(),this.children_.contains(n))this.children_.get(n).forget(e)&&this.children_.remove(n);return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},e.prototype.forEachTree=function(e,t){null!==this.value_?t(e,this.value_):this.forEachChild(function(r,n){var i=new F(e.toString()+"/"+r);n.forEachTree(i,t)})},e.prototype.forEachChild=function(e){null!==this.children_&&this.children_.each(function(t,r){e(t,r)})},e}(),et=function(e,t){return e&&"object"==typeof e?(Object(i.e)(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e},tt=function(e,t){var r,n=e.getPriority().val(),i=et(n,t);if(e.isLeafNode()){var o=e,s=et(o.getValue(),t);return s!==o.getValue()||i!==o.getPriority().val()?new we(s,Ve(i)):e}var a=e;return r=a,i!==a.getPriority().val()&&(r=r.updatePriority(new we(i))),a.forEachChild(Ae,function(e,n){var i=tt(n,t);i!==n&&(r=r.updateImmediateChild(e,i))}),r};!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ke||(Ke={}));var rt,nt,it=function(){function e(e,t,r,n){this.fromUser=e,this.fromServer=t,this.queryId=r,this.tagged=n,Object(i.e)(!n||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}(),ot=function(){function e(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ke.ACK_USER_WRITE,this.source=it.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Object(i.e)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var r=this.affectedTree.subtree(new F(t));return new e(F.Empty,r,this.revert)}return Object(i.e)(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}(),st=function(){return rt||(rt=new Re(k)),rt},at=function(){function e(e,t){void 0===t&&(t=st()),this.value=e,this.children=t}return e.fromObject=function(t){var r=e.Empty;return Object(i.r)(t,function(e,t){r=r.set(new F(e),t)}),r},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:F.Empty,value:this.value};if(e.isEmpty())return null;var r=e.getFront(),n=this.children.get(r);if(null!==n){var i=n.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new F(r).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var r=t.getFront(),n=this.children.get(r);return null!==n?n.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,r){if(t.isEmpty())return new e(r,this.children);var n=t.getFront(),i=(this.children.get(n)||e.Empty).set(t.popFront(),r),o=this.children.insert(n,i);return new e(this.value,o)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var r=t.getFront(),n=this.children.get(r);if(n){var i=n.remove(t.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),r=this.children.get(t);return r?r.get(e.popFront()):null},e.prototype.setTree=function(t,r){if(t.isEmpty())return r;var n=t.getFront(),i=(this.children.get(n)||e.Empty).setTree(t.popFront(),r),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(F.Empty,e)},e.prototype.fold_=function(e,t){var r={};return this.children.inorderTraversal(function(n,i){r[n]=i.fold_(e.child(n),t)}),t(e,this.value,r)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,F.Empty,t)},e.prototype.findOnPath_=function(e,t,r){var n=!!this.value&&r(t,this.value);if(n)return n;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),r):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,F.Empty,t)},e.prototype.foreachOnPath_=function(t,r,n){if(t.isEmpty())return this;this.value&&n(r,this.value);var i=t.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(t.popFront(),r.child(i),n):e.Empty},e.prototype.foreach=function(e){this.foreach_(F.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(r,n){n.foreach_(e.child(r),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,r){r.value&&e(t,r.value)})},e.Empty=new e(null),e}(),ct=function(){function e(e,t){this.source=e,this.path=t,this.type=Ke.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,F.Empty):new e(this.source,this.path.popFront())},e}(),ut=function(){function e(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ke.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,F.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}(),lt=function(){function e(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ke.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var r=this.children.subtree(new F(t));return r.isEmpty()?null:r.value?new ut(this.source,F.Empty,r.value):new e(this.source,F.Empty,r)}return Object(i.e)(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),ht=function(){function e(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),pt=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,r,n){return new e(new ht(t,r,n),this.serverCache_)},e.prototype.updateServerSnap=function(t,r,n){return new e(this.eventCache_,new ht(t,r,n))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new ht(Ue.EMPTY_NODE,!1,!1),new ht(Ue.EMPTY_NODE,!1,!1)),e}(),ft=function(){function e(e,t,r,n,i){this.type=e,this.snapshotNode=t,this.childName=r,this.oldSnap=n,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,r){return new e(e.CHILD_ADDED,r,t)},e.childRemovedChange=function(t,r){return new e(e.CHILD_REMOVED,r,t)},e.childChangedChange=function(t,r,n){return new e(e.CHILD_CHANGED,r,t,n)},e.childMovedChange=function(t,r){return new e(e.CHILD_MOVED,r,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}(),dt=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,r,n,o,s){Object(i.e)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(n).equals(r.getChild(n))&&a.isEmpty()==r.isEmpty()?e:(null!=s&&(r.isEmpty()?e.hasChild(t)?s.trackChildChange(ft.childRemovedChange(t,a)):Object(i.e)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(ft.childAddedChange(t,r)):s.trackChildChange(ft.childChangedChange(t,r,a))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Ae,function(e,n){t.hasChild(e)||r.trackChildChange(ft.childRemovedChange(e,n))}),t.isLeafNode()||t.forEachChild(Ae,function(t,n){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(n)||r.trackChildChange(ft.childChangedChange(t,n,i))}else r.trackChildChange(ft.childAddedChange(t,n))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?Ue.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),gt=function(){function e(){this.changeMap_={}}return e.prototype.trackChildChange=function(e){var t=e.type,r=e.childName;Object(i.e)(t==ft.CHILD_ADDED||t==ft.CHILD_CHANGED||t==ft.CHILD_REMOVED,"Only child changes supported for tracking"),Object(i.e)(".priority"!==r,"Only non-priority child changes can be tracked.");var n=Object(i.F)(this.changeMap_,r);if(n){var o=n.type;if(t==ft.CHILD_ADDED&&o==ft.CHILD_REMOVED)this.changeMap_[r]=ft.childChangedChange(r,e.snapshotNode,n.snapshotNode);else if(t==ft.CHILD_REMOVED&&o==ft.CHILD_ADDED)delete this.changeMap_[r];else if(t==ft.CHILD_REMOVED&&o==ft.CHILD_CHANGED)this.changeMap_[r]=ft.childRemovedChange(r,n.oldSnap);else if(t==ft.CHILD_CHANGED&&o==ft.CHILD_ADDED)this.changeMap_[r]=ft.childAddedChange(r,e.snapshotNode);else{if(t!=ft.CHILD_CHANGED||o!=ft.CHILD_CHANGED)throw Object(i.f)("Illegal combination of changes: "+e+" occurred after "+n);this.changeMap_[r]=ft.childChangedChange(r,e.snapshotNode,n.oldSnap)}}else this.changeMap_[r]=e},e.prototype.getChanges=function(){return Object(i.u)(this.changeMap_)},e}(),mt=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,r){return null},e}()),yt=function(){function e(e,t,r){void 0===r&&(r=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var r=null!=this.optCompleteServerCache_?new ht(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,r)},e.prototype.getChildAfterChild=function(e,t,r){var n=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(n,t,1,r,e);return 0===i.length?null:i[0]},e}(),vt=function(){return function(e,t){this.viewCache=e,this.changes=t}}(),bt=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){Object(i.e)(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Object(i.e)(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,r,n,o){var s,a,c=new gt;if(r.type===Ke.OVERWRITE){var u=r;u.source.fromUser?s=this.applyUserOverwrite_(t,u.path,u.snap,n,o,c):(Object(i.e)(u.source.fromServer,"Unknown source."),a=u.source.tagged||t.getServerCache().isFiltered()&&!u.path.isEmpty(),s=this.applyServerOverwrite_(t,u.path,u.snap,n,o,a,c))}else if(r.type===Ke.MERGE){var l=r;l.source.fromUser?s=this.applyUserMerge_(t,l.path,l.children,n,o,c):(Object(i.e)(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.getServerCache().isFiltered(),s=this.applyServerMerge_(t,l.path,l.children,n,o,a,c))}else if(r.type===Ke.ACK_USER_WRITE){var h=r;s=h.revert?this.revertUserWrite_(t,h.path,n,o,c):this.ackUserWrite_(t,h.path,h.affectedTree,n,o,c)}else{if(r.type!==Ke.LISTEN_COMPLETE)throw Object(i.f)("Unknown operation type: "+r.type);s=this.listenComplete_(t,r.path,n,c)}var p=c.getChanges();return e.maybeAddValueEvent_(t,s,p),new vt(s,p)},e.maybeAddValueEvent_=function(e,t,r){var n=t.getEventCache();if(n.isFullyInitialized()){var i=n.getNode().isLeafNode()||n.getNode().isEmpty(),o=e.getCompleteEventSnap();(r.length>0||!e.getEventCache().isFullyInitialized()||i&&!n.getNode().equals(o)||!n.getNode().getPriority().equals(o.getPriority()))&&r.push(ft.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,r,n,o){var s=e.getEventCache();if(null!=r.shadowingWrite(t))return e;var a=void 0,c=void 0;if(t.isEmpty())if(Object(i.e)(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var u=e.getCompleteServerSnap(),l=u instanceof Ue?u:Ue.EMPTY_NODE,h=r.calcCompleteEventChildren(l);a=this.filter_.updateFullNode(e.getEventCache().getNode(),h,o)}else{var p=r.calcCompleteEventCache(e.getCompleteServerSnap());a=this.filter_.updateFullNode(e.getEventCache().getNode(),p,o)}else{var f=t.getFront();if(".priority"==f){Object(i.e)(1==t.getLength(),"Can't have a priority with additional path components");var d=s.getNode();c=e.getServerCache().getNode();var g=r.calcEventCacheAfterServerOverwrite(t,d,c);a=null!=g?this.filter_.updatePriority(d,g):s.getNode()}else{var m=t.popFront(),y=void 0;if(s.isCompleteForChild(f)){c=e.getServerCache().getNode();var v=r.calcEventCacheAfterServerOverwrite(t,s.getNode(),c);y=null!=v?s.getNode().getImmediateChild(f).updateChild(m,v):s.getNode().getImmediateChild(f)}else y=r.calcCompleteChild(f,e.getServerCache());a=null!=y?this.filter_.updateChild(s.getNode(),f,y,m,n,o):s.getNode()}}return e.updateEventSnap(a,s.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,r,n,i,o,s){var a,c=e.getServerCache(),u=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())a=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){var l=c.getNode().updateChild(t,r);a=u.updateFullNode(c.getNode(),l,null)}else{var h=t.getFront();if(!c.isCompleteForPath(t)&&t.getLength()>1)return e;var p=t.popFront(),f=c.getNode().getImmediateChild(h).updateChild(p,r);a=".priority"==h?u.updatePriority(c.getNode(),f):u.updateChild(c.getNode(),h,f,p,mt,null)}var d=e.updateServerSnap(a,c.isFullyInitialized()||t.isEmpty(),u.filtersNodes()),g=new yt(n,d,i);return this.generateEventCacheAfterServerEvent_(d,t,n,g,s)},e.prototype.applyUserOverwrite_=function(e,t,r,n,i,o){var s,a,c=e.getEventCache(),u=new yt(n,e,i);if(t.isEmpty())a=this.filter_.updateFullNode(e.getEventCache().getNode(),r,o),s=e.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var l=t.getFront();if(".priority"===l)a=this.filter_.updatePriority(e.getEventCache().getNode(),r),s=e.updateEventSnap(a,c.isFullyInitialized(),c.isFiltered());else{var h=t.popFront(),p=c.getNode().getImmediateChild(l),f=void 0;if(h.isEmpty())f=r;else{var d=u.getCompleteChild(l);f=null!=d?".priority"===h.getBack()&&d.getChild(h.parent()).isEmpty()?d:d.updateChild(h,r):Ue.EMPTY_NODE}if(p.equals(f))s=e;else{var g=this.filter_.updateChild(c.getNode(),l,f,h,u,o);s=e.updateEventSnap(g,c.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,r,n,i,o,s){var a=this,c=t;return n.foreach(function(n,u){var l=r.child(n);e.cacheHasChild_(t,l.getFront())&&(c=a.applyUserOverwrite_(c,l,u,i,o,s))}),n.foreach(function(n,u){var l=r.child(n);e.cacheHasChild_(t,l.getFront())||(c=a.applyUserOverwrite_(c,l,u,i,o,s))}),c},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,r){e=e.updateChild(t,r)}),e},e.prototype.applyServerMerge_=function(e,t,r,n,i,o,s){var a=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var c,u=e;c=t.isEmpty()?r:at.Empty.setTree(t,r);var l=e.getServerCache().getNode();return c.children.inorderTraversal(function(t,r){if(l.hasChild(t)){var c=e.getServerCache().getNode().getImmediateChild(t),h=a.applyMerge_(c,r);u=a.applyServerOverwrite_(u,new F(t),h,n,i,o,s)}}),c.children.inorderTraversal(function(t,r){var c=!e.getServerCache().isCompleteForChild(t)&&null==r.value;if(!l.hasChild(t)&&!c){var h=e.getServerCache().getNode().getImmediateChild(t),p=a.applyMerge_(h,r);u=a.applyServerOverwrite_(u,new F(t),p,n,i,o,s)}}),u},e.prototype.ackUserWrite_=function(e,t,r,n,i,o){if(null!=n.shadowingWrite(t))return e;var s=e.getServerCache().isFiltered(),a=e.getServerCache();if(null!=r.value){if(t.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,a.getNode().getChild(t),n,i,s,o);if(t.isEmpty()){var c=at.Empty;return a.getNode().forEachChild(ye,function(e,t){c=c.set(new F(e),t)}),this.applyServerMerge_(e,t,c,n,i,s,o)}return e}var u=at.Empty;return r.foreach(function(e,r){var n=t.child(e);a.isCompleteForPath(n)&&(u=u.set(e,a.getNode().getChild(n)))}),this.applyServerMerge_(e,t,u,n,i,s,o)},e.prototype.listenComplete_=function(e,t,r,n){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,r,mt,n)},e.prototype.revertUserWrite_=function(e,t,r,n,o){var s;if(null!=r.shadowingWrite(t))return e;var a=new yt(r,e,n),c=e.getEventCache().getNode(),u=void 0;if(t.isEmpty()||".priority"===t.getFront()){var l=void 0;if(e.getServerCache().isFullyInitialized())l=r.calcCompleteEventCache(e.getCompleteServerSnap());else{var h=e.getServerCache().getNode();Object(i.e)(h instanceof Ue,"serverChildren would be complete if leaf node"),l=r.calcCompleteEventChildren(h)}l=l,u=this.filter_.updateFullNode(c,l,o)}else{var p=t.getFront(),f=r.calcCompleteChild(p,e.getServerCache());null==f&&e.getServerCache().isCompleteForChild(p)&&(f=c.getImmediateChild(p)),(u=null!=f?this.filter_.updateChild(c,p,f,t.popFront(),a,o):e.getEventCache().getNode().hasChild(p)?this.filter_.updateChild(c,p,Ue.EMPTY_NODE,t.popFront(),a,o):c).isEmpty()&&e.getServerCache().isFullyInitialized()&&(s=r.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(u=this.filter_.updateFullNode(u,s,o))}return s=e.getServerCache().isFullyInitialized()||null!=r.shadowingWrite(F.Empty),e.updateEventSnap(u,s,this.filter_.filtersNodes())},e}(),_t=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,r){var n=this,i=[],o=[];return e.forEach(function(e){e.type===ft.CHILD_CHANGED&&n.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(ft.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,ft.CHILD_REMOVED,e,r,t),this.generateEventsForType_(i,ft.CHILD_ADDED,e,r,t),this.generateEventsForType_(i,ft.CHILD_MOVED,o,r,t),this.generateEventsForType_(i,ft.CHILD_CHANGED,e,r,t),this.generateEventsForType_(i,ft.VALUE,e,r,t),i},e.prototype.generateEventsForType_=function(e,t,r,n,i){var o=this,s=r.filter(function(e){return e.type===t});s.sort(this.compareChanges_.bind(this)),s.forEach(function(t){var r=o.materializeSingleChange_(t,i);n.forEach(function(n){n.respondsTo(t.type)&&e.push(n.createEvent(r,o.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw Object(i.f)("Should only compare child_ events.");var r=new de(e.childName,e.snapshotNode),n=new de(t.childName,t.snapshotNode);return this.index_.compare(r,n)},e}(),Et=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var r=this.query_.getQueryParams(),n=new dt(r.getIndex()),i=r.getNodeFilter();this.processor_=new bt(i);var o=t.getServerCache(),s=t.getEventCache(),a=n.updateFullNode(Ue.EMPTY_NODE,o.getNode(),null),c=i.updateFullNode(Ue.EMPTY_NODE,s.getNode(),null),u=new ht(a,o.isFullyInitialized(),n.filtersNodes()),l=new ht(c,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new pt(l,u),this.eventGenerator_=new _t(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var r=[];if(t){Object(i.e)(null==e,"A cancel should cancel all event registrations.");var n=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,n);i&&r.push(i)})}if(e){for(var o=[],s=0;s<this.eventRegistrations_.length;++s){var a=this.eventRegistrations_[s];if(a.matches(e)){if(e.hasAnyCallback()){o=o.concat(this.eventRegistrations_.slice(s+1));break}}else o.push(a)}this.eventRegistrations_=o}else this.eventRegistrations_=[];return r},e.prototype.applyOperation=function(e,t,r){e.type===Ke.MERGE&&null!==e.source.queryId&&(Object(i.e)(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Object(i.e)(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var n=this.viewCache_,o=this.processor_.applyOperation(n,e,t,r);return this.processor_.assertIndexed(o.viewCache),Object(i.e)(o.viewCache.getServerCache().isFullyInitialized()||!n.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=o.viewCache,this.generateEventsForChanges_(o.changes,o.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),r=[];t.getNode().isLeafNode()||t.getNode().forEachChild(Ae,function(e,t){r.push(ft.childAddedChange(e,t))});return t.isFullyInitialized()&&r.push(ft.valueChange(t.getNode())),this.generateEventsForChanges_(r,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,r){var n=r?[r]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,n)},e}(),Ct=function(){function e(){this.views_={}}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return Object(i.e)(nt,"Reference.ts has not been loaded"),nt},set:function(e){Object(i.e)(!nt,"__referenceConstructor has already been defined"),nt=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return Object(i.w)(this.views_)},e.prototype.applyOperation=function(e,t,r){var n=e.source.queryId;if(null!==n){var o=Object(i.F)(this.views_,n);return Object(i.e)(null!=o,"SyncTree gave us an op for an invalid query."),o.applyOperation(e,t,r)}var s=[];return Object(i.r)(this.views_,function(n,i){s=s.concat(i.applyOperation(e,t,r))}),s},e.prototype.addEventRegistration=function(e,t,r,n,o){var s=e.queryIdentifier(),a=Object(i.F)(this.views_,s);if(!a){var c=r.calcCompleteEventCache(o?n:null),u=!1;c?u=!0:n instanceof Ue?(c=r.calcCompleteEventChildren(n),u=!1):(c=Ue.EMPTY_NODE,u=!1);var l=new pt(new ht(c,u,!1),new ht(n,o,!1));a=new Et(e,l),this.views_[s]=a}return a.addEventRegistration(t),a.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,r,n){var o=t.queryIdentifier(),s=[],a=[],c=this.hasCompleteView();if("default"===o){var u=this;Object(i.r)(this.views_,function(e,t){a=a.concat(t.removeEventRegistration(r,n)),t.isEmpty()&&(delete u.views_[e],t.getQuery().getQueryParams().loadsAllData()||s.push(t.getQuery()))})}else{var l=Object(i.F)(this.views_,o);l&&(a=a.concat(l.removeEventRegistration(r,n)),l.isEmpty()&&(delete this.views_[o],l.getQuery().getQueryParams().loadsAllData()||s.push(l.getQuery())))}return c&&!this.hasCompleteView()&&s.push(new e.__referenceConstructor(t.repo,t.path)),{removed:s,events:a}},e.prototype.getQueryViews=function(){var e=this;return Object.keys(this.views_).map(function(t){return e.views_[t]}).filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})},e.prototype.getCompleteServerCache=function(e){var t=null;return Object(i.r)(this.views_,function(r,n){t=t||n.getCompleteServerCache(e)}),t},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return Object(i.F)(this.views_,t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){return Object(i.q)(this.views_,function(e){return e.getQuery().getQueryParams().loadsAllData()})||null},e}(),wt=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,r){if(t.isEmpty())return new e(new at(r));var n=this.writeTree_.findRootMostValueAndPath(t);if(null!=n){var i=n.path,o=n.value,s=F.relativePath(i,t);return o=o.updateChild(s,r),new e(this.writeTree_.set(i,o))}var a=new at(r);return new e(this.writeTree_.setTree(t,a))},e.prototype.addWrites=function(e,t){var r=this;return Object(i.r)(t,function(t,n){r=r.addWrite(e.child(t),n)}),r},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,at.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(F.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Ae,function(t,r){e.push(new de(t,r))}):this.writeTree_.children.inorderTraversal(function(t,r){null!=r.value&&e.push(new de(t,r.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var r=this.getCompleteNode(t);return new e(null!=r?new at(r):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(t){return e.applySubtreeWrite_(F.Empty,this.writeTree_,t)},e.Empty=new e(new at(null)),e.applySubtreeWrite_=function(t,r,n){if(null!=r.value)return n.updateChild(t,r.value);var o=null;return r.children.inorderTraversal(function(r,s){".priority"===r?(Object(i.e)(null!==s.value,"Priority writes must always be leaf nodes"),o=s.value):n=e.applySubtreeWrite_(t.child(r),s,n)}),n.getChild(t).isEmpty()||null===o||(n=n.updateChild(t.child(".priority"),o)),n},e}(),St=function(){function e(){this.visibleWrites_=wt.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new Tt(e,this)},e.prototype.addOverwrite=function(e,t,r,n){Object(i.e)(r>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===n&&(n=!0),this.allWrites_.push({path:e,snap:t,writeId:r,visible:n}),n&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=r},e.prototype.addMerge=function(e,t,r){Object(i.e)(r>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:r,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=r},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var r=this.allWrites_[t];if(r.writeId===e)return r}return null},e.prototype.removeWrite=function(e){var t=this,r=this.allWrites_.findIndex(function(t){return t.writeId===e});Object(i.e)(r>=0,"removeWrite called with nonexistent writeId.");var n=this.allWrites_[r];this.allWrites_.splice(r,1);for(var o=n.visible,s=!1,a=this.allWrites_.length-1;o&&a>=0;){var c=this.allWrites_[a];c.visible&&(a>=r&&this.recordContainsPath_(c,n.path)?o=!1:n.path.contains(c.path)&&(s=!0)),a--}if(o){if(s)return this.resetTree_(),!0;if(n.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(n.path);else{var u=n.children;Object(i.r)(u,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(n.path.child(e))})}return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,r,n,i){if(n||i){var o=this.visibleWrites_.childCompoundWrite(t);if(!i&&o.isEmpty())return r;if(i||null!=r||o.hasCompleteWrite(F.Empty)){var s=e.layerTree_(this.allWrites_,function(e){return(e.visible||i)&&(!n||!~n.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t);u=r||Ue.EMPTY_NODE;return s.apply(u)}return null}var a=this.visibleWrites_.getCompleteNode(t);if(null!=a)return a;var c=this.visibleWrites_.childCompoundWrite(t);if(c.isEmpty())return r;if(null!=r||c.hasCompleteWrite(F.Empty)){var u=r||Ue.EMPTY_NODE;return c.apply(u)}return null},e.prototype.calcCompleteEventChildren=function(e,t){var r=Ue.EMPTY_NODE,n=this.visibleWrites_.getCompleteNode(e);if(n)return n.isLeafNode()||n.forEachChild(Ae,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(Ae,function(e,t){var n=i.childCompoundWrite(new F(e)).apply(t);r=r.updateImmediateChild(e,n)}),i.getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r,n){Object(i.e)(r||n,"Either existingEventSnap or existingServerSnap must exist");var o=e.child(t);if(this.visibleWrites_.hasCompleteWrite(o))return null;var s=this.visibleWrites_.childCompoundWrite(o);return s.isEmpty()?n.getChild(t):s.apply(n.getChild(t))},e.prototype.calcCompleteChild=function(e,t,r){var n=e.child(t),i=this.visibleWrites_.getCompleteNode(n);return null!=i?i:r.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(n).apply(r.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,r,n,i,o){var s,a=this.visibleWrites_.childCompoundWrite(e),c=a.getCompleteNode(F.Empty);if(null!=c)s=c;else{if(null==t)return[];s=a.apply(t)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var u=[],l=o.getCompare(),h=i?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),p=h.getNext();p&&u.length<n;)0!==l(p,r)&&u.push(p),p=h.getNext();return u},e.prototype.recordContainsPath_=function(e,t){return e.snap?e.path.contains(t):!!Object(i.p)(e.children,function(r,n){return e.path.child(n).contains(t)})},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,F.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,r){for(var n=wt.Empty,o=0;o<e.length;++o){var s=e[o];if(t(s)){var a=s.path,c=void 0;if(s.snap)r.contains(a)?(c=F.relativePath(r,a),n=n.addWrite(c,s.snap)):a.contains(r)&&(c=F.relativePath(a,r),n=n.addWrite(F.Empty,s.snap.getChild(c)));else{if(!s.children)throw Object(i.f)("WriteRecord should have .snap or .children");if(r.contains(a))c=F.relativePath(r,a),n=n.addWrites(c,s.children);else if(a.contains(r))if((c=F.relativePath(a,r)).isEmpty())n=n.addWrites(F.Empty,s.children);else{var u=Object(i.F)(s.children,c.getFront());if(u){var l=u.getChild(c.popFront());n=n.addWrite(F.Empty,l)}}}}}return n},e}(),Tt=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,r){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,r)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,r)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,r,n,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,r,n,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}(),At=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=at.Empty,this.pendingWriteTree_=new St,this.tagToQueryMap_={},this.queryToTagMap_={}}return e.prototype.applyUserOverwrite=function(e,t,r,n){return this.pendingWriteTree_.addOverwrite(e,t,r,n),n?this.applyOperationToSyncPoints_(new ut(it.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,r){this.pendingWriteTree_.addMerge(e,t,r);var n=at.fromObject(t);return this.applyOperationToSyncPoints_(new lt(it.User,e,n))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var r=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var n=at.Empty;return null!=r.snap?n=n.set(F.Empty,!0):Object(i.r)(r.children,function(e,t){n=n.set(new F(e),t)}),this.applyOperationToSyncPoints_(new ot(r.path,n,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new ut(it.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var r=at.fromObject(t);return this.applyOperationToSyncPoints_(new lt(it.Server,e,r))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new ct(it.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,r,n){var i=this.queryKeyForTag_(n);if(null!=i){var o=e.parseQueryKey_(i),s=o.path,a=o.queryId,c=F.relativePath(s,t),u=new ut(it.forServerTaggedQuery(a),c,r);return this.applyTaggedOperation_(s,u)}return[]},e.prototype.applyTaggedQueryMerge=function(t,r,n){var i=this.queryKeyForTag_(n);if(i){var o=e.parseQueryKey_(i),s=o.path,a=o.queryId,c=F.relativePath(s,t),u=at.fromObject(r),l=new lt(it.forServerTaggedQuery(a),c,u);return this.applyTaggedOperation_(s,l)}return[]},e.prototype.applyTaggedListenComplete=function(t,r){var n=this.queryKeyForTag_(r);if(n){var i=e.parseQueryKey_(n),o=i.path,s=i.queryId,a=F.relativePath(o,t),c=new ct(it.forServerTaggedQuery(s),a);return this.applyTaggedOperation_(o,c)}return[]},e.prototype.addEventRegistration=function(t,r){var n=t.path,o=null,s=!1;this.syncPointTree_.foreachOnPath(n,function(e,t){var r=F.relativePath(e,n);o=o||t.getCompleteServerCache(r),s=s||t.hasCompleteView()});var a,c=this.syncPointTree_.get(n);(c?(s=s||c.hasCompleteView(),o=o||c.getCompleteServerCache(F.Empty)):(c=new Ct,this.syncPointTree_=this.syncPointTree_.set(n,c)),null!=o)?a=!0:(a=!1,o=Ue.EMPTY_NODE,this.syncPointTree_.subtree(n).foreachChild(function(e,t){var r=t.getCompleteServerCache(F.Empty);r&&(o=o.updateImmediateChild(e,r))}));var u=c.viewExistsForQuery(t);if(!u&&!t.getQueryParams().loadsAllData()){var l=e.makeQueryKey_(t);Object(i.e)(!(l in this.queryToTagMap_),"View does not exist, but we have a tag");var h=e.getNextQueryTag_();this.queryToTagMap_[l]=h,this.tagToQueryMap_["_"+h]=l}var p=this.pendingWriteTree_.childWrites(n),f=c.addEventRegistration(t,r,p,o,a);if(!u&&!s){var d=c.viewForQuery(t);f=f.concat(this.setupListener_(t,d))}return f},e.prototype.removeEventRegistration=function(t,r,n){var i=this,o=t.path,s=this.syncPointTree_.get(o),a=[];if(s&&("default"===t.queryIdentifier()||s.viewExistsForQuery(t))){var c=s.removeEventRegistration(t,r,n);s.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var u=c.removed;a=c.events;var l=-1!==u.findIndex(function(e){return e.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(e,t){return t.hasCompleteView()});if(l&&!h){var p=this.syncPointTree_.subtree(o);if(!p.isEmpty())for(var f=this.collectDistinctViewsForSubTree_(p),d=0;d<f.length;++d){var g=f[d],m=g.getQuery(),y=this.createListenerForView_(g);this.listenProvider_.startListening(e.queryForListening_(m),this.tagForQuery_(m),y.hashFn,y.onComplete)}}if(!h&&u.length>0&&!n)if(l){this.listenProvider_.stopListening(e.queryForListening_(t),null)}else u.forEach(function(t){var r=i.queryToTagMap_[e.makeQueryKey_(t)];i.listenProvider_.stopListening(e.queryForListening_(t),r)});this.removeTags_(u)}return a},e.prototype.calcCompleteEventCache=function(e,t){var r=this.pendingWriteTree_,n=this.syncPointTree_.findOnPath(e,function(t,r){var n=F.relativePath(t,e),i=r.getCompleteServerCache(n);if(i)return i});return r.calcCompleteEventCache(e,n,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,r){if(t&&t.hasCompleteView())return[t.getCompleteView()];var n=[];return t&&(n=t.getQueryViews()),Object(i.r)(r,function(e,t){n=n.concat(t)}),n})},e.prototype.removeTags_=function(t){for(var r=0;r<t.length;++r){var n=t[r];if(!n.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(n),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,r){var n=t.path,o=this.tagForQuery_(t),s=this.createListenerForView_(r),a=this.listenProvider_.startListening(e.queryForListening_(t),o,s.hashFn,s.onComplete),c=this.syncPointTree_.subtree(n);if(o)Object(i.e)(!c.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var u=c.fold(function(e,t,r){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var n=[];return t&&(n=n.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),Object(i.r)(r,function(e,t){n=n.concat(t)}),n}),l=0;l<u.length;++l){var h=u[l];this.listenProvider_.stopListening(e.queryForListening_(h),this.tagForQuery_(h))}return a},e.prototype.createListenerForView_=function(e){var t=this,r=e.getQuery(),n=this.tagForQuery_(r);return{hashFn:function(){return(e.getServerCache()||Ue.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return n?t.applyTaggedListenComplete(r.path,n):t.applyListenComplete(r.path);var i=function(e,t){var r="Unknown Error";"too_big"===e?r="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?r="Client doesn't have permission to access the desired data.":"unavailable"==e&&(r="The service is unavailable");var n=new Error(e+" at "+t.path.toString()+": "+r);return n.code=e.toUpperCase(),n}(e,r);return t.removeEventRegistration(r,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return Object(i.e)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new F(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap_["_"+e]},e.prototype.tagForQuery_=function(t){var r=e.makeQueryKey_(t);return Object(i.F)(this.queryToTagMap_,r)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var r=this.syncPointTree_.get(e);Object(i.e)(r,"Missing sync point for query tag that we're tracking");var n=this.pendingWriteTree_.childWrites(e);return r.applyOperation(t,n,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(F.Empty))},e.prototype.applyOperationHelper_=function(e,t,r,n){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,r,n);var i=t.get(F.Empty);null==r&&null!=i&&(r=i.getCompleteServerCache(F.Empty));var o=[],s=e.path.getFront(),a=e.operationForChild(s),c=t.children.get(s);if(c&&a){var u=r?r.getImmediateChild(s):null,l=n.child(s);o=o.concat(this.applyOperationHelper_(a,c,u,l))}return i&&(o=o.concat(i.applyOperation(e,n,r))),o},e.prototype.applyOperationDescendantsHelper_=function(e,t,r,n){var i=this,o=t.get(F.Empty);null==r&&null!=o&&(r=o.getCompleteServerCache(F.Empty));var s=[];return t.children.inorderTraversal(function(t,o){var a=r?r.getImmediateChild(t):null,c=n.child(t),u=e.operationForChild(t);u&&(s=s.concat(i.applyOperationDescendantsHelper_(u,o,a,c)))}),o&&(s=s.concat(o.applyOperation(e,n,r))),s},e.nextQueryTag_=1,e}(),It=function(){function e(){this.rootNode_=Ue.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),Nt=function(){function e(e){this.app_=e}return e.prototype.getToken=function(e){return this.app_.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?(_("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},e.prototype.addTokenChangeListener=function(e){this.app_.INTERNAL.addAuthTokenListener(e)},e.prototype.removeTokenChangeListener=function(e){this.app_.INTERNAL.removeAuthTokenListener(e)},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',S(e)},e}(),kt=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Object(i.j)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Object(i.l)(this.counters_)},e}(),Rt=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new kt),this.collections_[t]},e.getOrCreateReporter=function(e,t){var r=e.toString();return this.reporters_[r]||(this.reporters_[r]=t()),this.reporters_[r]},e.collections_={},e.reporters_={},e}(),Ot=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=Object(i.i)(e);return this.last_&&Object(i.r)(this.last_,function(e,r){t[e]=t[e]-r}),this.last_=e,t},e}(),xt=1e4,Bt=3e4,Dt=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Ot(e);var r=xt+(Bt-xt)*Math.random();M(this.reportStats_.bind(this),Math.floor(r))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),r={},n=!1;Object(i.r)(t,function(t,o){o>0&&Object(i.j)(e.statsToReport_,t)&&(r[t]=o,n=!0)}),n&&this.server_.reportStats(r),M(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}(),Pt=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,r=0;r<e.length;r++){var n=e[r],i=n.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new Lt(i)),t.add(n)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,r=0;r<this.eventLists_.length;r++){var n=this.eventLists_[r];if(n)e(n.getPath())?(this.eventLists_[r].raise(),this.eventLists_[r]=null):t=!1}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),Lt=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var r=t.getEventRunner();y&&_("event: "+t.toString()),j(r)}}},e.prototype.getPath=function(){return this.path_},e}(),jt=function(){function e(e){this.allowedEvents_=e,this.listeners_={},Object(i.e)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Array.isArray(this.listeners_[e]))for(var n=this.listeners_[e].slice(),i=0;i<n.length;i++)n[i].callback.apply(n[i].context,t)},e.prototype.on=function(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});var n=this.getInitialEvent(e);n&&t.apply(r,n)},e.prototype.off=function(e,t,r){this.validateEventType_(e);for(var n=this.listeners_[e]||[],i=0;i<n.length;i++)if(n[i].callback===t&&(!r||r===n[i].context))return void n.splice(i,1)},e.prototype.validateEventType_=function(e){Object(i.e)(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),Ut=function(e){function t(){var t,r,n=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(r="visibilitychange",t="hidden"):void 0!==document.mozHidden?(r="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(r="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(r="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,r&&document.addEventListener(r,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}return Object(s.b)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(i.e)("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(jt),Mt=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(i.x)()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return Object(s.b)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(i.e)("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(jt),Ft=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var r=this;this.pendingResponses[e]=t;for(var n=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&j(function(){r.onMessage_(e[t])})},n=0;n<e.length;++n)t(n);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===n())break}},e}(),Vt="pLPCommand",qt="pRTLPCB",Kt=function(){function e(e,t,r,n){this.connId=e,this.repoInfo=t,this.transportSessionId=r,this.lastSessionId=n,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(e),this.stats_=Rt.getCollection(t),this.urlFn=function(e){return t.connectionURL(q,e)}}return e.prototype.open=function(e,t){var r=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Ft(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if(Object(i.y)()||"complete"===document.readyState)e();else{var t=!1,r=function(){document.body?t||(t=!0,e()):setTimeout(r,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&r()}),window.attachEvent("onload",r))}}(function(){if(!r.isClosed_){r.scriptTagHolder=new Ht(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],i=e[1],o=e[2];if(r.incrementIncomingBytes_(e),r.scriptTagHolder)if(r.connectTimeoutTimer_&&(clearTimeout(r.connectTimeoutTimer_),r.connectTimeoutTimer_=null),r.everConnected_=!0,"start"==n)r.id=i,r.password=o;else{if("close"!==n)throw new Error("Unrecognized command received: "+n);i?(r.scriptTagHolder.sendNewPolls=!1,r.myPacketOrderer.closeAfter(i,function(){r.onClosed_()})):r.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],i=e[1];r.incrementIncomingBytes_(e),r.myPacketOrderer.handleResponse(n,i)},function(){r.onClosed_()},r.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),r.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=r.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",r.transportSessionId&&(e.s=r.transportSessionId),r.lastSessionId&&(e.ls=r.lastSessionId),!Object(i.y)()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(e.r="f");var t=r.urlFn(e);r.log_("Connecting via long-poll to "+t),r.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI)&&!Object(i.y)()},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Object(i.I)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var r=Object(i.h)(t),n=x(r,1840),o=0;o<n.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[o]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!Object(i.y)()){this.myDisconnFrame=document.createElement("iframe");var r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Object(i.I)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),Ht=function(){function e(t,r,n,o){if(this.onDisconnect=n,this.urlFn=o,this.outstandingRequests=new Xe,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(i.y)())this.commandCB=t,this.onMessageCB=r;else{this.uniqueCallbackIdentifier=d(),window[Vt+this.uniqueCallbackIdentifier]=t,window[qt+this.uniqueCallbackIdentifier]=r,this.myIFrame=e.createIFrame_();var s="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))s='<script>document.domain="'+document.domain+'";<\/script>';var a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(e){_("frame writing exception"),e.stack&&_(e.stack),_(e)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||_("No IE domain setting required")}catch(r){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var t=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0))),Object(i.y)()&&this.myID){var r={disconn:"t"};r.id=this.myID,r.pw=this.myPW;var n=this.urlFn(r);e.nodeRestRequest(n)}var o=this.onDisconnect;o&&(this.onDisconnect=null,o())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),r="",n=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+r.length<=1870))break;var i=this.pendingSegs.shift();r=r+"&seg"+n+"="+i.seg+"&ts"+n+"="+i.ts+"&d"+n+"="+i.d,n++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var r=this;this.outstandingRequests.add(t,1);var n=function(){r.outstandingRequests.remove(t),r.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),n()})},e.prototype.addTag=function(e,t){var r=this;Object(i.y)()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!r.sendNewPolls)return;var n=r.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){var e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=function(){_("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(n)}catch(e){}},Math.floor(1))},e}(),Gt=null;"undefined"!=typeof MozWebSocket?Gt=MozWebSocket:"undefined"!=typeof WebSocket&&(Gt=WebSocket);var zt=function(){function e(t,r,n,i){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=Rt.getCollection(r),this.connURL=e.connectionURL_(r,n,i)}return e.connectionURL_=function(e,t,r){var n={v:"5"};return!Object(i.y)()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(n.r="f"),t&&(n.s=t),r&&(n.ls=r),e.connectionURL("websocket",n)},e.prototype.open=function(e,t){var r=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,h.set("previous_websocket_failure",!0);try{if(Object(i.y)()){var n=i.a.NODE_ADMIN?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/5/"+a.a.SDK_VERSION+"/"+process.platform+"/"+n}},s=process.env,c=0==this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;c&&(o.proxy={origin:c}),this.mySock=new Gt(this.connURL,[],o)}else this.mySock=new Gt(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var u=e.message||e.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==Gt&&!e.forceDisallow_},e.previouslyFailed=function(){return h.isInMemoryStorage||!0===h.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){h.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var r=Object(i.B)(t);this.onMessage(r)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(Object(i.e)(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var r=this.extractFrameCount_(t);null!==r&&this.appendFrame_(r)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Object(i.I)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var r=x(t,16384);r.length>1&&this.sendString_(String(r.length));for(var n=0;n<r.length;n++)this.sendString_(r[n])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),Wt=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Kt,zt]},enumerable:!0,configurable:!0}),e.prototype.initTransports_=function(t){var r=zt&&zt.isAvailable(),n=r&&!zt.previouslyFailed();if(t.webSocketOnly&&(r||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[zt];else{var i=this.transports_=[];B(e.ALL_TRANSPORTS,function(e,t){t&&t.isAvailable()&&i.push(t)})}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),Yt=function(){function e(e,t,r,n,i,o,s){this.id=e,this.repoInfo_=t,this.onMessage_=r,this.onReady_=n,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new Wt(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(r,n)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=M(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(r){e===t.conn_?t.onConnectionLost_(r):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(r){2!=t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(r):e===t.secondaryConn_?t.onSecondaryMessageReceived_(r):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=R("t",e),r=R("d",e);if("c"==t)this.onSecondaryControl_(r);else{if("d"!=t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=R("t",e),r=R("d",e);"c"==t?this.onControl_(r):"d"==t&&this.onDataMessage_(r)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=R("t",e);if("d"in e){var r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?C("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):C("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,r=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(n),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),M(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var r=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):M(function(){r.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(h.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),Qt=function(){function e(){}return e.prototype.put=function(e,t,r,n){},e.prototype.merge=function(e,t,r,n){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,r){},e.prototype.onDisconnectMerge=function(e,t,r){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),$t=1e3,Jt=3e5,Xt=function(e){function t(r,n,o,s,a,c){var u=e.call(this)||this;if(u.repoInfo_=r,u.onDataUpdate_=n,u.onConnectStatus_=o,u.onServerInfoUpdate_=s,u.authTokenProvider_=a,u.authOverride_=c,u.id=t.nextPersistentConnectionId_++,u.log_=E("p:"+u.id+":"),u.interruptReasons_={},u.listens_={},u.outstandingPuts_=[],u.outstandingPutCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=$t,u.maxReconnectDelay_=Jt,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,c&&!Object(i.y)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return u.scheduleConnect_(0),Ut.getInstance().on("visible",u.onVisible_,u),-1===r.host.indexOf("fblocal")&&Mt.getInstance().on("online",u.onOnline_,u),u}return Object(s.b)(t,e),t.prototype.sendRequest=function(e,t,r){var n=++this.requestNumber_,o={r:n,a:e,b:t};this.log_(Object(i.I)(o)),Object(i.e)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[n]=r)},t.prototype.listen=function(e,t,r,n){var o=e.queryIdentifier(),s=e.path.toString();this.log_("Listen called for "+s+" "+o),this.listens_[s]=this.listens_[s]||{},Object(i.e)(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Object(i.e)(!this.listens_[s][o],"listen() called twice for same path/queryId.");var a={onComplete:n,hashFn:t,query:e,tag:r};this.listens_[s][o]=a,this.connected_&&this.sendListen_(a)},t.prototype.sendListen_=function(e){var r=this,n=e.query,i=n.path.toString(),o=n.queryIdentifier();this.log_("Listen on "+i+" for "+o);var s={p:i};e.tag&&(s.q=n.queryObject(),s.t=e.tag),s.h=e.hashFn(),this.sendRequest("q",s,function(s){var a=s.d,c=s.s;t.warnOnListenWarnings_(a,n),(r.listens_[i]&&r.listens_[i][o])===e&&(r.log_("listen response",s),"ok"!==c&&r.removeListen_(i,o),e.onComplete&&e.onComplete(c,a))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&Object(i.j)(e,"w")){var r=Object(i.F)(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){var n='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',o=t.path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+n+" at "+o+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||Object(i.v)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,r=Object(i.A)(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(r,n,function(r){var n=r.s,i=r.d||"error";e.authToken_===t&&("ok"===n?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(n,i))})}},t.prototype.unlisten=function(e,t){var r=e.path.toString(),n=e.queryIdentifier();this.log_("Unlisten called for "+r+" "+n),Object(i.e)(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,n)&&this.connected_&&this.sendUnlisten_(r,n,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,r,n){this.log_("Unlisten on "+e+" for "+t);var i={p:e};n&&(i.q=r,i.t=n),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,r){this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})},t.prototype.onDisconnectMerge=function(e,t,r){this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,r,n){var i={p:t,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){n&&setTimeout(function(){n(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,r,n){this.putInternal("p",e,t,r,n)},t.prototype.merge=function(e,t,r,n){this.putInternal("m",e,t,r,n)},t.prototype.putInternal=function(e,t,r,n,i){var o={p:t,d:r};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:n}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,function(n){t.log_(r+" response",n),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(n.s,n.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,function(e){if("ok"!==e.s){var r=e.d;t.log_("reportStats","Error sending stats: "+r)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Object(i.I)(e));var t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):C("Unrecognized action received from server: "+Object(i.I)(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;Object(i.e)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=$t,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=$t,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=$t),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+t.nextConnectionId_++,s=this,a=this.lastSessionId,c=!1,u=null,l=function(){u?u.close():(c=!0,n())};this.realtime_={close:l,sendRequest:function(e){Object(i.e)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(e)}};var h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(h).then(function(t){c?_("getToken() completed but was canceled"):(_("getToken() completed. Creating connection."),s.authToken_=t&&t.accessToken,u=new Yt(o,s.repoInfo_,e,r,n,function(e){S(e+" ("+s.repoInfo_.toString()+")"),s.interrupt("server_kill")},a))}).then(null,function(e){s.log_("Failed to get token: "+e),c||(i.a.NODE_ADMIN&&S(e),l())})}},t.prototype.interrupt=function(e){_("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){_("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Object(i.w)(this.interruptReasons_)&&(this.reconnectDelay_=$t,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var r;r=t?t.map(function(e){return O(e)}).join("$"):"default";var n=this.removeListen_(e,r);n&&n.onComplete&&n.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var r,n=new F(e).toString();return void 0!==this.listens_[n]?(r=this.listens_[n][t],delete this.listens_[n][t],0===Object(i.t)(this.listens_[n])&&delete this.listens_[n]):r=void 0,r},t.prototype.onAuthRevoked_=function(e,t){_("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e=this;this.tryAuth(),Object(i.r)(this.listens_,function(t,r){Object(i.r)(r,function(t,r){e.sendListen_(r)})});for(var t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){var r=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(r.action,r.pathString,r.data,r.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";i.a.NODE_ADMIN?t="admin_node":i.a.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+a.a.SDK_VERSION.replace(/\./g,"-")]=1,Object(i.x)()?e["framework.cordova"]=1:Object(i.z)()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=Mt.getInstance().currentlyOnline();return Object(i.w)(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(Qt),Zt=function(e){function t(t,r,n){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=r,i.authTokenProvider_=n,i.log_=E("p:rest:"),i.listens_={},i}return Object(s.b)(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Object(i.e)(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,r,n,o){var s=this,a=e.path.toString();this.log_("Listen called for "+a+" "+e.queryIdentifier());var c=t.getListenId_(e,n),u={};this.listens_[c]=u;var l=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",l,function(e,t){var r=t;(404===e&&(r=null,e=null),null===e&&s.onDataUpdate_(a,r,!1,n),Object(i.F)(s.listens_,c)===u)&&o(e?401==e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,r){var n=t.getListenId_(e,r);delete this.listens_[n]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,r){var n=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(o){var s=o&&o.accessToken;s&&(t.auth=s);var a=(n.repoInfo_.secure?"https://":"http://")+n.repoInfo_.host+e+"?"+Object(i.E)(t);n.log_("Sending REST request for "+a);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){n.log_("REST Response for "+a+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=Object(i.B)(c.responseText)}catch(e){S("Failed to parse JSON response for "+a+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&S("Got unsuccessful REST response for "+a+" Status: "+c.status),r(c.status);r=null}},c.open("GET",a,!0),c.send()})},t}(Qt),er=function(){function e(e,t,r){var n=this;this.repoInfo_=e,this.app=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Pt,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Ze,this.persistentConnection_=null;var o=new Nt(r);if(this.stats_=Rt.getCollection(e),t||U())this.server_=new Zt(this.repoInfo_,this.onDataUpdate_.bind(this),o),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var s=r.options.databaseAuthVariableOverride;if(null!=s){if("object"!=typeof s)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(i.I)(s)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new Xt(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),o,s),this.server_=this.persistentConnection_}o.addTokenChangeListener(function(e){n.server_.refreshAuthToken(e)}),this.statsReporter_=Rt.getOrCreateReporter(e,function(){return new Dt(n.stats_,n.server_)}),this.transactions_init_(),this.infoData_=new It,this.infoSyncTree_=new At({startListening:function(e,t,r,i){var o=[],s=n.infoData_.getNode(e.path);return s.isEmpty()||(o=n.infoSyncTree_.applyServerOverwrite(e.path,s),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new At({startListening:function(e,t,r,i){return n.server_.listen(e,r,t,function(t,r){var o=i(t,r);n.eventQueue_.raiseEventsForChangedPath(e.path,o)}),[]},stopListening:function(e,t){n.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new F(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e},e.prototype.generateServerValues=function(){return(e=(e={timestamp:this.serverTime()})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e},e.prototype.onDataUpdate_=function(e,t,r,n){this.dataUpdateCount++;var o=new F(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var s=[];if(n)if(r){var a=Object(i.C)(t,function(e){return Ve(e)});s=this.serverSyncTree_.applyTaggedQueryMerge(o,a,n)}else{var c=Ve(t);s=this.serverSyncTree_.applyTaggedQueryOverwrite(o,c,n)}else if(r){var u=Object(i.C)(t,function(e){return Ve(e)});s=this.serverSyncTree_.applyServerMerge(o,u)}else{var l=Ve(t);s=this.serverSyncTree_.applyServerOverwrite(o,l)}var h=o;s.length>0&&(h=this.rerunTransactions_(o)),this.eventQueue_.raiseEventsForChangedPath(h,s)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;B(e,function(e,r){t.updateInfo_(r,e)})},e.prototype.updateInfo_=function(e,t){var r=new F("/.info/"+e),n=Ve(t);this.infoData_.updateSnapshot(r,n);var i=this.infoSyncTree_.applyServerOverwrite(r,n);this.eventQueue_.raiseEventsForChangedPath(r,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,r,n){var i=this;this.log_("set",{path:e.toString(),value:t,priority:r});var o=this.generateServerValues(),s=Ve(t,r),a=tt(s,o),c=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserOverwrite(e,a,c,!0);this.eventQueue_.queueEvents(u),this.server_.put(e.toString(),s.val(!0),function(t,r){var o="ok"===t;o||S("set at "+e+" failed: "+t);var s=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(e,s),i.callOnCompleteCallback(n,t,r)});var l=this.abortTransactions_(e);this.rerunTransactions_(l),this.eventQueue_.raiseEventsForChangedPath(l,[])},e.prototype.update=function(e,t,r){var n=this;this.log_("update",{path:e.toString(),value:t});var o=!0,s=this.generateServerValues(),a={};if(Object(i.r)(t,function(e,t){o=!1;var r=Ve(t);a[e]=tt(r,s)}),o)_("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(r,"ok");else{var c=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(e,a,c);this.eventQueue_.queueEvents(u),this.server_.merge(e.toString(),t,function(t,i){var o="ok"===t;o||S("update at "+e+" failed: "+t);var s=n.serverSyncTree_.ackUserWrite(c,!o),a=s.length>0?n.rerunTransactions_(e):e;n.eventQueue_.raiseEventsForChangedPath(a,s),n.callOnCompleteCallback(r,t,i)}),Object(i.r)(t,function(t){var r=n.abortTransactions_(e.child(t));n.rerunTransactions_(r)}),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),r=function(e,t){var r=new Ze;return e.forEachTree(new F(""),function(e,n){r.remember(e,tt(n,t))}),r}(this.onDisconnect_,t),n=[];r.forEachTree(F.Empty,function(t,r){n=n.concat(e.serverSyncTree_.applyServerOverwrite(t,r));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new Ze,this.eventQueue_.raiseEventsForChangedPath(F.Empty,n)},e.prototype.onDisconnectCancel=function(e,t){var r=this;this.server_.onDisconnectCancel(e.toString(),function(n,i){"ok"===n&&r.onDisconnect_.forget(e),r.callOnCompleteCallback(t,n,i)})},e.prototype.onDisconnectSet=function(e,t,r){var n=this,i=Ve(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,o){"ok"===t&&n.onDisconnect_.remember(e,i),n.callOnCompleteCallback(r,t,o)})},e.prototype.onDisconnectSetWithPriority=function(e,t,r,n){var i=this,o=Ve(t,r);this.server_.onDisconnectPut(e.toString(),o.val(!0),function(t,r){"ok"===t&&i.onDisconnect_.remember(e,o),i.callOnCompleteCallback(n,t,r)})},e.prototype.onDisconnectUpdate=function(e,t,r){var n=this;if(Object(i.w)(t))return _("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(r,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(o,s){"ok"===o&&Object(i.r)(t,function(t,r){var i=Ve(r);n.onDisconnect_.remember(e.child(t),i)}),n.callOnCompleteCallback(r,o,s)})},e.prototype.addEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.removeEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new Ot(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var r=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);Object(i.r)(t,function(e,t){for(var n=e.length;n<r+2;n++)e+=" ";console.log(e+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="";this.persistentConnection_&&(r=this.persistentConnection_.id+":"),_.apply(void 0,[r].concat(e))},e.prototype.callOnCompleteCallback=function(e,t,r){e&&j(function(){if("ok"==t)e(null);else{var n=(t||"error").toUpperCase(),i=n;r&&(i+=": "+r);var o=new Error(i);o.code=n,e(o)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new lr(this))},enumerable:!0,configurable:!0}),e}(),tr=function(){function e(t){this.indexedFilter_=new dt(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,r,n,i,o){return this.matches(new de(t,r))||(r=Ue.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,n,i,o)},e.prototype.updateFullNode=function(e,t,r){t.isLeafNode()&&(t=Ue.EMPTY_NODE);var n=t.withIndex(this.index_);n=n.updatePriority(Ue.EMPTY_NODE);var i=this;return t.forEachChild(Ae,function(e,t){i.matches(new de(e,t))||(n=n.updateImmediateChild(e,Ue.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),rr=function(){function e(e){this.rangedFilter_=new tr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,r,n,i,o){return this.rangedFilter_.matches(new de(t,r))||(r=Ue.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,n,i,o):this.fullLimitUpdateChild_(e,t,r,i,o)},e.prototype.updateFullNode=function(e,t,r){var n;if(t.isLeafNode()||t.isEmpty())n=Ue.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){n=Ue.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;n=n.updateImmediateChild(s.name,s.node),o++}}else{n=(n=t.withIndex(this.index_)).updatePriority(Ue.EMPTY_NODE);var a=void 0,c=void 0,u=void 0;i=void 0;if(this.reverse_){i=n.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();u=function(e,t){return l(t,e)}}else i=n.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),u=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();){s=i.getNext();!h&&u(a,s)<=0&&(h=!0),h&&o<this.limit_&&u(s,c)<=0?o++:n=n.updateImmediateChild(s.name,Ue.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,r,n,o){var s;if(this.reverse_){var a=this.index_.getCompare();s=function(e,t){return a(t,e)}}else s=this.index_.getCompare();var c=e;Object(i.e)(c.numChildren()==this.limit_,"");var u=new de(t,r),l=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(c.hasChild(t)){for(var p=c.getImmediateChild(t),f=n.getChildAfterChild(this.index_,l,this.reverse_);null!=f&&(f.name==t||c.hasChild(f.name));)f=n.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:s(f,u);if(h&&!r.isEmpty()&&d>=0)return null!=o&&o.trackChildChange(ft.childChangedChange(t,r,p)),c.updateImmediateChild(t,r);null!=o&&o.trackChildChange(ft.childRemovedChange(t,p));var g=c.updateImmediateChild(t,Ue.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=o&&o.trackChildChange(ft.childAddedChange(f.name,f.node)),g.updateImmediateChild(f.name,f.node)):g}return r.isEmpty()?e:h&&s(l,u)>=0?(null!=o&&(o.trackChildChange(ft.childRemovedChange(l.name,l.node)),o.trackChildChange(ft.childAddedChange(t,r))),c.updateImmediateChild(t,r).updateImmediateChild(l.name,Ue.EMPTY_NODE)):e},e}(),nr=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ae}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return Object(i.e)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return Object(i.e)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return Object(i.e)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return Object(i.e)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:I},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return Object(i.e)(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,r},e.prototype.limitToLast=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,r},e.prototype.startAt=function(e,t){var r=this.copy_();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r},e.prototype.endAt=function(e,t){var r=this.copy_();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,r={};if(this.startSet_&&(r[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(r[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(r[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(r[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){r[t.LIMIT]=this.limit_;var n=this.viewFrom_;""===n&&(n=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),r[t.VIEW_FROM]=n}return this.index_!==Ae&&(r[t.INDEX]=this.index_.toString()),r},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==Ae},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new dt(this.getIndex()):this.hasLimit()?new rr(this):new tr(this)},e.prototype.toRestQueryStringParameters=function(){var t,r=e.REST_QUERY_CONSTANTS_,n={};return this.isDefault()?n:(this.index_===Ae?t=r.PRIORITY_INDEX:this.index_===He?t=r.VALUE_INDEX:this.index_===ye?t=r.KEY_INDEX:(Object(i.e)(this.index_ instanceof Ge,"Unrecognized index type!"),t=this.index_.toString()),n[r.ORDER_BY]=Object(i.I)(t),this.startSet_&&(n[r.START_AT]=Object(i.I)(this.indexStartValue_),this.startNameSet_&&(n[r.START_AT]+=","+Object(i.I)(this.indexStartName_))),this.endSet_&&(n[r.END_AT]=Object(i.I)(this.indexEndValue_),this.endNameSet_&&(n[r.END_AT]+=","+Object(i.I)(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[r.LIMIT_TO_FIRST]=this.limit_:n[r.LIMIT_TO_LAST]=this.limit_),n)},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}(),ir=function(e){function t(t,r){if(!(t instanceof er))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,r,nr.DEFAULT,!1)||this}return Object(s.b)(t,e),t.prototype.getKey=function(){return Object(i.J)("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return Object(i.J)("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof F||(null===this.path.getFront()?function(e,t,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),ce(e,t,r,n)}("Reference.child",1,e,!1):ce("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){Object(i.J)("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){Object(i.J)("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){Object(i.J)("Reference.set",1,2,arguments.length),ue("Reference.set",this.path),re("Reference.set",1,e,this.path,!1),Object(i.K)("Reference.set",2,t,!0);var r=new i.b;return this.repo.setWithPriority(this.path,e,null,r.wrapCallback(t)),r.promise},t.prototype.update=function(e,t){if(Object(i.J)("Reference.update",1,2,arguments.length),ue("Reference.update",this.path),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ie("Reference.update",1,e,this.path,!1),Object(i.K)("Reference.update",2,t,!0);var o=new i.b;return this.repo.update(this.path,e,o.wrapCallback(t)),o.promise},t.prototype.setWithPriority=function(e,t,r){if(Object(i.J)("Reference.setWithPriority",2,3,arguments.length),ue("Reference.setWithPriority",this.path),re("Reference.setWithPriority",1,e,this.path,!1),oe("Reference.setWithPriority",2,t,!1),Object(i.K)("Reference.setWithPriority",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var n=new i.b;return this.repo.setWithPriority(this.path,e,t,n.wrapCallback(r)),n.promise},t.prototype.remove=function(e){return Object(i.J)("Reference.remove",0,1,arguments.length),ue("Reference.remove",this.path),Object(i.K)("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,r){if(Object(i.J)("Reference.transaction",1,3,arguments.length),ue("Reference.transaction",this.path),Object(i.K)("Reference.transaction",1,e,!1),Object(i.K)("Reference.transaction",2,t,!0),function(e,t,r,n){if((!n||void 0!==r)&&"boolean"!=typeof r)throw new Error(Object(i.n)(e,t,n)+"must be a boolean.")}("Reference.transaction",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===r&&(r=!0);var n=new i.b;"function"==typeof t&&n.promise.catch(function(){});return this.repo.startTransaction(this.path,e,function(e,r,i){e?n.reject(e):n.resolve(new pe(r,i)),"function"==typeof t&&t(e,r,i)},r),n.promise},t.prototype.setPriority=function(e,t){Object(i.J)("Reference.setPriority",1,2,arguments.length),ue("Reference.setPriority",this.path),oe("Reference.setPriority",1,e,!1),Object(i.K)("Reference.setPriority",2,t,!0);var r=new i.b;return this.repo.setWithPriority(this.path.child(".priority"),e,null,r.wrapCallback(t)),r.promise},t.prototype.push=function(e,t){Object(i.J)("Reference.push",0,2,arguments.length),ue("Reference.push",this.path),re("Reference.push",1,e,this.path,!0),Object(i.K)("Reference.push",2,t,!0);var r,n=this.repo.serverTime(),o=fe(n),s=this.child(o),a=this.child(o);return r=null!=e?s.set(e,t).then(function(){return a}):Promise.resolve(a),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),"function"==typeof t&&r.catch(function(){}),s},t.prototype.onDisconnect=function(){return ue("Reference.onDisconnect",this.path),new he(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(Je);Je.__referenceConstructor=ir,Ct.__referenceConstructor=ir;var or,sr=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),ar=function(){function e(e,t,r){void 0===e&&(e=""),void 0===t&&(t=null),void 0===r&&(r=new sr),this.name_=e,this.parent_=t,this.node_=r}return e.prototype.subTree=function(t){for(var r,n=t instanceof F?t:new F(t),o=this;null!==(r=n.getFront());){o=new e(r,o,Object(i.F)(o.node_.children,r)||new sr),n=n.popFront()}return o},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){Object(i.e)(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var r=this;Object(i.r)(this.node_.children,function(n,i){t(new e(n,r,i))})},e.prototype.forEachDescendant=function(e,t,r){t&&!r&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,r)}),t&&r&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var r=t?this:this.parent();null!==r;){if(e(r))return!0;r=r.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new F(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var r=t.isEmpty(),n=Object(i.j)(this.node_.children,e);r&&n?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):r||n||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}();!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(or||(or={})),er.MAX_TRANSACTION_RETRIES_=25,er.prototype.transactions_init_=function(){this.transactionQueueTree_=new ar},er.prototype.startTransaction=function(e,t,r,n){this.log_("transaction on "+e);var o=function(){},s=new ir(this,e);s.on("value",o);var a={path:e,update:t,onComplete:r,status:null,order:d(),applyLocally:n,retryCount:0,unwatcher:function(){s.off("value",o)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=this.getLatestState_(e);a.currentInputSnapshot=c;var u=a.update(c.val());if(void 0===u){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new ze(a.currentInputSnapshot,new ir(this,a.path),Ae);a.onComplete(null,!1,l)}}else{ne("transaction failed: Data returned ",u,a.path),a.status=or.RUN;var h=this.transactionQueueTree_.subTree(e),p=h.getValue()||[];p.push(a),h.setValue(p);var f=void 0;if("object"==typeof u&&null!==u&&Object(i.j)(u,".priority"))f=Object(i.F)(u,".priority"),Object(i.e)(te(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else f=(this.serverSyncTree_.calcCompleteEventCache(e)||Ue.EMPTY_NODE).getPriority().val();f=f;var g=this.generateServerValues(),m=Ve(u,f),y=tt(m,g);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=y,a.currentWriteId=this.getNextWriteId_();var v=this.serverSyncTree_.applyUserOverwrite(e,y,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,v),this.sendReadyTransactions_()}},er.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||Ue.EMPTY_NODE},er.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var r=this.buildTransactionQueue_(e);Object(i.e)(r.length>0,"Sending zero length transaction queue"),r.every(function(e){return e.status===or.RUN})&&this.sendTransactionQueue_(e.path(),r)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},er.prototype.sendTransactionQueue_=function(e,t){for(var r=this,n=t.map(function(e){return e.currentWriteId}),o=this.getLatestState_(e,n),s=o,a=o.hash(),c=0;c<t.length;c++){var u=t[c];Object(i.e)(u.status===or.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=or.SENT,u.retryCount++;var l=F.relativePath(e,u.path);s=s.updateChild(l,u.currentOutputSnapshotRaw)}var h=s.val(!0),p=e;this.server_.put(p.toString(),h,function(n){r.log_("transaction put response",{path:p.toString(),status:n});var i=[];if("ok"===n){for(var o=[],s=0;s<t.length;s++){if(t[s].status=or.COMPLETED,i=i.concat(r.serverSyncTree_.ackUserWrite(t[s].currentWriteId)),t[s].onComplete){var a=t[s].currentOutputSnapshotResolved,c=new ir(r,t[s].path),u=new ze(a,c,Ae);o.push(t[s].onComplete.bind(null,null,!0,u))}t[s].unwatcher()}r.pruneCompletedTransactionsBelowNode_(r.transactionQueueTree_.subTree(e)),r.sendReadyTransactions_(),r.eventQueue_.raiseEventsForChangedPath(e,i);for(s=0;s<o.length;s++)j(o[s])}else{if("datastale"===n)for(s=0;s<t.length;s++)t[s].status===or.SENT_NEEDS_ABORT?t[s].status=or.NEEDS_ABORT:t[s].status=or.RUN;else{S("transaction at "+p.toString()+" failed: "+n);for(s=0;s<t.length;s++)t[s].status=or.NEEDS_ABORT,t[s].abortReason=n}r.rerunTransactions_(e)}},a)},er.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),r=t.path(),n=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(n,r),r},er.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var r,n=[],o=[],s=e.filter(function(e){return e.status===or.RUN}).map(function(e){return e.currentWriteId}),a=0;a<e.length;a++){var c=e[a],u=F.relativePath(t,c.path),l=!1,h=void 0;if(Object(i.e)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===or.NEEDS_ABORT)l=!0,h=c.abortReason,o=o.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0));else if(c.status===or.RUN)if(c.retryCount>=er.MAX_TRANSACTION_RETRIES_)l=!0,h="maxretry",o=o.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0));else{var p=this.getLatestState_(c.path,s);c.currentInputSnapshot=p;var f=e[a].update(p.val());if(void 0!==f){ne("transaction failed: Data returned ",f,c.path);var d=Ve(f);"object"==typeof f&&null!=f&&Object(i.j)(f,".priority")||(d=d.updatePriority(p.getPriority()));var g=c.currentWriteId,m=this.generateServerValues(),y=tt(d,m);c.currentOutputSnapshotRaw=d,c.currentOutputSnapshotResolved=y,c.currentWriteId=this.getNextWriteId_(),s.splice(s.indexOf(g),1),o=(o=o.concat(this.serverSyncTree_.applyUserOverwrite(c.path,y,c.currentWriteId,c.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(g,!0))}else l=!0,h="nodata",o=o.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,o),o=[],l&&(e[a].status=or.COMPLETED,r=e[a].unwatcher,setTimeout(r,Math.floor(0)),e[a].onComplete))if("nodata"===h){var v=new ir(this,e[a].path),b=e[a].currentInputSnapshot,_=new ze(b,v,Ae);n.push(e[a].onComplete.bind(null,null,!1,_))}else n.push(e[a].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(a=0;a<n.length;a++)j(n[a]);this.sendReadyTransactions_()}},er.prototype.getAncestorTransactionNode_=function(e){for(var t,r=this.transactionQueueTree_;null!==(t=e.getFront())&&null===r.getValue();)r=r.subTree(t),e=e.popFront();return r},er.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},er.prototype.aggregateTransactionQueuesForNode_=function(e,t){var r=this,n=e.getValue();if(null!==n)for(var i=0;i<n.length;i++)t.push(n[i]);e.forEachChild(function(e){r.aggregateTransactionQueuesForNode_(e,t)})},er.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,r=e.getValue();if(r){for(var n=0,i=0;i<r.length;i++)r[i].status!==or.COMPLETED&&(r[n]=r[i],n++);r.length=n,e.setValue(r.length>0?r:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},er.prototype.abortTransactions_=function(e){var t=this,r=this.getAncestorTransactionNode_(e).path(),n=this.transactionQueueTree_.subTree(e);return n.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(n),n.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),r},er.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var r=[],n=[],o=-1,s=0;s<t.length;s++)if(t[s].status===or.SENT_NEEDS_ABORT);else if(t[s].status===or.SENT)Object(i.e)(o===s-1,"All SENT items should be at beginning of queue."),o=s,t[s].status=or.SENT_NEEDS_ABORT,t[s].abortReason="set";else if(Object(i.e)(t[s].status===or.RUN,"Unexpected transaction status in abort"),t[s].unwatcher(),n=n.concat(this.serverSyncTree_.ackUserWrite(t[s].currentWriteId,!0)),t[s].onComplete){r.push(t[s].onComplete.bind(null,new Error("set"),!1,null))}-1===o?e.setValue(null):t.length=o+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),n);for(s=0;s<r.length;s++)j(r[s])}};var cr,ur=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return cr||(cr=new e),cr},e.prototype.interrupt=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].interrupt()},e.prototype.resume=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].resume()},e.prototype.databaseFromApp=function(e,t){var r=t||e.options.databaseURL;void 0===r&&w("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var n=Q(r),i=n.repoInfo;return le("Invalid Firebase Database URL",1,n),n.path.isEmpty()||w("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,e).database},e.prototype.deleteRepo=function(e){var t=Object(i.F)(this.repos_,e.app.name);t&&Object(i.F)(t,e.repoInfo_.toURLString())===e||w("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.repoInfo_.toURLString()]},e.prototype.createRepo=function(e,t){var r=Object(i.F)(this.repos_,t.name);r||(r={},this.repos_[t.name]=r);var n=Object(i.F)(r,e.toURLString());return n&&w("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),n=new er(e,this.useRestClient_,t),r[e.toURLString()]=n,n},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),lr=function(){function e(e){this.repo_=e,e instanceof er||w("Don't call new Database() directly - please use firebase.database()."),this.root_=new ir(e,F.Empty),this.INTERNAL=new hr(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),Object(i.J)("database.ref",0,1,arguments.length),e instanceof ir?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),Object(i.J)(t,1,1,arguments.length);var r=Q(e);le(t,1,r);var n=r.repoInfo;return n.host!==this.repo_.repoInfo_.host&&w(t+": Host name does not match the current database: (found "+n.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(r.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&w("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){Object(i.J)("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){Object(i.J)("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}(),hr=function(){function e(e){this.database=e}return e.prototype.delete=function(){return Object(s.a)(this,void 0,void 0,function(){return Object(s.c)(this,function(e){return this.database.checkDeleted_("delete"),ur.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},e}(),pr=Object.freeze({forceLongPolling:function(){zt.forceDisallow(),Kt.forceAllow()},forceWebSockets:function(){Kt.forceDisallow()},isWebSocketsAvailable:function(){return zt.isAvailable()},setSecurityDebugCallback:function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){e.repo.stats(t)},statsIncrementCounter:function(e,t){e.repo.statsIncrementCounter(t)},dataUpdateCount:function(e){return e.repo.dataUpdateCount},interceptServerData:function(e,t){return e.repo.interceptServerData_(t)}}),fr=Xt;Xt.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Xt.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var dr=Yt,gr=K,mr=Object.freeze({DataConnection:fr,RealTimeConnection:dr,hijackHash:function(e){var t=Xt.prototype.put;return Xt.prototype.put=function(r,n,i,o){void 0!==o&&(o=e()),t.call(this,r,n,i,o)},function(){Xt.prototype.put=t}},ConnectionTarget:gr,queryIdentifier:function(e){return e.queryIdentifier()},listens:function(e){return e.repo.persistentConnection_.listens_},forceRestClient:function(e){ur.getInstance().forceRestClient(e)}}),yr=lr.ServerValue;function vr(t){var r=t.INTERNAL.registerService("database",function(e,t,r){return ur.getInstance().databaseFromApp(e,r)},{Reference:ir,Query:Je,Database:lr,enableLogging:b,INTERNAL:pr,ServerValue:yr,TEST_ACCESS:mr},null,!0);Object(i.y)()&&(e.exports=r)}vr(a.a)}.call(this,r(321)(e))},function(e){e.exports={_from:"firebase-admin@latest",_id:"firebase-admin@6.3.0",_inBundle:!1,_integrity:"sha512-9jEt69a9VB0X3WMJJkKDzOKKmCdqX+iIcfTke5dI16GfbHlfbvqXVisgKIwAmi8Ea7FYc1t3V/WCEJUrWnJ8tA==",_location:"/firebase-admin",_phantomChildren:{},_requested:{type:"tag",registry:!0,raw:"firebase-admin@latest",name:"firebase-admin",escapedName:"firebase-admin",rawSpec:"latest",saveSpec:null,fetchSpec:"latest"},_requiredBy:["#USER","/"],_resolved:"https://registry.npmjs.org/firebase-admin/-/firebase-admin-6.3.0.tgz",_shasum:"68ca0842ece2774c9455f7e1a054bacc24dde804",_spec:"firebase-admin@latest",_where:"D:\\Projects\\webhooks",author:{name:"Firebase",email:"firebase-support@google.com",url:"https://firebase.google.com/"},bugs:{url:"https://github.com/firebase/firebase-admin-node/issues"},bundleDependencies:!1,dependencies:{"@firebase/app":"^0.3.4","@firebase/database":"^0.3.6","@google-cloud/firestore":"^0.19.0","@google-cloud/storage":"^1.6.0","@types/google-cloud__storage":"^1.7.1","@types/node":"^8.0.53",jsonwebtoken:"8.1.0","node-forge":"0.7.4"},deprecated:!1,description:"Firebase admin SDK for Node.js",devDependencies:{"@firebase/auth":"0.5.2","@types/bcrypt":"^2.0.0","@types/chai":"^3.4.34","@types/chai-as-promised":"0.0.29","@types/firebase-token-generator":"^2.0.28","@types/jsonwebtoken":"^7.2.8","@types/lodash":"^4.14.104","@types/minimist":"^1.2.0","@types/mocha":"^2.2.48","@types/nock":"^9.1.0","@types/request":"^2.47.0","@types/request-promise":"^4.1.41","@types/scrypt":"^6.0.0","@types/sinon":"^4.1.3","@types/sinon-chai":"^2.7.27",bcrypt:"^3.0.0",chai:"^3.5.0","chai-as-promised":"^6.0.0",chalk:"^1.1.3",del:"^2.2.1","firebase-token-generator":"^2.0.0",gulp:"^3.9.1","gulp-exit":"0.0.2","gulp-header":"^1.8.8","gulp-replace":"^0.5.4","gulp-typescript":"^3.2.4",lodash:"^4.17.5",merge2:"^1.2.1",minimist:"^1.2.0",mocha:"^5.2.0",nock:"^9.6.0","npm-run-all":"^4.1.5",nyc:"^11.5.0",request:"^2.75.0","request-promise":"^4.1.1","run-sequence":"^1.1.5",scrypt:"^6.0.3",sinon:"^4.4.5","sinon-chai":"^2.8.0","ts-node":"^3.3.0",tslint:"^5.9.0",typescript:"^2.7.2"},engines:{node:">=6.0.0"},files:["lib/","LICENSE","README.md","package.json"],homepage:"https://firebase.google.com/",keywords:["admin","database","Firebase","realtime","authentication"],license:"Apache-2.0",main:"lib/index.js",name:"firebase-admin",nyc:{extension:[".ts"],include:["src"],exclude:["**/*.d.ts"],all:!0},optionalDependencies:{"@google-cloud/firestore":"^0.19.0","@google-cloud/storage":"^1.6.0","@types/google-cloud__storage":"^1.7.1"},repository:{type:"git",url:"git+https://github.com/firebase/firebase-admin-node.git"},scripts:{build:"gulp build",integration:"run-s build test:integration",lint:"run-p lint:src lint:unit lint:integration","lint:integration":"tslint -c tslint-test.json --format stylish test/integration/*.ts","lint:src":"tslint --format stylish -p tsconfig.json","lint:unit":"tslint -c tslint-test.json --format stylish test/unit/*.ts test/unit/**/*.ts",test:"run-s lint test:unit","test:coverage":"nyc npm run test:unit","test:integration":"mocha test/integration/*.ts --slow 5000 --timeout 20000 --require ts-node/register","test:unit":"mocha test/unit/*.spec.ts --require ts-node/register"},types:"./lib/index.d.ts",version:"6.3.0"}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(24),i=r(39),o=r(322),s=r(10),a=r(24),c=r(11),u={bodyLocArgs:"body_loc_args",bodyLocKey:"body_loc_key",clickAction:"click_action",titleLocArgs:"title_loc_args",titleLocKey:"title_loc_key"},l={dryRun:"dry_run",timeToLive:"time_to_live",collapseKey:"collapse_key",mutableContent:"mutable_content",contentAvailable:"content_available",restrictedPackageName:"restricted_package_name"},h={message_id:"messageId",registration_id:"canonicalRegistrationToken"},p={canonical_ids:"canonicalRegistrationTokenCount",failure:"failureCount",success:"successCount",multicast_id:"multicastId"},f={success:"successCount",failure:"failureCount",failed_registration_ids:"failedRegistrationTokens"},d={message_id:"messageId"},g={message_id:"messageId"};function m(e,t){if(void 0!==e){if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,t+" must be a non-null object");Object.keys(e).forEach(function(r){if(!c.isString(e[r]))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,t+" must only contain string values")})}}function y(e){if(void 0!==e){if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"apns must be a non-null object");m(e.headers,"apns.headers"),function(e){if(void 0===e)return;if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"apns.payload must be a non-null object");!function(e){if(void 0===e)return;if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"apns.payload.aps must be a non-null object");!function(e){if(void 0===e||c.isString(e))return;if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"apns.payload.aps.alert must be a string or a non-null object");var t=e;if(c.isNonEmptyArray(t.locArgs)&&!c.isNonEmptyString(t.locKey))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"apns.payload.aps.alert.locKey is required when specifying locArgs");if(c.isNonEmptyArray(t.titleLocArgs)&&!c.isNonEmptyString(t.titleLocKey))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"apns.payload.aps.alert.titleLocKey is required when specifying titleLocArgs");if(c.isNonEmptyArray(t.subtitleLocArgs)&&!c.isNonEmptyString(t.subtitleLocKey))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"apns.payload.aps.alert.subtitleLocKey is required when specifying subtitleLocArgs");n.renameProperties(t,{locKey:"loc-key",locArgs:"loc-args",titleLocKey:"title-loc-key",titleLocArgs:"title-loc-args",subtitleLocKey:"subtitle-loc-key",subtitleLocArgs:"subtitle-loc-args",actionLocKey:"action-loc-key",launchImage:"launch-image"})}(e.alert);var t={contentAvailable:"content-available",mutableContent:"mutable-content",threadId:"thread-id"};Object.keys(t).forEach(function(r){if(r in e&&t[r]in e)throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"Multiple specifications for "+r+" in Aps")}),n.renameProperties(e,t);var r=e["content-available"];void 0!==r&&1!==r&&(!0===r?e["content-available"]=1:delete e["content-available"]);var i=e["mutable-content"];void 0!==i&&1!==i&&(!0===i?e["mutable-content"]=1:delete e["mutable-content"])}(e.aps)}(e.payload)}}function v(e){if(void 0!==e){if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"android must be a non-null object");if(void 0!==e.ttl){if(!c.isNumber(e.ttl)||e.ttl<0)throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"TTL must be a non-negative duration in milliseconds");var t=Math.floor(e.ttl/1e3),r=1e6*(e.ttl-1e3*t),i=void 0;if(r>0){for(var o=r.toString();o.length<9;)o="0"+o;i=t+"."+o+"s"}else i=t+"s";e.ttl=i}m(e.data,"android.data"),function(e){if(void 0===e)return;if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"android.notification must be a non-null object");if(void 0!==e.color&&!/^#[0-9a-fA-F]{6}$/.test(e.color))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"android.notification.color must be in the form #RRGGBB");if(c.isNonEmptyArray(e.bodyLocArgs)&&!c.isNonEmptyString(e.bodyLocKey))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"android.notification.bodyLocKey is required when specifying bodyLocArgs");if(c.isNonEmptyArray(e.titleLocArgs)&&!c.isNonEmptyString(e.titleLocKey))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"android.notification.titleLocKey is required when specifying titleLocArgs");n.renameProperties(e,{clickAction:"click_action",bodyLocKey:"body_loc_key",bodyLocArgs:"body_loc_args",titleLocKey:"title_loc_key",titleLocArgs:"title_loc_args"})}(e.notification);n.renameProperties(e,{collapseKey:"collapse_key",restrictedPackageName:"restricted_package_name"})}}function b(e){if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"Message must be a non-null object");var t=e;if(t.topic&&(t.topic.startsWith("/topics/")&&(t.topic=t.topic.replace(/^\/topics\//,"")),!/^[a-zA-Z0-9-_.~%]+$/.test(t.topic)))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"Malformed topic name");if(1!==[t.token,t.topic,t.condition].filter(function(e){return c.isNonEmptyString(e)}).length)throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"Exactly one of topic, token or condition is required");m(e.data,"data"),v(e.android),function(e){if(void 0!==e){if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,"webpush must be a non-null object");m(e.headers,"webpush.headers"),m(e.data,"webpush.data")}}(e.webpush),y(e.apns)}function _(e){return a.renameProperties(e,p),"results"in e&&e.results.forEach(function(e){if(a.renameProperties(e,h),"error"in e){var t=s.FirebaseMessagingError.fromServerError(e.error,void 0,e.error);e.error=t}}),e}function E(e){return a.renameProperties(e,f),e.failedRegistrationTokens=e.failedRegistrationTokens||[],e}t.BLACKLISTED_DATA_PAYLOAD_KEYS=["from"],t.BLACKLISTED_OPTIONS_KEYS=["condition","data","notification","registrationIds","registration_ids","to"];var C=function(){function e(){}return e.prototype.delete=function(){return Promise.resolve(void 0)},e}(),w=function(){function e(e){if(this.INTERNAL=new C,!(c.isNonNullObject(e)&&"options"in e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_ARGUMENT,"First argument passed to admin.messaging() must be a valid Firebase app instance.");var t=a.getProjectId(e);if(!c.isNonEmptyString(t))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_ARGUMENT,"Failed to determine project ID for Messaging. Initialize the SDK with service account credentials or set project ID as an app option. Alternatively set the GOOGLE_CLOUD_PROJECT environment variable.");this.urlPath="/v1/projects/"+t+"/messages:send",this.appInternal=e,this.messagingRequestHandler=new o.FirebaseMessagingRequestHandler(e)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.appInternal},enumerable:!0,configurable:!0}),e.prototype.send=function(e,t){var r=this,n=i.deepCopy(e);if(b(n),void 0!==t&&!c.isBoolean(t))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_ARGUMENT,"dryRun must be a boolean");return Promise.resolve().then(function(){var e={message:n};return t&&(e.validate_only=!0),r.messagingRequestHandler.invokeRequestHandler("fcm.googleapis.com",r.urlPath,e)}).then(function(e){return e.name})},e.prototype.sendToDevice=function(e,t,r){var n=this;return void 0===r&&(r={}),this.validateRegistrationTokensType(e,"sendToDevice",s.MessagingClientErrorCode.INVALID_RECIPIENT),this.validateMessagingPayloadAndOptionsTypes(t,r),Promise.resolve().then(function(){n.validateRegistrationTokens(e,"sendToDevice",s.MessagingClientErrorCode.INVALID_RECIPIENT);var o=n.validateMessagingPayload(t),a=n.validateMessagingOptions(r),u=i.deepCopy(o);return i.deepExtend(u,a),c.isString(e)?u.to=e:u.registration_ids=e,n.messagingRequestHandler.invokeRequestHandler("fcm.googleapis.com","/fcm/send",u)}).then(function(e){return"multicast_id"in e?_(e):E(e)})},e.prototype.sendToDeviceGroup=function(e,t,r){var n=this;if(void 0===r&&(r={}),!c.isNonEmptyString(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_RECIPIENT,"Notification key provided to sendToDeviceGroup() must be a non-empty string.");return-1!==e.indexOf(":")?Promise.reject(new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_RECIPIENT,"Notification key provided to sendToDeviceGroup() has the format of a registration token. You should use sendToDevice() instead.")):(this.validateMessagingPayloadAndOptionsTypes(t,r),Promise.resolve().then(function(){var o=n.validateMessagingPayload(t),s=n.validateMessagingOptions(r),a=i.deepCopy(o);return i.deepExtend(a,s),a.to=e,n.messagingRequestHandler.invokeRequestHandler("fcm.googleapis.com","/fcm/send",a)}).then(function(e){if("multicast_id"in e){if(0===e.success)throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_RECIPIENT,"Notification key provided to sendToDeviceGroup() is invalid.");return _(e)}return E(e)}))},e.prototype.sendToTopic=function(e,t,r){var n=this;return void 0===r&&(r={}),this.validateTopicType(e,"sendToTopic",s.MessagingClientErrorCode.INVALID_RECIPIENT),this.validateMessagingPayloadAndOptionsTypes(t,r),e=this.normalizeTopic(e),Promise.resolve().then(function(){var o=n.validateMessagingPayload(t),a=n.validateMessagingOptions(r);n.validateTopic(e,"sendToTopic",s.MessagingClientErrorCode.INVALID_RECIPIENT);var c=i.deepCopy(o);return i.deepExtend(c,a),c.to=e,n.messagingRequestHandler.invokeRequestHandler("fcm.googleapis.com","/fcm/send",c)}).then(function(e){return a.renameProperties(e,d),e})},e.prototype.sendToCondition=function(e,t,r){var n=this;if(void 0===r&&(r={}),!c.isNonEmptyString(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_RECIPIENT,"Condition provided to sendToCondition() must be a non-empty string.");return this.validateMessagingPayloadAndOptionsTypes(t,r),e=e.replace(/"/g,"'"),Promise.resolve().then(function(){var o=n.validateMessagingPayload(t),s=n.validateMessagingOptions(r),a=i.deepCopy(o);return i.deepExtend(a,s),a.condition=e,n.messagingRequestHandler.invokeRequestHandler("fcm.googleapis.com","/fcm/send",a)}).then(function(e){return a.renameProperties(e,g),e})},e.prototype.subscribeToTopic=function(e,t){return this.sendTopicManagementRequest(e,t,"subscribeToTopic","/iid/v1:batchAdd")},e.prototype.unsubscribeFromTopic=function(e,t){return this.sendTopicManagementRequest(e,t,"unsubscribeFromTopic","/iid/v1:batchRemove")},e.prototype.sendTopicManagementRequest=function(e,t,r,n){var i=this;return this.validateRegistrationTokensType(e,r),this.validateTopicType(t,r),t=this.normalizeTopic(t),Promise.resolve().then(function(){i.validateRegistrationTokens(e,r),i.validateTopic(t,r);var o=e;c.isString(e)&&(o=[e]);var s={to:t,registration_tokens:o};return i.messagingRequestHandler.invokeRequestHandler("iid.googleapis.com",n,s)}).then(function(e){return function(e){var t={successCount:0,failureCount:0,errors:[]};return"results"in e&&e.results.forEach(function(e,r){if("error"in e){t.failureCount+=1;var n=s.FirebaseMessagingError.fromTopicManagementServerError(e.error,void 0,e.error);t.errors.push({index:r,error:n})}else t.successCount+=1}),t}(e)})},e.prototype.validateMessagingPayloadAndOptionsTypes=function(e,t){if(!c.isNonNullObject(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,'Messaging payload must be an object with at least one of the "data" or "notification" properties.');if(!c.isNonNullObject(t))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,"Messaging options must be an object.")},e.prototype.validateMessagingPayload=function(e){var r=i.deepCopy(e),n=Object.keys(r),o=["data","notification"],l=!1;if(n.forEach(function(e){if(-1===o.indexOf(e))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,'Messaging payload contains an invalid "'+e+'" property. Valid properties are "data" and "notification".');l=!0}),!l)throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,'Messaging payload must contain at least one of the "data" or "notification" properties.');return n.forEach(function(e){var t=r[e];if(!c.isNonNullObject(t))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,'Messaging payload contains an invalid value for the "'+e+'" property. Value must be an object.');Object.keys(t).forEach(function(r){if(!c.isString(t[r]))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,'Messaging payload contains an invalid value for the "'+e+"."+r+'" property. Values must be strings.');if("data"===e&&/^google\./.test(r))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,'Messaging payload contains the blacklisted "data.'+r+'" property.')})}),"data"in r&&t.BLACKLISTED_DATA_PAYLOAD_KEYS.forEach(function(e){if(e in r.data)throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_PAYLOAD,'Messaging payload contains the blacklisted "data.'+e+'" property.')}),"notification"in r&&a.renameProperties(r.notification,u),r},e.prototype.validateMessagingOptions=function(e){var r=i.deepCopy(e);if(t.BLACKLISTED_OPTIONS_KEYS.forEach(function(e){if(e in r)throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains the blacklisted "'+e+'" property.')}),a.renameProperties(r,l),"collapse_key"in r&&!c.isNonEmptyString(r.collapse_key)){var n="collapseKey"in e?"collapseKey":"collapse_key";throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains an invalid value for the "'+n+'" property. Value must be a non-empty string.')}if("dry_run"in r&&!c.isBoolean(r.dry_run)){n="dryRun"in e?"dryRun":"dry_run";throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains an invalid value for the "'+n+'" property. Value must be a boolean.')}if("priority"in r&&!c.isNonEmptyString(r.priority))throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains an invalid value for the "priority" property. Value must be a non-empty string.');if("restricted_package_name"in r&&!c.isNonEmptyString(r.restricted_package_name)){n="restrictedPackageName"in e?"restrictedPackageName":"restricted_package_name";throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains an invalid value for the "'+n+'" property. Value must be a non-empty string.')}if("time_to_live"in r&&!c.isNumber(r.time_to_live)){n="timeToLive"in e?"timeToLive":"time_to_live";throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains an invalid value for the "'+n+'" property. Value must be a number.')}if("content_available"in r&&!c.isBoolean(r.content_available)){n="contentAvailable"in e?"contentAvailable":"content_available";throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains an invalid value for the "'+n+'" property. Value must be a boolean.')}if("mutable_content"in r&&!c.isBoolean(r.mutable_content)){n="mutableContent"in e?"mutableContent":"mutable_content";throw new s.FirebaseMessagingError(s.MessagingClientErrorCode.INVALID_OPTIONS,'Messaging options contains an invalid value for the "'+n+'" property. Value must be a boolean.')}return r},e.prototype.validateRegistrationTokensType=function(e,t,r){if(void 0===r&&(r=s.MessagingClientErrorCode.INVALID_ARGUMENT),!c.isNonEmptyArray(e)&&!c.isNonEmptyString(e))throw new s.FirebaseMessagingError(r,"Registration token(s) provided to "+t+"() must be a non-empty string or a non-empty array.")},e.prototype.validateRegistrationTokens=function(e,t,r){if(void 0===r&&(r=s.MessagingClientErrorCode.INVALID_ARGUMENT),c.isArray(e)){if(e.length>1e3)throw new s.FirebaseMessagingError(r,"Too many registration tokens provided in a single request to "+t+"(). Batch your requests to contain no more than 1,000 registration tokens per request.");e.forEach(function(e,n){if(!c.isNonEmptyString(e))throw new s.FirebaseMessagingError(r,"Registration token provided to "+t+"() at index "+n+" must be a non-empty string.")})}},e.prototype.validateTopicType=function(e,t,r){if(void 0===r&&(r=s.MessagingClientErrorCode.INVALID_ARGUMENT),!c.isNonEmptyString(e))throw new s.FirebaseMessagingError(r,"Topic provided to "+t+'() must be a string which matches the format "/topics/[a-zA-Z0-9-_.~%]+".')},e.prototype.validateTopic=function(e,t,r){if(void 0===r&&(r=s.MessagingClientErrorCode.INVALID_ARGUMENT),!c.isTopic(e))throw new s.FirebaseMessagingError(r,"Topic provided to "+t+'() must be a string which matches the format "/topics/[a-zA-Z0-9-_.~%]+".')},e.prototype.normalizeTopic=function(e){return/^\/topics\//.test(e)||(e="/topics/"+e),e},e}();t.Messaging=w},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(109),o=r(11),s=function(){function e(){}return e.prototype.delete=function(){return Promise.resolve()},e}(),a=function(){function e(e){if(this.INTERNAL=new s,!(o.isNonNullObject(e)&&"options"in e))throw new n.FirebaseError({code:"storage/invalid-argument",message:"First argument passed to admin.storage() must be a valid Firebase app instance."});var t;try{t=r(!function(){var e=new Error("Cannot find module '@google-cloud/storage'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){throw new n.FirebaseError({code:"storage/missing-dependencies",message:'Failed to import the Cloud Storage client library for Node.js. Make sure to install the "@google-cloud/storage" npm package. Original error: '+e})}var a=e.options.credential.getCertificate();if(null!=a)this.storageClient=new t({projectId:a.projectId,credentials:{private_key:a.privateKey,client_email:a.clientEmail}});else{if(!(e.options.credential instanceof i.ApplicationDefaultCredential))throw new n.FirebaseError({code:"storage/invalid-credential",message:"Failed to initialize Google Cloud Storage client with the available credential. Must initialize the SDK with a certificate credential or application default credentials to use Cloud Storage API."});this.storageClient=new t}this.appInternal=e}return e.prototype.bucket=function(e){var t=void 0!==e?e:this.appInternal.options.storageBucket;if(o.isNonEmptyString(t))return this.storageClient.bucket(t);throw new n.FirebaseError({code:"storage/invalid-argument",message:"Bucket name not specified or invalid. Specify a valid bucket name via the storageBucket option when initializing the app, or specify the bucket name explicitly when calling the getBucket() method."})},Object.defineProperty(e.prototype,"app",{get:function(){return this.appInternal},enumerable:!0,configurable:!0}),e}();t.Storage=a},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(324),i=r(15),o=r(203),s=r(137),a=r(59),c=r(138),u=r(140),l=r(77),h=r(116),p=r(142),f=r(61),d=r(27),g=r(27),m=r(335),y=r(117),v=r(117),b=r(78),_=r(54),E=r(214),C=r(62),w=r(26),S=r(118),T=r(118);var A=r(117);t.CollectionReference=A.CollectionReference,t.DocumentReference=A.DocumentReference,t.QuerySnapshot=A.QuerySnapshot,t.Query=A.Query;var I=r(77);t.DocumentSnapshot=I.DocumentSnapshot,t.QueryDocumentSnapshot=I.QueryDocumentSnapshot;var N=r(116);t.FieldValue=N.FieldValue;var k=r(118);t.WriteBatch=k.WriteBatch,t.WriteResult=k.WriteResult;var R=r(214);t.Transaction=R.Transaction;var O=r(54);t.Timestamp=O.Timestamp;var x=r(143);t.DocumentChange=x.DocumentChange;var B=r(27);t.FieldPath=B.FieldPath;var D=r(142);t.GeoPoint=D.GeoPoint;var P=r(61);t.setLogFunction=P.setLogFunction;const L=r(215).version;
/*!
 * DO NOT REMOVE THE FOLLOWING NAMESPACE DEFINITIONS
 */
/*!
 * @see v1beta1
 */
let j;
/*!
 * HTTP header for the resource prefix to improve routing and project isolation
 * by the backend.
 */f.setLibVersion(L);const U="google-cloud-resource-prefix",M=5,F=100,V=14,q=20;
/*!
 * The maximum number of times to retry idempotent requests.
 */class K{constructor(e){this._clientPool=null,this._settings={},this._settingsFrozen=!1,this._clientInitialized=null,this._serializer=null,this._referencePath=null,this._lastSuccessfulRequest=0,this._validator=new w.Validator({ArrayElement:(e,t)=>H(e,t,void 0,0,!0),DeletePrecondition:e=>l.validatePrecondition(e,!0),Document:G,DocumentReference:y.validateDocumentReference,FieldPath:d.FieldPath.validateFieldPath,FieldValue:H,FieldOrder:y.validateFieldOrder,QueryComparison:y.validateComparisonOperator,QueryValue:H,ResourcePath:g.ResourcePath.validateResourcePath,SetOptions:l.validateSetOptions,ReadOptions:z,UpdateMap:T.validateUpdateMap,UpdatePrecondition:e=>l.validatePrecondition(e,!1)});const t={libName:"gccl",libVersion:L};e&&e.firebaseVersion&&(t.libVersion+=" fire/"+e.firebaseVersion),this.validateAndApplySettings(Object.assign({},e,t)),this._preferTransactions=a.defined(process.env.FUNCTION_TRIGGER_TYPE),this._lastSuccessfulRequest=0,this._preferTransactions&&f.logger("Firestore",null,"Detected GCF environment"),f.logger("Firestore",null,"Initialized Firestore")}settings(e){if(this._validator.isObject("settings",e),this._validator.isOptionalString("settings.projectId",e.projectId),this._validator.isOptionalBoolean("settings.timestampsInSnapshots",e.timestampsInSnapshots),this._clientInitialized)throw new Error("Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");if(this._settingsFrozen)throw new Error("Firestore.settings() has already be called. You can only call settings() once, and only before calling any other methods on a Firestore object.");const t=Object.assign({},this._settings,e);this.validateAndApplySettings(t),this._settingsFrozen=!0}validateAndApplySettings(e){this._validator.isOptionalBoolean("settings.timestampsInSnapshots",e.timestampsInSnapshots),e&&e.projectId?(this._validator.isString("settings.projectId",e.projectId),this._referencePath=new g.ResourcePath(e.projectId,"(default)")):this._referencePath=new g.ResourcePath("{{projectId}}","(default)"),this._settings=e,this._serializer=new b.Serializer(this)}get formattedName(){return this._referencePath.formattedName}doc(e){this._validator.isResourcePath("documentPath",e);const t=this._referencePath.append(e);if(!t.isDocument)throw new Error(`Argument "documentPath" must point to a document, but was "${e}". Your path does not contain an even number of components.`);return new v.DocumentReference(this,t)}collection(e){this._validator.isResourcePath("collectionPath",e);const t=this._referencePath.append(e);if(!t.isCollection)throw new Error(`Argument "collectionPath" must point to a collection, but was "${e}". Your path does not contain an odd number of components.`);return new y.CollectionReference(this,t)}batch(){return new S.WriteBatch(this)}snapshot_(e,t,r){let n,i;if(a.defined(r)&&"protobufJS"!==r){if("json"!==r)throw new Error('Unsupported encoding format. Expected "json" or "protobufJS", '+`but was "${r}".`);n=u.timestampFromJson,i=u.documentFromJson}else n=(e=>e),i=(e=>e);const o=new l.DocumentSnapshotBuilder;return"string"==typeof e?o.ref=new v.DocumentReference(this,g.ResourcePath.fromSlashSeparatedString(e)):(o.ref=new v.DocumentReference(this,g.ResourcePath.fromSlashSeparatedString(e.name)),o.fieldsProto=e.fields?i(e.fields):{},o.createTime=_.Timestamp.fromProto(n(e.createTime,"documentOrName.createTime")),o.updateTime=_.Timestamp.fromProto(n(e.updateTime,"documentOrName.updateTime"))),t&&(o.readTime=_.Timestamp.fromProto(n(t,"readTime"))),o.build()}runTransaction(e,t){return this._validator.isFunction("updateFunction",e),t&&(this._validator.isObject("transactionOptions",t),this._validator.isOptionalInteger("transactionOptions.maxAttempts",t.maxAttempts,1)),this._runTransaction(e,t)}_runTransaction(e,t){let r,n=5;t&&(n=t.maxAttempts||n,r=t.previousTransaction);const i=new E.Transaction(this,r),o=i.requestTag;let s;return--n,i.begin().then(()=>{const t=e(i);return(s=t instanceof Promise?t:Promise.reject(new Error("You must return a Promise in your transaction()-callback."))).catch(e=>(f.logger("Firestore.runTransaction",o,"Rolling back transaction after callback error:",e),i.rollback().then(()=>s)))}).then(()=>i.commit().then(()=>s).catch(t=>n>0?(f.logger("Firestore.runTransaction",o,`Retrying transaction after error: ${JSON.stringify(t)}.`),this._runTransaction(e,{previousTransaction:i,maxAttempts:n})):(f.logger("Firestore.runTransaction",o,"Exhausted transaction retries, returning error: %s",t),Promise.reject(t))))}listCollections(){return new v.DocumentReference(this,this._referencePath).listCollections()}getCollections(){return this.listCollections()}getAll(e,...t){this._validator.minNumberOfArguments("Firestore.getAll",arguments,1);const{documents:r,fieldMask:n}=C.parseGetAllArguments(this._validator,[e,...t]);return this.getAll_(r,n,C.requestTag())}getAll_(e,t,r,n){const i=new Set,o=new Map;for(const t of e)i.add(t.formattedName);const s={database:this.formattedName,transaction:n,documents:Array.from(i)};if(t){const e=t.map(e=>e.formattedName);s.mask={fieldPaths:e}}const c=this;return c.readStream("batchGetDocuments",s,r,!0).then(t=>new Promise((n,i)=>{t.on("error",e=>{f.logger("Firestore.getAll_",r,"GetAll failed with error:",e),i(e)}).on("data",e=>{try{let t;e.found?(f.logger("Firestore.getAll_",r,"Received document: %s",e.found.name),t=c.snapshot_(e.found,e.readTime)):(f.logger("Firestore.getAll_",r,"Document missing: %s",e.missing),t=c.snapshot_(e.missing,e.readTime));const n=t.ref.path;o.set(n,t)}catch(e){f.logger("Firestore.getAll_",r,"GetAll failed with exception:",e),i(e)}}).on("end",()=>{f.logger("Firestore.getAll_",r,"Received %d results",o.size);const t=[];for(const r of e){const e=o.get(r.path);a.defined(e)||i(new Error(`Did not receive document for "${r.path}".`)),t.push(e)}n(t)}),t.resume()}))}_runRequest(e){return this._clientInitialized||(this._settings.timestampsInSnapshots||console.error("\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = new Firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK."),this._clientInitialized=this._initClientPool().then(e=>{this._clientPool=e})),this._clientInitialized.then(()=>this._clientPool.run(e))}_initClientPool(){i(!this._clientInitialized,"Client pool already initialized");const t=new m.ClientPool(F,()=>{const t=new e.exports.v1beta1(this._settings);return f.logger("Firestore",null,"Initialized Firestore GAPIC Client"),t});return"{{projectId}}"!==this._referencePath.projectId?Promise.resolve(t):t.run(e=>this._detectProjectId(e)).then(e=>(this._referencePath=new g.ResourcePath(e,this._referencePath.databaseId),t))}_detectProjectId(e){return new Promise((t,r)=>{e.getProjectId((e,n)=>{e?(f.logger("Firestore._detectProjectId",null,"Failed to detect project ID: %s",e),r(e)):(f.logger("Firestore._detectProjectId",null,"Detected project ID: %s",n),t(n))})})}_decorateRequest(e){let t=s(!0,{},e);t=n.replaceProjectIdToken(t,this._referencePath.projectId);const r={otherArgs:{headers:{}}};return r.otherArgs.headers[U]=this.formattedName,{request:t,gax:r}}_retry(e,t,r,n=0){const i=this,o=n,s=n||100;return--e,new Promise(e=>{setTimeout(e,o)}).then(r).then(e=>(i._lastSuccessfulRequest=(new Date).getTime(),e)).catch(n=>a.defined(n.code)&&n.code!==V?(f.logger("Firestore._retry",t,"Request failed with unrecoverable error:",n),Promise.reject(n)):0===e?(f.logger("Firestore._retry",t,"Request failed with error:",n),Promise.reject(n)):(f.logger("Firestore._retry",t,"Retrying request that failed with error:",n),i._retry(e,t,r,s)))}_initializeStream(e,t,r){let n=null,i=!1,o=!1;return new Promise((s,a)=>{const c=()=>{n?(f.logger("Firestore._initializeStream",t,"Emit error:",n),e.emit("error",n),n=null):i||(f.logger("Firestore._initializeStream",t,"Releasing stream"),i=!0,e.pause(),s(e),setTimeout(()=>{o&&(f.logger("Firestore._initializeStream",t,"Forwarding stream close"),e.emit("end"))},0))};e.on("readable",()=>{c()}),e.on("end",()=>{f.logger("Firestore._initializeStream",t,"Received stream end"),o=!0,c()}),e.on("error",e=>{f.logger("Firestore._initializeStream",t,"Received stream error:",e),i?n=e:(f.logger("Firestore._initializeStream",t,"Received initial error:",e),i=!0,a(e))}),r&&(f.logger("Firestore._initializeStream",t,"Sending request: %j",r),e.write(r,"utf-8",()=>{f.logger("Firestore._initializeStream",t,"Marking stream as healthy"),c()}))})}request(e,t,r,n){const i=n?M:1;return this._runRequest(n=>{const o=this._decorateRequest(t);return this._retry(i,r,()=>new Promise((t,i)=>{f.logger("Firestore.request",r,"Sending request: %j",o.request),n[e](o.request,o.gax,(e,n)=>{e?(f.logger("Firestore.request",r,"Received error:",e),i(e)):(f.logger("Firestore.request",r,"Received response: %j",n),t(n))})}))})}readStream(e,t,r,n){const i=n?M:1;return this._runRequest(n=>{const s=this._decorateRequest(t);return this._retry(i,r,()=>new Promise((t,i)=>{try{f.logger("Firestore.readStream",r,"Sending request: %j",s.request);const a=n[e](s.request,s.gax),u=c.obj(function(e,t,n){f.logger("Firestore.readStream",r,"Received response: %j",e),this.push(e),n()});t(o([a,u]))}catch(e){f.logger("Firestore.readStream",r,"Received error:",e),i(e)}}).then(e=>this._initializeStream(e,r)))})}readWriteStream(e,t,r,i){const a=this,u=i?M:1;return this._runRequest(i=>{const l=this._decorateRequest(t);return this._retry(u,r,()=>Promise.resolve().then(()=>{f.logger("Firestore.readWriteStream",r,"Opening stream");const u=i[e](l.gax),h=c.obj((e,t,i)=>{const o=s(!0,{},e);n.replaceProjectIdToken(o,a._referencePath.projectId),f.logger("Firestore.readWriteStream",r,"Streaming request: %j",o),u.write(o,t,i)}),p=c.obj(function(e,t,n){f.logger("Firestore.readWriteStream",r,"Received response: %j",e),this.push(e),n()}),d=o([h,u,p]);return this._initializeStream(d,r,t)}))})}}function H(e,t,r,n,i){if(r&&r.size>q)throw new Error(`Input object is deeper than ${q} levels or contains a cycle.`);n=n||0,i=i||!1;const o=r?` (found in field ${r.toString()})`:"";if(Array.isArray(e)){const i=e;for(let e=0;e<i.length;++e)H(i[e],t,r?r.append(String(e)):new d.FieldPath(String(e)),n+1,!0)}else if(b.isPlainObject(e)){const o=e;for(const e in o)o.hasOwnProperty(e)&&H(o[e],t,r?r.append(new d.FieldPath(e)):new d.FieldPath(e),n+1,i)}else{if(void 0===e)throw new Error(`Cannot use "undefined" as a Firestore value${o}.`);if(e instanceof h.DeleteTransform){if(i)throw new Error(`${e.methodName}() cannot be used inside of an array${o}.`);if("root"===t.allowDeletes&&0!==n||"none"===t.allowDeletes)throw new Error(`${e.methodName}() must appear at the top-level and can only be used in update() or set() with {merge:true}${o}.`)}else if(e instanceof h.FieldTransform){if(i)throw new Error(`${e.methodName}() cannot be used inside of an array${o}.`);if(!t.allowTransforms)throw new Error(`${e.methodName}() can only be used in set(), create() or update()${o}.`)}else{if(e instanceof v.DocumentReference)return!0;if(e instanceof p.GeoPoint)return!0;if(e instanceof _.Timestamp)return!0;if(e instanceof d.FieldPath)throw new Error(`Cannot use object of type "FieldPath" as a Firestore value${o}.`);if(a.object(e))throw w.customObjectError(e,r)}}return!0}function G(e,t){if(!b.isPlainObject(e))throw w.customObjectError(e);t=t||{};let r=!0;for(const n in e)e.hasOwnProperty(n)&&(r=!1,H(e[n],t,new d.FieldPath(n)));if(!1===t.allowEmpty&&r)throw new Error("At least one field must be updated.");return!0}function z(e){if(!a.object(e))throw new Error("Input is not an object.");if(void 0===e.fieldMask)return!0;if(!Array.isArray(e.fieldMask))throw new Error('"fieldMask" is not an array.');for(let t=0;t<e.fieldMask.length;++t)try{d.FieldPath.validateFieldPath(e.fieldMask[t])}catch(e){throw new Error(`Element at index ${t} is not a valid FieldPath. ${e.message}`)}return!0}t.Firestore=K,t.validateReadOptions=z,t.default=K;const W=e.exports;e.exports=K,e.exports=Object.assign(e.exports,W),Object.defineProperty(e.exports,"v1beta1",{get:()=>(j||(j=r(341)),j)})},function(e,t,r){var n=r(325),i=function(e){e=e||{},Array.isArray(e)&&(e={streams:e}),e.objectMode=!0,n.Duplex.call(this,e);var t=this;if(this._streams=(e.streams||[]).slice(),0===this._streams.length&&this._streams.push(new n.PassThrough({objectMode:!0})),this._bubbleErrors=void 0===e.bubbleErrors||!!e.bubbleErrors,this._bubbleErrors)for(var r=0;r<this._streams.length;++r)this._streams[r].on("error",function(e){return t.emit("error",e)});for(r=0;r<this._streams.length-1;++r)this._streams[r].pipe(this._streams[r+1]);this._first=this._streams[0],this._last=this._streams[this._streams.length-1],this._last.on("data",function(e){t.push(e)||t._last.pause()}),this._last.on("end",function(){t.push(null)}),this._first.on("finish",function(){t.end()}),this.on("finish",function(){t._first.end()})};(i.prototype=Object.create(n.Duplex.prototype,{constructor:{value:i}}))._write=function(e,t,r){this._first.write(e,r)},i.prototype._read=function(e){this._last.resume()},(e.exports=function(e,t){if(Array.isArray(e)){var r=t;t=e,e=r}return(e=e||{}).streams=e.streams||t,new i(e)}).BunWrapper=i},function(e,t,r){e.exports=l;var n=r(326),i=r(35).Buffer;l.ReadableState=u;var o=r(12).EventEmitter;o.listenerCount||(o.listenerCount=function(e,t){return e.listeners(t).length});var s,a=r(9),c=r(25);function u(e,t){var n=(e=e||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(s||(s=r(205).StringDecoder),this.decoder=new s(e.encoding),this.encoding=e.encoding)}function l(e){if(!(this instanceof l))return new l(e);this._readableState=new u(e,this),this.readable=!0,a.call(this)}function h(e,t,r,n,o){var s=function(e,t){var r=null;i.isBuffer(t)||"string"==typeof t||null==t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));return r}(t,r);if(s)e.emit("error",s);else if(null==r)t.reading=!1,t.ended||function(e,t){if(t.decoder&&!t.ended){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.length>0?d(e):_(e)}(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!o){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&o){a=new Error("stream.unshift() after end event");e.emit("error",a)}else!t.decoder||o||n||(r=t.decoder.write(r)),t.length+=t.objectMode?1:r.length,o?t.buffer.unshift(r):(t.reading=!1,t.buffer.push(r)),t.needReadable&&d(e),function(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){!function(e,t){var r=t.length;for(;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}(e,t)}))}(e,t);else o||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}c.inherits=r(19),c.inherits(l,a),l.prototype.push=function(e,t){var r=this._readableState;return"string"!=typeof e||r.objectMode||(t=t||r.defaultEncoding)!==r.encoding&&(e=new i(e,t),t=""),h(this,r,e,t,!1)},l.prototype.unshift=function(e){return h(this,this._readableState,e,"",!0)},l.prototype.setEncoding=function(e){s||(s=r(205).StringDecoder),this._readableState.decoder=new s(e),this._readableState.encoding=e};var p=8388608;function f(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>=p)e=p;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function d(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?process.nextTick(function(){g(e)}):g(e))}function g(e){e.emit("readable")}function m(e){var t,r=e._readableState;function n(e,n,i){!1===e.write(t)&&r.awaitDrain++}for(r.awaitDrain=0;r.pipesCount&&null!==(t=e.read());)if(1===r.pipesCount?n(r.pipes):E(r.pipes,n),e.emit("data",t),r.awaitDrain>0)return;if(0===r.pipesCount)return r.flowing=!1,void(o.listenerCount(e,"data")>0&&v(e));r.ranOut=!0}function y(){this._readableState.ranOut&&(this._readableState.ranOut=!1,m(this))}function v(e,t){if(e._readableState.flowing)throw new Error("Cannot switch to old mode now.");var r=t||!1,n=!1;e.readable=!0,e.pipe=a.prototype.pipe,e.on=e.addListener=a.prototype.on,e.on("readable",function(){var t;for(n=!0;!r&&null!==(t=e.read());)e.emit("data",t);null===t&&(n=!1,e._readableState.needReadable=!0)}),e.pause=function(){r=!0,this.emit("pause")},e.resume=function(){r=!1,n?process.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function b(e,t){var r,n=t.buffer,o=t.length,s=!!t.decoder,a=!!t.objectMode;if(0===n.length)return null;if(0===o)r=null;else if(a)r=n.shift();else if(!e||e>=o)r=s?n.join(""):i.concat(n,o),n.length=0;else{if(e<n[0].length)r=(h=n[0]).slice(0,e),n[0]=h.slice(e);else if(e===n[0].length)r=n.shift();else{r=s?"":new i(e);for(var c=0,u=0,l=n.length;u<l&&c<e;u++){var h=n[0],p=Math.min(e-c,h.length);s?r+=h.slice(0,p):h.copy(r,c,0,p),p<h.length?n[0]=h.slice(p):n.shift(),c+=p}}}return r}function _(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function E(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}l.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var r,n=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d(this),null;if(0===(e=f(e,t))&&t.ended)return r=null,t.length>0&&t.decoder&&(r=b(e,t),t.length-=r.length),0===t.length&&_(this),r;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=f(n,t)),null===(r=e>0?b(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&_(this),r},l.prototype._read=function(e){this.emit("error",new Error("not implemented"))},l.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1;var s=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?c:l;function a(e){e===r&&l()}function c(){e.end()}i.endEmitted?process.nextTick(s):r.once("end",s),e.on("unpipe",a);var u=function(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&m(e)}}(r);function l(){e.removeListener("close",p),e.removeListener("finish",f),e.removeListener("drain",u),e.removeListener("error",h),e.removeListener("unpipe",a),r.removeListener("end",c),r.removeListener("end",l),e._writableState&&!e._writableState.needDrain||u()}function h(t){d(),e.removeListener("error",h),0===o.listenerCount(e,"error")&&e.emit("error",t)}function p(){e.removeListener("finish",f),d()}function f(){e.removeListener("close",p),d()}function d(){r.unpipe(e)}return e.on("drain",u),e._events&&e._events.error?n(e._events.error)?e._events.error.unshift(h):e._events.error=[h,e._events.error]:e.on("error",h),e.once("close",p),e.once("finish",f),e.emit("pipe",r),i.flowing||(this.on("readable",y),i.flowing=!0,process.nextTick(function(){m(r)})),e},l.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",y),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",y),t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}return-1===(i=function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},l.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||v(this),"readable"===e&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&d(this):this.read(0))}return r},l.prototype.addListener=l.prototype.on,l.prototype.resume=function(){v(this),this.read(0),this.emit("resume")},l.prototype.pause=function(){v(this,!0),this.emit("pause")},l.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i)||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))}),e)"function"==typeof e[i]&&void 0===this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return E(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){r&&(r=!1,e.resume())},n},l._fromList=b},function(e,t,r){var n=r(35).Buffer,i=n.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};var o=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!i(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=a;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=c;break;default:return void(this.write=s)}this.charBuffer=new n(6),this.charReceived=0,this.charLength=0};function s(e){return e.toString(this.encoding)}function a(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function c(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}o.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},o.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},o.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t}},function(e,t,r){e.exports=c;var n=r(35).Buffer;c.WritableState=a;var i=r(25);i.inherits=r(19);var o=r(9);function s(e,t,r){this.chunk=e,this.encoding=t,this.callback=r}function a(e,t){var r=(e=e||{}).highWaterMark;this.highWaterMark=r||0===r?r:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=!1===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){r?process.nextTick(function(){i(n)}):i(n);e._writableState.errorEmitted=!0,e.emit("error",n)}(e,0,n,t,i);else{var o=h(e,r);o||r.bufferProcessing||!r.buffer.length||function(e,t){t.bufferProcessing=!0;for(var r=0;r<t.buffer.length;r++){var n=t.buffer[r],i=n.chunk,o=n.encoding,s=n.callback,a=t.objectMode?1:i.length;if(u(e,t,a,i,o,s),t.writing){r++;break}}t.bufferProcessing=!1,r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}(e,r),n?process.nextTick(function(){l(e,r,o,i)}):l(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function c(e){var t=r(136);if(!(this instanceof c||this instanceof t))return new c(e);this._writableState=new a(e,this),this.writable=!0,o.call(this)}function u(e,t,r,n,i,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,e._write(n,i,t.onwrite),t.sync=!1}function l(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),n(),r&&p(e,t)}function h(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function p(e,t){var r=h(0,t);return r&&(t.finished=!0,e.emit("finish")),r}i.inherits(c,o),c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},c.prototype.write=function(e,t,r){var i=this._writableState,o=!1;return"function"==typeof t&&(r=t,t=null),n.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=function(){}),i.ended?function(e,t,r){var n=new Error("write after end");e.emit("error",n),process.nextTick(function(){r(n)})}(this,0,r):function(e,t,r,i){var o=!0;if(!n.isBuffer(r)&&"string"!=typeof r&&null!=r&&!t.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),process.nextTick(function(){i(s)}),o=!1}return o}(this,i,e,r)&&(o=function(e,t,r,i,o){r=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new n(t,r)),t}(t,r,i),n.isBuffer(r)&&(i="buffer");var a=t.objectMode?1:r.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);t.writing?t.buffer.push(new s(r,i,o)):u(e,t,a,r,i,o);return c}(this,i,e,t,r)),o},c.prototype._write=function(e,t,r){r(new Error("not implemented"))},c.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.ending||n.finished||function(e,t,r){t.ending=!0,p(e,t),r&&(t.finished?process.nextTick(r):e.once("finish",r));t.ended=!0}(this,n,r)}},function(e,t,r){e.exports=s;var n=r(136),i=r(25);function o(e,t){this.afterTransform=function(e,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r);i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(t,e,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function s(e){if(!(this instanceof s))return new s(e);n.call(this,e);this._transformState=new o(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){a(t,e)}):a(t)})}function a(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=(e._readableState,e._transformState);if(r.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}i.inherits=r(19),i.inherits(s,n),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){throw new Error("not implemented")},s.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(e,t,r){"use strict";var n=r(115);e.exports=v;var i,o=r(329);v.ReadableState=y;r(12).EventEmitter;var s=function(e,t){return e.listeners(t).length},a=r(209),c=r(34).Buffer,u=global.Uint8Array||function(){};var l=r(25);l.inherits=r(19);var h=r(4),p=void 0;p=h&&h.debuglog?h.debuglog("stream"):function(){};var f,d=r(330),g=r(210);l.inherits(v,a);var m=["error","close","destroy","pause","resume"];function y(e,t){e=e||{};var n=t instanceof(i=i||r(60));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var o=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:n&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(f||(f=r(212).StringDecoder),this.decoder=new f(e.encoding),this.encoding=e.encoding)}function v(e){if(i=i||r(60),!(this instanceof v))return new v(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function b(e,t,r,n,i){var o,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,w(e)}(e,s)):(i||(o=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):_(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?_(e,s,t,!1):T(e,s)):_(e,s,t,!1))):n||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function _(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&w(e)),T(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),b(this,e,t,!1,r)},v.prototype.unshift=function(e){return b(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return f||(f=r(212).StringDecoder),this._readableState.decoder=new f(e),this._readableState.encoding=e,this};var E=8388608;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=E?e=E:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(S,e):S(e))}function S(e){p("emit readable"),e.emit("readable"),k(e)}function T(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(A,e,t))}function A(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(p("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function I(e){p("readable nexttick read 0"),e.read(0)}function N(e,t){t.reading||(p("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),k(e),t.flowing&&!t.reading&&e.read(0)}function k(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function R(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function O(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(x,t,e))}function x(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function B(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}v.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?O(this):w(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&O(this),null;var n,i=t.needReadable;return p("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&p("length less than watermark",i=!0),t.ended||t.reading?p("reading or ended",i=!1):i&&(p("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(r,t))),null===(n=e>0?R(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&O(this)),null!==n&&this.emit("data",n),n},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,p("pipe count=%d opts=%j",i.pipesCount,t);var a=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?u:v;function c(t,n){p("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,p("cleanup"),e.removeListener("close",m),e.removeListener("finish",y),e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",c),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",d),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){p("onend"),e.end()}i.endEmitted?n.nextTick(a):r.once("end",a),e.on("unpipe",c);var l=function(e){return function(){var t=e._readableState;p("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,k(e))}}(r);e.on("drain",l);var h=!1;var f=!1;function d(t){p("ondata"),f=!1,!1!==e.write(t)||f||((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==B(i.pipes,e))&&!h&&(p("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,f=!0),r.pause())}function g(t){p("onerror",t),v(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",y),v()}function y(){p("onfinish"),e.removeListener("close",m),v()}function v(){p("unpipe"),r.unpipe(e)}return r.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",m),e.once("finish",y),e.emit("pipe",r),i.flowing||(p("pipe resume"),r.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var s=B(t.pipes,e);return-1===s?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},v.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):n.nextTick(I,this))}return r},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(N,e,t))}(this,e)),this},v.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(p("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(p("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<m.length;o++)e.on(m[o],this.emit.bind(this,m[o]));return this._read=function(t){p("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=R},function(e,t,r){e.exports=r(9)},function(e,t,r){"use strict";var n=r(115);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(n.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,r){"use strict";var n=r(115);function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var o,s=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:n.nextTick;m.WritableState=g;var a=r(25);a.inherits=r(19);var c={deprecate:r(331)},u=r(209),l=r(34).Buffer,h=global.Uint8Array||function(){};var p,f=r(210);function d(){}function g(e,t){o=o||r(60),e=e||{};var a=t instanceof o;this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var c=e.highWaterMark,u=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=c||0===c?c:a&&(u||0===u)?u:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,o=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,o){--t.pendingcb,r?(n.nextTick(o,i),n.nextTick(C,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(o(i),e._writableState.errorEmitted=!0,e.emit("error",i),C(e,t))}(e,r,i,t,o);else{var a=_(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||b(e,r),i?s(v,e,r,a,o):v(e,r,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function m(e){if(o=o||r(60),!(p.call(m,this)||this instanceof o))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function y(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function v(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),C(e,t)}function b(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,o=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,c=!0;r;)o[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;o.allBuffers=c,y(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,h=r.callback;if(y(e,t,!1,t.objectMode?1:u.length,u,l,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function E(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),C(e,t)})}function C(e,t){var r=_(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,n.nextTick(E,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}a.inherits(m,u),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===m&&(e&&e._writableState instanceof g)}})):p=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,r){var i,o=this._writableState,s=!1,a=!o.objectMode&&(i=e,l.isBuffer(i)||i instanceof h);return a&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof r&&(r=d),o.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),n.nextTick(t,r)}(this,r):(a||function(e,t,r,i){var o=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),n.nextTick(i,s),o=!1),o}(this,o,e,r))&&(o.pendingcb++,s=function(e,t,r,n,i,o){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r));return t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,a,n,i,o);return c}(this,o,a,e,t,r)),s},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,r){t.ending=!0,C(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=f.destroy,m.prototype._undestroy=f.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}},function(e,t,r){"use strict";var n=r(34).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=p,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if((i=s(t[n]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if((i=s(t[n]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){"use strict";e.exports=s;var n=r(60),i=r(25);function o(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);n.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){c(e,t,r)}):c(this,null,null)}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=r(19),i.inherits(s,n),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(117),i=r(62),o=r(62),s="Firestore transactions require all reads to be executed before all writes.",a=!0;t.Transaction=class{constructor(e,t){this._firestore=e,this._validator=e._validator,this._previousTransaction=t,this._writeBatch=e.batch(),this._requestTag=t?t.requestTag:o.requestTag()}get(e){if(!this._writeBatch.isEmpty)throw new Error(s);if(e instanceof n.DocumentReference)return this._firestore.getAll_([e],null,this._requestTag,this._transactionId).then(e=>Promise.resolve(e[0]));if(e instanceof n.Query)return e._get(this._transactionId);throw new Error('Argument "refOrQuery" must be a DocumentRef or a Query.')}getAll(e,...t){if(!this._writeBatch.isEmpty)throw new Error(s);this._validator.minNumberOfArguments("Transaction.getAll",arguments,1);const{documents:r,fieldMask:n}=i.parseGetAllArguments(this._validator,[e,...t]);return this._firestore.getAll_(r,n,this._requestTag,this._transactionId)}create(e,t){return this._writeBatch.create(e,t),this}set(e,t,r){return this._writeBatch.set(e,t,r),this}update(e,t,...r){return this._validator.minNumberOfArguments("update",arguments,2),r=Array.prototype.slice.call(arguments,2),this._writeBatch.update.apply(this._writeBatch,[e,t].concat(r)),this}delete(e,t){return this._writeBatch.delete(e,t),this}begin(){const e={database:this._firestore.formattedName};return this._previousTransaction&&(e.options={readWrite:{retryTransaction:this._previousTransaction._transactionId}}),this._firestore.request("beginTransaction",e,this._requestTag,a).then(e=>{this._transactionId=e.transaction})}commit(){return this._writeBatch.commit_({transactionId:this._transactionId,requestTag:this._requestTag}).then(()=>{})}rollback(){const e={database:this._firestore.formattedName,transaction:this._transactionId};return this._firestore.request("rollback",e,this._requestTag,!1)}get requestTag(){return this._requestTag}}},function(e){e.exports={_from:"@google-cloud/firestore@^0.19.0",_id:"@google-cloud/firestore@0.19.0",_inBundle:!1,_integrity:"sha512-5WBS4UT3e0pogjiq7Ih/ezBQFqM/eEWQfB0oPiCYl2uzAcMfIvYjQlbxG7QI0fSB93TIA7fa+xCHvRHnIVnF+Q==",_location:"/@google-cloud/firestore",_phantomChildren:{"readable-stream":"2.3.6",xtend:"4.0.1"},_requested:{type:"range",registry:!0,raw:"@google-cloud/firestore@^0.19.0",name:"@google-cloud/firestore",escapedName:"@google-cloud%2ffirestore",scope:"@google-cloud",rawSpec:"^0.19.0",saveSpec:null,fetchSpec:"^0.19.0"},_requiredBy:["/firebase-admin"],_resolved:"https://registry.npmjs.org/@google-cloud/firestore/-/firestore-0.19.0.tgz",_shasum:"c16c426a2af33badfa0257245bc04730c7094fec",_spec:"@google-cloud/firestore@^0.19.0",_where:"D:\\Projects\\webhooks\\node_modules\\firebase-admin",author:{name:"Google Inc."},bugs:{url:"https://github.com/googleapis/nodejs-firestore/issues"},bundleDependencies:!1,dependencies:{"@google-cloud/projectify":"^0.3.0",bun:"^0.0.12","deep-equal":"^1.0.1",extend:"^3.0.1","functional-red-black-tree":"^1.0.1","google-gax":"^0.22.0",is:"^3.2.1","lodash.merge":"^4.6.1",protobufjs:"^6.8.6",through2:"^3.0.0"},deprecated:!1,description:"Firestore Client Library for Node.js",devDependencies:{"@google-cloud/nodejs-repo-tools":"^3.0.0","@types/assert":"^1.4.0","@types/chai":"^4.1.7","@types/chai-as-promised":"^7.1.0","@types/duplexify":"^3.5.0","@types/extend":"^3.0.0","@types/is":"0.0.21","@types/mocha":"^5.2.3","@types/node":"^10.3.5","@types/through2":"^2.0.34",chai:"^4.1.2","chai-as-promised":"^7.1.1",codecov:"^3.0.2",duplexify:"^3.6.0",gts:"^0.9.0","hard-rejection":"^1.0.0","ink-docstrap":"git+https://github.com/docstrap/docstrap.git","intelli-espower-loader":"^1.0.1",jsdoc:"^3.5.5",mocha:"^5.2.0",nyc:"^13.0.0",proxyquire:"^2.0.1","source-map-support":"^0.5.6","ts-node":"^7.0.0",typescript:"~3.1.1"},engines:{node:">=6.0.0"},files:["build/protos","build/src","!build/src/**/*.map","types"],homepage:"https://github.com/googleapis/nodejs-firestore#readme",keywords:["google apis client","google api client","google apis","google api","google","google cloud platform","google cloud","cloud","firestore"],license:"Apache-2.0",main:"./build/src/index.js",name:"@google-cloud/firestore",repository:{type:"git",url:"git+https://github.com/googleapis/nodejs-firestore.git"},scripts:{clean:"gts clean",codecov:"nyc report --reporter=json && codecov -f .coverage/*.json",compile:"tsc -p . && cp -r dev/protos build && cp -r dev/test/fake-certificate.json build/test/fake-certificate.json  && cp dev/src/v1beta1/firestore_client_config.json build/src/v1beta1/ && cp dev/conformance/test-definition.proto build/conformance && cp dev/conformance/test-suite.binproto build/conformance",conformance:"mocha build/conformance",docs:"jsdoc -c .jsdoc.js",fix:"gts fix","generate-scaffolding":"repo-tools generate all",lint:"gts check",posttest:"npm run lint",predocs:"npm run compile",prepare:"npm run compile","pretest-only":"npm run compile","samples-test":"npm link && cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 600000",test:"npm run test-only && npm run conformance","test-only":"nyc mocha build/test"},types:"./types/firestore.d.ts",version:"0.19.0"}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(217),o=r(8),s=r(229),a=r(252),c=r(254),u=r(7),l=r(144),h=r(154),p=r(253),f=r(127),d=u.normalize(a.getProtoPath(".."));[].push(d);const g=["api",u.join("iam","v1"),u.join("logging","type"),"longrunning","protobuf","rpc","type"].map(e=>u.join(d,"google",e)).map(e=>p.sync(e).filter(e=>".proto"===u.extname(e)).map(e=>u.normalize(e).substring(d.length+1))).reduce((e,t)=>e.concat(t),[]);t.ClientStub=class extends c.Client{};class m{constructor(e={}){this.auth=e.auth||new s.GoogleAuth(e),this.promise=e.promise||Promise,"grpc"in e?(this.grpc=e.grpc,this.grpcVersion=""):h.satisfies(process.version,"8.x")&&process.env.GOOGLE_CLOUD_USE_GRPC_JS?(this.grpc=r(456),this.grpcVersion=r(279).version):(this.grpc=r(254),this.grpcVersion=r(274).version),this.grpcProtoLoader=r(217)}_getCredentials(e){return n(this,void 0,void 0,function*(){if(e.sslCreds)return e.sslCreds;const t=this.grpc,r=t.credentials.createSsl(),n=yield this.auth.getClient();return t.credentials.combineChannelCredentials(r,t.credentials.createFromGoogleCredential(n))})}loadFromProto(e,t){const r=i.loadSync(e,t);return this.grpc.loadPackageDefinition(r)}loadProto(e,t){const r=m._resolveFile(e,t);return this.grpc.loadObject(l.loadSync(r,new y))}static _resolveFile(e,t){if(o.existsSync(u.join(e,t)))return u.join(e,t);if(g.indexOf(t)>-1)return u.join(d,t);throw new Error(t+" could not be found in "+e)}metadataBuilder(e){const t=new(0,this.grpc.Metadata);for(const r in e){const n=e[r];Array.isArray(n)?n.forEach(e=>t.add(r,e)):t.set(r,`${n}`)}return function(e,r){let n=!1,i=t;if(r)for(const e in r)if("x-goog-api-client"!==e.toLowerCase()&&r.hasOwnProperty(e)){n||(n=!0,i=i.clone());const t=r[e];Array.isArray(t)?t.forEach(t=>i.add(e,t)):i.set(e,`${t}`)}return i}}constructSettings(e,t,r,n){return f.constructSettings(e,t,r,this.grpc.status,{metadataBuilder:this.metadataBuilder(n)},this.promise)}createStub(e,t){const r=t.servicePath+":"+t.port;return this._getCredentials(t).then(n=>{const i={};return Object.keys(t).forEach(e=>{if(0===e.indexOf("grpc."))i[e]=t[e];else if(0===e.indexOf("grpc_gcp.")){const r="grpc_gcp.".length;i[e.substr(r)]=t[e]}}),new e(r,n,i)})}static createByteLengthFunction(e){return function(t){return e.encode(t).finish().length}}}t.GrpcClient=m;class y extends l.Root{constructor(...e){super(...e)}resolvePath(e,t){if(e=u.normalize(e),t=u.normalize(t),u.isAbsolute(t)){if(!o.existsSync(t))throw new Error("The include `"+t+"` was not found.");return t}return g.indexOf(t)>-1?u.join(d,t):y._findIncludePath(e,t)}static _findIncludePath(e,t){e=u.normalize(e),t=u.normalize(t);let r=e,n=o.existsSync(u.join(r,t));for(;!n&&r.length>0;)r=r.substring(0,r.lastIndexOf(u.sep)),n=o.existsSync(u.join(r,t));if(!n)throw new Error("The include `"+t+"` was not found.");return u.join(r,t)}}t.GoogleProtoFilesRoot=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
var n=r(144),i=r(8),o=r(7),s=r(16);function a(e,t){return function(r){return e.toObject(e.decode(r),t)}}function c(e){return function(t){var r=e.fromObject(t);return e.encode(r).finish()}}function u(e,t,r){return{path:"/"+t+"/"+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestSerialize:c(e.resolvedRequestType),requestDeserialize:a(e.resolvedRequestType,r),responseSerialize:c(e.resolvedResponseType),responseDeserialize:a(e.resolvedResponseType,r),originalName:s.camelCase(e.name)}}function l(e,t,r){for(var n={},i=0,o=e.methodsArray;i<o.length;i++){var s=o[i];n[s.name]=u(s,t,r)}return n}function h(e,t){for(var r={},n=0,i=function e(t,r){var n,i,o=(n=r,i=t.name,""===n?i:n+"."+i);return t.hasOwnProperty("methods")?[[o,t]]:t.nestedArray.map(function(t){return t.hasOwnProperty("nested")?e(t,o):[]}).reduce(function(e,t){return e.concat(t)},[])}(e,"");n<i.length;n++){var o=i[n],s=o[0],a=o[1];r[s]=l(a,s,t)}return r}function p(e,t){e.resolvePath=function(e,r){for(var n=0,s=t;n<s.length;n++){var a=s[n],c=o.join(a,r);try{return i.accessSync(c,i.constants.R_OK),c}catch(e){continue}}return null}}t.load=function(e,t){var r=new n.Root;if((t=t||{}).includeDirs){if(!(t.includeDirs instanceof Array))return Promise.reject(new Error("The includeDirs option must be an array"));p(r,t.includeDirs)}return r.load(e,t).then(function(e){return e.resolveAll(),h(r,t)})},t.loadSync=function(e,t){var r=new n.Root;if((t=t||{}).includeDirs){if(!(t.includeDirs instanceof Array))throw new Error("The include option must be an array");p(r,t.includeDirs)}return r.loadSync(e,t).resolveAll(),h(r,t)}},function(e,t,r){"use strict";e.exports=function(e,t){var r=new Array(arguments.length-1),n=0,i=2,o=!0;for(;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}})}},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,r){"use strict";t.Service=r(356)},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";e.exports=function(e){for(var t,r=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),a=e.fieldsArray.slice().sort(o.compareFieldsById),c=0;c<a.length;++c){var u=a[c].resolve(),l=e._fieldsArray.indexOf(u),h=u.resolvedType instanceof n?"int32":u.type,p=i.basic[h];t="m"+o.safeProp(u.name),u.map?(r("if(%s!=null&&m.hasOwnProperty(%j)){",t,u.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(u.id<<3|2)>>>0,8|i.mapKey[u.keyType],u.keyType),void 0===p?r("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",l,t):r(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|p,h,t),r("}")("}")):u.repeated?(r("if(%s!=null&&%s.length){",t,t),u.packed&&void 0!==i.packed[h]?r("w.uint32(%i).fork()",(u.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",h,t)("w.ldelim()"):(r("for(var i=0;i<%s.length;++i)",t),void 0===p?s(r,u,l,t+"[i]"):r("w.uint32(%i).%s(%s[i])",(u.id<<3|p)>>>0,h,t)),r("}")):(u.optional&&r("if(%s!=null&&m.hasOwnProperty(%j))",t,u.name),void 0===p?s(r,u,l,t):r("w.uint32(%i).%s(%s)",(u.id<<3|p)>>>0,h,t))}return r("return w")};var n=r(28),i=r(64),o=r(13);function s(e,t,r,n){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(t.id<<3|2)>>>0)}},function(e,t,r){"use strict";e.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter(function(e){return e.map}).length?",k":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break");t("switch(t>>>3){");for(var r=0;r<e.fieldsArray.length;++r){var a=e._fieldsArray[r].resolve(),c=a.resolvedType instanceof n?"int32":a.type,u="m"+o.safeProp(a.name);t("case %i:",a.id),a.map?(t("r.skip().pos++")("if(%s===util.emptyObject)",u)("%s={}",u)("k=r.%s()",a.keyType)("r.pos++"),void 0!==i.long[a.keyType]?void 0===i.basic[c]?t('%s[typeof k==="object"?util.longToHash(k):k]=types[%i].decode(r,r.uint32())',u,r):t('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()',u,c):void 0===i.basic[c]?t("%s[k]=types[%i].decode(r,r.uint32())",u,r):t("%s[k]=r.%s()",u,c)):a.repeated?(t("if(!(%s&&%s.length))",u,u)("%s=[]",u),void 0!==i.packed[c]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",u,c)("}else"),void 0===i.basic[c]?t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",u,r):t("%s.push(r.%s())",u,c)):void 0===i.basic[c]?t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",u,r):t("%s=r.%s()",u,c),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<e._fieldsArray.length;++r){var l=e._fieldsArray[r];l.required&&t("if(!m.hasOwnProperty(%j))",l.name)("throw util.ProtocolError(%j,{instance:m})",s(l))}return t("return m")};var n=r(28),i=r(64),o=r(13);function s(e){return"missing required '"+e.name+"'"}},function(e,t,r){"use strict";e.exports=function(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=e.oneofsArray,n={};r.length&&t("var p={}");for(var c=0;c<e.fieldsArray.length;++c){var u=e._fieldsArray[c].resolve(),l="m"+i.safeProp(u.name);if(u.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",l,u.name),u.map)t("if(!util.isObject(%s))",l)("return%j",o(u,"object"))("var k=Object.keys(%s)",l)("for(var i=0;i<k.length;++i){"),a(t,u,"k[i]"),s(t,u,c,l+"[k[i]]")("}");else if(u.repeated)t("if(!Array.isArray(%s))",l)("return%j",o(u,"array"))("for(var i=0;i<%s.length;++i){",l),s(t,u,c,l+"[i]")("}");else{if(u.partOf){var h=i.safeProp(u.partOf.name);1===n[u.partOf.name]&&t("if(p%s===1)",h)("return%j",u.partOf.name+": multiple values"),n[u.partOf.name]=1,t("p%s=1",h)}s(t,u,c,l)}u.optional&&t("}")}return t("return null")};var n=r(28),i=r(13);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function s(e,t,r,i){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(%s){",i)("default:")("return%j",o(t,"enum value"));for(var s=Object.keys(t.resolvedType.values),a=0;a<s.length;++a)e("case %i:",t.resolvedType.values[s[a]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",r,i)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",o(t,"buffer"))}return e}function a(e,t,r){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",r)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",r)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",r)("return%j",o(t,"boolean key"))}return e}},function(e,t,r){"use strict";var n=t,i=r(28),o=r(13);function s(e,t,r,n){if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(d%s){",n);for(var o=t.resolvedType.values,s=Object.keys(o),a=0;a<s.length;++a)t.repeated&&o[s[a]]===t.typeDefault&&e("default:"),e("case%j:",s[a])("case %i:",o[s[a]])("m%s=%j",n,o[s[a]])("break");e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,c)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n)}}return e}function a(e,t,r,n){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",n,r,n,n):e("d%s=types[%i].toObject(m%s,o)",n,r,n);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,o?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n)}}return e}n.fromObject=function(e){var t=e.fieldsArray,r=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var n=0;n<t.length;++n){var a=t[n].resolve(),c=o.safeProp(a.name);a.map?(r("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),s(r,a,n,c+"[ks[i]]")("}")("}")):a.repeated?(r("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),s(r,a,n,c+"[i]")("}")("}")):(a.resolvedType instanceof i||r("if(d%s!=null){",c),s(r,a,n,c),a.resolvedType instanceof i||r("}"))}return r("return m")},n.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var r=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],s=[],c=[],u=0;u<t.length;++u)t[u].partOf||(t[u].resolve().repeated?n:t[u].map?s:c).push(t[u]);if(n.length){for(r("if(o.arrays||o.defaults){"),u=0;u<n.length;++u)r("d%s=[]",o.safeProp(n[u].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),u=0;u<s.length;++u)r("d%s={}",o.safeProp(s[u].name));r("}")}if(c.length){for(r("if(o.defaults){"),u=0;u<c.length;++u){var l=c[u],h=o.safeProp(l.name);if(l.resolvedType instanceof i)r("d%s=o.enums===String?%j:%j",h,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",h)("}else")("d%s=o.longs===String?%j:%i",h,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var p="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",h,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",h,p)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",h,h)("}")}else r("d%s=%j",h,l.typeDefault)}r("}")}var f=!1;for(u=0;u<t.length;++u){l=t[u];var d=e._fieldsArray.indexOf(l);h=o.safeProp(l.name);l.map?(f||(f=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",h,h)("d%s={}",h)("for(var j=0;j<ks2.length;++j){"),a(r,l,d,h+"[ks2[j]]")("}")):l.repeated?(r("if(m%s&&m%s.length){",h,h)("d%s=[]",h)("for(var j=0;j<m%s.length;++j){",h),a(r,l,d,h+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",h,l.name),a(r,l,d,h),l.partOf&&r("if(o.oneofs)")("d%s=%j",o.safeProp(l.partOf.name),l.name)),r("}")}return r("return d")}},function(e,t,r){"use strict";var n=t,i=r(151);n[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=this.lookup(e["@type"]);if(t){var r="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return this.create({type_url:"/"+r,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){if(t&&t.json&&e.type_url&&e.value){var r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=this.lookup(r);n&&(e=n.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var o=e.$type.toObject(e,t);return o["@type"]=e.$type.fullName,o}return this.toObject(e,t)}}},function(e,t,r){"use strict";e.exports=f;var n=/[\s{}=;:[\],'"()<>]/g,i=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,o=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,s=/^ *[*\/]+ */,a=/^\s*\*?\/*/,c=/\n/g,u=/\s/,l=/\\(.?)/g,h={0:"\0",r:"\r",n:"\n",t:"\t"};function p(e){return e.replace(l,function(e,t){switch(t){case"\\":case"":return t;default:return h[t]||""}})}function f(e,t){e=e.toString();var r=0,l=e.length,h=1,f=null,d=null,g=0,m=!1,y=[],v=null;function b(e){return Error("illegal "+e+" (line "+h+")")}function _(t){return e.charAt(t)}function E(r,n){f=e.charAt(r++),g=h,m=!1;var i,o=r-(t?2:3);do{if(--o<0||"\n"===(i=e.charAt(o))){m=!0;break}}while(" "===i||"\t"===i);for(var u=e.substring(r,n).split(c),l=0;l<u.length;++l)u[l]=u[l].replace(t?a:s,"").trim();d=u.join("\n").trim()}function C(t){var r=w(t),n=e.substring(t,r);return/^\s*\/{1,2}/.test(n)}function w(e){for(var t=e;t<l&&"\n"!==_(t);)t++;return t}function S(){if(y.length>0)return y.shift();if(v)return function(){var t="'"===v?o:i;t.lastIndex=r-1;var n=t.exec(e);if(!n)throw b("string");return r=t.lastIndex,T(v),v=null,p(n[1])}();var s,a,c,f,d;do{if(r===l)return null;for(s=!1;u.test(c=_(r));)if("\n"===c&&++h,++r===l)return null;if("/"===_(r)){if(++r===l)throw b("comment");if("/"===_(r))if(t){if(f=r,d=!1,C(r)){d=!0;do{if((r=w(r))===l)break;r++}while(C(r))}else r=Math.min(l,w(r)+1);d&&E(f,r),h++,s=!0}else{for(d="/"===_(f=r+1);"\n"!==_(++r);)if(r===l)return null;++r,d&&E(f,r-1),++h,s=!0}else{if("*"!==(c=_(r)))return"/";f=r+1,d=t||"*"===_(f);do{if("\n"===c&&++h,++r===l)throw b("comment");a=c,c=_(r)}while("*"!==a||"/"!==c);++r,d&&E(f,r-2),s=!0}}}while(s);var g=r;if(n.lastIndex=0,!n.test(_(g++)))for(;g<l&&!n.test(_(g));)++g;var m=e.substring(r,r=g);return'"'!==m&&"'"!==m||(v=m),m}function T(e){y.push(e)}function A(){if(!y.length){var e=S();if(null===e)return null;T(e)}return y[0]}return Object.defineProperty({next:S,peek:A,push:T,skip:function(e,t){var r=A();if(r===e)return S(),!0;if(!t)throw b("token '"+r+"', '"+e+"' expected");return!1},cmnt:function(e){var r=null;return void 0===e?g===h-1&&(t||"*"===f||m)&&(r=d):(g<e&&A(),g!==e||m||!t&&"/"!==f||(r=d)),r}},"line",{get:function(){return h}})}f.unescape=p},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(362);t.GoogleAuth=n.GoogleAuth;var i=r(232);t.Compute=i.Compute;var o=r(402);t.IAMAuth=o.IAMAuth;var s=r(250);t.JWTAccess=s.JWTAccess;var a=r(234);t.JWT=a.JWT;var c=r(120);t.CodeChallengeMethod=c.CodeChallengeMethod,t.OAuth2Client=c.OAuth2Client;var u=r(251);t.UserRefreshClient=u.UserRefreshClient;var l=r(155);t.DefaultTransporter=l.DefaultTransporter;const h=new n.GoogleAuth;t.auth=h},function(e,t){e.exports=require("child_process")},function(e,t,r){"use strict";e.exports=function(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){var r;function s(){if(s.enabled){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var o=s,a=Number(new Date),c=a-(r||a);o.diff=c,o.prev=r,o.curr=a,r=a,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,r){if("%%"===e)return e;u++;var i=n.formatters[r];if("function"==typeof i){var s=t[u];e=i.call(o,s),t.splice(u,1),u--}return e}),n.formatArgs.call(o,t),(o.log||n.log).apply(o,t)}}return s.namespace=e,s.enabled=n.enabled(e),s.useColors=n.useColors(),s.color=t(e),s.destroy=i,s.extend=o,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function i(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function o(e,t){return n(this.namespace+(void 0===t?":":t)+e)}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var o=n.instances[t];o.enabled=n.enabled(o.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=r(195),Object.keys(e).forEach(function(t){n[t]=e[t]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(153),o=r(68),s=r(120);t.Compute=class extends s.OAuth2Client{constructor(e={}){super(e),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=e.serviceAccountEmail||"default"}createScopedRequired(){return o.warn(o.COMPUTE_CREATE_SCOPED_DEPRECATED),!1}refreshTokenNoCache(e){return n(this,void 0,void 0,function*(){const e=`service-accounts/${this.serviceAccountEmail}/token`;let t;try{t=yield i.instance(e)}catch(e){throw e.message="Could not refresh access token.",e}const r=t.data;return t.data&&t.data.expires_in&&(r.expiry_date=(new Date).getTime()+1e3*t.data.expires_in,delete r.expires_in),this.emit("tokens",r),{tokens:r,res:t}})}requestAsync(e,t=!1){return super.requestAsync(e,t).catch(e=>{const r=e.response;if(r&&r.status){let n=null;403===r.status?n="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified.":404===r.status&&(n="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified."),n&&(e&&e.message&&!t&&(n+=" "+e.message),e?e.message=n:(e=new Error(n)).code=r.status.toString())}throw e})}}},function(e,t){e.exports=require("querystring")},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(380),o=r(68),s=r(250),a=r(120),c=r(196);class u extends a.OAuth2Client{constructor(e,t,r,n,i,o){const s=e&&"object"==typeof e?e:{email:e,keyFile:t,key:r,keyId:o,scopes:n,subject:i};super({eagerRefreshThresholdMillis:s.eagerRefreshThresholdMillis}),this.email=s.email,this.keyFile=s.keyFile,this.key=s.key,this.keyId=s.keyId,this.scopes=s.scopes,this.subject=s.subject,this.additionalClaims=s.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(e){return new u({email:this.email,keyFile:this.keyFile,key:this.key,keyId:this.keyId,scopes:e,subject:this.subject,additionalClaims:this.additionalClaims})}getRequestMetadataAsync(e){const t=e=>super[e];return n(this,void 0,void 0,function*(){if(this.apiKey||this.hasScopes()||!e)return t("getRequestMetadataAsync").call(this,e);if(this.additionalClaims&&this.additionalClaims.target_audience){const{tokens:e}=yield this.refreshToken();return{headers:{Authorization:`Bearer ${e.id_token}`}}}return this.access||(this.access=new s.JWTAccess(this.email,this.key,this.keyId)),{headers:yield this.access.getRequestHeaders(e,this.additionalClaims)}})}createScopedRequired(){return o.warn(o.JWT_CREATE_SCOPED_DEPRECATED),!this.hasScopes()}hasScopes(){return!!this.scopes&&(this.scopes instanceof Array?this.scopes.length>0:String(this.scopes).length>0)}authorize(e){if(!e)return this.authorizeAsync();this.authorizeAsync().then(t=>e(null,t),e)}authorizeAsync(){return n(this,void 0,void 0,function*(){const e=yield this.refreshToken();if(!e)throw new Error("No result returned");return this.credentials=e.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,e.tokens})}refreshTokenNoCache(e){return n(this,void 0,void 0,function*(){const e=this.createGToken(),t={access_token:yield e.getToken(),token_type:"Bearer",expiry_date:e.expiresAt,id_token:e.rawToken.id_token};return this.emit("tokens",t),{res:null,tokens:t}})}createGToken(){return this.gtoken||(this.gtoken=new i.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims})),this.gtoken}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(e=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{if(!e)throw new Error("Must pass in a stream containing the service account auth settings.");let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{const e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}fromAPIKey(e){if(!c(e))throw new Error("Must provide an API Key string.");this.apiKey=e}getCredentials(){return n(this,void 0,void 0,function*(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){const e=this.createGToken(),t=yield e.getCredentials(this.keyFile);return{private_key:t.privateKey,client_email:t.clientEmail}}throw new Error("A key or a keyFile must be provided to getCredentials.")})}}t.JWT=u},function(e,t,r){var n=r(3);r(6),n.cipher=n.cipher||{};var i=e.exports=n.cipher.modes=n.cipher.modes||{};function o(e){if("string"==typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var t=e;e=n.util.createBuffer();for(var r=0;r<t.length;++r)e.putByte(t[r])}return n.util.isArray(e)||(e=[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]),e}function s(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*i)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=a(8*t.length());var o=t.length()%this.blockSize;for(o&&t.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(0===o||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],c=(n-1-s%n)*t;a[s/n|0]=1<<t-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,e),t)}return o},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],c=i[s];i[o+s]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var u=i[o^n];i[o]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i}},function(e,t,r){var n=r(3);r(37),r(102),r(158),r(69),r(237),r(22),r(103),r(6);var i=function(e,t,r,i){var o=n.util.createBuffer(),s=e.length>>1,a=s+(1&e.length),c=e.substr(0,a),u=e.substr(s,a),l=n.util.createBuffer(),h=n.hmac.create();r=t+r;var p=Math.ceil(i/16),f=Math.ceil(i/20);h.start("MD5",c);var d=n.util.createBuffer();l.putBytes(r);for(var g=0;g<p;++g)h.start(null,null),h.update(l.getBytes()),l.putBuffer(h.digest()),h.start(null,null),h.update(l.bytes()+r),d.putBuffer(h.digest());h.start("SHA1",u);var m=n.util.createBuffer();l.clear(),l.putBytes(r);for(g=0;g<f;++g)h.start(null,null),h.update(l.getBytes()),l.putBuffer(h.digest()),h.start(null,null),h.update(l.bytes()+r),m.putBuffer(h.digest());return o.putBytes(n.util.xorBytes(d.getBytes(),m.getBytes(),i)),o},o=function(e,t,r){var i=!1;try{var o=e.deflate(t.fragment.getBytes());t.fragment=n.util.createBuffer(o),t.length=o.length,i=!0}catch(e){}return i},s=function(e,t,r){var i=!1;try{var o=e.inflate(t.fragment.getBytes());t.fragment=n.util.createBuffer(o),t.length=o.length,i=!0}catch(e){}return i},a=function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32()}return n.util.createBuffer(e.getBytes(r))},c=function(e,t,r){e.putInt(r.length(),t<<3),e.putBuffer(r)},u={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}}};u.SupportedVersions=[u.Versions.TLS_1_1,u.Versions.TLS_1_0],u.Version=u.SupportedVersions[0],u.MaxFragment=15360,u.ConnectionEnd={server:0,client:1},u.PRFAlgorithm={tls_prf_sha256:0},u.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},u.CipherType={stream:0,block:1,aead:2},u.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},u.CompressionMethod={none:0,deflate:1},u.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},u.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},u.Alert={},u.Alert.Level={warning:1,fatal:2},u.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},u.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},u.CipherSuites={},u.getCipherSuite=function(e){var t=null;for(var r in u.CipherSuites){var n=u.CipherSuites[r];if(n.id[0]===e.charCodeAt(0)&&n.id[1]===e.charCodeAt(1)){t=n;break}}return t},u.handleUnexpected=function(e,t){!e.open&&e.entity===u.ConnectionEnd.client||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})},u.handleHelloRequest=function(e,t,r){!e.handshaking&&e.handshakes>0&&(u.queue(e,u.createAlert(e,{level:u.Alert.Level.warning,description:u.Alert.Description.no_renegotiation})),u.flush(e)),e.process()},u.parseHelloMessage=function(e,t,r){var i=null,o=e.entity===u.ConnectionEnd.client;if(r<38)e.error(e,{message:o?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});else{var s=t.fragment,c=s.length();if(i={version:{major:s.getByte(),minor:s.getByte()},random:n.util.createBuffer(s.getBytes(32)),session_id:a(s,1),extensions:[]},o?(i.cipher_suite=s.getBytes(2),i.compression_method=s.getByte()):(i.cipher_suites=a(s,2),i.compression_methods=a(s,1)),(c=r-(c-s.length()))>0){for(var l=a(s,2);l.length()>0;)i.extensions.push({type:[l.getByte(),l.getByte()],data:a(l,2)});if(!o)for(var h=0;h<i.extensions.length;++h){var p=i.extensions[h];if(0===p.type[0]&&0===p.type[1])for(var f=a(p.data,2);f.length()>0;){if(0!==f.getByte())break;e.session.extensions.server_name.serverNameList.push(a(f,2).getBytes())}}}if(e.session.version&&(i.version.major!==e.session.version.major||i.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});if(o)e.session.cipherSuite=u.getCipherSuite(i.cipher_suite);else for(var d=n.util.createBuffer(i.cipher_suites.bytes());d.length()>0&&(e.session.cipherSuite=u.getCipherSuite(d.getBytes(2)),null===e.session.cipherSuite););if(null===e.session.cipherSuite)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure},cipherSuite:n.util.bytesToHex(i.cipher_suite)});e.session.compressionMethod=o?i.compression_method:u.CompressionMethod.none}return i},u.createSecurityParameters=function(e,t){var r=e.entity===u.ConnectionEnd.client,n=t.random.bytes(),i=r?e.session.sp.client_random:n,o=r?n:u.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:u.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:o}},u.handleServerHello=function(e,t,r){var n=u.parseHelloMessage(e,t,r);if(!e.fail){if(!(n.version.minor<=e.version.minor))return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});e.version.minor=n.version.minor,e.session.version=e.version;var i=n.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=d,e.session.resuming=!0,e.session.sp.server_random=n.random.bytes()):(e.expect=l,e.session.resuming=!1,u.createSecurityParameters(e,n)),e.session.id=i,e.process()}},u.handleClientHello=function(e,t,r){var i=u.parseHelloMessage(e,t,r);if(!e.fail){var o=i.session_id.bytes(),s=null;if(e.sessionCache&&(null===(s=e.sessionCache.getSession(o))?o="":(s.version.major!==i.version.major||s.version.minor>i.version.minor)&&(s=null,o="")),0===o.length&&(o=n.random.getBytes(32)),e.session.id=o,e.session.clientHelloVersion=i.version,e.session.sp={},s)e.version=e.session.version=s.version,e.session.sp=s.sp;else{for(var a,c=1;c<u.SupportedVersions.length&&!((a=u.SupportedVersions[c]).minor<=i.version.minor);++c);e.version={major:a.major,minor:a.minor},e.session.version=e.version}null!==s?(e.expect=E,e.session.resuming=!0,e.session.sp.client_random=i.random.bytes()):(e.expect=!1!==e.verifyClient?v:b,e.session.resuming=!1,u.createSecurityParameters(e,i)),e.open=!0,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHello(e)})),e.session.resuming?(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))):(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)})),e.fail||(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerKeyExchange(e)})),!1!==e.verifyClient&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateRequest(e)})),u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHelloDone(e)})))),u.flush(e),e.process()}},u.handleCertificate=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var i,o,s=t.fragment,c={certificate_list:a(s,3)},l=[];try{for(;c.certificate_list.length()>0;)i=a(c.certificate_list,3),o=n.asn1.fromDer(i),i=n.pki.certificateFromAsn1(o,!0),l.push(i)}catch(t){return e.error(e,{message:"Could not parse certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var p=e.entity===u.ConnectionEnd.client;!p&&!0!==e.verifyClient||0!==l.length?0===l.length?e.expect=p?h:b:(p?e.session.serverCertificate=l[0]:e.session.clientCertificate=l[0],u.verifyCertificateChain(e,l)&&(e.expect=p?h:b)):e.error(e,{message:p?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}}),e.process()},u.handleServerKeyExchange=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});e.expect=p,e.process()},u.handleClientKeyExchange=function(e,t,r){if(r<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});var i=t.fragment,o={enc_pre_master_secret:a(i,2).getBytes()},s=null;if(e.getPrivateKey)try{s=e.getPrivateKey(e,e.session.serverCertificate),s=n.pki.privateKeyFromPem(s)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}if(null===s)return e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}});try{var c=e.session.sp;c.pre_master_secret=s.decrypt(o.enc_pre_master_secret);var l=e.session.clientHelloVersion;if(l.major!==c.pre_master_secret.charCodeAt(0)||l.minor!==c.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(e){c.pre_master_secret=n.random.getBytes(48)}e.expect=E,null!==e.session.clientCertificate&&(e.expect=_),e.process()},u.handleCertificateRequest=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_types:a(n,1),certificate_authorities:a(n,2)};e.session.certificateRequest=i,e.expect=f,e.process()},u.handleCertificateVerify=function(e,t,r){if(r<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var i=t.fragment;i.read-=4;var o=i.bytes();i.read+=4;var s={signature:a(i,2).getBytes()},c=n.util.createBuffer();c.putBuffer(e.session.md5.digest()),c.putBuffer(e.session.sha1.digest()),c=c.getBytes();try{if(!e.session.clientCertificate.publicKey.verify(c,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(o),e.session.sha1.update(o)}catch(t){return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure}})}e.expect=E,e.process()},u.handleServerHelloDone=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.record_overflow}});if(null===e.serverCertificate){var i={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.insufficient_security}},o=e.verify(e,i.alert.description,0,[]);if(!0!==o)return(o||0===o)&&("object"!=typeof o||n.util.isArray(o)?"number"==typeof o&&(i.alert.description=o):(o.message&&(i.message=o.message),o.alert&&(i.alert.description=o.alert))),e.error(e,i)}null!==e.session.certificateRequest&&(t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)}),u.queue(e,t)),t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createClientKeyExchange(e)}),u.queue(e,t),e.expect=y;var s=function(e,t){null!==e.session.certificateRequest&&null!==e.session.clientCertificate&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateVerify(e,t)})),u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)})),e.expect=d,u.flush(e),e.process()};if(null===e.session.certificateRequest||null===e.session.clientCertificate)return s(e,null);u.getClientSignature(e,s)},u.handleChangeCipherSpec=function(e,t){if(1!==t.fragment.getByte())return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var r=e.entity===u.ConnectionEnd.client;(e.session.resuming&&r||!e.session.resuming&&!r)&&(e.state.pending=u.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&r||e.session.resuming&&!r)&&(e.state.pending=null),e.expect=r?g:C,e.process()},u.handleFinished=function(e,t,r){var o=t.fragment;o.read-=4;var s=o.bytes();o.read+=4;var a=t.fragment.getBytes();(o=n.util.createBuffer()).putBuffer(e.session.md5.digest()),o.putBuffer(e.session.sha1.digest());var c=e.entity===u.ConnectionEnd.client,l=c?"server finished":"client finished",h=e.session.sp;if((o=i(h.master_secret,l,o.getBytes(),12)).getBytes()!==a)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decrypt_error}});e.session.md5.update(s),e.session.sha1.update(s),(e.session.resuming&&c||!e.session.resuming&&!c)&&(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))),e.expect=c?m:w,e.handshaking=!1,++e.handshakes,e.peerCertificate=c?e.session.serverCertificate:e.session.clientCertificate,u.flush(e),e.isConnected=!0,e.connected(e),e.process()},u.handleAlert=function(e,t){var r,n=t.fragment,i={level:n.getByte(),description:n.getByte()};switch(i.description){case u.Alert.Description.close_notify:r="Connection closed.";break;case u.Alert.Description.unexpected_message:r="Unexpected message.";break;case u.Alert.Description.bad_record_mac:r="Bad record MAC.";break;case u.Alert.Description.decryption_failed:r="Decryption failed.";break;case u.Alert.Description.record_overflow:r="Record overflow.";break;case u.Alert.Description.decompression_failure:r="Decompression failed.";break;case u.Alert.Description.handshake_failure:r="Handshake failure.";break;case u.Alert.Description.bad_certificate:r="Bad certificate.";break;case u.Alert.Description.unsupported_certificate:r="Unsupported certificate.";break;case u.Alert.Description.certificate_revoked:r="Certificate revoked.";break;case u.Alert.Description.certificate_expired:r="Certificate expired.";break;case u.Alert.Description.certificate_unknown:r="Certificate unknown.";break;case u.Alert.Description.illegal_parameter:r="Illegal parameter.";break;case u.Alert.Description.unknown_ca:r="Unknown certificate authority.";break;case u.Alert.Description.access_denied:r="Access denied.";break;case u.Alert.Description.decode_error:r="Decode error.";break;case u.Alert.Description.decrypt_error:r="Decrypt error.";break;case u.Alert.Description.export_restriction:r="Export restriction.";break;case u.Alert.Description.protocol_version:r="Unsupported protocol version.";break;case u.Alert.Description.insufficient_security:r="Insufficient security.";break;case u.Alert.Description.internal_error:r="Internal error.";break;case u.Alert.Description.user_canceled:r="User canceled.";break;case u.Alert.Description.no_renegotiation:r="Renegotiation not supported.";break;default:r="Unknown error."}if(i.description===u.Alert.Description.close_notify)return e.close();e.error(e,{message:r,send:!1,origin:e.entity===u.ConnectionEnd.client?"server":"client",alert:i}),e.process()},u.handleHandshake=function(e,t){var r=t.fragment,i=r.getByte(),o=r.getInt24();if(o>r.length())return e.fragmented=t,t.fragment=n.util.createBuffer(),r.read-=4,e.process();e.fragmented=null,r.read-=4;var s=r.bytes(o+4);r.read+=4,i in U[e.entity][e.expect]?(e.entity!==u.ConnectionEnd.server||e.open||e.fail||(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:n.md.md5.create(),sha1:n.md.sha1.create()}),i!==u.HandshakeType.hello_request&&i!==u.HandshakeType.certificate_verify&&i!==u.HandshakeType.finished&&(e.session.md5.update(s),e.session.sha1.update(s)),U[e.entity][e.expect][i](e,t,o)):u.handleUnexpected(e,t)},u.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()},u.handleHeartbeat=function(e,t){var r=t.fragment,i=r.getByte(),o=r.getInt16(),s=r.getBytes(o);if(i===u.HeartbeatMessageType.heartbeat_request){if(e.handshaking||o>s.length)return e.process();u.queue(e,u.createRecord(e,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_response,s)})),u.flush(e)}else if(i===u.HeartbeatMessageType.heartbeat_response){if(s!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,n.util.createBuffer(s))}e.process()};var l=1,h=2,p=3,f=4,d=5,g=6,m=7,y=8,v=1,b=2,_=3,E=4,C=5,w=6,S=u.handleUnexpected,T=u.handleChangeCipherSpec,A=u.handleAlert,I=u.handleHandshake,N=u.handleApplicationData,k=u.handleHeartbeat,R=[];R[u.ConnectionEnd.client]=[[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[T,A,S,S,k],[S,A,I,S,k],[S,A,I,N,k],[S,A,I,S,k]],R[u.ConnectionEnd.server]=[[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[S,A,I,S,k],[T,A,S,S,k],[S,A,I,S,k],[S,A,I,N,k],[S,A,I,S,k]];var O=u.handleHelloRequest,x=u.handleServerHello,B=u.handleCertificate,D=u.handleServerKeyExchange,P=u.handleCertificateRequest,L=u.handleServerHelloDone,j=u.handleFinished,U=[];U[u.ConnectionEnd.client]=[[S,S,x,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,B,D,P,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,D,P,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,P,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,L,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,j],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[O,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]];var M=u.handleClientHello,F=u.handleClientKeyExchange,V=u.handleCertificateVerify;U[u.ConnectionEnd.server]=[[S,M,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,B,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,F,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,V,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,j],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]],u.generateKeys=function(e,t){var r=i,n=t.client_random+t.server_random;e.session.resuming||(t.master_secret=r(t.pre_master_secret,"master secret",n,48).bytes(),t.pre_master_secret=null),n=t.server_random+t.client_random;var o=2*t.mac_key_length+2*t.enc_key_length,s=e.version.major===u.Versions.TLS_1_0.major&&e.version.minor===u.Versions.TLS_1_0.minor;s&&(o+=2*t.fixed_iv_length);var a=r(t.master_secret,"key expansion",n,o),c={client_write_MAC_key:a.getBytes(t.mac_key_length),server_write_MAC_key:a.getBytes(t.mac_key_length),client_write_key:a.getBytes(t.enc_key_length),server_write_key:a.getBytes(t.enc_key_length)};return s&&(c.client_write_IV=a.getBytes(t.fixed_iv_length),c.server_write_IV=a.getBytes(t.fixed_iv_length)),c},u.createConnectionState=function(e){var t=e.entity===u.ConnectionEnd.client,r=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return!0},compressionState:null,compressFunction:function(e){return!0},updateSequenceNumber:function(){4294967295===e.sequenceNumber[1]?(e.sequenceNumber[1]=0,++e.sequenceNumber[0]):++e.sequenceNumber[1]}};return e},n={read:r(),write:r()};if(n.read.update=function(e,t){return n.read.cipherFunction(t,n.read)?n.read.compressFunction(e,t,n.read)||e.error(e,{message:"Could not decompress record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decompression_failure}}):e.error(e,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_record_mac}}),!e.fail},n.write.update=function(e,t){return n.write.compressFunction(e,t,n.write)?n.write.cipherFunction(t,n.write)||e.error(e,{message:"Could not encrypt record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):e.error(e,{message:"Could not compress record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}),!e.fail},e.session){var i=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(i),i.keys=u.generateKeys(e,i),n.read.macKey=t?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,n.write.macKey=t?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(n,e,i),i.compression_algorithm){case u.CompressionMethod.none:break;case u.CompressionMethod.deflate:n.read.compressFunction=s,n.write.compressFunction=o;break;default:throw new Error("Unsupported compression algorithm.")}}return n},u.createRandom=function(){var e=new Date,t=+e+6e4*e.getTimezoneOffset(),r=n.util.createBuffer();return r.putInt32(t),r.putBytes(n.random.getBytes(28)),r},u.createRecord=function(e,t){return t.data?{type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data}:null},u.createAlert=function(e,t){var r=n.util.createBuffer();return r.putByte(t.level),r.putByte(t.description),u.createRecord(e,{type:u.ContentType.alert,data:r})},u.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=n.util.createBuffer(),r=0;r<e.cipherSuites.length;++r){var i=e.cipherSuites[r];t.putByte(i.id[0]),t.putByte(i.id[1])}var o=t.length(),s=n.util.createBuffer();s.putByte(u.CompressionMethod.none);var a=s.length(),l=n.util.createBuffer();if(e.virtualHost){var h=n.util.createBuffer();h.putByte(0),h.putByte(0);var p=n.util.createBuffer();p.putByte(0),c(p,2,n.util.createBuffer(e.virtualHost));var f=n.util.createBuffer();c(f,2,p),c(h,2,f),l.putBuffer(h)}var d=l.length();d>0&&(d+=2);var g=e.session.id,m=g.length+1+2+4+28+2+o+1+a+d,y=n.util.createBuffer();return y.putByte(u.HandshakeType.client_hello),y.putInt24(m),y.putByte(e.version.major),y.putByte(e.version.minor),y.putBytes(e.session.sp.client_random),c(y,1,n.util.createBuffer(g)),c(y,2,t),c(y,1,s),d>0&&c(y,2,l),y},u.createServerHello=function(e){var t=e.session.id,r=t.length+1+2+4+28+2+1,i=n.util.createBuffer();return i.putByte(u.HandshakeType.server_hello),i.putInt24(r),i.putByte(e.version.major),i.putByte(e.version.minor),i.putBytes(e.session.sp.server_random),c(i,1,n.util.createBuffer(t)),i.putByte(e.session.cipherSuite.id[0]),i.putByte(e.session.cipherSuite.id[1]),i.putByte(e.session.compressionMethod),i},u.createCertificate=function(e){var t,r=e.entity===u.ConnectionEnd.client,i=null;e.getCertificate&&(t=r?e.session.certificateRequest:e.session.extensions.server_name.serverNameList,i=e.getCertificate(e,t));var o=n.util.createBuffer();if(null!==i)try{n.util.isArray(i)||(i=[i]);for(var s=null,a=0;a<i.length;++a){var l=n.pem.decode(i[a])[0];if("CERTIFICATE"!==l.type&&"X509 CERTIFICATE"!==l.type&&"TRUSTED CERTIFICATE"!==l.type){var h=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw h.headerType=l.type,h}if(l.procType&&"ENCRYPTED"===l.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var p=n.util.createBuffer(l.body);null===s&&(s=n.asn1.fromDer(p.bytes(),!1));var f=n.util.createBuffer();c(f,3,p),o.putBuffer(f)}i=n.pki.certificateFromAsn1(s),r?e.session.clientCertificate=i:e.session.serverCertificate=i}catch(t){return e.error(e,{message:"Could not send certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var d=3+o.length(),g=n.util.createBuffer();return g.putByte(u.HandshakeType.certificate),g.putInt24(d),c(g,3,o),g},u.createClientKeyExchange=function(e){var t=n.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(n.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var i=(t=e.session.serverCertificate.publicKey.encrypt(r.pre_master_secret)).length+2,o=n.util.createBuffer();return o.putByte(u.HandshakeType.client_key_exchange),o.putInt24(i),o.putInt16(t.length),o.putBytes(t),o},u.createServerKeyExchange=function(e){var t=n.util.createBuffer();return t},u.getClientSignature=function(e,t){var r=n.util.createBuffer();r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest()),r=r.getBytes(),e.getSignature=e.getSignature||function(e,t,r){var i=null;if(e.getPrivateKey)try{i=e.getPrivateKey(e,e.session.clientCertificate),i=n.pki.privateKeyFromPem(i)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}null===i?e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):t=i.sign(t,null),r(e,t)},e.getSignature(e,r,t)},u.createCertificateVerify=function(e,t){var r=t.length+2,i=n.util.createBuffer();return i.putByte(u.HandshakeType.certificate_verify),i.putInt24(r),i.putInt16(t.length),i.putBytes(t),i},u.createCertificateRequest=function(e){var t=n.util.createBuffer();t.putByte(1);var r=n.util.createBuffer();for(var i in e.caStore.certs){var o=e.caStore.certs[i],s=n.pki.distinguishedNameToAsn1(o.subject),a=n.asn1.toDer(s);r.putInt16(a.length()),r.putBuffer(a)}var l=1+t.length()+2+r.length(),h=n.util.createBuffer();return h.putByte(u.HandshakeType.certificate_request),h.putInt24(l),c(h,1,t),c(h,2,r),h},u.createServerHelloDone=function(e){var t=n.util.createBuffer();return t.putByte(u.HandshakeType.server_hello_done),t.putInt24(0),t},u.createChangeCipherSpec=function(){var e=n.util.createBuffer();return e.putByte(1),e},u.createFinished=function(e){var t=n.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var r=e.entity===u.ConnectionEnd.client,o=e.session.sp,s=r?"client finished":"server finished";t=i(o.master_secret,s,t.getBytes(),12);var a=n.util.createBuffer();return a.putByte(u.HandshakeType.finished),a.putInt24(t.length()),a.putBuffer(t),a},u.createHeartbeat=function(e,t,r){void 0===r&&(r=t.length);var i=n.util.createBuffer();i.putByte(e),i.putInt16(r),i.putBytes(t);var o=i.length(),s=Math.max(16,o-r-3);return i.putBytes(n.random.getBytes(s)),i},u.queue=function(e,t){if(t&&(0!==t.fragment.length()||t.type!==u.ContentType.handshake&&t.type!==u.ContentType.alert&&t.type!==u.ContentType.change_cipher_spec)){if(t.type===u.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r),e.session.sha1.update(r),r=null}var i;if(t.fragment.length()<=u.MaxFragment)i=[t];else{i=[];for(var o=t.fragment.bytes();o.length>u.MaxFragment;)i.push(u.createRecord(e,{type:t.type,data:n.util.createBuffer(o.slice(0,u.MaxFragment))})),o=o.slice(u.MaxFragment);o.length>0&&i.push(u.createRecord(e,{type:t.type,data:n.util.createBuffer(o)}))}for(var s=0;s<i.length&&!e.fail;++s){var a=i[s];e.state.current.write.update(e,a)&&e.records.push(a)}}},u.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type),e.tlsData.putByte(r.version.major),e.tlsData.putByte(r.version.minor),e.tlsData.putInt16(r.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var q=function(e){switch(e){case!0:return!0;case n.pki.certificateError.bad_certificate:return u.Alert.Description.bad_certificate;case n.pki.certificateError.unsupported_certificate:return u.Alert.Description.unsupported_certificate;case n.pki.certificateError.certificate_revoked:return u.Alert.Description.certificate_revoked;case n.pki.certificateError.certificate_expired:return u.Alert.Description.certificate_expired;case n.pki.certificateError.certificate_unknown:return u.Alert.Description.certificate_unknown;case n.pki.certificateError.unknown_ca:return u.Alert.Description.unknown_ca;default:return u.Alert.Description.bad_certificate}};for(var K in u.verifyCertificateChain=function(e,t){try{n.pki.verifyCertificateChain(e.caStore,t,function(t,r,i){q(t);var o=e.verify(e,t,r,i);if(!0!==o){if("object"==typeof o&&!n.util.isArray(o)){var s=new Error("The application rejected the certificate.");throw s.send=!0,s.alert={level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate},o.message&&(s.message=o.message),o.alert&&(s.alert.description=o.alert),s}o!==t&&(o=function(e){switch(e){case!0:return!0;case u.Alert.Description.bad_certificate:return n.pki.certificateError.bad_certificate;case u.Alert.Description.unsupported_certificate:return n.pki.certificateError.unsupported_certificate;case u.Alert.Description.certificate_revoked:return n.pki.certificateError.certificate_revoked;case u.Alert.Description.certificate_expired:return n.pki.certificateError.certificate_expired;case u.Alert.Description.certificate_unknown:return n.pki.certificateError.certificate_unknown;case u.Alert.Description.unknown_ca:return n.pki.certificateError.unknown_ca;default:return n.pki.certificateError.bad_certificate}}(o))}return o})}catch(t){var r=t;("object"!=typeof r||n.util.isArray(r))&&(r={send:!0,alert:{level:u.Alert.Level.fatal,description:q(t)}}),"send"in r||(r.send=!0),"alert"in r||(r.alert={level:u.Alert.Level.fatal,description:q(r.error)}),e.error(e,r)}return!e.fail},u.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order)r=e;else{for(var i in(r={}).cache=e||{},r.capacity=Math.max(t||100,1),r.order=[],e)r.order.length<=t?r.order.push(i):delete e[i];r.getSession=function(e){var t=null,i=null;if(e?i=n.util.bytesToHex(e):r.order.length>0&&(i=r.order[0]),null!==i&&i in r.cache)for(var o in t=r.cache[i],delete r.cache[i],r.order)if(r.order[o]===i){r.order.splice(o,1);break}return t},r.setSession=function(e,t){if(r.order.length===r.capacity){var i=r.order.shift();delete r.cache[i]}i=n.util.bytesToHex(e);r.order.push(i),r.cache[i]=t}}return r},u.createConnection=function(e){var t=null;t=e.caStore?n.util.isArray(e.caStore)?n.pki.createCaStore(e.caStore):e.caStore:n.pki.createCaStore();var r=e.cipherSuites||null;if(null===r)for(var i in r=[],u.CipherSuites)r.push(u.CipherSuites[i]);var o=e.server?u.ConnectionEnd.server:u.ConnectionEnd.client,s=e.sessionCache?u.createSessionCache(e.sessionCache):null,a={version:{major:u.Version.major,minor:u.Version.minor},entity:o,sessionId:e.sessionId,caStore:t,sessionCache:s,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(e,t,r,n){return t},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:n.util.createBuffer(),tlsData:n.util.createBuffer(),data:n.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(t,r){r.origin=r.origin||(t.entity===u.ConnectionEnd.client?"client":"server"),r.send&&(u.queue(t,u.createAlert(t,r.alert)),u.flush(t));var n=!1!==r.fatal;n&&(t.fail=!0),e.error(t,r),n&&t.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null,reset:function(e){a.version={major:u.Version.major,minor:u.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=(a.entity,u.ConnectionEnd.client,0),a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(e||void 0===e),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=u.createConnectionState(a)}};a.reset();return a.handshake=function(e){if(a.entity!==u.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&0===a.handshakes&&(a.fail=!1),a.handshaking=!0;var t=null;(e=e||"").length>0&&(a.sessionCache&&(t=a.sessionCache.getSession(e)),null===t&&(e="")),0===e.length&&a.sessionCache&&null!==(t=a.sessionCache.getSession())&&(e=t.id),a.session={id:e,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:n.md.md5.create(),sha1:n.md.sha1.create()},t&&(a.version=t.version,a.session.sp=t.sp),a.session.sp.client_random=u.createRandom().getBytes(),a.open=!0,u.queue(a,u.createRecord(a,{type:u.ContentType.handshake,data:u.createClientHello(a)})),u.flush(a)}},a.process=function(e){var t=0;return e&&a.input.putBytes(e),a.fail||(null!==a.record&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),null===a.record&&(t=function(e){var t=0,r=e.input,i=r.length();if(i<5)t=5-i;else{e.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:n.util.createBuffer(),ready:!1};var o=e.record.version.major===e.version.major;o&&e.session&&e.session.version&&(o=e.record.version.minor===e.version.minor),o||e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}})}return t}(a)),a.fail||null===a.record||a.record.ready||(t=function(e){var t=0,r=e.input,n=r.length();n<e.record.length?t=e.record.length-n:(e.record.fragment.putBytes(r.getBytes(e.record.length)),r.compact(),e.state.current.read.update(e,e.record)&&(null!==e.fragmented&&(e.fragmented.type===e.record.type?(e.fragmented.fragment.putBuffer(e.record.fragment),e.record=e.fragmented):e.error(e,{message:"Invalid fragmented record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})),e.record.ready=!0));return t}(a)),!a.fail&&null!==a.record&&a.record.ready&&function(e,t){var r=t.type-u.ContentType.change_cipher_spec,n=R[e.entity][e.expect];r in n?n[r](e,t):u.handleUnexpected(e,t)}(a,a.record)),t},a.prepare=function(e){return u.queue(a,u.createRecord(a,{type:u.ContentType.application_data,data:n.util.createBuffer(e)})),u.flush(a)},a.prepareHeartbeatRequest=function(e,t){return e instanceof n.util.ByteBuffer&&(e=e.bytes()),void 0===t&&(t=e.length),a.expectedHeartbeatPayload=e,u.queue(a,u.createRecord(a,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_request,e,t)})),u.flush(a)},a.close=function(e){if(!a.fail&&a.sessionCache&&a.session){var t={id:a.session.id,version:a.session.version,sp:a.session.sp};t.sp.keys=null,a.sessionCache.setSession(t.id,t)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,u.queue(a,u.createAlert(a,{level:u.Alert.Level.warning,description:u.Alert.Description.close_notify})),u.flush(a)),a.closed(a)),a.reset(e)},a},e.exports=n.tls=n.tls||{},u)"function"!=typeof u[K]&&(n.tls[K]=u[K]);n.tls.prf_tls1=i,n.tls.hmac_sha1=function(e,t,r){var i=n.hmac.create();i.start("SHA1",e);var o=n.util.createBuffer();return o.putInt32(t[0]),o.putInt32(t[1]),o.putByte(r.type),o.putByte(r.version.major),o.putByte(r.version.minor),o.putInt16(r.length),o.putBytes(r.fragment.bytes()),i.update(o.getBytes()),i.digest().getBytes()},n.tls.createSessionCache=u.createSessionCache,n.tls.createConnection=u.createConnection},function(e,t,r){var n=r(3);r(37),r(57),r(238),r(69),r(159),r(244),r(161),r(122),r(6),r(160);var i=n.asn1,o=e.exports=n.pki=n.pki||{};o.pemToDer=function(e){var t=n.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(t.body)},o.privateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.privateKeyFromAsn1(s)},o.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:i.toDer(o.privateKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:i.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})}},function(e,t,r){var n=r(3);if(r(56),r(37),r(121),r(38),r(57),r(159),r(69),r(22),r(241),r(122),r(6),void 0===i)var i=n.jsbn.BigInteger;var o=n.asn1,s=n.pki=n.pki||{};e.exports=s.pbe=n.pbe=n.pbe||{};var a=s.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},u={name:"PBES2Algorithms",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function p(e){var t;if(e){if(!(t=s.oids[o.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return f(t)}function f(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!(t&&e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}s.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i,c,u,l=n.random.getBytesSync(r.saltSize),h=r.count,p=o.integerToDer(h);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var d,g,m;switch(r.algorithm){case"aes128":i=16,d=16,g=a["aes128-CBC"],m=n.aes.createEncryptionCipher;break;case"aes192":i=24,d=16,g=a["aes192-CBC"],m=n.aes.createEncryptionCipher;break;case"aes256":i=32,d=16,g=a["aes256-CBC"],m=n.aes.createEncryptionCipher;break;case"des":i=8,d=8,g=a.desCBC,m=n.des.createEncryptionCipher;break;default:throw(C=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,C}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),v=f(y),b=n.pkcs5.pbkdf2(t,l,h,i,v),_=n.random.getBytesSync(d);(w=m(b)).start(_),w.update(o.toDer(e)),w.finish(),u=w.output.getBytes();var E=function(e,t,r,i){var a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==i&&a.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids[i]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]));return a}(l,p,i,y);c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBES2).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBKDF2).getBytes()),E]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(g).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,_)])])])}else{var C;if("3des"!==r.algorithm)throw(C=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,C;i=24;var w,S=new n.util.ByteBuffer(l);b=s.pbe.generatePkcs12Key(t,S,1,h,i),_=s.pbe.generatePkcs12Key(t,S,2,h,i);(w=n.des.createEncryptionCipher(b)).start(_),w.update(o.toDer(e)),w.finish(),u=w.output.getBytes(),c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,l),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,p.getBytes())])])}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[c,o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,u)])},s.decryptPrivateKeyInfo=function(e,t){var r=null,i={},a=[];if(!o.validate(e,c,i,a)){var u=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw u.errors=a,u}var l=o.derToOid(i.encryptionOid),h=s.pbe.getCipher(l,i.encryptionParams,t),p=n.util.createBuffer(i.encryptedData);return h.update(p),h.finish()&&(r=o.fromDer(h.output)),r},s.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:o.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},s.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return o.fromDer(t.body)},s.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var i=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));return i=s.encryptPrivateKeyInfo(i,t,r),s.encryptedPrivateKeyToPem(i)}var a,c,u,l;switch(r.algorithm){case"aes128":a="AES-128-CBC",u=16,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",u=24,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",u=32,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",u=24,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;case"des":a="DES-CBC",u=8,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw h.algorithm=r.algorithm,h}var p=l(n.pbe.opensslDeriveBytes(t,c.substr(0,8),u));p.start(c),p.update(o.toDer(s.privateKeyToAsn1(e))),p.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:n.util.bytesToHex(c).toUpperCase()},body:p.output.getBytes()};return n.pem.encode(f)},s.decryptRsaPrivateKey=function(e,t){var r=null,i=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type)throw(u=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=u,u;if(i.procType&&"ENCRYPTED"===i.procType.type){var a,c;switch(i.dekInfo.algorithm){case"DES-CBC":a=8,c=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,c=n.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,c=n.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,c=n.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,c=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,c=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":a=8,c=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":a=16,c=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var u;throw(u=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".')).algorithm=i.dekInfo.algorithm,u}var l=n.util.hexToBytes(i.dekInfo.parameters),h=c(n.pbe.opensslDeriveBytes(t,l.substr(0,8),a));if(h.start(l),h.update(n.util.createBuffer(i.body)),!h.finish())return r;r=h.output.getBytes()}else r=i.body;return null!==(r="ENCRYPTED PRIVATE KEY"===i.type?s.decryptPrivateKeyInfo(o.fromDer(r),t):o.fromDer(r))&&(r=s.privateKeyFromAsn1(r)),r},s.pbe.generatePkcs12Key=function(e,t,r,i,o,s){var a,c;if(null==s){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');s=n.md.sha1.create()}var u=s.digestLength,l=s.blockLength,h=new n.util.ByteBuffer,p=new n.util.ByteBuffer;if(null!=e){for(c=0;c<e.length;c++)p.putInt16(e.charCodeAt(c));p.putInt16(0)}var f=p.length(),d=t.length(),g=new n.util.ByteBuffer;g.fillWithByte(r,l);var m=l*Math.ceil(d/l),y=new n.util.ByteBuffer;for(c=0;c<m;c++)y.putByte(t.at(c%d));var v=l*Math.ceil(f/l),b=new n.util.ByteBuffer;for(c=0;c<v;c++)b.putByte(p.at(c%f));var _=y;_.putBuffer(b);for(var E=Math.ceil(o/u),C=1;C<=E;C++){var w=new n.util.ByteBuffer;w.putBytes(g.bytes()),w.putBytes(_.bytes());for(var S=0;S<i;S++)s.start(),s.update(w.getBytes()),w=s.digest();var T=new n.util.ByteBuffer;for(c=0;c<l;c++)T.putByte(w.at(c%u));var A=Math.ceil(d/l)+Math.ceil(f/l),I=new n.util.ByteBuffer;for(a=0;a<A;a++){var N=new n.util.ByteBuffer(_.getBytes(l)),k=511;for(c=T.length()-1;c>=0;c--)k>>=8,k+=T.at(c)+N.at(c),N.setAt(c,255&k);I.putBuffer(N)}_=I,h.putBuffer(w)}return h.truncate(h.length()-o),h},s.pbe.getCipher=function(e,t,r){switch(e){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(e,t,r);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},s.pbe.getCipherForPBES2=function(e,t,r){var i,a={},c=[];if(!o.validate(t,u,a,c))throw(i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=c,i;if((e=o.derToOid(a.kdfOid))!==s.oids.pkcs5PBKDF2)throw(i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,i.supportedOids=["pkcs5PBKDF2"],i;if((e=o.derToOid(a.encOid))!==s.oids["aes128-CBC"]&&e!==s.oids["aes192-CBC"]&&e!==s.oids["aes256-CBC"]&&e!==s.oids["des-EDE3-CBC"]&&e!==s.oids.desCBC)throw(i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i;var l,h,f=a.kdfSalt,d=n.util.createBuffer(a.kdfIterationCount);switch(d=d.getInt(d.length()<<3),s.oids[e]){case"aes128-CBC":l=16,h=n.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,h=n.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,h=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,h=n.des.createDecryptionCipher;break;case"desCBC":l=8,h=n.des.createDecryptionCipher}var g=p(a.prfOid),m=n.pkcs5.pbkdf2(r,f,d,l,g),y=a.encIv,v=h(m);return v.start(y),v},s.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={},a=[];if(!o.validate(t,l,i,a))throw(g=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=a,g;var c,u,h,f=n.util.createBuffer(i.salt),d=n.util.createBuffer(i.iterations);switch(d=d.getInt(d.length()<<3),e){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,h=n.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,h=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var g;throw(g=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,g}var m=p(i.prfOid),y=s.pbe.generatePkcs12Key(r,f,1,d,c,m);return m.start(),h(y,s.pbe.generatePkcs12Key(r,f,2,d,u,m))},s.pbe.opensslDeriveBytes=function(e,t,r,i){if(null==i){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');i=n.md.md5.create()}null===t&&(t="");for(var o=[h(i,e+t)],s=16,a=1;s<r;++a,s+=16)o.push(h(i,o[a-1]+e+t));return o.join("").substr(0,r)}},function(e,t,r){var n=r(3);r(38),r(6);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){s||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var a=o.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=a[1],a[1]=a[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(o),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var a,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(a=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(l>>>0),l=a>>>0;s.putInt32(l);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(p,r,s);var f=n.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f.putInt32(p.h5),f.putInt32(p.h6),f.putInt32(p.h7),f},i};var o=null,s=!1,a=null;function c(e,t,r){for(var n,i,o,s,c,u,l,h,p,f,d,g,m,y=r.length();y>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=((n=t[c-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=((i=t[c-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,l=e.h1,h=e.h2,p=e.h3,f=e.h4,d=e.h5,g=e.h6,m=e.h7,c=0;c<64;++c)o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),s=u&l|h&(u^l),n=m+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(g^f&(d^g))+a[c]+t[c],m=g,g=d,d=f,f=p+n>>>0,p=h,h=l,l=u,u=n+(i=o+s)>>>0;e.h0=e.h0+u|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+p|0,e.h4=e.h4+f|0,e.h5=e.h5+d|0,e.h6=e.h6+g|0,e.h7=e.h7+m|0,y-=64}}},function(e,t,r){var n=r(3);r(6);var i=null;!n.util.isNodejs||n.options.usePureJavaScript||process.versions["node-webkit"]||(i=r(33)),(e.exports=n.prng=n.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,o=new Array(32),s=0;s<32;++s)o[s]=r.create();function a(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r==0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function u(e){var t=null;if("undefined"!=typeof window){var r=window.crypto||window.msCrypto;r&&r.getRandomValues&&(t=function(e){return r.getRandomValues(e)})}var i=n.util.createBuffer();if(t)for(;i.length()<e;){var o=Math.max(1,Math.min(e-i.length(),65536)/4),s=new Uint32Array(Math.floor(o));try{t(s);for(var a=0;a<s.length;++a)i.putInt32(s[a])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(i.length()<e)for(var c,u,l,h=Math.floor(65536*Math.random());i.length()<e;){u=16807*(65535&h),u+=(32767&(c=16807*(h>>16)))<<16,h=4294967295&(u=(2147483647&(u+=c>>15))+(u>>31));for(a=0;a<3;++a)l=h>>>(a<<3),l^=Math.floor(256*Math.random()),i.putByte(String.fromCharCode(255&l))}return i.getBytes(e)}return t.pools=o,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var i=t.plugin.cipher,o=t.plugin.increment,s=t.plugin.formatKey,a=t.plugin.formatSeed,u=n.util.createBuffer();t.key=null,function l(h){if(h)return r(h);if(u.length()>=e)return r(null,u.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return n.util.nextTick(function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,function(r,n){if(r)return e(r);t.collect(n),c(),e()})}(l)});var p=i(t.key,t.seed);t.generated+=p.length;u.putBytes(p);t.key=s(i(t.key,o(t.seed)));t.seed=a(i(t.key,t.seed));n.util.setImmediate(l)}()},t.generateSync=function(e){var r=t.plugin.cipher,i=t.plugin.increment,o=t.plugin.formatKey,s=t.plugin.formatSeed;t.key=null;for(var c=n.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&a();var u=r(t.key,t.seed);t.generated+=u.length,c.putBytes(u),t.key=o(r(t.key,i(t.seed))),t.seed=s(r(t.key,t.seed))}return c.getBytes(e)},i?(t.seedFile=function(e,t){i.randomBytes(e,function(e,r){if(e)return t(e);t(null,r.toString())})},t.seedFileSync=function(e){return i.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,u(e))}catch(e){t(e)}},t.seedFileSync=u),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))}),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})})})}},t}},function(e,t,r){var n=r(3);r(6);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],o=[1,2,3,5];e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"==typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,o=e,s=e.length(),a=t,c=Math.ceil(a/8),u=255>>(7&a);for(r=s;r<128;r++)o.putByte(i[o.at(r-1)+o.at(r-s)&255]);for(o.setAt(128-c,i[o.at(128-c)&u]),r=127-c;r>=0;r--)o.setAt(r,i[o.at(r+1)^o.at(r+c)]);return o};var s=function(e,t,r){var i,s,a,c,u=!1,l=null,h=null,p=null,f=[];for(e=n.rc2.expandKey(e,t),a=0;a<64;a++)f.push(e.getInt16Le());r?(i=function(e){for(a=0;a<4;a++)e[a]+=f[c]+(e[(a+3)%4]&e[(a+2)%4])+(~e[(a+3)%4]&e[(a+1)%4]),e[a]=(t=e[a])<<(r=o[a])&65535|(65535&t)>>16-r,c++;var t,r},s=function(e){for(a=0;a<4;a++)e[a]+=f[63&e[(a+3)%4]]}):(i=function(e){for(a=3;a>=0;a--)e[a]=(65535&(t=e[a]))>>(r=o[a])|t<<16-r&65535,e[a]-=f[c]+(e[(a+3)%4]&e[(a+2)%4])+(~e[(a+3)%4]&e[(a+1)%4]),c--;var t,r},s=function(e){for(a=3;a>=0;a--)e[a]-=f[63&e[(a+3)%4]]});var d=function(e){var t=[];for(a=0;a<4;a++){var n=l.getInt16Le();null!==p&&(r?n^=p.getInt16Le():p.putInt16Le(n)),t.push(65535&n)}c=r?0:63;for(var i=0;i<e.length;i++)for(var o=0;o<e[i][0];o++)e[i][1](t);for(a=0;a<4;a++)null!==p&&(r?p.putInt16Le(t[a]):t[a]^=p.getInt16Le()),h.putInt16Le(t[a])},g=null;return g={start:function(e,t){e&&"string"==typeof e&&(e=n.util.createBuffer(e)),u=!1,l=n.util.createBuffer(),h=t||new n.util.createBuffer,p=e,g.output=h},update:function(e){for(u||l.putBuffer(e);l.length()>=8;)d([[5,i],[1,s],[6,i],[1,s],[5,i]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,l,!r);else{var n=8===l.length()?8:8-l.length();l.fillWithByte(n,n)}if(t&&(u=!0,g.update()),!r&&(t=0===l.length()))if(e)t=e(8,h,!r);else{var i=h.length(),o=h.at(i-1);o>i?t=!1:h.truncate(o)}return t}}};n.rc2.startEncrypting=function(e,t,r){var i=n.rc2.createEncryptionCipher(e,128);return i.start(t,r),i},n.rc2.createEncryptionCipher=function(e,t){return s(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var i=n.rc2.createDecryptionCipher(e,128);return i.start(t,r),i},n.rc2.createDecryptionCipher=function(e,t){return s(e,t,!1)}},function(e,t,r){var n=r(3);r(6),r(22),r(103);var i=e.exports=n.pkcs1=n.pkcs1||{};function o(e,t,r){r||(r=n.md.sha1.create());for(var i="",o=Math.ceil(t/r.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);r.start(),r.update(e+a),i+=r.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,r){var i,s,a,c;"string"==typeof r?(i=r,s=arguments[3]||void 0,a=arguments[4]||void 0):r&&(i=r.label||void 0,s=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),a?a.start():a=n.md.sha1.create(),c||(c=a);var u=Math.ceil(e.n.bitLength()/8),l=u-2*a.digestLength-2;if(t.length>l)throw(m=new Error("RSAES-OAEP input message length is too long.")).length=t.length,m.maxLength=l,m;i||(i=""),a.update(i,"raw");for(var h=a.digest(),p="",f=l-t.length,d=0;d<f;d++)p+="\0";var g=h.getBytes()+p+""+t;if(s){if(s.length!==a.digestLength){var m;throw(m=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=s.length,m.digestLength=a.digestLength,m}}else s=n.random.getBytes(a.digestLength);var y=o(s,u-a.digestLength-1,c),v=n.util.xorBytes(g,y,g.length),b=o(v,a.digestLength,c);return"\0"+n.util.xorBytes(s,b,s.length)+v},i.decode_rsa_oaep=function(e,t,r){var i,s,a;"string"==typeof r?(i=r,s=arguments[3]||void 0):r&&(i=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(y=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,y.expectedLength=c,y;if(void 0===s?s=n.md.sha1.create():s.start(),a||(a=s),c<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),s.update(i,"raw");for(var u=s.digest().getBytes(),l=t.charAt(0),h=t.substring(1,s.digestLength+1),p=t.substring(1+s.digestLength),f=o(p,s.digestLength,a),d=o(n.util.xorBytes(h,f,h.length),c-s.digestLength-1,a),g=n.util.xorBytes(p,d,p.length),m=g.substring(0,s.digestLength),y="\0"!==l,v=0;v<s.digestLength;++v)y|=u.charAt(v)!==m.charAt(v);for(var b=1,_=s.digestLength,E=s.digestLength;E<g.length;E++){var C=g.charCodeAt(E);y|=C&(b?65534:0),_+=b&=1&C^1}if(y||1!==g.charCodeAt(_))throw new Error("Invalid RSAES-OAEP padding.");return g.substring(_+1)}},function(e,t,r){var n=r(3);r(6),r(123),r(22),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],o=new r(null);o.fromInt(30);var s=function(e,t){return e|t};t.generateProbablePrime=function(e,t,i){"function"==typeof t&&(i=t,t={});var o=(t=t||{}).algorithm||"PRIMEINC";"string"==typeof o&&(o={name:o}),o.options=o.options||{};var s=t.prng||n.random,u={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===o.name)return function(e,t,i,o){if("workers"in i)return function(e,t,i,o){if("undefined"==typeof Worker)return a(e,t,i,o);var s=c(e,t),u=i.workers,l=i.workLoad||100,h=30*l/8,p=i.workerScript||"forge/prime.worker.js";if(-1===u)return n.util.estimateCores(function(e,t){e&&(t=2),u=t-1,f()});function f(){u=Math.max(1,u);for(var n=[],i=0;i<u;++i)n[i]=new Worker(p);for(var i=0;i<u;++i)n[i].addEventListener("message",f);var a=!1;function f(i){if(!a){0;var u=i.data;if(u.found){for(var p=0;p<n.length;++p)n[p].terminate();return a=!0,o(null,new r(u.prime,16))}s.bitLength()>e&&(s=c(e,t));var f=s.toString(16);i.target.postMessage({hex:f,workLoad:l}),s.dAddOffset(h,0)}}}f()}(e,t,i,o);return a(e,t,i,o)}(e,u,o.options,i);throw new Error("Invalid prime generation algorithm: "+o.name)}}function a(e,t,r,o){var s=c(e,t),a=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(s.bitLength());"millerRabinTests"in r&&(a=r.millerRabinTests);var u=10;"maxBlockTime"in r&&(u=r.maxBlockTime),function e(t,r,o,s,a,u,l){var h=+new Date;do{if(t.bitLength()>r&&(t=c(r,o)),t.isProbablePrime(a))return l(null,t);t.dAddOffset(i[s++%8],0)}while(u<0||+new Date-h<u);n.util.setImmediate(function(){e(t,r,o,s,a,u,l)})}(s,e,t,0,a,u,o)}function c(e,t){var n=new r(e,t),i=e-1;return n.testBit(i)||n.bitwiseTo(r.ONE.shiftLeft(i),s,n),n.dAddOffset(31-n.mod(o).byteValue(),0),n}}()},function(e,t,r){var n=r(3);r(37),r(102),r(57),r(245),r(238),r(22),r(122),r(103),r(6),r(160);var i=n.asn1,o=n.pki,s=e.exports=n.pkcs12=n.pkcs12||{},a={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},a,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},u={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},l={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function p(e,t,r,n){for(var i=[],o=0;o<e.length;o++)for(var s=0;s<e[o].safeBags.length;s++){var a=e[o].safeBags[s];void 0!==n&&a.type!==n||(null!==t?void 0!==a.attributes[t]&&a.attributes[t].indexOf(r)>=0&&i.push(a):i.push(a))}return i}function f(e){if(e.composed||e.constructed){for(var t=n.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function d(e,t){var r={},s=[];if(!i.validate(e,n.pkcs7.asn1.encryptedDataValidator,r,s))throw(a=new Error("Cannot read EncryptedContentInfo.")).errors=s,a;var a,c=i.derToOid(r.contentType);if(c!==o.oids.data)throw(a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=c,a;c=i.derToOid(r.encAlgorithm);var u=o.pbe.getCipher(c,r.encParameter,t),l=f(r.encryptedContentAsn1),h=n.util.createBuffer(l.value);if(u.update(h),!u.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return u.output.getBytes()}function g(e,t,r){if(!t&&0===e.length)return[];if((e=i.fromDer(e,t)).tagClass!==i.Class.UNIVERSAL||e.type!==i.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],s=0;s<e.value.length;s++){var a=e.value[s],c={},l=[];if(!i.validate(a,u,c,l))throw(y=new Error("Cannot read SafeBag.")).errors=l,y;var p,f,d={type:i.derToOid(c.bagId),attributes:m(c.bagAttributes)};n.push(d);var g=c.bagValue.value[0];switch(d.type){case o.oids.pkcs8ShroudedKeyBag:if(null===(g=o.decryptPrivateKeyInfo(g,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case o.oids.keyBag:try{d.key=o.privateKeyFromAsn1(g)}catch(e){d.key=null,d.asn1=g}continue;case o.oids.certBag:p=h,f=function(){if(i.derToOid(c.certId)!==o.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=i.derToOid(c.certId),e}var r=i.fromDer(c.cert,t);try{d.cert=o.certificateFromAsn1(r,!0)}catch(e){d.cert=null,d.asn1=r}};break;default:var y;throw(y=new Error("Unsupported PKCS#12 SafeBag type.")).oid=d.type,y}if(void 0!==p&&!i.validate(g,p,c,l))throw(y=new Error("Cannot read PKCS#12 "+p.name)).errors=l,y;f()}return n}function m(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},s=[];if(!i.validate(e[r],l,n,s)){var a=new Error("Cannot read PKCS#12 BagAttribute.");throw a.errors=s,a}var c=i.derToOid(n.oid);if(void 0!==o.oids[c]){t[o.oids[c]]=[];for(var u=0;u<n.values.length;++u)t[o.oids[c]].push(n.values[u].value)}}return t}s.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var u={};if(!i.validate(e,c,u,[]))throw(l=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=l,l;var l,h={version:u.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=n.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=p(h.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=p(h.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=p(h.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return p(h.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return p(h.safeContents,"localKeyId",e,t)}};if(3!==u.version.charCodeAt(0))throw(l=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=u.version.charCodeAt(0),l;if(i.derToOid(u.contentType)!==o.oids.data)throw(l=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=i.derToOid(u.contentType),l;var m=u.content.value[0];if(m.tagClass!==i.Class.UNIVERSAL||m.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(m=f(m),u.mac){var y=null,v=0,b=i.derToOid(u.macAlgorithm);switch(b){case o.oids.sha1:y=n.md.sha1.create(),v=20;break;case o.oids.sha256:y=n.md.sha256.create(),v=32;break;case o.oids.sha384:y=n.md.sha384.create(),v=48;break;case o.oids.sha512:y=n.md.sha512.create(),v=64;break;case o.oids.md5:y=n.md.md5.create(),v=16}if(null===y)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+b);var _=new n.util.ByteBuffer(u.macSalt),E="macIterations"in u?parseInt(n.util.bytesToHex(u.macIterations),16):1,C=s.generateKey(r,_,3,E,v,y),w=n.hmac.create();if(w.start(y,C),w.update(m.value),w.getMac().getBytes()!==u.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if((t=i.fromDer(t,r)).tagClass!==i.Class.UNIVERSAL||t.type!==i.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var s=0;s<t.value.length;s++){var c=t.value[s],u={},l=[];if(!i.validate(c,a,u,l)){var h=new Error("Cannot read ContentInfo.");throw h.errors=l,h}var p={encrypted:!1},m=null,y=u.content.value[0];switch(i.derToOid(u.contentType)){case o.oids.data:if(y.tagClass!==i.Class.UNIVERSAL||y.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");m=f(y).value;break;case o.oids.encryptedData:m=d(y,n),p.encrypted=!0;break;default:var h=new Error("Unsupported PKCS#12 contentType.");throw h.contentType=i.derToOid(u.contentType),h}p.safeBags=g(m,r,n),e.safeContents.push(p)}}(h,m.value,t,r),h},s.toPkcs12Asn1=function(e,t,r,a){(a=a||{}).saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||a.encAlgorithm||"aes128","useMac"in a||(a.useMac=!0),"localKeyId"in a||(a.localKeyId=null),"generateLocalKeyId"in a||(a.generateLocalKeyId=!0);var c,u=a.localKeyId;if(null!==u)u=n.util.hexToBytes(u);else if(a.generateLocalKeyId)if(t){var l=n.util.isArray(t)?t[0]:t;"string"==typeof l&&(l=o.certificateFromPem(l)),(I=n.md.sha1.create()).update(i.toDer(o.certificateToAsn1(l)).getBytes()),u=I.digest().getBytes()}else u=n.random.getBytes(20);var h=[];null!==u&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,u)])])),"friendlyName"in a&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,!1,a.friendlyName)])])),h.length>0&&(c=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,h));var p=[],f=[];null!==t&&(f=n.util.isArray(t)?t:[t]);for(var d=[],g=0;g<f.length;++g){"string"==typeof(t=f[g])&&(t=o.certificateFromPem(t));var m=0===g?c:void 0,y=o.certificateToAsn1(t),v=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(y).getBytes())])])]),m]);d.push(v)}if(d.length>0){var b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,d),_=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(b).getBytes())])]);p.push(_)}var E=null;if(null!==e){var C=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));E=null===r?i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[C]),c]):i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[o.encryptPrivateKeyInfo(C,r,a)]),c]);var w=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[E]),S=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(w).getBytes())])]);p.push(S)}var T,A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,p);if(a.useMac){var I=n.md.sha1.create(),N=new n.util.ByteBuffer(n.random.getBytes(a.saltSize)),k=a.count,R=(e=s.generateKey(r,N,3,k,20),n.hmac.create());R.start(I,e),R.update(i.toDer(A).getBytes());var O=R.getMac();T=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,O.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,N.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(k).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(A).getBytes())])]),T])},s.generateKey=n.pbe.generatePkcs12Key},function(e,t,r){var n=r(3);r(37),r(6);var i=n.asn1,o=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=o;var s={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};o.contentInfoValidator=s;var a={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};o.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},o.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};o.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},o.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},function(e,t,r){var n=r(3);r(6),n.mgf=n.mgf||{},(e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{}).create=function(e){return{generate:function(t,r){for(var i=new n.util.ByteBuffer,o=Math.ceil(r/e.digestLength),s=0;s<o;s++){var a=new n.util.ByteBuffer;a.putInt32(s),e.start(),e.update(t+a.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}}}},function(e,t,r){var n=r(3);e.exports=n.debug=n.debug||{},n.debug.storage={},n.debug.get=function(e,t){var r;return void 0===e?r=n.debug.storage:e in n.debug.storage&&(r=void 0===t?n.debug.storage[e]:n.debug.storage[e][t]),r},n.debug.set=function(e,t,r){e in n.debug.storage||(n.debug.storage[e]={}),n.debug.storage[e][t]=r},n.debug.clear=function(e,t){void 0===e?n.debug.storage={}:e in n.debug.storage&&(void 0===t?delete n.debug.storage[e]:delete n.debug.storage[e][t])}},function(e,t,r){var n=r(3);r(38),r(6);var i=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=i;var o=n.sha384=n.sha512.sha384=n.sha512.sha384||{};o.create=function(){return i.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=o,n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,i.create=function(e){if(a||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(u={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0),void 0===e&&(e="SHA-512"),!(e in u))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=u[e],r=null,i=n.util.createBuffer(),o=new Array(80),h=0;h<80;++h)o[h]=new Array(2);var p=64;switch(e){case"SHA-384":p=48;break;case"SHA-512/256":p=32;break;case"SHA-512/224":p=28}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:p,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,o=0;o<e;++o)f.fullMessageLength.push(0);i=n.util.createBuffer(),r=new Array(t.length);for(o=0;o<t.length;++o)r[o]=t[o].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var s=e.length;f.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=f.fullMessageLength.length-1;a>=0;--a)f.fullMessageLength[a]+=s[1],s[1]=s[0]+(f.fullMessageLength[a]/4294967296>>>0),f.fullMessageLength[a]=f.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return i.putBytes(e),l(r,o,i),(i.read>2048||0===i.length())&&i.compact(),f},f.digest=function(){var t=n.util.createBuffer();t.putBytes(i.bytes());var a,c=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1;t.putBytes(s.substr(0,f.blockLength-c));for(var u=8*f.fullMessageLength[0],h=0;h<f.fullMessageLength.length-1;++h)u+=(a=8*f.fullMessageLength[h+1])/4294967296>>>0,t.putInt32(u>>>0),u=a>>>0;t.putInt32(u);var p=new Array(r.length);for(h=0;h<r.length;++h)p[h]=r[h].slice(0);l(p,o,t);var d,g=n.util.createBuffer();d="SHA-512"===e?p.length:"SHA-384"===e?p.length-2:p.length-4;for(h=0;h<d;++h)g.putInt32(p[h][0]),h===d-1&&"SHA-512/224"===e||g.putInt32(p[h][1]);return g},f};var s=null,a=!1,c=null,u=null;function l(e,t,r){for(var n,i,o,s,a,u,l,h,p,f,d,g,m,y,v,b,_,E,C,w,S,T,A,I,N,k,R,O,x,B,D,P,L,j=r.length();j>=128;){for(R=0;R<16;++R)t[R][0]=r.getInt32()>>>0,t[R][1]=r.getInt32()>>>0;for(;R<80;++R)n=(((O=(B=t[R-2])[0])>>>19|(x=B[1])<<13)^(x>>>29|O<<3)^O>>>6)>>>0,i=((O<<13|x>>>19)^(x<<3|O>>>29)^(O<<26|x>>>6))>>>0,o=(((O=(P=t[R-15])[0])>>>1|(x=P[1])<<31)^(O>>>8|x<<24)^O>>>7)>>>0,s=((O<<31|x>>>1)^(O<<24|x>>>8)^(O<<25|x>>>7))>>>0,D=t[R-7],L=t[R-16],x=i+D[1]+s+L[1],t[R][0]=n+D[0]+o+L[0]+(x/4294967296>>>0)>>>0,t[R][1]=x>>>0;for(d=e[0][0],g=e[0][1],m=e[1][0],y=e[1][1],v=e[2][0],b=e[2][1],_=e[3][0],E=e[3][1],C=e[4][0],w=e[4][1],S=e[5][0],T=e[5][1],A=e[6][0],I=e[6][1],N=e[7][0],k=e[7][1],R=0;R<80;++R)l=((C>>>14|w<<18)^(C>>>18|w<<14)^(w>>>9|C<<23))>>>0,h=(A^C&(S^A))>>>0,a=((d>>>28|g<<4)^(g>>>2|d<<30)^(g>>>7|d<<25))>>>0,u=((d<<4|g>>>28)^(g<<30|d>>>2)^(g<<25|d>>>7))>>>0,p=(d&m|v&(d^m))>>>0,f=(g&y|b&(g^y))>>>0,x=k+(((C<<18|w>>>14)^(C<<14|w>>>18)^(w<<23|C>>>9))>>>0)+((I^w&(T^I))>>>0)+c[R][1]+t[R][1],n=N+l+h+c[R][0]+t[R][0]+(x/4294967296>>>0)>>>0,i=x>>>0,o=a+p+((x=u+f)/4294967296>>>0)>>>0,s=x>>>0,N=A,k=I,A=S,I=T,S=C,T=w,C=_+n+((x=E+i)/4294967296>>>0)>>>0,w=x>>>0,_=v,E=b,v=m,b=y,m=d,y=g,d=n+o+((x=i+s)/4294967296>>>0)>>>0,g=x>>>0;x=e[0][1]+g,e[0][0]=e[0][0]+d+(x/4294967296>>>0)>>>0,e[0][1]=x>>>0,x=e[1][1]+y,e[1][0]=e[1][0]+m+(x/4294967296>>>0)>>>0,e[1][1]=x>>>0,x=e[2][1]+b,e[2][0]=e[2][0]+v+(x/4294967296>>>0)>>>0,e[2][1]=x>>>0,x=e[3][1]+E,e[3][0]=e[3][0]+_+(x/4294967296>>>0)>>>0,e[3][1]=x>>>0,x=e[4][1]+w,e[4][0]=e[4][0]+C+(x/4294967296>>>0)>>>0,e[4][1]=x>>>0,x=e[5][1]+T,e[5][0]=e[5][0]+S+(x/4294967296>>>0)>>>0,e[5][1]=x>>>0,x=e[6][1]+I,e[6][0]=e[6][0]+A+(x/4294967296>>>0)>>>0,e[6][1]=x>>>0,x=e[7][1]+k,e[7][0]=e[7][0]+N+(x/4294967296>>>0)>>>0,e[7][1]=x>>>0,j-=128}}},function(e,t,r){var n=r(3);r(6),e.exports=n.log=n.log||{},n.log.levels=["none","error","warning","info","debug","verbose","max"];var i={},o=[],s=null;n.log.LEVEL_LOCKED=2,n.log.NO_LEVEL_CHECK=4,n.log.INTERPOLATE=8;for(var a=0;a<n.log.levels.length;++a){var c=n.log.levels[a];i[c]={index:a,name:c.toUpperCase()}}n.log.logMessage=function(e){for(var t=i[e.level].index,r=0;r<o.length;++r){var s=o[r];if(s.flags&n.log.NO_LEVEL_CHECK)s.f(e);else t<=i[s.level].index&&s.f(s,e)}},n.log.prepareStandard=function(e){"standard"in e||(e.standard=i[e.level].name+" ["+e.category+"] "+e.message)},n.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]||!1),e.full=n.util.format.apply(this,t)}},n.log.prepareStandardFull=function(e){"standardFull"in e||(n.log.prepareStandard(e),e.standardFull=e.standard)};var u=["error","warning","info","debug","verbose"];for(a=0;a<u.length;++a)!function(e){n.log[e]=function(t,r){var i=Array.prototype.slice.call(arguments).slice(2),o={timestamp:new Date,level:e,category:t,message:r,arguments:i};n.log.logMessage(o)}}(u[a]);if(n.log.makeLogger=function(e){var t={flags:0,f:e};return n.log.setLevel(t,"none"),t},n.log.setLevel=function(e,t){var r=!1;if(e&&!(e.flags&n.log.LEVEL_LOCKED))for(var i=0;i<n.log.levels.length;++i){if(t==n.log.levels[i]){e.level=t,r=!0;break}}return r},n.log.lock=function(e,t){void 0===t||t?e.flags|=n.log.LEVEL_LOCKED:e.flags&=~n.log.LEVEL_LOCKED},n.log.addLogger=function(e){o.push(e)},"undefined"!=typeof console&&"log"in console){var l;if(console.error&&console.warn&&console.info&&console.debug){var h={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},p=function(e,t){n.log.prepareStandard(t);var r=h[t.level],i=[t.standard];i=i.concat(t.arguments.slice()),r.apply(console,i)};l=n.log.makeLogger(p)}else{p=function(e,t){n.log.prepareStandardFull(t),console.log(t.standardFull)};l=n.log.makeLogger(p)}n.log.setLevel(l,"debug"),n.log.addLogger(l),s=l}else console={log:function(){}};if(null!==s){var f=n.util.getQueryVariables();if("console.level"in f&&n.log.setLevel(s,f["console.level"].slice(-1)[0]),"console.lock"in f)"true"==f["console.lock"].slice(-1)[0]&&n.log.lock(s)}n.log.consoleLogger=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(76),i=r(398),o=r(68),s={alg:"RS256",typ:"JWT"};t.JWTAccess=class{constructor(e,t,r){this.cache=i({max:500,maxAge:36e5}),this.email=e,this.key=t,this.keyId=r}createScopedRequired(){return o.warn(o.JWT_ACCESS_CREATE_SCOPED_DEPRECATED),!1}getRequestMetadata(e,t){return o.warn(o.JWT_ACCESS_GET_REQUEST_METADATA_DEPRECATED),{headers:this.getRequestHeaders(e,t)}}getRequestHeaders(e,t){const r=this.cache.get(e);if(r)return r;const i=Math.floor((new Date).getTime()/1e3),o=i+3600,a={iss:this.email,sub:this.email,aud:e,exp:o,iat:i};if(t)for(const e in a)if(t[e])throw new Error(`The '${e}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`);const c=this.keyId?Object.assign({},s,{kid:this.keyId}):s,u=Object.assign(a,t),l={Authorization:`Bearer ${n.sign({header:c,payload:u,secret:this.key})}`};return this.cache.set(e,l),l}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(e=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{e||r(new Error("Must pass in a stream containing the service account auth settings."));let n="";e.setEncoding("utf8").on("data",e=>n+=e).on("error",r).on("end",()=>{try{const e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(120);t.UserRefreshClient=class extends i.OAuth2Client{constructor(e,t,r,n){const i=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,refreshToken:r,eagerRefreshThresholdMillis:n};super({clientId:i.clientId,clientSecret:i.clientSecret,eagerRefreshThresholdMillis:i.eagerRefreshThresholdMillis}),this._refreshToken=i.refreshToken}refreshTokenNoCache(e){const t=e=>super[e];return n(this,void 0,void 0,function*(){return t("refreshTokenNoCache").call(this,this._refreshToken)})}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==e.type)throw new Error('The incoming JSON object does not have the "authorized_user" type');if(!e.client_id)throw new Error("The incoming JSON object does not contain a client_id field");if(!e.client_secret)throw new Error("The incoming JSON object does not contain a client_secret field");if(!e.refresh_token)throw new Error("The incoming JSON object does not contain a refresh_token field");this._clientId=e.client_id,this._clientSecret=e.client_secret,this._refreshToken=e.refresh_token,this.credentials.refresh_token=e.refresh_token}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(e=>t(),t)}fromStreamAsync(e){return n(this,void 0,void 0,function*(){return new Promise((t,r)=>{if(!e)return r(new Error("Must pass in a stream containing the user refresh token."));let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{const e=JSON.parse(n);return this.fromJSON(e),t()}catch(e){return r(e)}})})})}}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(7),i=r(403);function o(...t){return n.join(e,"../../","google",...t)}t.getProtoPath=o,t.load=i.load,t.loadSync=i.loadSync,t.appengine={v1:o("appengine/v1/appengine.proto")},t.bigtable={v1:o("bigtable/v1/bigtable_service.proto"),v2:o("bigtable/v2/bigtable.proto"),admin:{v1:o("bigtable/admin/table/v1/bigtable_table_service.proto"),v2:{instance:o("bigtable/admin/v2/bigtable_instance_admin.proto"),table:o("bigtable/admin/v2/bigtable_table_admin.proto")}}},t.cloudtrace={v1:o("devtools/cloudtrace/v1/trace.proto")},t.container={v1:o("container/v1/cluster_service.proto")},t.datastore={v1:o("datastore/v1/datastore.proto"),v1beta3:o("datastore/v1beta3/datastore.proto")},t.dlp={v2beta1:o("privacy/dlp/v2beta1/dlp.proto")},t.embeddedAssistant={v1alpha1:o("assistant/embedded/v1alpha1/embedded_assistant.proto"),v1alpha2:o("assistant/embedded/v1alpha2/embedded_assistant.proto")},t.firestore={v1beta1:o("firestore/v1beta1/firestore.proto"),admin:{v1beta1:o("firestore/admin/v1beta1/firestore_admin.proto")}},t.functions={v1beta2:o("cloud/functions/v1beta2/functions.proto")},t.iam={v1:o("iam/v1/iam_policy.proto"),admin:{v1:o("iam/admin/v1/iam.proto")}},t.language={v1beta1:o("cloud/language/v1beta1/language_service.proto"),v1:o("cloud/language/v1/language_service.proto")},t.logging={v2:o("logging/v2/logging.proto")},t.monitoring={v3:{group:o("monitoring/v3/group_service.proto"),metric:o("monitoring/v3/metric_service.proto")}},t.pubsub={v1:o("pubsub/v1/pubsub.proto"),v1beta2:o("pubsub/v1beta2/pubsub.proto")},t.spanner={v1:o("spanner/v1/spanner.proto"),admin:{v1:{database:o("spanner/admin/database/v1/spanner_database_admin.proto"),instance:o("spanner/admin/instance/v1/spanner_instance_admin.proto")}}},t.speech={v1beta1:o("cloud/speech/v1beta1/cloud_speech.proto"),v1:o("cloud/speech/v1/cloud_speech.proto"),v2:o("cloud/speech/v2/cloud_speech.proto")},t.storagetransfer={v1:o("storagetransfer/v1/transfer.proto")},t.videointelligence={v1beta1:o("cloud/videointelligence/v1beta1/video_intelligence.proto")},t.vision={v1:o("cloud/vision/v1/image_annotator.proto")}}).call(this,"/")},function(e,t,r){var n=r(12).EventEmitter,i=r(8),o=r(7),s=o.sep||"/";function a(e,t,r){"function"==typeof t&&(r=t);var a=(t=t||{}).fs||i,c=new n,u=[],l=t.return_object?{}:[],h=!1,p={},f=0,d=null,g=0,m=0,y=function(e){m+=e,e<1&&!v&&(v=1,process.nextTick(function(){v=0,m<=0&&!g&&(g=1,c.emit("end"))}))},v=0;c.ignore=function(e){return Array.isArray(e)?u.push.apply(u,e):u.push(e),this};var b=[["isFile","file"],["isDirectory","directory"],["isSymbolicLink","link"],["isSocket","socket"],["isFIFO","fifo"],["isBlockDevice","blockdevice"],["isCharacterDevice","characterdevice"]],_=function(e,r,n){y(1);var i=function(i,s,a){if(y(-1),!f)if(!i&&s){var u=o.basename(e),l=s.dev+"-"+s.ino+"-"+u;if(!1!==t.track_inodes){if(p[l]&&s.ino)return;p[l]=1}if(r&&s.isDirectory())c.emit("targetdirectory",e,s,n);else{c.emit("path",e,s,n);for(var h=0,d=b.length;h<d;h++)if(s[b[h][0]]()){c.emit(b[h][1],e,s,n);break}}}else c.emit("fail",e,i)};if(t.sync){var s,u;try{s=a.lstatSync(e)}catch(e){u=e}i(u,s)}else a.lstat(e,i)},E=function(e,r,n){if(h||(e=o.resolve(e),h=1),t.max_depth&&n>=t.max_depth)c.emit("maxdepth",e,r,n);else{if(u.length)for(var i=0;i<u.length;++i)if(u[i]==e)return void u.splice(i,1);y(1);var l=function(t,i){if(y(-1),!t&&i)if(i.length){e==s&&(e="");for(var o=0,a=i.length;o<a;o++)_(e+s+i[o],!1,(n||0)+1)}else c.emit("empty",e,r,n);else c.emit("fail",e,t)};if(t.sync){var p;try{p=a.readdirSync(e)}catch(e){}l(void 0,p)}else a.readdir(e,l)}};if(t.follow_symlinks){var C=function(e,t,r){y(-1),_(t,!1,r)};c.on("link",function(e,r,n){if(y(1),t.sync){var i;try{i=a.readlinkSync(e)}catch(e){e}C(0,o.resolve(o.dirname(e),i),n)}else a.readlink(e,function(t,r){C(0,o.resolve(o.dirname(e),r),n)})})}if(r&&c.on("path",r),t.sync&&(t.no_return||c.on("path",function(e,r){t.return_object?l[e]=r:l.push(e)})),t.no_recurse||c.on("directory",E),c.once("targetdirectory",E),c.once("fail",function(t,r){e==t&&c.emit("error",e,r)}),_(e,1),t.sync)return l;c.end=c.stop=function(){f=1};var w=[];return c.pause=function(){y(1),d=!0,c.emit=function(){w.push(arguments)}},c.resume=function(){if(d){d=!1,y(-1),c.emit=n.prototype.emit;var e=w;for(w=[];e.length;)c.emit.apply(c,e.shift())}},c}e.exports=a,a.find=a.walk=a,a.sync=function(e,t,r){return"function"==typeof t&&(r=t),(t=t||{}).sync=!0,a(e,t,r)}},function(e,t,r){"use strict";(function(e){
/**
 * @license
 * Copyright 2015 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
var n=r(7),i=r(8),o=r(4),s=n.resolve(e,"deps","grpc","etc","roots.pem"),a=r(16),c=r(404),u=r(162),l=r(454),h=r(106),p=r(105),f=r(70),d=r(275),g=r(276),m=r(73);f.setDefaultRootsPem(i.readFileSync(s,"ascii")),t.loadObject=function(e,t){var r;if(t=a.defaults(t,h.defaultGrpcOptions),"detect"===(t=a.defaults(t,{protobufjsVersion:"detect"})).protobufjsVersion)if(g.isProbablyProtobufJs6(e))r=6;else{if(!d.isProbablyProtobufJs5(e)){throw new Error('Could not detect ProtoBuf.js version. Please specify the version number with the "protobufjsVersion" option')}r=5}else r=t.protobufjsVersion;switch(r){case 6:return g.loadObject(e,t);case 5:return d.loadObject(e,t);default:throw new Error("Unrecognized protobufjsVersion",r)}};var y=t.loadObject;t.load=o.deprecate(function(e,t,r){(r=a.defaults(r,h.defaultGrpcOptions)).protobufjsVersion=5,t||(t="proto");var n,i=c.convertFieldsToCamelCase;r&&r.hasOwnProperty("convertFieldsToCamelCase")&&(c.convertFieldsToCamelCase=r.convertFieldsToCamelCase);try{switch(t){case"proto":n=c.loadProtoFile(e);break;case"json":n=c.loadJsonFile(e);break;default:throw new Error('Unrecognized format "'+t+'"')}}finally{c.convertFieldsToCamelCase=i}if(!n)throw new Error('Could not load file "'+e+'"');return y(n.ns,r)},"grpc.load: Use the @grpc/proto-loader module with grpc.loadPackageDefinition instead"),t.loadPackageDefinition=function(e){const t={};for(const r in e){const n=e[r],i=r.split("."),o=i[i.length-1];let s=t;for(const e of i.slice(0,-1))s[e]||(s[e]={}),s=s[e];s[o]=u.makeClientConstructor(n,o,{})}return t};t.setLogger=function(e){h.logger=e,f.setDefaultLoggerCallback(function(t,r,i,o,s){e.error(function(e){var t=e.file,r=e.line,n=e.severity,i=e.message;return`${n} ${e.timestamp}\t${t}:${r}]\t${i}`}({file:n.basename(t),line:r,severity:i,message:o,timestamp:s.toISOString()}))})},t.setLogVerbosity=function(e){h.logVerbosity=e,f.setLogVerbosity(e)},t.Server=l.Server,t.Metadata=p,t.status=m.status,t.propagate=m.propagate,t.callError=m.callError,t.writeFlags=m.writeFlags,t.logVerbosity=m.logVerbosity,t.methodTypes=m.methodTypes,t.connectivityState=m.connectivityState,t.credentials=r(455),t.ServerCredentials=f.ServerCredentials,t.makeGenericClientConstructor=u.makeClientConstructor,t.getClientChannel=u.getClientChannel,t.waitForClientReady=u.waitForClientReady,t.StatusBuilder=u.StatusBuilder,t.ListenerBuilder=u.ListenerBuilder,t.RequesterBuilder=u.RequesterBuilder,t.InterceptingCall=u.InterceptingCall,t.closeClient=function(e){u.Client.prototype.close.apply(e)},t.Client=u.Client,t.Channel=f.Channel}).call(this,"/")},function(e,t,r){"use strict";var n=r(8),i=r(412),o=r(420);e.exports=t;var s=process.version.substr(1).replace(/-.*$/,"").split(".").map(function(e){return+e}),a=["build","clean","configure","package","publish","reveal","testbinary","testpackage","unpublish"];function c(e){return e&&(-1!==e.indexOf("{napi_build_version}")||-1!==e.indexOf("{node_napi_label}"))}e.exports.get_napi_version=function(e){var t=process.versions.napi;return t||(9===s[0]&&s[1]>=3?t=2:8===s[0]&&(t=1)),t},e.exports.get_napi_version_as_string=function(t){var r=e.exports.get_napi_version(t);return r?""+r:""},e.exports.validate_package_json=function(t,r){var n=t.binary,i=c(n.module_path),o=c(n.remote_path),s=c(n.package_name),a=e.exports.get_napi_build_versions(t,r,!0),u=e.exports.get_napi_build_versions_raw(t);if(a&&a.forEach(function(e){if(!(parseInt(e,10)===e&&e>0))throw new Error("All values specified in napi_versions must be positive integers.")}),a&&(!i||!o&&!s))throw new Error("When napi_versions is specified; module_path and either remote_path or package_name must contain the substitution string '{napi_build_version}`.");if((i||o||s)&&!u)throw new Error("When the substitution string '{napi_build_version}` is specified in module_path, remote_path, or package_name; napi_versions must also be specified.");if(a&&!e.exports.get_best_napi_build_version(t,r)&&e.exports.build_napi_only(t))throw new Error("The N-API version of this Node instance is "+e.exports.get_napi_version(r?r.target:void 0)+". This module supports N-API version(s) "+e.exports.get_napi_build_versions_raw(t)+". This Node instance cannot run this module.");if(u&&!a&&e.exports.build_napi_only(t))throw new Error("The N-API version of this Node instance is "+e.exports.get_napi_version(r?r.target:void 0)+". This module supports N-API version(s) "+e.exports.get_napi_build_versions_raw(t)+". This Node instance cannot run this module.")},e.exports.expand_commands=function(t,r,n){var i=[],o=e.exports.get_napi_build_versions(t,r);return n.forEach(function(n){if(o&&"install"===n.name){var s=e.exports.get_best_napi_build_version(t,r),c=s?["napi_build_version="+s]:[];i.push({name:n.name,args:c})}else o&&-1!==a.indexOf(n.name)?o.forEach(function(e){var t=n.args.slice();t.push("napi_build_version="+e),i.push({name:n.name,args:t})}):i.push(n)}),i},e.exports.get_napi_build_versions=function(t,r,n){var i=[],s=e.exports.get_napi_version(r?r.target:void 0);if(t.binary&&t.binary.napi_versions&&t.binary.napi_versions.forEach(function(e){var t=-1!==i.indexOf(e);!t&&s&&e<=s?i.push(e):n&&!t&&s&&o.info("This Node instance does not support builds for N-API version",e)}),r&&r["build-latest-napi-version-only"]){var a=0;i.forEach(function(e){e>a&&(a=e)}),i=a?[a]:[]}return i.length?i:void 0},e.exports.get_napi_build_versions_raw=function(e){var t=[];return e.binary&&e.binary.napi_versions&&e.binary.napi_versions.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t.length?t:void 0},e.exports.get_command_arg=function(e){return"napi_build_version="+e},e.exports.get_napi_build_version_from_command_args=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(0===r.indexOf("napi_build_version="))return parseInt(r.substr("napi_build_version=".length),10)}},e.exports.swap_build_dir_out=function(t){t&&(i.sync(e.exports.get_build_dir(t)),n.renameSync("build",e.exports.get_build_dir(t)))},e.exports.swap_build_dir_in=function(t){t&&(i.sync("build"),n.renameSync(e.exports.get_build_dir(t),"build"))},e.exports.get_build_dir=function(e){return"build-tmp-napi-v"+e},e.exports.get_best_napi_build_version=function(t,r){var n=0,i=e.exports.get_napi_build_versions(t,r);if(i){var o=e.exports.get_napi_version(r?r.target:void 0);i.forEach(function(e){e>n&&e<=o&&(n=e)})}return 0===n?void 0:n},e.exports.build_napi_only=function(e){return e.binary&&e.binary.package_name&&-1===e.binary.package_name.indexOf("{node_napi_label}")}},function(e,t,r){e.exports=b;var n=r(8),i=r(257),o=r(163),s=(o.Minimatch,r(71)),a=r(12).EventEmitter,c=r(7),u=r(15),l=r(164),h=r(418),p=r(258),f=(p.alphasort,p.alphasorti,p.setopts),d=p.ownProp,g=r(419),m=(r(4),p.childrenIgnored),y=p.isIgnored,v=r(260);function b(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return h(e,t)}return new E(e,t,r)}b.sync=h;var _=b.GlobSync=h.GlobSync;function E(e,t,r){if("function"==typeof t&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new _(e,t)}if(!(this instanceof E))return new E(e,t,r);f(this,e,t),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=v(r),this.on("error",r),this.on("end",function(e){r(null,e)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return a();for(var o=!0,s=0;s<n;s++)this._process(this.minimatch.set[s],s,!1,a);function a(){--i._processing,i._processing<=0&&(o?process.nextTick(function(){i._finish()}):i._finish())}o=!1}b.glob=b,b.hasMagic=function(e,t){var r=function(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}({},t);r.noprocess=!0;var n=new E(e,r).minimatch.set;if(!e)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},b.Glob=E,s(E,a),E.prototype._finish=function(){if(u(this instanceof E),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();p.finish(this),this.emit("end",this.found)}},E.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--e&&t._finish()}},E.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),o=this,s=n.length;if(0===s)return t();var a=this.matches[e]=Object.create(null);n.forEach(function(r,n){r=o._makeAbs(r),i.realpath(r,o.realpathCache,function(n,i){n?"stat"===n.syscall?a[r]=!0:o.emit("error",n):a[i]=!0,0==--s&&(o.matches[e]=a,t())})})},E.prototype._mark=function(e){return p.mark(this,e)},E.prototype._makeAbs=function(e){return p.makeAbs(this,e)},E.prototype.abort=function(){this.aborted=!0,this.emit("abort")},E.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},E.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<n.length;t++){var i=n[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},E.prototype._process=function(e,t,r,n){if(u(this instanceof E),u("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,r,n]);else{for(var i,s=0;"string"==typeof e[s];)s++;switch(s){case e.length:return void this._processSimple(e.join("/"),t,n);case 0:i=null;break;default:i=e.slice(0,s).join("/")}var a,c=e.slice(s);null===i?a=".":l(i)||l(e.join("/"))?(i&&l(i)||(i="/"+i),a=i):a=i;var h=this._makeAbs(a);if(m(this,a))return n();c[0]===o.GLOBSTAR?this._processGlobStar(i,a,h,c,t,r,n):this._processReaddir(i,a,h,c,t,r,n)}},E.prototype._processReaddir=function(e,t,r,n,i,o,s){var a=this;this._readdir(r,o,function(c,u){return a._processReaddir2(e,t,r,n,i,o,u,s)})},E.prototype._processReaddir2=function(e,t,r,n,i,o,s,a){if(!s)return a();for(var u=n[0],l=!!this.minimatch.negate,h=u._glob,p=this.dot||"."===h.charAt(0),f=[],d=0;d<s.length;d++){if("."!==(m=s[d]).charAt(0)||p)(l&&!e?!m.match(u):m.match(u))&&f.push(m)}var g=f.length;if(0===g)return a();if(1===n.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(d=0;d<g;d++){var m=f[d];e&&(m="/"!==e?e+"/"+m:e+m),"/"!==m.charAt(0)||this.nomount||(m=c.join(this.root,m)),this._emitMatch(i,m)}return a()}n.shift();for(d=0;d<g;d++){m=f[d];e&&(m="/"!==e?e+"/"+m:e+m),this._process([m].concat(n),i,o,a)}a()},E.prototype._emitMatch=function(e,t){if(!this.aborted&&!y(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var r=l(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}},E.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var r=this,i=g("lstat\0"+e,function(n,i){if(n&&"ENOENT"===n.code)return t();var o=i&&i.isSymbolicLink();r.symlinks[e]=o,o||!i||i.isDirectory()?r._readdir(e,!1,t):(r.cache[e]="FILE",t())});i&&n.lstat(e,i)}},E.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=g("readdir\0"+e+"\0"+t,r))){if(t&&!d(this.symlinks,e))return this._readdirInGlobStar(e,r);if(d(this.cache,e)){var i=this.cache[e];if(!i||"FILE"===i)return r();if(Array.isArray(i))return r(null,i)}n.readdir(e,function(e,t,r){return function(n,i){n?e._readdirError(t,n,r):e._readdirEntries(t,i,r)}}(this,e,r))}},E.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var i=t[n];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}},E.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},E.prototype._processGlobStar=function(e,t,r,n,i,o,s){var a=this;this._readdir(r,o,function(c,u){a._processGlobStar2(e,t,r,n,i,o,u,s)})},E.prototype._processGlobStar2=function(e,t,r,n,i,o,s,a){if(!s)return a();var c=n.slice(1),u=e?[e]:[],l=u.concat(c);this._process(l,i,!1,a);var h=this.symlinks[r],p=s.length;if(h&&o)return a();for(var f=0;f<p;f++){if("."!==s[f].charAt(0)||this.dot){var d=u.concat(s[f],c);this._process(d,i,!0,a);var g=u.concat(s[f],n);this._process(g,i,!0,a)}}a()},E.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,function(i,o){n._processSimple2(e,t,i,o,r)})},E.prototype._processSimple2=function(e,t,r,n,i){if(this.matches[t]||(this.matches[t]=Object.create(null)),!n)return i();if(e&&l(e)&&!this.nomount){var o=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=c.join(this.root,e):(e=c.resolve(this.root,e),o&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),i()},E.prototype._stat=function(e,t){var r=this._makeAbs(e),i="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&d(this.cache,r)){var o=this.cache[r];if(Array.isArray(o)&&(o="DIR"),!i||"DIR"===o)return t(null,o);if(i&&"FILE"===o)return t()}var s=this.statCache[r];if(void 0!==s){if(!1===s)return t(null,s);var a=s.isDirectory()?"DIR":"FILE";return i&&"FILE"===a?t():t(null,a,s)}var c=this,u=g("stat\0"+r,function(i,o){if(o&&o.isSymbolicLink())return n.stat(r,function(n,i){n?c._stat2(e,r,null,o,t):c._stat2(e,r,n,i,t)});c._stat2(e,r,i,o,t)});u&&n.lstat(r,u)},E.prototype._stat2=function(e,t,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,i();var o="/"===e.slice(-1);if(this.statCache[t]=n,"/"===t.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,o&&"FILE"===s?i():i(null,s,n)}},function(e,t,r){e.exports=l,l.realpath=l,l.sync=h,l.realpathSync=h,l.monkeypatch=function(){n.realpath=l,n.realpathSync=h},l.unmonkeypatch=function(){n.realpath=i,n.realpathSync=o};var n=r(8),i=n.realpath,o=n.realpathSync,s=process.version,a=/^v[0-5]\./.test(s),c=r(413);function u(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function l(e,t,r){if(a)return i(e,t,r);"function"==typeof t&&(r=t,t=null),i(e,t,function(n,i){u(n)?c.realpath(e,t,r):r(n,i)})}function h(e,t){if(a)return o(e,t);try{return o(e,t)}catch(r){if(u(r))return c.realpathSync(e,t);throw r}}},function(e,t,r){function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.alphasort=u,t.alphasorti=c,t.setopts=function(e,t,r){r||(r={});if(r.matchBase&&-1===t.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!r.silent,e.pattern=t,e.strict=!1!==r.strict,e.realpath=!!r.realpath,e.realpathCache=r.realpathCache||Object.create(null),e.follow=!!r.follow,e.dot=!!r.dot,e.mark=!!r.mark,e.nodir=!!r.nodir,e.nodir&&(e.mark=!0);e.sync=!!r.sync,e.nounique=!!r.nounique,e.nonull=!!r.nonull,e.nosort=!!r.nosort,e.nocase=!!r.nocase,e.stat=!!r.stat,e.noprocess=!!r.noprocess,e.absolute=!!r.absolute,e.maxLength=r.maxLength||1/0,e.cache=r.cache||Object.create(null),e.statCache=r.statCache||Object.create(null),e.symlinks=r.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(l))}(e,r),e.changedCwd=!1;var o=process.cwd();n(r,"cwd")?(e.cwd=i.resolve(r.cwd),e.changedCwd=e.cwd!==o):e.cwd=o;e.root=r.root||i.resolve(e.cwd,"/"),e.root=i.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=s(e.cwd)?e.cwd:h(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,e.minimatch=new a(t,r),e.options=e.minimatch.options},t.ownProp=n,t.makeAbs=h,t.finish=function(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,i=e.matches.length;n<i;n++){var o=e.matches[n];if(o&&0!==Object.keys(o).length){var s=Object.keys(o);t?r.push.apply(r,s):s.forEach(function(e){r[e]=!0})}else if(e.nonull){var a=e.minimatch.globSet[n];t?r.push(a):r[a]=!0}}t||(r=Object.keys(r));e.nosort||(r=r.sort(e.nocase?c:u));if(e.mark){for(var n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter(function(t){var r=!/\/$/.test(t),n=e.cache[t]||e.cache[h(e,t)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r}))}e.ignore.length&&(r=r.filter(function(t){return!p(e,t)}));e.found=r},t.mark=function(e,t){var r=h(e,t),n=e.cache[r],i=t;if(n){var o="DIR"===n||Array.isArray(n),s="/"===t.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==t){var a=h(e,i);e.statCache[a]=e.statCache[r],e.cache[a]=e.cache[r]}}return i},t.isIgnored=p,t.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return!(!e.gmatcher||!e.gmatcher.match(t))})};var i=r(7),o=r(163),s=r(164),a=o.Minimatch;function c(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}function u(e,t){return e.localeCompare(t)}function l(e){var t=null;if("/**"===e.slice(-3)){var r=e.replace(/(\/\*\*)+$/,"");t=new a(r,{dot:!0})}return{matcher:new a(e,{dot:!0}),gmatcher:t}}function h(e,t){var r=t;return r="/"===t.charAt(0)?i.join(e.root,t):s(t)||""===t?t:e.changedCwd?i.resolve(e.cwd,t):i.resolve(t),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function p(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))})}},function(e,t){e.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");Object.keys(t).forEach(function(e){n[e]=t[e]});return n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(e){n[e]=i[e]}),n}}},function(e,t,r){var n=r(259);function i(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function o(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}e.exports=n(i),e.exports.strict=n(o),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(e,t,r){"use strict";var n=r(12).EventEmitter,i=r(4),o=0,s=e.exports=function(e){n.call(this),this.id=++o,this.name=e};i.inherits(s,n)},function(e,t,r){"use strict";var n=r(4),i=r(423),o=r(428),s=r(165),a=e.exports=function(e,t,r){var n;i.Transform.call(this,r),this.tracker=new s(e,t),this.name=e,this.id=this.tracker.id,this.tracker.on("change",(n=this,function(e,t,r){n.emit("change",e,t,n)}))};n.inherits(a,i.Transform),a.prototype._transform=function(e,t,r){this.tracker.completeWork(e.length?e.length:1),this.push(e),r()},a.prototype._flush=function(e){this.tracker.finish(),e()},o(a.prototype,"tracker").method("completed").method("addWork").method("finish")},function(e,t,r){"use strict";var n=r(124);e.exports=v;var i,o=r(424);v.ReadableState=y;r(12).EventEmitter;var s=function(e,t){return e.listeners(t).length},a=r(264),c=r(125).Buffer,u=global.Uint8Array||function(){};var l=r(104);l.inherits=r(71);var h=r(4),p=void 0;p=h&&h.debuglog?h.debuglog("stream"):function(){};var f,d=r(425),g=r(265);l.inherits(v,a);var m=["error","close","destroy","pause","resume"];function y(e,t){e=e||{};var n=t instanceof(i=i||r(72));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var o=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:n&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(f||(f=r(267).StringDecoder),this.decoder=new f(e.encoding),this.encoding=e.encoding)}function v(e){if(i=i||r(72),!(this instanceof v))return new v(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function b(e,t,r,n,i){var o,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,w(e)}(e,s)):(i||(o=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):_(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?_(e,s,t,!1):T(e,s)):_(e,s,t,!1))):n||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function _(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&w(e)),T(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),b(this,e,t,!1,r)},v.prototype.unshift=function(e){return b(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return f||(f=r(267).StringDecoder),this._readableState.decoder=new f(e),this._readableState.encoding=e,this};var E=8388608;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=E?e=E:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(S,e):S(e))}function S(e){p("emit readable"),e.emit("readable"),k(e)}function T(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(A,e,t))}function A(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(p("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function I(e){p("readable nexttick read 0"),e.read(0)}function N(e,t){t.reading||(p("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),k(e),t.flowing&&!t.reading&&e.read(0)}function k(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function R(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function O(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(x,t,e))}function x(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function B(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}v.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?O(this):w(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&O(this),null;var n,i=t.needReadable;return p("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&p("length less than watermark",i=!0),t.ended||t.reading?p("reading or ended",i=!1):i&&(p("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(r,t))),null===(n=e>0?R(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&O(this)),null!==n&&this.emit("data",n),n},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,p("pipe count=%d opts=%j",i.pipesCount,t);var a=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?u:v;function c(t,n){p("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,p("cleanup"),e.removeListener("close",m),e.removeListener("finish",y),e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",c),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",d),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){p("onend"),e.end()}i.endEmitted?n.nextTick(a):r.once("end",a),e.on("unpipe",c);var l=function(e){return function(){var t=e._readableState;p("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,k(e))}}(r);e.on("drain",l);var h=!1;var f=!1;function d(t){p("ondata"),f=!1,!1!==e.write(t)||f||((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==B(i.pipes,e))&&!h&&(p("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,f=!0),r.pause())}function g(t){p("onerror",t),v(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",y),v()}function y(){p("onfinish"),e.removeListener("close",m),v()}function v(){p("unpipe"),r.unpipe(e)}return r.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",m),e.once("finish",y),e.emit("pipe",r),i.flowing||(p("pipe resume"),r.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var s=B(t.pipes,e);return-1===s?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},v.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):n.nextTick(I,this))}return r},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(N,e,t))}(this,e)),this},v.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(p("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(p("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<m.length;o++)e.on(m[o],this.emit.bind(this,m[o]));return this._read=function(t){p("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=R},function(e,t,r){e.exports=r(9)},function(e,t,r){"use strict";var n=r(124);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(n.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,r){"use strict";var n=r(124);function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var o,s=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:n.nextTick;m.WritableState=g;var a=r(104);a.inherits=r(71);var c={deprecate:r(426)},u=r(264),l=r(125).Buffer,h=global.Uint8Array||function(){};var p,f=r(265);function d(){}function g(e,t){o=o||r(72),e=e||{};var a=t instanceof o;this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var c=e.highWaterMark,u=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=c||0===c?c:a&&(u||0===u)?u:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,o=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,o){--t.pendingcb,r?(n.nextTick(o,i),n.nextTick(C,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(o(i),e._writableState.errorEmitted=!0,e.emit("error",i),C(e,t))}(e,r,i,t,o);else{var a=_(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||b(e,r),i?s(v,e,r,a,o):v(e,r,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function m(e){if(o=o||r(72),!(p.call(m,this)||this instanceof o))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function y(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function v(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),C(e,t)}function b(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,o=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,c=!0;r;)o[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;o.allBuffers=c,y(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,h=r.callback;if(y(e,t,!1,t.objectMode?1:u.length,u,l,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function E(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),C(e,t)})}function C(e,t){var r=_(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,n.nextTick(E,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}a.inherits(m,u),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===m&&(e&&e._writableState instanceof g)}})):p=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,r){var i,o=this._writableState,s=!1,a=!o.objectMode&&(i=e,l.isBuffer(i)||i instanceof h);return a&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof r&&(r=d),o.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),n.nextTick(t,r)}(this,r):(a||function(e,t,r,i){var o=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),n.nextTick(i,s),o=!1),o}(this,o,e,r))&&(o.pendingcb++,s=function(e,t,r,n,i,o){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r));return t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,a,n,i,o);return c}(this,o,a,e,t,r)),s},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,r){t.ending=!0,C(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=f.destroy,m.prototype._undestroy=f.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}},function(e,t,r){"use strict";var n=r(125).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=p,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if((i=s(t[n]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if((i=s(t[n]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){"use strict";e.exports=s;var n=r(72),i=r(104);function o(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);n.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){c(e,t,r)}):c(this,null,null)}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=r(71),i.inherits(s,n),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},function(e,t,r){"use strict";var n=r(431),i=r(167),o=r(271),s=r(272),a=r(436),c=r(437);function u(e){return function(t){return function(e,t){var r=e.getBaseLength(),o="function"==typeof e.value?function(e,t,r){return i("OON",arguments),e.type?e.value(t,t[e.type+"Theme"]||{},r):e.value(t,{},r)}(e,t,r):e.value;if(null==o||""===o)return"";var a=n[e.align]||n.left,c=e.padLeft?n.left("",e.padLeft):"",u=e.padRight?n.right("",e.padRight):"",l=s(String(o),r),h=a(l,r);return c+h+u}(t,e)}}var l=e.exports=function(e,t,r){var i=function(e,t,r){var n=t.map(function(t,n,i){var s=new c(t,e),u=s.type;if(null==s.value)if(u in r)s.value=r[u];else{if(null==s.default)throw new a.MissingTemplateValue(s,r);s.value=s.default}if(null==s.value||""===s.value)return null;s.index=n,s.first=0===n,s.last=n===i.length-1,function(e,t){if(e.type)return t[h(e)]||t[p(e)]}(s,r)&&(s.value=function(e,t){var r=o({},e),n=Object.create(t),i=[],s=h(r),a=p(r);n[s]&&(i.push({value:n[s]}),n[s]=null);r.minLength=null,r.length=null,r.maxLength=null,i.push(r),n[r.type]=n[r.type],n[a]&&(i.push({value:n[a]}),n[a]=null);return function(e,t,r){return l(r,i,n)}}(s,r));return s}).filter(function(e){return null!=e}),i=e,s=n.length;function u(e,t){if(e.finished)throw new a.Internal("Tried to finish template item that was already finished");if(t===1/0)throw new a.Internal("Length of template item cannot be infinity");if(null!=t&&(e.length=t),e.minLength=null,e.maxLength=null,--s,e.finished=!0,null==e.length&&(e.length=e.getBaseLength()),null==e.length)throw new a.Internal("Finished template items must have a length");!function(e){e>i&&(e=i);e,i-=e}(e.getLength())}n.forEach(function(e){if(e.kerning){var t=e.first?0:n[e.index-1].padRight;!e.first&&t<e.kerning&&(e.padLeft=e.kerning-t),e.last||(e.padRight=e.kerning)}}),n.forEach(function(e){null!=e.getBaseLength()&&u(e)});var f,d,g=0;do{f=!1,d=Math.round(i/s),n.forEach(function(e){e.finished||e.maxLength&&e.getMaxLength()<d&&(u(e,e.maxLength),f=!0)})}while(f&&g++<n.length);if(f)throw new a.Internal("Resize loop iterated too many times while determining maxLength");g=0;do{f=!1,d=Math.round(i/s),n.forEach(function(e){e.finished||e.minLength&&e.getMinLength()>=d&&(u(e,e.minLength),f=!0)})}while(f&&g++<n.length);if(f)throw new a.Internal("Resize loop iterated too many times while determining minLength");return d=Math.round(i/s),n.forEach(function(e){e.finished||u(e,d)}),n}(e,t,r).map(u(r)).join("");return n.left(s(i,e),e)};function h(e){return"pre"+(e.type[0].toUpperCase()+e.type.slice(1))}function p(e){return"post"+(e.type[0].toUpperCase()+e.type.slice(1))}},function(e,t,r){"use strict";var n=r(432)();e.exports=function(e){return"string"==typeof e?e.replace(n,""):e}},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var u in r=Object(arguments[c]))i.call(r,u)&&(a[u]=r[u]);if(n){s=n(r);for(var l=0;l<s.length;l++)o.call(r,s[l])&&(a[s[l]]=r[s[l]])}}return a}},function(e,t,r){"use strict";var n=r(126),i=r(270);e.exports=function(e,t){if(0===n(e))return e;if(t<=0)return"";if(n(e)<=t)return e;var r=i(e),o=e.length+r.length,s=e.slice(0,t+o);for(;n(s)>t;)s=s.slice(0,-1);return s}},function(e,t,r){"use strict";e.exports=process},function(e){e.exports={_from:"grpc@^1.16.0",_id:"grpc@1.16.1",_inBundle:!1,_integrity:"sha512-7uHN1Nd3UqfvwgQ6f5U3+EZb/0iuHJ9mbPH+ydaTkszJsUi3nwdz6DuSh0eJwYVXXn6Gojv2khiQAadMongGKg==",_location:"/grpc",_phantomChildren:{ascli:"1.0.1",bytebuffer:"5.0.1",yargs:"3.32.0"},_requested:{type:"range",registry:!0,raw:"grpc@^1.16.0",name:"grpc",escapedName:"grpc",rawSpec:"^1.16.0",saveSpec:null,fetchSpec:"^1.16.0"},_requiredBy:["/google-gax"],_resolved:"https://registry.npmjs.org/grpc/-/grpc-1.16.1.tgz",_shasum:"533316f38cea68111ef577728c3f4e8e9e554543",_spec:"grpc@^1.16.0",_where:"D:\\Projects\\webhooks\\node_modules\\google-gax",author:{name:"Google Inc."},binary:{module_name:"grpc_node",module_path:"src/node/extension_binary/{node_abi}-{platform}-{arch}-{libc}",host:"https://node-precompiled-binaries.grpc.io/",remote_path:"{name}/v{version}",package_name:"{node_abi}-{platform}-{arch}-{libc}.tar.gz"},bugs:{url:"https://github.com/grpc/grpc-node/issues"},bundleDependencies:["node-pre-gyp"],contributors:[{name:"Michael Lumish",email:"mlumish@google.com"}],dependencies:{lodash:"^4.17.5",nan:"^2.0.0","node-pre-gyp":"^0.12.0",protobufjs:"^5.0.3"},deprecated:!1,description:"gRPC Library for Node",devDependencies:{async:"^2.0.1","body-parser":"^1.15.2","electron-mocha":"^3.1.1",express:"^4.14.0","google-auth-library":"^0.9.2","google-protobuf":"^3.0.0",istanbul:"^0.4.4",lodash:"^4.17.4",minimist:"^1.1.0","node-forge":"^0.7.5","poisson-process":"^0.2.1"},directories:{lib:"src"},engines:{node:">=4"},files:["LICENSE","README.md","deps/grpc/etc/","index.js","index.d.ts","src/*.js","ext/*.{cc,h}","deps/grpc/include/grpc/**/*.h","deps/grpc/src/core/**/*.{c,cc,h}","deps/grpc/src/boringssl/err_data.c","deps/grpc/src/cpp/ext/filters/census/grpc_context.cc","deps/grpc/third_party/nanopb/*.{c,cc,h}","deps/grpc/third_party/zlib/**/*.{c,cc,h}","deps/grpc/third_party/boringssl/crypto/**/*.{c,cc,h}","deps/grpc/third_party/boringssl/include/**/*.{c,cc,h}","deps/grpc/third_party/boringssl/ssl/**/*.{c,cc,h}","deps/grpc/third_party/boringssl/third_party/**/*.{c,h}","deps/grpc/third_party/abseil-cpp/absl/**/*.{h,hh}","binding.gyp"],homepage:"https://grpc.io/",jshintConfig:{bitwise:!0,curly:!0,eqeqeq:!0,esnext:!0,freeze:!0,immed:!0,indent:2,latedef:"nofunc",maxlen:80,mocha:!0,newcap:!0,node:!0,noarg:!0,quotmark:"single",strict:!0,trailing:!0,undef:!0,unused:"vars"},license:"Apache-2.0",main:"index.js",name:"grpc",repository:{type:"git",url:"git+https://github.com/grpc/grpc-node.git"},scripts:{build:"node-pre-gyp build",coverage:"istanbul cover ./node_modules/.bin/_mocha test","electron-build":"node-pre-gyp configure build --runtime=electron --disturl=https://atom.io/download/atom-shell",install:"node-pre-gyp install --fallback-to-build --library=static_library",prepack:"git submodule update --init --recursive && npm install"},typings:"index.d.ts",version:"1.16.1"}},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2017 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(16),i=r(162);t.deserializeCls=function(e,t){return function(r){return e.decode(r).toRaw(t.binaryAsBase64,t.longsAsStrings)}};var o=t.deserializeCls;t.serializeCls=function(e){return function(t){return new Buffer(new e(t).encode().toBuffer())}};var s=t.serializeCls;t.fullyQualifiedName=function e(t){if(null==t)return"";var r=t.name,n=e(t.parent);return""!==n&&(r=n+"."+r),r};var a=t.fullyQualifiedName;t.getProtobufServiceAttrs=function(e,t){var r="/"+a(e)+"/";return t&&(t.binaryAsBase64,t.longsAsStrings),n.zipObject(n.map(e.children,function(e){return n.camelCase(e.name)}),n.map(e.children,function(e){return{originalName:e.name,path:r+e.name,requestStream:e.requestStream,responseStream:e.responseStream,requestType:e.resolvedRequestType,responseType:e.resolvedResponseType,requestSerialize:s(e.resolvedRequestType.build()),requestDeserialize:o(e.resolvedRequestType.build(),t),responseSerialize:s(e.resolvedResponseType.build()),responseDeserialize:o(e.resolvedResponseType.build(),t)}}))};var c=t.getProtobufServiceAttrs;t.loadObject=function e(t,r){var o={};return t?t.hasOwnProperty("ns")?e(t.ns,r):"Namespace"===t.className?(n.each(t.children,function(t){o[t.name]=e(t,r)}),o):"Service"===t.className?i.makeClientConstructor(c(t,r),r):"Message"===t.className||"Enum"===t.className?t.build():t:t},t.isProbablyProtobufJs5=function(e){return n.isArray(e.children)&&"function"==typeof e.build}},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2017 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(16),i=r(162);t.deserializeCls=function(e,t){var r={defaults:!0,bytes:t.binaryAsBase64?String:Buffer,longs:t.longsAsStrings?String:null,enums:t.enumsAsStrings?String:null,oneofs:!0};return function(t){return e.toObject(e.decode(t),r)}};var o=t.deserializeCls;t.serializeCls=function(e){return function(t){var r=e.fromObject(t);return e.encode(r).finish()}};var s=t.serializeCls;t.fullyQualifiedName=function e(t){if(null==t)return"";var r=t.name,n=e(t.parent);return""!==n&&(r=n+"."+r),r};var a=t.fullyQualifiedName;t.getProtobufServiceAttrs=function(e,t){var r="/"+a(e)+"/";return e.resolveAll(),n.zipObject(n.map(e.methods,function(e){return n.camelCase(e.name)}),n.map(e.methods,function(e){return{originalName:e.name,path:r+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestType:e.resolvedRequestType,responseType:e.resolvedResponseType,requestSerialize:s(e.resolvedRequestType),requestDeserialize:o(e.resolvedRequestType,t),responseSerialize:s(e.resolvedResponseType),responseDeserialize:o(e.resolvedResponseType,t)}}))};var c=t.getProtobufServiceAttrs;t.loadObject=function e(t,r){var o={};if(!t)return t;if(t.hasOwnProperty("methods")){var s=c(t,r);return i.makeClientConstructor(s)}return t.hasOwnProperty("nested")?(n.each(t.nested,function(t,n){o[n]=e(t,r)}),o):t},t.isProbablyProtobufJs6=function(e){return"object"==typeof e.root&&"function"==typeof e.resolve}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(458),i=r(278),o=r(49),s=r(128);t.kChannel=Symbol();t.Client=class{constructor(e,r,n={}){n.channelOverride?this[t.kChannel]=n.channelOverride:n.channelFactoryOverride?this[t.kChannel]=n.channelFactoryOverride(e,r,n):this[t.kChannel]=new i.Http2Channel(e,r,n)}close(){this[t.kChannel].close()}getChannel(){return this[t.kChannel]}waitForReady(e,r){const n=o=>{if(o)return void r(new Error("Failed to connect before the deadline"));let s;try{s=this[t.kChannel].getConnectivityState(!0)}catch(e){return void r(new Error("The channel has been closed"))}if(s===i.ConnectivityState.READY)r();else try{this[t.kChannel].watchConnectivityState(s,e,n)}catch(e){r(new Error("The channel has been closed"))}};setImmediate(n)}handleUnaryResponse(e,t,r){let n=null;e.on("data",r=>{null!=n&&e.cancelWithStatus(o.Status.INTERNAL,"Too many responses received");try{n=t(r)}catch(t){e.cancelWithStatus(o.Status.INTERNAL,"Failed to parse server response")}}),e.on("end",()=>{null==n&&e.cancelWithStatus(o.Status.INTERNAL,"Not enough responses received")}),e.on("status",e=>{if(e.code===o.Status.OK)r(null,n);else{const t=Object.assign(new Error(e.details),e);r(t)}})}checkOptionalUnaryResponseArguments(e,t,r){if(e instanceof Function)return{metadata:new s.Metadata,options:{},callback:e};if(t instanceof Function)return e instanceof s.Metadata?{metadata:e,options:{},callback:t}:{metadata:new s.Metadata,options:e,callback:t};if(!(e instanceof s.Metadata&&t instanceof Object&&r instanceof Function))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:r}}makeUnaryRequest(e,r,i,o,s,a,c){({metadata:s,options:a,callback:c}=this.checkOptionalUnaryResponseArguments(s,a,c));const u=this[t.kChannel].createCall(e,a.deadline,a.host,a.parent,a.propagate_flags);a.credentials&&u.setCredentials(a.credentials);const l={message:r(o)};return u.sendMetadata(s),u.write(l),u.end(),this.handleUnaryResponse(u,i,c),new n.ClientUnaryCallImpl(u)}makeClientStreamRequest(e,r,i,o,s,a){({metadata:o,options:s,callback:a}=this.checkOptionalUnaryResponseArguments(o,s,a));const c=this[t.kChannel].createCall(e,s.deadline,s.host,s.parent,s.propagate_flags);return s.credentials&&c.setCredentials(s.credentials),c.sendMetadata(o),this.handleUnaryResponse(c,i,a),new n.ClientWritableStreamImpl(c,r)}checkMetadataAndOptions(e,t){let r,n;return e instanceof s.Metadata?(r=e,n=t||{}):(n=e||{},r=new s.Metadata),{metadata:r,options:n}}makeServerStreamRequest(e,r,i,o,s,a){({metadata:s,options:a}=this.checkMetadataAndOptions(s,a));const c=this[t.kChannel].createCall(e,a.deadline,a.host,a.parent,a.propagate_flags);a.credentials&&c.setCredentials(a.credentials);const u={message:r(o)};return c.sendMetadata(s),c.write(u),c.end(),new n.ClientReadableStreamImpl(c,i)}makeBidiStreamRequest(e,r,i,o,s){({metadata:o,options:s}=this.checkMetadataAndOptions(o,s));const a=this[t.kChannel].createCall(e,s.deadline,s.host,s.parent,s.propagate_flags);return s.credentials&&a.setCredentials(s.credentials),a.sendMetadata(o),new n.ClientDuplexStreamImpl(a,r,i)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12),i=r(169),o=r(156),s=r(14),a=r(459),c=r(460),u=r(461),l=r(462),h=r(49),p=r(463),f=r(464),d=r(465),g=r(466),{version:m}=r(279),y=2e4,v=1e3,b=1.6,_=12e4,E=.2,{HTTP2_HEADER_AUTHORITY:C,HTTP2_HEADER_CONTENT_TYPE:w,HTTP2_HEADER_METHOD:S,HTTP2_HEADER_PATH:T,HTTP2_HEADER_TE:A,HTTP2_HEADER_USER_AGENT:I}=i.constants;var N;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.READY=1]="READY",e[e.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",e[e.IDLE=3]="IDLE",e[e.SHUTDOWN=4]="SHUTDOWN"}(N=t.ConnectivityState||(t.ConnectivityState={}));t.Http2Channel=class extends n.EventEmitter{constructor(e,t,r){super(),this.credentials=t,this.options=r,this.connectivityState=N.IDLE,this.connecting=null,this.subChannel=null,this.subChannelConnectCallback=(()=>{}),this.subChannelCloseCallback=(()=>{}),this.currentBackoff=v;for(const e in r)r.hasOwnProperty(e)&&(u.recognizedOptions.hasOwnProperty(e)||console.warn(`Unrecognized channel argument '${e}' will be ignored.`));t._isSecure()?this.target=new s.URL(`https://${e}`):this.target=new s.URL(`http://${e}`),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=this.target.host,this.filterStackFactory=new f.FilterStackFactory([new a.CallCredentialsFilterFactory(this),new p.DeadlineFilterFactory(this),new d.MetadataStatusFilterFactory(this),new l.CompressionFilterFactory(this)]),this.currentBackoffDeadline=new Date,this.backoffTimerId=setTimeout(()=>{},0),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${m}`,r["grpc.secondary_user_agent"]].filter(e=>e).join(" ")}handleStateChange(e,t){const r=new Date;switch(t){case N.CONNECTING:if(e===N.IDLE)this.currentBackoff=v,this.currentBackoffDeadline=new Date(r.getTime()+v);else if(e===N.TRANSIENT_FAILURE){this.currentBackoff=Math.min(this.currentBackoff*b,_);const e=E*this.currentBackoff;this.currentBackoffDeadline=new Date(r.getTime()+this.currentBackoff+(n=-e,i=e,Math.random()*(i-n)+n))}this.startConnecting();break;case N.READY:this.emit("connect");break;case N.TRANSIENT_FAILURE:this.subChannel=null,this.backoffTimerId=setTimeout(()=>{this.transitionToState([N.TRANSIENT_FAILURE],N.CONNECTING)},this.currentBackoffDeadline.getTime()-r.getTime());break;case N.IDLE:case N.SHUTDOWN:this.subChannel&&(this.subChannel.close(),this.subChannel.removeListener("connect",this.subChannelConnectCallback),this.subChannel.removeListener("close",this.subChannelCloseCallback),this.subChannel=null,this.emit("shutdown"),clearTimeout(this.backoffTimerId));break;default:throw new Error("This should never happen")}var n,i}transitionToState(e,t){if(e.indexOf(this.connectivityState)>-1){const e=this.connectivityState;this.connectivityState=t,this.handleStateChange(e,t),this.emit("connectivityStateChanged",t)}}startConnecting(){const e=this.credentials._getConnectionOptions()||{};if(null!==e.secureContext&&this.options["grpc.ssl_target_name_override"]){const t=this.options["grpc.ssl_target_name_override"];e.checkServerIdentity=((e,r)=>o.checkServerIdentity(t,r)),e.servername=t}const t=new g.Http2SubChannel(this.target,e,this.userAgent,this.options);this.subChannel=t;const r=new Date,n=Math.max(this.currentBackoffDeadline.getTime()-r.getTime(),y),i=setTimeout(()=>{t.close()},n);this.subChannelConnectCallback=(()=>{clearTimeout(i),this.transitionToState([N.CONNECTING],N.READY)}),t.once("connect",this.subChannelConnectCallback),this.subChannelCloseCallback=(()=>{clearTimeout(i),this.transitionToState([N.CONNECTING,N.READY],N.TRANSIENT_FAILURE)}),t.once("close",this.subChannelCloseCallback)}_startHttp2Stream(e,t,r,n){const i=r.filterStack.sendMetadata(Promise.resolve(n.clone()));Promise.all([i,this.connect()]).then(([i])=>{const o=i.toHttp2Headers();o[C]=e,o[I]=this.userAgent,o[w]="application/grpc",o[S]="POST",o[T]=t,o[A]="trailers",this.connectivityState===N.READY?this.subChannel.startCallStream(i,r):setImmediate(()=>{this._startHttp2Stream(e,t,r,n)})}).catch(e=>{r.cancelWithStatus(e.code||h.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${e.message}`)})}createCall(e,t,r,n,i){if(this.connectivityState===N.SHUTDOWN)throw new Error("Channel has been shut down");const o={deadline:null==t?1/0:t,flags:i||0,host:r||this.defaultAuthority,parentCall:n||null};return new c.Http2CallStream(e,this,o,this.filterStackFactory)}connect(){return this.connectivityState===N.READY?Promise.resolve():this.connectivityState===N.SHUTDOWN?Promise.reject(new Error("Channel has been shut down")):(this.connecting||(this.connecting=new Promise((e,t)=>{this.transitionToState([N.IDLE],N.CONNECTING);const r=()=>{this.connecting=null,this.removeListener("shutdown",n),e()},n=()=>{this.connecting=null,this.removeListener("connect",r),t(new Error("Channel has been shut down"))};this.once("connect",r),this.once("shutdown",n)})),this.connecting)}getConnectivityState(e){return e&&this.transitionToState([N.IDLE],N.CONNECTING),this.connectivityState}watchConnectivityState(e,t,r){if(this.connectivityState!==e)setImmediate(r);else{let e=0,n=(e=t instanceof Date?t.getTime():t)-Date.now();n<0&&(n=0);const i=setTimeout(()=>{this.removeListener("connectivityStateChanged",o),r(new Error("Channel state did not change before deadline"))},n),o=()=>{clearTimeout(i),r()};this.once("connectivityStateChanged",o)}}getTarget(){return this.target.toString()}close(){if(this.connectivityState===N.SHUTDOWN)throw new Error("Channel has been shut down");this.transitionToState([N.CONNECTING,N.READY,N.TRANSIENT_FAILURE,N.IDLE],N.SHUTDOWN)}}},function(e){e.exports={_from:"@grpc/grpc-js@^0.3.0",_id:"@grpc/grpc-js@0.3.2",_inBundle:!1,_integrity:"sha512-vvcC4EZwS2kzEuwe3zmExi20YM1tqO+L/xdpzInze0WnRfhwbssDfLtMfAyAPQaL2CD8dRZLCOVLbsSdF1KVjA==",_location:"/@grpc/grpc-js",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"@grpc/grpc-js@^0.3.0",name:"@grpc/grpc-js",escapedName:"@grpc%2fgrpc-js",scope:"@grpc",rawSpec:"^0.3.0",saveSpec:null,fetchSpec:"^0.3.0"},_requiredBy:["/google-gax"],_resolved:"https://registry.npmjs.org/@grpc/grpc-js/-/grpc-js-0.3.2.tgz",_shasum:"8adcf22154bfd4a0903296d6656420c2ff86e388",_spec:"@grpc/grpc-js@^0.3.0",_where:"D:\\Projects\\webhooks\\node_modules\\google-gax",author:{name:"Google Inc."},bundleDependencies:!1,contributors:[{name:"Google Inc."}],dependencies:{lodash:"^4.17.4",semver:"^5.5.0"},deprecated:!1,description:"gRPC Library for Node - pure JS implementation",devDependencies:{"@types/lodash":"^4.14.108","@types/mocha":"^2.2.43","@types/node":"^10.5.4","clang-format":"^1.0.55",gts:"^0.5.1",typescript:"~2.7.0"},engines:{node:"^8.11.2 || >=9.4"},files:["build/src/*.{js,d.ts}"],homepage:"https://grpc.io/",keywords:[],license:"Apache-2.0",main:"build/src/index.js",name:"@grpc/grpc-js",repository:{type:"git",url:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js-core"},scripts:{build:"npm run compile",check:"gts check",clean:"gts clean",compile:"tsc -p .",fix:"gts fix",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"tslint -c node_modules/google-ts-style/tslint.json -p . -t codeFrame --type-check",posttest:"npm run check",prepare:"npm run compile",pretest:"npm run compile",test:"gulp test"},types:"build/src/index.d.ts",version:"0.3.2"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(471),i=r(9),o=r(107);class s extends o.NormalApiCaller{constructor(e){super(),this.pageDescriptor=e}createActualCallback(e,t){const r=this;return function(n,i){if(n)return void t(n);const o=i[r.pageDescriptor.resourceField],s=i[r.pageDescriptor.responsePageTokenField];s?(e[r.pageDescriptor.requestPageTokenField]=s,t(n,o,e,i)):t(n,o,null,i)}}wrap(e){const t=this;return function(r,n,i,o){return e(r,n,i,t.createActualCallback(r,o))}}init(e,t){return o.NormalApiCaller.prototype.init.call(this,e,t)}call(e,t,r,n){if(t=Object.assign({},t),r.pageToken&&(t[this.pageDescriptor.requestPageTokenField]=r.pageToken),r.pageSize&&(t[this.pageDescriptor.requestPageSizeField]=r.pageSize),!r.autoPaginate)return void o.NormalApiCaller.prototype.call.call(this,e,t,r,n);const i=r.maxResults||-1,s=[];setImmediate(e,t,function t(r,o,a){if(r)n.callback(r);else{for(let e=0;e<o.length;++e)if(s.push(o[e]),s.length===i){a=null;break}a?setImmediate(e,a,t):n.callback(null,s)}})}}t.PagedIteration=s;t.PageDescriptor=class{constructor(e,t,r){this.requestPageTokenField=e,this.responsePageTokenField=t,this.resourceField=r}createStream(e,t,r){const o=new i.PassThrough({objectMode:!0}),s="maxResults"in(r=Object.assign({},r,{autoPaginate:!1}))?r.maxResults:-1;let a=0,c=!1;function u(i,l,h){if(i)o.emit("error",i);else{for(let e=0;e<l.length;++e){if(n(o))return;null!==l[e]&&(o.push(l[e]),++a===s&&o.end())}n(o)||(h?("pageToken"in r&&delete r.pageToken,o.isPaused()?(t=h,c=!1):setImmediate(e,h,r,u)):o.end())}}return o.on("resume",()=>{c||(c=!0,e(t,r,u))}),o}apiCaller(){return new s(this)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(472),i=r(4),o=r(282),s=r(473);class a{get size(){return this.parseResult.size}get segments(){return this.parseResult.segments}constructor(e){this.parseResult=o.finishParse(s.parse(e))}match(e){const t=e.split("/"),r={};let n,s=this.size,a=0;if(this.segments.forEach(e=>{if(!(a>t.length))if(e.kind===o.BINDING)n=e.literal;else if(e.kind===o.TERMINAL)if("*"===e.literal)r[n]=t[a],a+=1;else if("**"===e.literal){const e=t.length-s+1;s+=e-1,r[n]=t.slice(a,a+e).join("/"),a+=e}else{if(e.literal!==t[a]){const r=i.format("mismatched literal (index=%d): '%s' != '%s'",a,e.literal,t[a]);throw new TypeError(r)}a+=1}}),a!==t.length||a!==s){const t=i.format("match error: could not instantiate a path template from %s",e);throw new TypeError(t)}return r}render(e){const t=[];let r=!1;this.segments.forEach(s=>{if(s.kind===o.BINDING){if(!n(e,s.literal)){const t=i.format("Value for key %s is not provided in %s",s.literal,e);throw new TypeError(t)}const o=new a(e[s.literal]);Array.prototype.push.apply(t,o.segments),r=!0}else if(s.kind===o.END_BINDING)r=!1;else{if(r)return;t.push(s)}});const s=c(t);return this.match(s),s}inspect(){return c(this.segments)}}function c(e){let t="",r=!0;return e.forEach(e=>{if(e.kind===o.TERMINAL)return r&&(t+="/"),void(t+=e.literal);r=!0,e.kind===o.BINDING?(t+="/{"+e.literal+"=",r=!1):t+=e.literal+"}"}),t.substring(1)}t.PathTemplate=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4);function i(e){return e.filter(e=>e.kind===t.TERMINAL).length}t.BINDING=1,t.END_BINDING=2,t.TERMINAL=3,t.finishParse=function(e){return function(e){let r=!1;for(let n=0;n<e.length;n++){const i=e[n];if(i.kind===t.TERMINAL&&"**"===i.literal){if(r)throw new TypeError("cannot contain more than one path wildcard");r=!0}}}(e),function(e){let r=0;e.forEach(e=>{e.kind!==t.BINDING||e.literal||(e.literal=n.format("$%d",r),r+=1)})}(e),{segments:e,size:i(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GoogleError=class extends Error{}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(489),o=r(24),s=r(11),a=function(){function e(){}return e.prototype.delete=function(){return Promise.resolve(void 0)},e}(),c=function(){function e(e){if(this.INTERNAL=new a,!(s.isNonNullObject(e)&&"options"in e))throw new n.FirebaseInstanceIdError(n.InstanceIdClientErrorCode.INVALID_ARGUMENT,"First argument passed to admin.instanceId() must be a valid Firebase app instance.");var t=o.getProjectId(e);if(!s.isNonEmptyString(t))throw new n.FirebaseInstanceIdError(n.InstanceIdClientErrorCode.INVALID_PROJECT_ID,"Failed to determine project ID for InstanceId. Initialize the SDK with service account credentials or set project ID as an app option. Alternatively set the GOOGLE_CLOUD_PROJECT environment variable.");this.app_=e,this.requestHandler=new i.FirebaseInstanceIdRequestHandler(e,t)}return e.prototype.deleteInstanceId=function(e){return this.requestHandler.deleteInstanceId(e).then(function(e){})},Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),e}();t.InstanceId=c},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(24),o=r(11),s=r(490),a=r(491),c=r(170),u=function(){function e(){}return e.prototype.delete=function(){return Promise.resolve()},e}(),l=function(){function e(e){if(this.app=e,this.INTERNAL=new u,!(o.isNonNullObject(e)&&"options"in e))throw new n.FirebaseProjectManagementError("invalid-argument","First argument passed to admin.projectManagement() must be a valid Firebase app instance.");if(this.projectId=i.getProjectId(e),!o.isNonEmptyString(this.projectId))throw new n.FirebaseProjectManagementError("invalid-project-id","Failed to determine project ID. Initialize the SDK with service account credentials, or set project ID as an app option. Alternatively, set the GOOGLE_CLOUD_PROJECT environment variable.");this.requestHandler=new c.ProjectManagementRequestHandler(e)}return e.prototype.listAndroidApps=function(){return this.listPlatformApps("android","listAndroidApps()")},e.prototype.listIosApps=function(){return this.listPlatformApps("ios","listIosApps()")},e.prototype.androidApp=function(e){return new s.AndroidApp(e,this.requestHandler)},e.prototype.iosApp=function(e){return new a.IosApp(e,this.requestHandler)},e.prototype.createAndroidApp=function(e,t){var r=this;return this.requestHandler.createAndroidApp(this.projectId,e,t).then(function(e){return c.assertServerResponse(o.isNonNullObject(e),e,"createAndroidApp()'s responseData must be a non-null object."),c.assertServerResponse(o.isNonEmptyString(e.appId),e,'"responseData.appId" field must be present in createAndroidApp()\'s response data.'),new s.AndroidApp(e.appId,r.requestHandler)})},e.prototype.createIosApp=function(e,t){var r=this;return this.requestHandler.createIosApp(this.projectId,e,t).then(function(e){return c.assertServerResponse(o.isNonNullObject(e),e,"createIosApp()'s responseData must be a non-null object."),c.assertServerResponse(o.isNonEmptyString(e.appId),e,'"responseData.appId" field must be present in createIosApp()\'s response data.'),new a.IosApp(e.appId,r.requestHandler)})},e.prototype.listPlatformApps=function(e,t){var r=this;return("android"===e?this.requestHandler.listAndroidApps(this.projectId):this.requestHandler.listIosApps(this.projectId)).then(function(n){return c.assertServerResponse(o.isNonNullObject(n),n,t+"'s responseData must be a non-null object."),n.apps?(c.assertServerResponse(o.isArray(n.apps),n,'"apps" field must be present in the '+t+" response data."),n.apps.map(function(i){return c.assertServerResponse(o.isNonEmptyString(i.appId),n,'"apps[].appId" field must be present in the '+t+" response data."),"android"===e?new s.AndroidApp(i.appId,r.requestHandler):new a.IosApp(i.appId,r.requestHandler)})):[]})},e}();t.ProjectManagement=l},function(e,t,r){function n(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}const i=r(287);r(108).config(),i.initializeApp({credential:i.credential.cert({projectId:process.env.SA_PROJECT_ID,privateKey:process.env.SA_PRIVATE_KEY,clientEmail:process.env.SA_CLIENT_EMAIL})}),t.handler=function(){var e,t=(e=function*(e,t,r){const n=JSON.parse(e.body),{item:o}=n.queryResult.parameters,s=i.firestore().collection("lists").doc("UK3phBebpQTcCa8GlZGL"),a=o.split(" and ");yield s.update({items:i.firestore.FieldValue.arrayUnion(...a)});const c=o.split(" and ").length>1?"All items have been added":`${o} has been addded`,u={fulfillmentText:c,fulfillmentMessages:[{text:{text:[c]}}],source:""};r(null,{statusCode:200,body:JSON.stringify(u)})},function(){var t=this,r=arguments;return new Promise(function(i,o){var s=e.apply(t,r);function a(e){n(s,i,o,a,c,"next",e)}function c(e){n(s,i,o,a,c,"throw",e)}a(void 0)})});return function(e,r,n){return t.apply(this,arguments)}}()},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var n=r(288);e.exports=n},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var n=new(r(289).FirebaseNamespace);n.default=n,e.exports=n},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(8),o=r(39),s=r(10),a=r(290),c=r(109),u=r(11);t.FIREBASE_CONFIG_VAR="FIREBASE_CONFIG";var l={},h={},p=function(){function e(e){this.firebase_=e,this.serviceFactories={},this.apps_={},this.appHooks_={}}return e.prototype.initializeApp=function(e,t){if(void 0===t&&(t="[DEFAULT]"),void 0===e&&((e=this.loadOptionsFromEnvVar()).credential=new c.ApplicationDefaultCredential),"string"!=typeof t||""===t)throw new s.FirebaseAppError(s.AppErrorCodes.INVALID_APP_NAME,'Invalid Firebase app name "'+t+'" provided. App name must be a non-empty string.');if(t in this.apps_)throw"[DEFAULT]"===t?new s.FirebaseAppError(s.AppErrorCodes.DUPLICATE_APP,"The default Firebase app already exists. This means you called initializeApp() more than once without providing an app name as the second argument. In most cases you only need to call initializeApp() once. But if you do want to initialize multiple apps, pass a second argument to initializeApp() to give each app a unique name."):new s.FirebaseAppError(s.AppErrorCodes.DUPLICATE_APP,'Firebase app named "'+t+'" already exists. This means you called initializeApp() more than once with the same app name as the second argument. Make sure you provide a unique name every time you call initializeApp().');var r=new a.FirebaseApp(e,t,this);return this.apps_[t]=r,this.callAppHooks_(r,"create"),r},e.prototype.app=function(e){if(void 0===e&&(e="[DEFAULT]"),"string"!=typeof e||""===e)throw new s.FirebaseAppError(s.AppErrorCodes.INVALID_APP_NAME,'Invalid Firebase app name "'+e+'" provided. App name must be a non-empty string.');if(!(e in this.apps_)){var t="[DEFAULT]"===e?"The default Firebase app does not exist. ":'Firebase app named "'+e+'" does not exist. ';throw t+="Make sure you call initializeApp() before using any of the Firebase services.",new s.FirebaseAppError(s.AppErrorCodes.NO_APP,t)}return this.apps_[e]},Object.defineProperty(e.prototype,"apps",{get:function(){var e=this;return Object.keys(this.apps_).map(function(t){return e.apps_[t]})},enumerable:!0,configurable:!0}),e.prototype.removeApp=function(e){if(void 0===e)throw new s.FirebaseAppError(s.AppErrorCodes.INVALID_APP_NAME,"No Firebase app name provided. App name must be a non-empty string.");var t=this.app(e);this.callAppHooks_(t,"delete"),delete this.apps_[e]},e.prototype.registerService=function(e,t,r,n){var i,a,c=this;if(void 0===e?i="No service name provided. Service name must be a non-empty string.":"string"!=typeof e||""===e?i='Invalid service name "'+e+'" provided. Service name must be a non-empty string.':e in this.serviceFactories&&(i='Firebase service named "'+e+'" has already been registered.'),void 0!==i)throw new s.FirebaseAppError(s.AppErrorCodes.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: "+i);return this.serviceFactories[e]=t,n&&(this.appHooks_[e]=n),a=function(t){return void 0===t&&(t=c.app()),t[e]()},void 0!==r&&o.deepExtend(a,r),this.firebase_[e]=a,a},e.prototype.callAppHooks_=function(e,t){var r=this;Object.keys(this.serviceFactories).forEach(function(n){r.appHooks_[n]&&r.appHooks_[n](t,e)})},e.prototype.loadOptionsFromEnvVar=function(){var e=process.env[t.FIREBASE_CONFIG_VAR];if(!u.isNonEmptyString(e))return{};try{var r=e.startsWith("{")?e:i.readFileSync(e,"utf8");return JSON.parse(r)}catch(e){throw new s.FirebaseAppError(s.AppErrorCodes.INVALID_APP_OPTIONS,"Failed to parse app options file: "+e)}},e}();t.FirebaseNamespaceInternals=p;var f={cert:function(e){var t=JSON.stringify(e);return t in l||(l[t]=new c.CertCredential(e)),l[t]},refreshToken:function(e){var t=JSON.stringify(e);return t in h||(h[t]=new c.RefreshTokenCredential(e)),h[t]},applicationDefault:function(){return void 0===n&&(n=new c.ApplicationDefaultCredential),n}},d=function(){function e(){this.__esModule=!0,this.credential=f,this.SDK_VERSION="6.3.0",this.Promise=Promise,this.INTERNAL=new p(this)}return Object.defineProperty(e.prototype,"auth",{get:function(){var e=this,t=r(197).Auth;return Object.assign(function(t){return e.ensureApp(t).auth()},{Auth:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"database",{get:function(){var e=this;return Object.assign(function(t){return e.ensureApp(t).database()},r(198))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messaging",{get:function(){var e=this,t=r(200).Messaging;return Object.assign(function(t){return e.ensureApp(t).messaging()},{Messaging:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storage",{get:function(){var e=this,t=r(201).Storage;return Object.assign(function(t){return e.ensureApp(t).storage()},{Storage:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firestore",{get:function(){var e=this;return Object.assign(function(t){return e.ensureApp(t).firestore()},r(202))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instanceId",{get:function(){var e=this,t=r(284).InstanceId;return Object.assign(function(t){return e.ensureApp(t).instanceId()},{InstanceId:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projectManagement",{get:function(){var e=this,t=r(285).ProjectManagement;return Object.assign(function(t){return e.ensureApp(t).projectManagement()},{ProjectManagement:t})},enumerable:!0,configurable:!0}),e.prototype.initializeApp=function(e,t){return this.INTERNAL.initializeApp(e,t)},e.prototype.app=function(e){return this.INTERNAL.app(e)},Object.defineProperty(e.prototype,"apps",{get:function(){return this.INTERNAL.apps},enumerable:!0,configurable:!0}),e.prototype.ensureApp=function(e){return void 0===e&&(e=this.app()),e},e}();t.FirebaseNamespace=d},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(109),i=r(11),o=r(39),s=r(10),a=function(){function e(e){this.credential_=e,this.isDeleted_=!1,this.tokenListeners_=[]}return e.prototype.getToken=function(e){var t=this,r=this.cachedToken_&&this.cachedToken_.expirationTime<Date.now();return!this.cachedTokenPromise_||e||r?(clearTimeout(this.tokenRefreshTimeout_),this.cachedTokenPromise_=Promise.resolve(this.credential_.getAccessToken()).then(function(e){if(!i.isNonNullObject(e)||"number"!=typeof e.expires_in||"string"!=typeof e.access_token)throw new s.FirebaseAppError(s.AppErrorCodes.INVALID_CREDENTIAL,'Invalid access token generated: "'+JSON.stringify(e)+'". Valid access tokens must be an object with the "expires_in" (number) and "access_token" (string) properties.');var r={accessToken:e.access_token,expirationTime:Date.now()+1e3*e.expires_in},n=t.cachedToken_&&t.cachedToken_.accessToken!==r.accessToken,o=t.cachedToken_&&t.cachedToken_.expirationTime!==r.expirationTime;(!t.cachedToken_||n||o)&&(t.cachedToken_=r,t.tokenListeners_.forEach(function(e){e(r.accessToken)}));var a=e.expires_in-300,c=4;return a<=0&&(a=e.expires_in%60,c=Math.floor(e.expires_in/60)-1),c&&!t.isDeleted_&&t.setTokenRefreshTimeout(1e3*a,c),r}).catch(function(e){var t="string"==typeof e?e:e.message;throw-1!==(t='Credential implementation provided to initializeApp() via the "credential" property failed to fetch a valid Google OAuth2 access token with the following error: "'+t+'".').indexOf("invalid_grant")&&(t+=" There are two likely causes: (1) your server time is not properly synced or (2) your certificate key file has been revoked. To solve (1), re-sync the time on your server. To solve (2), make sure the key ID for your key file is still present at https://console.firebase.google.com/iam-admin/serviceaccounts/project. If not, generate a new key file at https://console.firebase.google.com/project/_/settings/serviceaccounts/adminsdk."),new s.FirebaseAppError(s.AppErrorCodes.INVALID_CREDENTIAL,t)}),this.cachedTokenPromise_):this.cachedTokenPromise_.catch(function(e){if(t.cachedToken_)return t.cachedTokenPromise_=Promise.resolve(t.cachedToken_),t.cachedTokenPromise_;throw t.cachedTokenPromise_=null,e})},e.prototype.addAuthTokenListener=function(e){this.tokenListeners_.push(e),this.cachedToken_&&e(this.cachedToken_.accessToken)},e.prototype.removeAuthTokenListener=function(e){this.tokenListeners_=this.tokenListeners_.filter(function(t){return t!==e})},e.prototype.delete=function(){this.isDeleted_=!0,clearTimeout(this.tokenRefreshTimeout_)},e.prototype.setTokenRefreshTimeout=function(e,t){var r=this;this.tokenRefreshTimeout_=setTimeout(function(){r.getToken(!0).catch(function(e){t>0&&r.setTokenRefreshTimeout(6e4,t-1)})},e)},e}();t.FirebaseAppInternals=a;var c=function(){function e(e,t,r){var c=this;if(this.firebaseInternals_=r,this.services_={},this.isDeleted_=!1,this.name_=t,this.options_=o.deepCopy(e),!i.isNonNullObject(this.options_))throw new s.FirebaseAppError(s.AppErrorCodes.INVALID_APP_OPTIONS,'Invalid Firebase app options passed as the first argument to initializeApp() for the app named "'+this.name_+'". Options must be a non-null object.');"credential"in this.options_||(this.options_.credential=new n.ApplicationDefaultCredential);var u=this.options_.credential;if("object"!=typeof u||null===u||"function"!=typeof u.getAccessToken)throw new s.FirebaseAppError(s.AppErrorCodes.INVALID_APP_OPTIONS,'Invalid Firebase app options passed as the first argument to initializeApp() for the app named "'+this.name_+'". The "credential" property must be an object which implements the Credential interface.');Object.keys(r.serviceFactories).forEach(function(e){c[e]=c.getService_.bind(c,e)}),this.INTERNAL=new a(this.options_.credential)}return e.prototype.auth=function(){var e=this;return this.ensureService_("auth",function(){return new(0,r(197).Auth)(e)})},e.prototype.database=function(e){var t=this;return this.ensureService_("database",function(){return new(0,r(320).DatabaseService)(t)}).getDatabase(e)},e.prototype.messaging=function(){var e=this;return this.ensureService_("messaging",function(){return new(0,r(200).Messaging)(e)})},e.prototype.storage=function(){var e=this;return this.ensureService_("storage",function(){return new(0,r(201).Storage)(e)})},e.prototype.firestore=function(){var e=this;return this.ensureService_("firestore",function(){return new(0,r(323).FirestoreService)(e)}).client},e.prototype.instanceId=function(){var e=this;return this.ensureService_("iid",function(){return new(0,r(284).InstanceId)(e)})},e.prototype.projectManagement=function(){var e=this;return this.ensureService_("project-management",function(){return new(0,r(285).ProjectManagement)(e)})},Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),o.deepCopy(this.options_)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return this.checkDestroyed_(),this.firebaseInternals_.removeApp(this.name_),this.INTERNAL.delete(),Promise.all(Object.keys(this.services_).map(function(t){return e.services_[t].INTERNAL.delete()})).then(function(){e.services_={},e.isDeleted_=!0})},e.prototype.ensureService_=function(e,t){var r;return this.checkDestroyed_(),e in this.services_?r=this.services_[e]:(r=t(),this.services_[e]=r),r},e.prototype.getService_=function(e){return this.checkDestroyed_(),e in this.services_||(this.services_[e]=this.firebaseInternals_.serviceFactories[e](this,this.extendApp_.bind(this))),this.services_[e]},e.prototype.extendApp_=function(e){o.deepExtend(this,e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw new s.FirebaseAppError(s.AppErrorCodes.APP_DELETED,'Firebase app named "'+this.name_+'" has already been deleted.')},e}();t.FirebaseApp=c},function(e,t,r){e.exports=r(2),r(52),r(293),r(31),r(131),r(184),r(110),r(295),r(74),r(296),r(186),r(297),r(183),r(133),r(58),r(179),r(181),r(298),r(174),r(180),r(177),r(135),r(18),r(178),r(299),r(300),r(173),r(5)},function(e,t){var r={};e.exports=r;var n={};r.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,u=e[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%o,u=u/o|0;for(;u>0;)a.push(u%o),u=u/o|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),o=[0];for(r=0;r<e.length();++r){for(var s=0,a=e.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var c="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)c+=i;for(r=o.length-1;r>=0;--r)c+=t[o[r]];return c}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},r.decode=function(e,t){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');var r=n[t];if(!r){r=n[t]=[];for(var i=0;i<t.length;++i)r[t.charCodeAt(i)]=i}e=e.replace(/\s/g,"");var o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;i++){var c=r[e.charCodeAt(i)];if(void 0===c)return;for(var u=0,l=c;u<a.length;++u)l+=a[u]*o,a[u]=255&l,l>>=8;for(;l>0;)a.push(255&l),l>>=8}for(var h=0;e[h]===s&&h<e.length-1;++h)a.push(0);return"undefined"!=typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())}},function(e,t,r){var n=r(2);r(52),r(173);var i=e.exports=n.tls;function o(e,t,r){var o=t.entity===n.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:n.cipher.createDecipher("AES-CBC",o?r.keys.server_write_key:r.keys.client_write_key),iv:o?r.keys.server_write_IV:r.keys.client_write_IV},e.write.cipherState={init:!1,cipher:n.cipher.createCipher("AES-CBC",o?r.keys.client_write_key:r.keys.server_write_key),iv:o?r.keys.client_write_IV:r.keys.server_write_IV},e.read.cipherFunction=u,e.write.cipherFunction=s,e.read.macLength=e.write.macLength=r.mac_length,e.read.macFunction=e.write.macFunction=i.hmac_sha1}function s(e,t){var r,o=!1,s=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(s),t.updateSequenceNumber(),r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:n.random.getBytesSync(16),t.cipherState.init=!0;var c=t.cipherState.cipher;return c.start({iv:r}),e.version.minor>=i.Versions.TLS_1_1.minor&&c.output.putBytes(r),c.update(e.fragment),c.finish(a)&&(e.fragment=c.output,e.length=e.fragment.length(),o=!0),o}function a(e,t,r){if(!r){var n=e-t.length()%e;t.fillWithByte(n-1,n)}return!0}function c(e,t,r){var n=!0;if(r){for(var i=t.length(),o=t.last(),s=i-1-o;s<i-1;++s)n=n&&t.at(s)==o;n&&t.truncate(o+1)}return n}i.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:o},i.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:o};function u(e,t){var r,o=!1;0,r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:e.fragment.getBytes(16),t.cipherState.init=!0;var s=t.cipherState.cipher;s.start({iv:r}),s.update(e.fragment),o=s.finish(c);var a=t.macLength,u=n.random.getBytesSync(a),l=s.output.length();l>=a?(e.fragment=s.output.getBytes(l-a),u=s.output.getBytes(a)):e.fragment=s.output.getBytes(),e.fragment=n.util.createBuffer(e.fragment),e.length=e.fragment.length();var h=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),o=function(e,t,r){var i=n.hmac.create();return i.start("SHA1",e),i.update(t),t=i.digest().getBytes(),i.start(null,null),i.update(r),r=i.digest().getBytes(),t===r}(t.macKey,u,h)&&o}},function(e,t,r){var n=r(2);r(183),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},function(e,t,r){var n=r(2);if(r(112),r(18),r(185),r(5),void 0===i)var i=n.jsbn.BigInteger;var o=n.util.ByteBuffer,s="undefined"==typeof Buffer?Uint8Array:Buffer;n.pki=n.pki||{},e.exports=n.pki.ed25519=n.ed25519=n.ed25519||{};var a=n.ed25519;function c(e){var t=e.message;if(t instanceof Uint8Array)return t;var r=e.encoding;if(void 0===t){if(!e.md)throw new TypeError('"options.message" or "options.md" not specified.');t=e.md.digest().getBytes(),r="binary"}if("string"==typeof t&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if("string"==typeof t){if("undefined"!=typeof Buffer)return new Buffer(t,r);t=new o(t,r)}else if(!(t instanceof o))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new s(t.length()),i=0;i<n.length;++i)n[i]=t.at(i);return n}a.constants={},a.constants.PUBLIC_KEY_BYTE_LENGTH=32,a.constants.PRIVATE_KEY_BYTE_LENGTH=64,a.constants.SEED_BYTE_LENGTH=32,a.constants.SIGN_BYTE_LENGTH=64,a.constants.HASH_BYTE_LENGTH=64,a.generateKeyPair=function(e){var t=(e=e||{}).seed;if(void 0===t)t=n.random.getBytesSync(a.constants.SEED_BYTE_LENGTH);else if("string"==typeof t){if(t.length!==a.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+a.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=c({message:t,encoding:"binary"});for(var r=new s(a.constants.PUBLIC_KEY_BYTE_LENGTH),i=new s(a.constants.PRIVATE_KEY_BYTE_LENGTH),o=0;o<32;++o)i[o]=t[o];return function(e,t){var r,n=[x(),x(),x(),x()],i=y(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,N(n,i),C(e,n),r=0;r<32;++r)t[r+32]=e[r]}(r,i),{publicKey:r,privateKey:i}},a.publicKeyFromPrivateKey=function(e){var t=c({message:(e=e||{}).privateKey,encoding:"binary"});if(t.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new s(a.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=t[32+n];return r},a.sign=function(e){var t=c(e=e||{}),r=c({message:e.privateKey,encoding:"binary"});if(r.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new s(a.constants.SIGN_BYTE_LENGTH+t.length);!function(e,t,r,n){var i,o,s=new Float64Array(64),a=[x(),x(),x(),x()],c=y(n,32);c[0]&=248,c[31]&=127,c[31]|=64;var u=r+64;for(i=0;i<r;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=c[32+i];var l=y(e.subarray(32),r+32);for(b(l),N(a,l),C(e,a),i=32;i<64;++i)e[i]=n[i];var h=y(e,r+64);for(b(h),i=32;i<64;++i)s[i]=0;for(i=0;i<32;++i)s[i]=l[i];for(i=0;i<32;++i)for(o=0;o<32;o++)s[i+o]+=h[i]*c[o];v(e.subarray(32),s)}(n,t,t.length,r);for(var i=new s(a.constants.SIGN_BYTE_LENGTH),o=0;o<i.length;++o)i[o]=n[o];return i},a.verify=function(e){var t=c(e=e||{});if(void 0===e.signature)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=c({message:e.signature,encoding:"binary"});if(r.length!==a.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+a.constants.SIGN_BYTE_LENGTH);var n=c({message:e.publicKey,encoding:"binary"});if(n.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+a.constants.PUBLIC_KEY_BYTE_LENGTH);var i,o=new s(a.constants.SIGN_BYTE_LENGTH+t.length),p=new s(a.constants.SIGN_BYTE_LENGTH+t.length);for(i=0;i<a.constants.SIGN_BYTE_LENGTH;++i)o[i]=r[i];for(i=0;i<t.length;++i)o[i+a.constants.SIGN_BYTE_LENGTH]=t[i];return function(e,t,r,n){var i,o=new s(32),a=[x(),x(),x(),x()],c=[x(),x(),x(),x()];if(-1,r<64)return-1;if(function(e,t){var r=x(),n=x(),i=x(),o=x(),s=x(),a=x(),c=x();k(e[2],l),function(e,t){var r;for(r=0;r<16;++r)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(e[1],t),P(i,e[1]),L(o,i,h),D(i,i,e[2]),B(o,e[2],o),P(s,o),P(a,s),L(c,a,s),L(r,c,i),L(r,r,o),function(e,t){var r,n=x();for(r=0;r<16;++r)n[r]=t[r];for(r=250;r>=0;--r)P(n,n),1!==r&&L(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(r,r),L(r,r,i),L(r,r,o),L(r,r,o),L(e[0],r,o),P(n,e[0]),L(n,n,o),S(n,i)&&L(e[0],e[0],m);if(P(n,e[0]),L(n,n,o),S(n,i))return-1;A(e[0])===t[31]>>7&&D(e[0],u,e[0]);return L(e[3],e[0],e[1]),0}(c,n))return-1;for(i=0;i<r;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=n[i];var p=y(e,r);if(b(p),I(a,c,p),N(c,t.subarray(32)),_(a,c),C(o,a),r-=64,T(t,0,o,0)){for(i=0;i<r;++i)e[i]=0;return-1}for(i=0;i<r;++i)e[i]=t[i+64];return r}(p,o,o.length,n)>=0};var u=x(),l=x([1]),h=x([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=x([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=x([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),d=x([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),m=x([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(e,t){var r=n.md.sha512.create(),i=new o(e);r.update(i.getBytes(t),"binary");const c=r.digest().getBytes();if("undefined"!=typeof Buffer)return new Buffer(c,"binary");for(var u=new s(a.constants.HASH_BYTE_LENGTH),l=0;l<64;++l)u[l]=c.charCodeAt(l);return u}function v(e,t){var r,n,i,o;for(n=63;n>=32;--n){for(r=0,i=n-32,o=n-12;i<o;++i)t[i]+=r-16*t[n]*g[i-(n-32)],r=t[i]+128>>8,t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;++i)t[i]+=r-(t[31]>>4)*g[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=r*g[i];for(n=0;n<32;++n)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function b(e){for(var t=new Float64Array(64),r=0;r<64;++r)t[r]=e[r],e[r]=0;v(e,t)}function _(e,t){var r=x(),n=x(),i=x(),o=x(),s=x(),a=x(),c=x(),u=x(),l=x();D(r,e[1],e[0]),D(l,t[1],t[0]),L(r,r,l),B(n,e[0],e[1]),B(l,t[0],t[1]),L(n,n,l),L(i,e[3],t[3]),L(i,i,p),L(o,e[2],t[2]),B(o,o,o),D(s,n,r),D(a,o,i),B(c,o,i),B(u,n,r),L(e[0],s,a),L(e[1],u,c),L(e[2],c,a),L(e[3],s,u)}function E(e,t,r){for(var n=0;n<4;++n)O(e[n],t[n],r)}function C(e,t){var r=x(),n=x(),i=x();!function(e,t){var r,n=x();for(r=0;r<16;++r)n[r]=t[r];for(r=253;r>=0;--r)P(n,n),2!==r&&4!==r&&L(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(i,t[2]),L(r,t[0],i),L(n,t[1],i),w(e,n),e[31]^=A(r)<<7}function w(e,t){var r,n,i,o=x(),s=x();for(r=0;r<16;++r)s[r]=t[r];for(R(s),R(s),R(s),n=0;n<2;++n){for(o[0]=s[0]-65517,r=1;r<15;++r)o[r]=s[r]-65535-(o[r-1]>>16&1),o[r-1]&=65535;o[15]=s[15]-32767-(o[14]>>16&1),i=o[15]>>16&1,o[14]&=65535,O(s,o,1-i)}for(r=0;r<16;r++)e[2*r]=255&s[r],e[2*r+1]=s[r]>>8}function S(e,t){var r=new s(32),n=new s(32);return w(r,e),w(n,t),T(r,0,n,0)}function T(e,t,r,n){return function(e,t,r,n,i){var o,s=0;for(o=0;o<i;++o)s|=e[t+o]^r[n+o];return(1&s-1>>>8)-1}(e,t,r,n,32)}function A(e){var t=new s(32);return w(t,e),1&t[0]}function I(e,t,r){var n,i;for(k(e[0],u),k(e[1],l),k(e[2],l),k(e[3],u),i=255;i>=0;--i)E(e,t,n=r[i/8|0]>>(7&i)&1),_(t,e),_(e,e),E(e,t,n)}function N(e,t){var r=[x(),x(),x(),x()];k(r[0],f),k(r[1],d),k(r[2],l),L(r[3],f,d),I(e,r,t)}function k(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function R(e){var t,r,n=1;for(t=0;t<16;++t)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function O(e,t,r){for(var n,i=~(r-1),o=0;o<16;++o)n=i&(e[o]^t[o]),e[o]^=n,t[o]^=n}function x(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;++t)r[t]=e[t];return r}function B(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]+r[n]}function D(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]-r[n]}function P(e,t){L(e,t,t)}function L(e,t,r){var n,i,o=0,s=0,a=0,c=0,u=0,l=0,h=0,p=0,f=0,d=0,g=0,m=0,y=0,v=0,b=0,_=0,E=0,C=0,w=0,S=0,T=0,A=0,I=0,N=0,k=0,R=0,O=0,x=0,B=0,D=0,P=0,L=r[0],j=r[1],U=r[2],M=r[3],F=r[4],V=r[5],q=r[6],K=r[7],H=r[8],G=r[9],z=r[10],W=r[11],Y=r[12],Q=r[13],$=r[14],J=r[15];o+=(n=t[0])*L,s+=n*j,a+=n*U,c+=n*M,u+=n*F,l+=n*V,h+=n*q,p+=n*K,f+=n*H,d+=n*G,g+=n*z,m+=n*W,y+=n*Y,v+=n*Q,b+=n*$,_+=n*J,s+=(n=t[1])*L,a+=n*j,c+=n*U,u+=n*M,l+=n*F,h+=n*V,p+=n*q,f+=n*K,d+=n*H,g+=n*G,m+=n*z,y+=n*W,v+=n*Y,b+=n*Q,_+=n*$,E+=n*J,a+=(n=t[2])*L,c+=n*j,u+=n*U,l+=n*M,h+=n*F,p+=n*V,f+=n*q,d+=n*K,g+=n*H,m+=n*G,y+=n*z,v+=n*W,b+=n*Y,_+=n*Q,E+=n*$,C+=n*J,c+=(n=t[3])*L,u+=n*j,l+=n*U,h+=n*M,p+=n*F,f+=n*V,d+=n*q,g+=n*K,m+=n*H,y+=n*G,v+=n*z,b+=n*W,_+=n*Y,E+=n*Q,C+=n*$,w+=n*J,u+=(n=t[4])*L,l+=n*j,h+=n*U,p+=n*M,f+=n*F,d+=n*V,g+=n*q,m+=n*K,y+=n*H,v+=n*G,b+=n*z,_+=n*W,E+=n*Y,C+=n*Q,w+=n*$,S+=n*J,l+=(n=t[5])*L,h+=n*j,p+=n*U,f+=n*M,d+=n*F,g+=n*V,m+=n*q,y+=n*K,v+=n*H,b+=n*G,_+=n*z,E+=n*W,C+=n*Y,w+=n*Q,S+=n*$,T+=n*J,h+=(n=t[6])*L,p+=n*j,f+=n*U,d+=n*M,g+=n*F,m+=n*V,y+=n*q,v+=n*K,b+=n*H,_+=n*G,E+=n*z,C+=n*W,w+=n*Y,S+=n*Q,T+=n*$,A+=n*J,p+=(n=t[7])*L,f+=n*j,d+=n*U,g+=n*M,m+=n*F,y+=n*V,v+=n*q,b+=n*K,_+=n*H,E+=n*G,C+=n*z,w+=n*W,S+=n*Y,T+=n*Q,A+=n*$,I+=n*J,f+=(n=t[8])*L,d+=n*j,g+=n*U,m+=n*M,y+=n*F,v+=n*V,b+=n*q,_+=n*K,E+=n*H,C+=n*G,w+=n*z,S+=n*W,T+=n*Y,A+=n*Q,I+=n*$,N+=n*J,d+=(n=t[9])*L,g+=n*j,m+=n*U,y+=n*M,v+=n*F,b+=n*V,_+=n*q,E+=n*K,C+=n*H,w+=n*G,S+=n*z,T+=n*W,A+=n*Y,I+=n*Q,N+=n*$,k+=n*J,g+=(n=t[10])*L,m+=n*j,y+=n*U,v+=n*M,b+=n*F,_+=n*V,E+=n*q,C+=n*K,w+=n*H,S+=n*G,T+=n*z,A+=n*W,I+=n*Y,N+=n*Q,k+=n*$,R+=n*J,m+=(n=t[11])*L,y+=n*j,v+=n*U,b+=n*M,_+=n*F,E+=n*V,C+=n*q,w+=n*K,S+=n*H,T+=n*G,A+=n*z,I+=n*W,N+=n*Y,k+=n*Q,R+=n*$,O+=n*J,y+=(n=t[12])*L,v+=n*j,b+=n*U,_+=n*M,E+=n*F,C+=n*V,w+=n*q,S+=n*K,T+=n*H,A+=n*G,I+=n*z,N+=n*W,k+=n*Y,R+=n*Q,O+=n*$,x+=n*J,v+=(n=t[13])*L,b+=n*j,_+=n*U,E+=n*M,C+=n*F,w+=n*V,S+=n*q,T+=n*K,A+=n*H,I+=n*G,N+=n*z,k+=n*W,R+=n*Y,O+=n*Q,x+=n*$,B+=n*J,b+=(n=t[14])*L,_+=n*j,E+=n*U,C+=n*M,w+=n*F,S+=n*V,T+=n*q,A+=n*K,I+=n*H,N+=n*G,k+=n*z,R+=n*W,O+=n*Y,x+=n*Q,B+=n*$,D+=n*J,_+=(n=t[15])*L,s+=38*(C+=n*U),a+=38*(w+=n*M),c+=38*(S+=n*F),u+=38*(T+=n*V),l+=38*(A+=n*q),h+=38*(I+=n*K),p+=38*(N+=n*H),f+=38*(k+=n*G),d+=38*(R+=n*z),g+=38*(O+=n*W),m+=38*(x+=n*Y),y+=38*(B+=n*Q),v+=38*(D+=n*$),b+=38*(P+=n*J),o=(n=(o+=38*(E+=n*j))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=(o+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),o+=i-1+37*(i-1),e[0]=o,e[1]=s,e[2]=a,e[3]=c,e[4]=u,e[5]=l,e[6]=h,e[7]=p,e[8]=f,e[9]=d,e[10]=g,e[11]=m,e[12]=y,e[13]=v,e[14]=b,e[15]=_}},function(e,t,r){var n=r(2);r(5),r(18),r(112),e.exports=n.kem=n.kem||{};var i=n.jsbn.BigInteger;function o(e,t,r,i){e.generate=function(e,o){for(var s=new n.util.ByteBuffer,a=Math.ceil(o/i)+r,c=new n.util.ByteBuffer,u=r;u<a;++u){c.putInt32(u),t.start(),t.update(e+c.getBytes());var l=t.digest();s.putBytes(l.getBytes(i))}return s.truncate(s.length()-o),s.getBytes()}}n.kem.rsa={},n.kem.rsa.create=function(e,t){var r=(t=t||{}).prng||n.random,o={encrypt:function(t,o){var s,a=Math.ceil(t.n.bitLength()/8);do{s=new i(n.util.bytesToHex(r.getBytesSync(a)),16).mod(t.n)}while(s.equals(i.ZERO));var c=a-(s=n.util.hexToBytes(s.toString(16))).length;return c>0&&(s=n.util.fillString(String.fromCharCode(0),c)+s),{encapsulation:t.encrypt(s,"NONE"),key:e.generate(s,o)}},decrypt:function(t,r,n){var i=t.decrypt(r,"NONE");return e.generate(i,n)}};return o},n.kem.kdf1=function(e,t){o(this,e,0,t||e.digestLength)},n.kem.kdf2=function(e,t){o(this,e,1,t||e.digestLength)}},function(e,t,r){e.exports=r(32),r(132),r(75),r(176),r(185)},function(e,t,r){var n=r(2);r(52),r(31),r(110),r(53),r(58),r(182),r(18),r(5),r(134);var i=n.asn1,o=e.exports=n.pkcs7=n.pkcs7||{};function s(e){var t={},r=[];if(!i.validate(e,o.asn1.recipientInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw s.errors=r,s}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function a(e){for(var t,r=[],o=0;o<e.length;++o)r.push((t=e[o],i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:t.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(t.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function c(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),o=0;o<e.unauthenticatedAttributes.length;++o){var s=e.unauthenticatedAttributes[o];r.values.push(u(s))}t.value.push(r)}return t}function u(e){var t;if(e.type===n.pki.oids.contentType)t=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),o=new Date("2050-01-01T00:00:00Z"),s=e.value;if("string"==typeof s){var a=Date.parse(s);s=isNaN(a)?13===s.length?i.utcTimeToDate(s):i.generalizedTimeToDate(s):new Date(a)}t=s>=r&&s<o?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(s)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(s))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[t])])}function l(e,t,r){var o={};if(!i.validate(t,r,o,[])){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}if(i.derToOid(o.contentType)!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(o.encryptedContent){var a="";if(n.util.isArray(o.encryptedContent))for(var c=0;c<o.encryptedContent.length;++c){if(o.encryptedContent[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=o.encryptedContent[c].value}else a=o.encryptedContent;e.encryptedContent={algorithm:i.derToOid(o.encAlgorithm),parameter:n.util.createBuffer(o.encParameter.value),content:n.util.createBuffer(a)}}if(o.content){a="";if(n.util.isArray(o.content))for(c=0;c<o.content.length;++c){if(o.content[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=o.content[c].value}else a=o.content;e.content=n.util.createBuffer(a)}return e.version=o.version.charCodeAt(0),e.rawCapture=o,o}function h(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}o.messageFromPem=function(e){var t=n.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.messageFromAsn1(s)},o.messageToPem=function(e,t){var r={type:"PKCS7",body:i.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},o.messageFromAsn1=function(e){var t={},r=[];if(!i.validate(e,o.asn1.contentInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw s.errors=r,s}var a,c=i.derToOid(t.contentType);switch(c){case n.pki.oids.envelopedData:a=o.createEnvelopedData();break;case n.pki.oids.encryptedData:a=o.createEncryptedData();break;case n.pki.oids.signedData:a=o.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},o.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(l(e,t,o.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,i=0;i<r.length;++i)e.certificates.push(n.pki.certificateFromAsn1(r[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var o=[],s=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,t)),o.length>0&&s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,o)),s.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),s])},addSigner:function(t){var r=t.issuer,i=t.serialNumber;if(t.certificate){var o=t.certificate;"string"==typeof o&&(o=n.pki.certificateFromPem(o)),r=o.issuer.attributes,i=o.serialNumber}var s=t.key;if(!s)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof s&&(s=n.pki.privateKeyFromPem(s));var a=t.digestAlgorithm||n.pki.oids.sha1;switch(a){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var u=!1,l=!1,h=0;h<c.length;++h){var p=c[h];if(u||p.type!==n.pki.oids.contentType){if(l||p.type!==n.pki.oids.messageDigest);else if(l=!0,u)break}else if(u=!0,l)break}if(!u||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:s,version:1,issuer:r,serialNumber:i,digestAlgorithm:a,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(){var t;"object"==typeof e.content&&null!==e.contentInfo||(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof n.util.ByteBuffer?t=e.content.bytes():"string"==typeof e.content&&(t=n.util.encodeUtf8(e.content)),e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t)]))));0!==e.signers.length&&function(t){if(e.contentInfo.value.length<2)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var r=i.derToOid(e.contentInfo.value[0].value),o=e.contentInfo.value[1];o=o.value[0];var s=i.toDer(o);for(var a in s.getByte(),i.getBerValueLength(s),s=s.getBytes(),t)t[a].start().update(s);for(var l=new Date,h=0;h<e.signers.length;++h){var p=e.signers[h];if(0===p.authenticatedAttributes.length){if(r!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{p.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),d=0;d<p.authenticatedAttributes.length;++d){var g=p.authenticatedAttributes[d];g.type===n.pki.oids.messageDigest?g.value=t[p.digestAlgorithm].digest():g.type===n.pki.oids.signingTime&&(g.value||(g.value=l)),f.value.push(u(g)),p.authenticatedAttributesAsn1.value.push(u(g))}s=i.toDer(f).getBytes(),p.md.start().update(s)}p.signature=p.key.sign(p.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(c(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var o=e.signers[r],s=o.digestAlgorithm;s in t||(t[s]=n.md[n.pki.oids[s]].create()),0===o.authenticatedAttributes.length?o.md=t[s]:o.md=n.md[n.pki.oids[s]].create()}for(var s in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},o.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){l(e,t,o.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),h(e)}}},o.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=l(e,t,o.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(s(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,a(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,(t=e.encryptedContent,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.parameter.getBytes())]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],o=i.issuer;if(i.serialNumber===t.serialNumber&&o.length===r.length){for(var s=!0,a=0;a<r.length;++a)if(o[a].type!==r[a].type||o[a].value!==r[a].value){s=!1;break}if(s)return i}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var i=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}h(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var i,o,s;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids["aes128-CBC"]:i=16,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:i=24,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:i=32,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:i=24,o=8,s=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(i));else if(t.length()!=i)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+i+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(o));var a=s(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var u=e.recipients[c];if(void 0===u.encryptedContent.content)switch(u.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}}}},function(e,t,r){var n=r(2);r(52),r(74),r(132),r(75),r(5);var i=e.exports=n.ssh=n.ssh||{};function o(e,t){var r=t.toString(16);r[0]>="8"&&(r="00"+r);var i=n.util.hexToBytes(r);e.putInt32(i.length),e.putBytes(i)}function s(e,t){e.putInt32(t.length),e.putString(t)}function a(){for(var e=n.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}i.privateKeyToPutty=function(e,t,r){var i=""===(t=t||"")?"none":"aes256-cbc",c="PuTTY-User-Key-File-2: ssh-rsa\r\n";c+="Encryption: "+i+"\r\n",c+="Comment: "+(r=r||"")+"\r\n";var u=n.util.createBuffer();s(u,"ssh-rsa"),o(u,e.e),o(u,e.n);var l=n.util.encode64(u.bytes(),64),h=Math.floor(l.length/66)+1;c+="Public-Lines: "+h+"\r\n",c+=l;var p,f=n.util.createBuffer();if(o(f,e.d),o(f,e.p),o(f,e.q),o(f,e.qInv),t){var d=f.length()+16-1;d-=d%16;var g=a(f.bytes());g.truncate(g.length()-d+f.length()),f.putBuffer(g);var m=n.util.createBuffer();m.putBuffer(a("\0\0\0\0",t)),m.putBuffer(a("\0\0\0",t));var y=n.aes.createEncryptionCipher(m.truncate(8),"CBC");y.start(n.util.createBuffer().fillWithByte(0,16)),y.update(f.copy()),y.finish();var v=y.output;v.truncate(16),p=n.util.encode64(v.bytes(),64)}else p=n.util.encode64(f.bytes(),64);c+="\r\nPrivate-Lines: "+(h=Math.floor(p.length/66)+1)+"\r\n",c+=p;var b=a("putty-private-key-file-mac-key",t),_=n.util.createBuffer();s(_,"ssh-rsa"),s(_,i),s(_,r),_.putInt32(u.length()),_.putBuffer(u),_.putInt32(f.length()),_.putBuffer(f);var E=n.hmac.create();return E.start("sha1",b),E.update(_.bytes()),c+="\r\nPrivate-MAC: "+E.digest().toHex()+"\r\n"},i.publicKeyToOpenSSH=function(e,t){t=t||"";var r=n.util.createBuffer();return s(r,"ssh-rsa"),o(r,e.e),o(r,e.n),"ssh-rsa "+n.util.encode64(r.bytes())+" "+t},i.privateKeyToOpenSSH=function(e,t){return t?n.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):n.pki.privateKeyToPem(e)},i.getPublicKeyFingerprint=function(e,t){var r=(t=t||{}).md||n.md.md5.create(),i=n.util.createBuffer();s(i,"ssh-rsa"),o(i,e.e),o(i,e.n),r.start(),r.update(i.getBytes());var a=r.digest();if("hex"===t.encoding){var c=a.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a}},function(e,t,r){var n=r(2);r(184),r(186),r(5);var i="forge.task",o={},s=0;n.debug.set(i,"tasks",o);var a={};n.debug.set(i,"queues",a);var c="ready",u="running",l="blocked",h="sleeping",p="done",f="error",d={ready:{}};d.ready.stop=c,d.ready.start=u,d.ready.cancel=p,d.ready.fail=f,d.running={},d.running.stop=c,d.running.start=u,d.running.block=l,d.running.unblock=u,d.running.sleep=h,d.running.wakeup=u,d.running.cancel=p,d.running.fail=f,d.blocked={},d.blocked.stop=l,d.blocked.start=l,d.blocked.block=l,d.blocked.unblock=l,d.blocked.sleep=l,d.blocked.wakeup=l,d.blocked.cancel=p,d.blocked.fail=f,d.sleeping={},d.sleeping.stop=h,d.sleeping.start=h,d.sleeping.block=h,d.sleeping.unblock=h,d.sleeping.sleep=h,d.sleeping.wakeup=h,d.sleeping.cancel=p,d.sleeping.fail=f,d.done={},d.done.stop=p,d.done.start=p,d.done.block=p,d.done.unblock=p,d.done.sleep=p,d.done.wakeup=p,d.done.cancel=p,d.done.fail=f,d.error={},d.error.stop=f,d.error.start=f,d.error.block=f,d.error.unblock=f,d.error.sleep=f,d.error.wakeup=f,d.error.cancel=f,d.error.fail=f;var g=function(e){this.id=-1,this.name=e.name||"?",this.parent=e.parent||null,this.run=e.run,this.subtasks=[],this.error=!1,this.state=c,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=s++,o[this.id]=this};g.prototype.debug=function(e){e=e||"",n.log.debug(i,e,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",a)},g.prototype.next=function(e,t){"function"==typeof e&&(t=e,e=this.name);var r=new g({run:t,name:e,parent:this});return r.state=u,r.type=this.type,r.successCallback=this.successCallback||null,r.failureCallback=this.failureCallback||null,this.subtasks.push(r),this},g.prototype.parallel=function(e,t){return n.util.isArray(e)&&(t=e,e=this.name),this.next(e,function(r){var i=r;i.block(t.length);for(var o=function(e,r){n.task.start({type:e,run:function(e){t[r](e)},success:function(e){i.unblock()},failure:function(e){i.unblock()}})},s=0;s<t.length;s++){o(e+"__parallel-"+r.id+"-"+s,s)}})},g.prototype.stop=function(){this.state=d[this.state].stop},g.prototype.start=function(){this.error=!1,this.state=d[this.state].start,this.state===u&&(this.start=new Date,this.run(this),m(this,0))},g.prototype.block=function(e){e=void 0===e?1:e,this.blocks+=e,this.blocks>0&&(this.state=d[this.state].block)},g.prototype.unblock=function(e){return e=void 0===e?1:e,this.blocks-=e,0===this.blocks&&this.state!==p&&(this.state=u,m(this,0)),this.blocks},g.prototype.sleep=function(e){e=void 0===e?0:e,this.state=d[this.state].sleep;var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=null,t.state=u,m(t,0)},e)},g.prototype.wait=function(e){e.wait(this)},g.prototype.wakeup=function(){this.state===h&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=u,m(this,0))},g.prototype.cancel=function(){this.state=d[this.state].cancel,this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},g.prototype.fail=function(e){if(this.error=!0,y(this,!0),e)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,m(e,0);else{if(null!==this.parent){for(var t=this.parent;null!==t.parent;)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;y(t,!0)}this.failureCallback&&this.failureCallback(this)}};var m=function(e,t){var r=t>30||+new Date-e.swapTime>20,n=function(t){if(t++,e.state===u)if(r&&(e.swapTime=+new Date),e.subtasks.length>0){var n=e.subtasks.shift();n.error=e.error,n.swapTime=e.swapTime,n.userData=e.userData,n.run(n),n.error||m(n,t)}else y(e),e.error||null!==e.parent&&(e.parent.error=e.error,e.parent.swapTime=e.swapTime,e.parent.userData=e.userData,m(e.parent,t))};r?setTimeout(n,0):n(t)},y=function(e,t){e.state=p,delete o[e.id],null===e.parent&&(e.type in a?0===a[e.type].length?n.log.error(i,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type):a[e.type][0]!==e?n.log.error(i,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type):(a[e.type].shift(),0===a[e.type].length?delete a[e.type]:a[e.type][0].start()):n.log.error(i,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type),t||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};e.exports=n.task=n.task||{},n.task.start=function(e){var t=new g({run:e.run,name:e.name||"?"});t.type=e.type,t.successCallback=e.success||null,t.failureCallback=e.failure||null,t.type in a?a[e.type].push(t):(a[t.type]=[t],function(e){e.error=!1,e.state=d[e.state].start,setTimeout(function(){e.state===u&&(e.swapTime=+new Date,e.run(e),m(e,0))},0)}(t))},n.task.cancel=function(e){e in a&&(a[e]=[a[e][0]])},n.task.createCondition=function(){var e={tasks:{},wait:function(t){t.id in e.tasks||(t.block(),e.tasks[t.id]=t)},notify:function(){var t=e.tasks;for(var r in e.tasks={},t)t[r].unblock()}};return e}},function(e,t,r){var n=r(34).Buffer,i=r(189),o=r(190),s=r(9),a=r(191),c=r(4);function u(e,t){return n.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function l(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,i=e.encoding,s=o(t.alg),l=function(e,t,r){r=r||"utf8";var n=u(a(e),"binary"),i=u(a(t),r);return c.format("%s.%s",n,i)}(t,r,i),h=s.sign(l,n);return c.format("%s.%s",l,h)}function h(e){var t=e.secret||e.privateKey||e.key,r=new i(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new i(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}c.inherits(h,s),h.prototype.sign=function(){try{var e=l({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},h.sign=l,e.exports=h},function(e,t,r){"use strict";var n=r(35).Buffer,i=r(35).SlowBuffer;function o(e,t){if(!n.isBuffer(e)||!n.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}e.exports=o,o.install=function(){n.prototype.equal=i.prototype.equal=function(e){return o(this,e)}};var s=n.prototype.equal,a=i.prototype.equal;o.restore=function(){n.prototype.equal=s,i.prototype.equal=a}},function(e,t,r){"use strict";var n=r(34).Buffer,i=r(304),o=128,s=48,a=2;function c(e){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function u(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=o&&--n,n}e.exports={derToJose:function(e,t){e=c(e);var r=i(t),u=r+1,l=e.length,h=0;if(e[h++]!==s)throw new Error('Could not find expected "seq"');var p=e[h++];if(p===(1|o)&&(p=e[h++]),l-h<p)throw new Error('"seq" specified length of "'+p+'", only "'+(l-h)+'" remaining');if(e[h++]!==a)throw new Error('Could not find expected "int" for "r"');var f=e[h++];if(l-h-2<f)throw new Error('"r" specified length of "'+f+'", only "'+(l-h-2)+'" available');if(u<f)throw new Error('"r" specified length of "'+f+'", max of "'+u+'" is acceptable');var d=h;if(h+=f,e[h++]!==a)throw new Error('Could not find expected "int" for "s"');var g=e[h++];if(l-h!==g)throw new Error('"s" specified length of "'+g+'", expected "'+(l-h)+'"');if(u<g)throw new Error('"s" specified length of "'+g+'", max of "'+u+'" is acceptable');var m=h;if((h+=g)!==l)throw new Error('Expected to consume entire buffer, but "'+(l-h)+'" bytes remain');var y=r-f,v=r-g,b=n.allocUnsafe(y+f+v+g);for(h=0;h<y;++h)b[h]=0;e.copy(b,h,d+Math.max(-y,0),d+f);for(var _=h=r;h<_+v;++h)b[h]=0;return e.copy(b,h,m+Math.max(-v,0),m+g),b=(b=b.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=c(e);var r=i(t),l=e.length;if(l!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+l+'"');var h=u(e,0,r),p=u(e,r,e.length),f=r-h,d=r-p,g=2+f+1+1+d,m=g<o,y=n.allocUnsafe((m?2:3)+g),v=0;return y[v++]=s,m?y[v++]=g:(y[v++]=1|o,y[v++]=255&g),y[v++]=a,y[v++]=f,h<0?(y[v++]=0,v+=e.copy(y,v,0,r)):v+=e.copy(y,v,h,r),y[v++]=a,y[v++]=d,p<0?(y[v++]=0,e.copy(y,v,r)):e.copy(y,v,r+p),y}}},function(e,t,r){"use strict";function n(e){return(e/8|0)+(e%8==0?0:1)}var i={ES256:n(256),ES384:n(384),ES512:n(521)};e.exports=function(e){var t=i[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')}},function(e,t,r){var n=r(34).Buffer,i=r(189),o=r(190),s=r(9),a=r(191),c=r(4),u=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function l(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function h(e){var t=e.split(".",1)[0];return l(n.from(t,"base64").toString("binary"))}function p(e){return e.split(".")[2]}function f(e){return u.test(e)&&!!h(e)}function d(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=p(e=a(e)),s=function(e){return e.split(".",2).join(".")}(e);return o(t).verify(s,i,r)}function g(e,t){if(t=t||{},!f(e=a(e)))return null;var r=h(e);if(!r)return null;var i=function(e,t){t=t||"utf8";var r=e.split(".")[1];return n.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(i=JSON.parse(i,t.encoding)),{header:r,payload:i,signature:p(e)}}function m(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new i(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new i(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}c.inherits(m,s),m.prototype.verify=function(){try{var e=d(this.signature.buffer,this.algorithm,this.key.buffer),t=g(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},m.decode=g,m.isValid=f,m.verify=d,e.exports=m},function(e,t,r){var n=r(113),i=r(192),o=r(193),s=r(188),a=r(194),c=r(76),u=r(114);e.exports=function(e,t,r,l){var h;if("function"!=typeof r||l||(l=r,r={}),r||(r={}),h=l||function(e,t){if(e)throw e;return t},(r=u(r)).clockTimestamp&&"number"!=typeof r.clockTimestamp)return h(new n("clockTimestamp must be a number"));var p=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return h(new n("jwt must be provided"));if("string"!=typeof e)return h(new n("jwt must be a string"));var f=e.split(".");if(3!==f.length)return h(new n("jwt malformed"));var d,g=""!==f[2].trim();if(!g&&t)return h(new n("jwt signature is required"));if(g&&!t)return h(new n("secret or public key must be provided"));g||r.algorithms||(r.algorithms=["none"]),r.algorithms||(r.algorithms=~t.toString().indexOf("BEGIN CERTIFICATE")||~t.toString().indexOf("BEGIN PUBLIC KEY")?["RS256","RS384","RS512","ES256","ES384","ES512"]:~t.toString().indexOf("BEGIN RSA PUBLIC KEY")?["RS256","RS384","RS512"]:["HS256","HS384","HS512"]);try{d=c.decode(e)}catch(e){return h(e)}if(!d)return h(new n("invalid token"));var m,y,v=d.header;if(!~r.algorithms.indexOf(v.alg))return h(new n("invalid algorithm"));try{m=c.verify(e,v.alg,t)}catch(e){return h(e)}if(!m)return h(new n("invalid signature"));try{y=s(e)}catch(e){return h(e)}if(void 0!==y.nbf&&!r.ignoreNotBefore){if("number"!=typeof y.nbf)return h(new n("invalid nbf value"));if(y.nbf>p+(r.clockTolerance||0))return h(new i("jwt not active",new Date(1e3*y.nbf)))}if(void 0!==y.exp&&!r.ignoreExpiration){if("number"!=typeof y.exp)return h(new n("invalid exp value"));if(p>=y.exp+(r.clockTolerance||0))return h(new o("jwt expired",new Date(1e3*y.exp)))}if(r.audience){var b=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(y.aud)?y.aud:[y.aud]).some(function(e){return b.some(function(t){return t instanceof RegExp?t.test(e):t===e})}))return h(new n("jwt audience invalid. expected: "+b.join(" or ")))}if(r.issuer&&("string"==typeof r.issuer&&y.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(y.iss)))return h(new n("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&y.sub!==r.subject)return h(new n("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&y.jti!==r.jwtid)return h(new n("jwt jwtid invalid. expected: "+r.jwtid));if(r.maxAge){if("number"!=typeof y.iat)return h(new n("iat required when maxAge is specified"));var _=a(r.maxAge,y.iat);if(void 0===_)return h(new n('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(p>=_+(r.clockTolerance||0))return h(new o("maxAge exceeded",new Date(1e3*_)))}return h(null,y)}},function(e,t,r){var n=r(194),i=r(114),o=r(76),s=r(308),a=r(309),c=r(310),u=r(311),l=r(312),h=r(196),p=r(313),f={expiresIn:{isValid:function(e){return c(e)||h(e)},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return c(e)||h(e)},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return h(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:s.bind(null,["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"]),message:'"algorithm" must be a valid string enum value'},header:{isValid:l,message:'"header" must be an object'},encoding:{isValid:h,message:'"encoding" must be a string'},issuer:{isValid:h,message:'"issuer" must be a string'},subject:{isValid:h,message:'"subject" must be a string'},jwtid:{isValid:h,message:'"jwtid" must be a string'},noTimestamp:{isValid:a,message:'"noTimestamp" must be a boolean'},keyid:{isValid:h,message:'"keyid" must be a string'}},d={iat:{isValid:u,message:'"iat" should be a number of seconds'},exp:{isValid:u,message:'"exp" should be a number of seconds'},nbf:{isValid:u,message:'"nbf" should be a number of seconds'}};function g(e,t,r,n){if(!l(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach(function(i){var o=e[i];if(o){if(!o.isValid(r[i]))throw new Error(o.message)}else if(!t)throw new Error('"'+i+'" is not allowed in "'+n+'"')})}var m={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},y=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];e.exports=function(e,t,r,s){"function"==typeof r?(s=r,r={}):r=r||{};var a="object"==typeof e&&!Buffer.isBuffer(e),c=i({alg:r.algorithm||"HS256",typ:a?"JWT":void 0,kid:r.keyid},r.header);function u(e){if(s)return s(e);throw e}if(!t&&"none"!==r.algorithm)return u(new Error("secretOrPrivateKey must have a value"));if(void 0===e)return u(new Error("payload is required"));if(a){try{!function(e){g(d,!0,e,"payload")}(e)}catch(e){return u(e)}e=i(e)}else{var l=y.filter(function(e){return void 0!==r[e]});if(l.length>0)return u(new Error("invalid "+l.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==r.expiresIn)return u(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==r.notBefore)return u(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){g(f,!1,e,"options")}(r)}catch(e){return u(e)}var h=e.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete e.iat:e.iat=h,void 0!==r.notBefore&&(e.nbf=n(r.notBefore),void 0===e.nbf))return u(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(void 0!==r.expiresIn&&"object"==typeof e&&(e.exp=n(r.expiresIn,h),void 0===e.exp))return u(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));Object.keys(m).forEach(function(t){var n=m[t];if(void 0!==r[t]){if(void 0!==e[n])return u(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=r[t]}});var v=r.encoding||"utf8";if("function"!=typeof s)return o.sign({header:c,payload:e,secret:t,encoding:v});s=s&&p(s),o.createSign({header:c,privateKey:t,payload:e,encoding:v}).once("error",s).once("done",function(e){s(null,e)})}},function(e,t){var r=1/0,n=9007199254740991,i=1.7976931348623157e308,o=NaN,s="[object Arguments]",a="[object Function]",c="[object GeneratorFunction]",u="[object String]",l="[object Symbol]",h=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,d=/^0o[0-7]+$/i,g=/^(?:0|[1-9]\d*)$/,m=parseInt;function y(e){return e!=e}function v(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(t,function(t){return e[t]})}var b,_,E=Object.prototype,C=E.hasOwnProperty,w=E.toString,S=E.propertyIsEnumerable,T=(b=Object.keys,_=Object,function(e){return b(_(e))}),A=Math.max;function I(e,t){var r=R(e)||function(e){return function(e){return B(e)&&O(e)}(e)&&C.call(e,"callee")&&(!S.call(e,"callee")||w.call(e)==s)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var o in e)!t&&!C.call(e,o)||i&&("length"==o||k(o,n))||r.push(o);return r}function N(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||E,t!==n)return T(e);var t,r,n,i=[];for(var o in Object(e))C.call(e,o)&&"constructor"!=o&&i.push(o);return i}function k(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||g.test(e))&&e>-1&&e%1==0&&e<t}var R=Array.isArray;function O(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}(e.length)&&!function(e){var t=x(e)?w.call(e):"";return t==a||t==c}(e)}function x(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function B(e){return!!e&&"object"==typeof e}e.exports=function(e,t,n,s){var a;e=O(e)?e:(a=e)?v(a,function(e){return O(e)?I(e):N(e)}(a)):[],n=n&&!s?function(e){var t=function(e){if(!e)return 0===e?e:0;if((e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||B(e)&&w.call(e)==l}(e))return o;if(x(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=x(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(h,"");var r=f.test(e);return r||d.test(e)?m(e.slice(2),r?2:8):p.test(e)?o:+e}(e))===r||e===-r){var t=e<0?-1:1;return t*i}return e==e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}(n):0;var c=e.length;return n<0&&(n=A(c+n,0)),function(e){return"string"==typeof e||!R(e)&&B(e)&&w.call(e)==u}(e)?n<=c&&e.indexOf(t,n)>-1:!!c&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,y,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,n)>-1}},function(e,t){var r="[object Boolean]",n=Object.prototype.toString;e.exports=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&n.call(e)==r}},function(e,t){var r=1/0,n=1.7976931348623157e308,i=NaN,o="[object Symbol]",s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt,h=Object.prototype.toString;function p(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return"number"==typeof e&&e==function(e){var t=function(e){if(!e)return 0===e?e:0;if((e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&h.call(e)==o}(e))return i;if(p(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=p(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var r=c.test(e);return r||u.test(e)?l(e.slice(2),r?2:8):a.test(e)?i:+e}(e))===r||e===-r){var t=e<0?-1:1;return t*n}return e==e?e:0}(e),f=t%1;return t==t?f?t-f:t:0}(e)}},function(e,t){var r="[object Number]",n=Object.prototype.toString;e.exports=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&n.call(e)==r}},function(e,t){var r="[object Object]";var n,i,o=Function.prototype,s=Object.prototype,a=o.toString,c=s.hasOwnProperty,u=a.call(Object),l=s.toString,h=(n=Object.getPrototypeOf,i=Object,function(e){return n(i(e))});e.exports=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||l.call(e)!=r||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=h(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&a.call(n)==u}},function(e,t){var r="Expected a function",n=1/0,i=1.7976931348623157e308,o=NaN,s="[object Symbol]",a=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,h=parseInt,p=Object.prototype.toString;function f(e,t){var f;if("function"!=typeof t)throw new TypeError(r);return e=function(e){var t=function(e){if(!e)return 0===e?e:0;if((e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&p.call(e)==s}(e))return o;if(d(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=d(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var r=u.test(e);return r||l.test(e)?h(e.slice(2),r?2:8):c.test(e)?o:+e}(e))===n||e===-n){var t=e<0?-1:1;return t*i}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e),function(){return--e>0&&(f=t.apply(this,arguments)),e<=1&&(t=void 0),f}}function d(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return f(2,e)}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(39),i=r(24),o=r(10);function s(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}return null}var a=function(){function e(e){i.addReadonlyGetter(this,"creationTime",s(e.createdAt)),i.addReadonlyGetter(this,"lastSignInTime",s(e.lastLoginAt))}return e.prototype.toJSON=function(){return{lastSignInTime:this.lastSignInTime,creationTime:this.creationTime}},e}();t.UserMetadata=a;var c=function(){function e(e){if(!e.rawId||!e.providerId)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Invalid user info response");i.addReadonlyGetter(this,"uid",e.rawId),i.addReadonlyGetter(this,"displayName",e.displayName),i.addReadonlyGetter(this,"email",e.email),i.addReadonlyGetter(this,"photoURL",e.photoUrl),i.addReadonlyGetter(this,"providerId",e.providerId),i.addReadonlyGetter(this,"phoneNumber",e.phoneNumber)}return e.prototype.toJSON=function(){return{uid:this.uid,displayName:this.displayName,email:this.email,photoURL:this.photoURL,providerId:this.providerId,phoneNumber:this.phoneNumber}},e}();t.UserInfo=c;var u=function(){function e(e){if(!e.localId)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Invalid user response");i.addReadonlyGetter(this,"uid",e.localId),i.addReadonlyGetter(this,"email",e.email),i.addReadonlyGetter(this,"emailVerified",!!e.emailVerified),i.addReadonlyGetter(this,"displayName",e.displayName),i.addReadonlyGetter(this,"photoURL",e.photoUrl),i.addReadonlyGetter(this,"phoneNumber",e.phoneNumber),i.addReadonlyGetter(this,"disabled",e.disabled||!1),i.addReadonlyGetter(this,"metadata",new a(e));for(var t=[],r=0,n=e.providerUserInfo||[];r<n.length;r++){var u=n[r];t.push(new c(u))}i.addReadonlyGetter(this,"providerData",t),i.addReadonlyGetter(this,"passwordHash",e.passwordHash),i.addReadonlyGetter(this,"passwordSalt",e.salt);try{i.addReadonlyGetter(this,"customClaims",JSON.parse(e.customAttributes))}catch(e){i.addReadonlyGetter(this,"customClaims",void 0)}var l=null;void 0!==e.validSince&&(l=s(1e3*e.validSince)),i.addReadonlyGetter(this,"tokensValidAfterTime",l)}return e.prototype.toJSON=function(){for(var e={uid:this.uid,email:this.email,emailVerified:this.emailVerified,displayName:this.displayName,photoURL:this.photoURL,phoneNumber:this.phoneNumber,disabled:this.disabled,metadata:this.metadata.toJSON(),passwordHash:this.passwordHash,passwordSalt:this.passwordSalt,customClaims:n.deepCopy(this.customClaims),tokensValidAfterTime:this.tokensValidAfterTime,providerData:[]},t=0,r=this.providerData;t<r.length;t++){var i=r[t];e.providerData.push(i.toJSON())}return e},e}();t.UserRecord=u},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(50),o=r(11),s=r(24),a=["acr","amr","at_hash","aud","auth_time","azp","cnf","c_hash","exp","iat","iss","jti","nbf","nonce"],c=function(){function e(e){if(!e)throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_CREDENTIAL,"INTERNAL ASSERT: Must provide a certificate to initialize ServiceAccountSigner.");if(!o.isNonEmptyString(e.clientEmail)||!o.isNonEmptyString(e.privateKey))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_CREDENTIAL,"INTERNAL ASSERT: Must provide a certificate with validate clientEmail and privateKey to initialize ServiceAccountSigner.");this.certificate=e}return e.prototype.sign=function(e){var t=r(33).createSign("RSA-SHA256");return t.update(e),Promise.resolve(t.sign(this.certificate.privateKey))},e.prototype.getAccountId=function(){return Promise.resolve(this.certificate.clientEmail)},e}();t.ServiceAccountSigner=c;var u=function(){function e(e,t){if(!e)throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"INTERNAL ASSERT: Must provide a HTTP client to initialize IAMSigner.");if(void 0!==t&&!o.isNonEmptyString(t))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"INTERNAL ASSERT: Service account ID must be undefined or a non-empty string.");this.httpClient=e,this.serviceAccountId=t}return e.prototype.sign=function(e){var t=this;return this.getAccountId().then(function(r){var n={method:"POST",url:"https://iam.googleapis.com/v1/projects/-/serviceAccounts/"+r+":signBlob",data:{bytesToSign:e.toString("base64")}};return t.httpClient.send(n)}).then(function(e){return Buffer.from(e.data.signature,"base64")}).catch(function(e){if(e instanceof i.HttpError){var t=e.response.data,r=void 0,s=void 0;if(o.isNonNullObject(t)&&t.error){r=t.error.status||null;s=t.error.message+"; Please refer to https://firebase.google.com/docs/auth/admin/create-custom-tokens for more details on how to use and troubleshoot this feature."||null}throw n.FirebaseAuthError.fromServerError(r,s,t)}throw e})},e.prototype.getAccountId=function(){var e=this;if(o.isNonEmptyString(this.serviceAccountId))return Promise.resolve(this.serviceAccountId);return(new i.HttpClient).send({method:"GET",url:"http://metadata/computeMetadata/v1/instance/service-accounts/default/email",headers:{"Metadata-Flavor":"Google"}}).then(function(t){return e.serviceAccountId=t.text,e.serviceAccountId}).catch(function(e){throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_CREDENTIAL,"Failed to determine service account. Make sure to initialize the SDK with a service account credential. Alternatively specify a service account with iam.serviceAccounts.signBlob permission. Original error: "+e)})},e}();t.IAMSigner=u,t.cryptoSignerFromApp=function(e){var t=e.options.credential.getCertificate();return null!=t&&o.isNonEmptyString(t.privateKey)&&o.isNonEmptyString(t.clientEmail)?new c(t):new u(new i.AuthorizedHttpClient(e),e.options.serviceAccountId)};var l=function(){function e(e){if(!o.isNonNullObject(e))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_CREDENTIAL,"INTERNAL ASSERT: Must provide a CryptoSigner to use FirebaseTokenGenerator.");this.signer=e}return e.prototype.createCustomToken=function(e,t){var r,i=this;if("string"!=typeof e||""===e?r="First argument to createCustomToken() must be a non-empty string uid.":e.length>128?r="First argument to createCustomToken() must a uid with less than or equal to 128 characters.":this.isDeveloperClaimsValid_(t)||(r="Second argument to createCustomToken() must be an object containing the developer claims."),void 0!==r)throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,r);var o={};if(void 0!==t)for(var s in t)if(t.hasOwnProperty(s)){if(-1!==a.indexOf(s))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,'Developer claim "'+s+'" is reserved and cannot be specified.');o[s]=t[s]}return this.signer.getAccountId().then(function(t){var r={alg:"RS256",typ:"JWT"},n=Math.floor(Date.now()/1e3),s={aud:"https://identitytoolkit.googleapis.com/google.identity.identitytoolkit.v1.IdentityToolkit",iat:n,exp:n+3600,iss:t,sub:t,uid:e};Object.keys(o).length>0&&(s.claims=o);var a=i.encodeSegment(r)+"."+i.encodeSegment(s),c=i.signer.sign(Buffer.from(a));return Promise.all([a,c])}).then(function(e){var t=e[0],r=e[1];return t+"."+i.encodeSegment(r)})},e.prototype.encodeSegment=function(e){var t=e instanceof Buffer?e:Buffer.from(JSON.stringify(e));return s.toWebSafeBase64(t).replace(/\=+$/,"")},e.prototype.isDeveloperClaimsValid_=function(e){return void 0===e||o.isNonNullObject(e)},e}();t.FirebaseTokenGenerator=l},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(39),o=r(10),s=r(50),a=r(317),c=r(24),u=r(318),l={"X-Client-Version":"Node/Admin/6.3.0"};t.RESERVED_CLAIMS=["acr","amr","at_hash","aud","auth_time","azp","cnf","c_hash","exp","iat","iss","jti","nbf","nonce","sub","firebase"],t.EMAIL_ACTION_REQUEST_TYPES=["PASSWORD_RESET","VERIFY_EMAIL","EMAIL_SIGNIN"];var h=1e3,p="https://identitytoolkit.googleapis.com/{version}/projects/{projectId}{api}",f=function(){function e(e,t){void 0===t&&(t="v1"),this.projectId=e,this.version=t,this.urlFormat=p}return e.prototype.getUrl=function(e,t){var r={version:this.version,projectId:this.projectId,api:e||""},n=c.formatString(this.urlFormat,r);return c.formatString(n,t||{})},e}();function d(e,r){void 0===r&&(r=!1);var i={displayName:!0,localId:!0,email:!0,password:!0,rawPassword:!0,emailVerified:!0,photoUrl:!0,disabled:!0,disableUser:!0,deleteAttribute:!0,deleteProvider:!0,sanityCheck:!0,phoneNumber:!0,customAttributes:!0,validSince:!0,passwordHash:r,salt:r,createdAt:r,lastLoginAt:r,providerUserInfo:r};for(var s in e)s in i||delete e[s];if(void 0!==e.displayName&&!n.isString(e.displayName))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_DISPLAY_NAME);if((void 0!==e.localId||r)&&!n.isUid(e.localId))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_UID);if(void 0!==e.email&&!n.isEmail(e.email))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_EMAIL);if(void 0!==e.phoneNumber&&!n.isPhoneNumber(e.phoneNumber))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PHONE_NUMBER);if(void 0!==e.password&&!n.isPassword(e.password))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PASSWORD);if(void 0!==e.rawPassword&&!n.isPassword(e.rawPassword))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PASSWORD);if(void 0!==e.emailVerified&&"boolean"!=typeof e.emailVerified)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_EMAIL_VERIFIED);if(void 0!==e.photoUrl&&!n.isURL(e.photoUrl))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PHOTO_URL);if(void 0!==e.disabled&&"boolean"!=typeof e.disabled)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_DISABLED_FIELD);if(void 0!==e.validSince&&!n.isNumber(e.validSince))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_TOKENS_VALID_AFTER_TIME);if(void 0!==e.createdAt&&!n.isNumber(e.createdAt))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_CREATION_TIME);if(void 0!==e.lastLoginAt&&!n.isNumber(e.lastLoginAt))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_LAST_SIGN_IN_TIME);if(void 0!==e.disableUser&&"boolean"!=typeof e.disableUser)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_DISABLED_FIELD);if(void 0!==e.customAttributes){var a;try{a=JSON.parse(e.customAttributes)}catch(e){throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_CLAIMS,e.message)}var c=[];if(t.RESERVED_CLAIMS.forEach(function(e){a.hasOwnProperty(e)&&c.push(e)}),c.length>0)throw new o.FirebaseAuthError(o.AuthClientErrorCode.FORBIDDEN_CLAIM,c.length>1?'Developer claims "'+c.join('", "')+'" are reserved and cannot be specified.':'Developer claim "'+c[0]+'" is reserved and cannot be specified.');if(e.customAttributes.length>h)throw new o.FirebaseAuthError(o.AuthClientErrorCode.CLAIMS_TOO_LARGE,"Developer claims payload should not exceed "+h+" characters.")}if(void 0!==e.passwordHash&&!n.isString(e.passwordHash))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PASSWORD_HASH);if(void 0!==e.salt&&!n.isString(e.salt))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PASSWORD_SALT);if(void 0!==e.providerUserInfo&&!n.isArray(e.providerUserInfo))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PROVIDER_DATA);n.isArray(e.providerUserInfo)&&e.providerUserInfo.forEach(function(e){!function(e){var t={rawId:!0,providerId:!0,email:!0,displayName:!0,photoUrl:!0};for(var r in e)r in t||delete e[r];if(!n.isNonEmptyString(e.providerId))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PROVIDER_ID);if(void 0!==e.displayName&&"string"!=typeof e.displayName)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_DISPLAY_NAME,'The provider "displayName" for "'+e.providerId+'" must be a valid string.');if(!n.isNonEmptyString(e.rawId))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_UID,'The provider "uid" for "'+e.providerId+'" must be a valid non-empty string.');if(void 0!==e.email&&!n.isEmail(e.email))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_EMAIL,'The provider "email" for "'+e.providerId+'" must be a valid email string.');if(void 0!==e.photoUrl&&!n.isURL(e.photoUrl))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PHOTO_URL,'The provider "photoURL" for "'+e.providerId+'" must be a valid URL string.')}(e)})}t.FIREBASE_AUTH_CREATE_SESSION_COOKIE=new s.ApiSettings(":createSessionCookie","POST").setRequestValidator(function(e){if(!n.isNonEmptyString(e.idToken))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ID_TOKEN);if(!n.isNumber(e.validDuration)||e.validDuration<300||e.validDuration>1209600)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_SESSION_COOKIE_DURATION)}).setResponseValidator(function(e){if(!n.isNonEmptyString(e.sessionCookie))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR)}),t.FIREBASE_AUTH_UPLOAD_ACCOUNT=new s.ApiSettings("/accounts:batchCreate","POST"),t.FIREBASE_AUTH_DOWNLOAD_ACCOUNT=new s.ApiSettings("/accounts:batchGet","GET").setRequestValidator(function(e){if(void 0!==e.nextPageToken&&!n.isNonEmptyString(e.nextPageToken))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PAGE_TOKEN);if(!n.isNumber(e.maxResults)||e.maxResults<=0||e.maxResults>1e3)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ARGUMENT,'Required "maxResults" must be a positive non-zero number that does not exceed the allowed 1000.')}),t.FIREBASE_AUTH_GET_ACCOUNT_INFO=new s.ApiSettings("/accounts:lookup","POST").setRequestValidator(function(e){if(!e.localId&&!e.email&&!e.phoneNumber)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Server request is missing user identifier")}).setResponseValidator(function(e){if(!e.users)throw new o.FirebaseAuthError(o.AuthClientErrorCode.USER_NOT_FOUND)}),t.FIREBASE_AUTH_DELETE_ACCOUNT=new s.ApiSettings("/accounts:delete","POST").setRequestValidator(function(e){if(!e.localId)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Server request is missing user identifier")}),t.FIREBASE_AUTH_SET_ACCOUNT_INFO=new s.ApiSettings("/accounts:update","POST").setRequestValidator(function(e){if(void 0===e.localId)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Server request is missing user identifier");d(e)}).setResponseValidator(function(e){if(!e.localId)throw new o.FirebaseAuthError(o.AuthClientErrorCode.USER_NOT_FOUND)}),t.FIREBASE_AUTH_SIGN_UP_NEW_USER=new s.ApiSettings("/accounts","POST").setRequestValidator(function(e){if(void 0!==e.customAttributes)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ARGUMENT,'"customAttributes" cannot be set when creating a new user.');if(void 0!==e.validSince)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ARGUMENT,'"validSince" cannot be set when creating a new user.');d(e)}).setResponseValidator(function(e){if(!e.localId)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Unable to create new user")});var g=new s.ApiSettings("/accounts:sendOobCode","POST").setRequestValidator(function(e){if(!n.isEmail(e.email))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_EMAIL);if(-1===t.EMAIL_ACTION_REQUEST_TYPES.indexOf(e.requestType))throw new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ARGUMENT,'"'+e.requestType+'" is not a supported email action request type.')}).setResponseValidator(function(e){if(!e.oobLink)throw new o.FirebaseAuthError(o.AuthClientErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Unable to create the email action link")}),m=function(){function e(e){this.httpClient=new s.AuthorizedHttpClient(e),this.authUrlBuilder=new f(c.getProjectId(e),"v1")}return e.getErrorCode=function(e){return n.isNonNullObject(e)&&e.error&&e.error.message||null},e.prototype.createSessionCookie=function(e,r){var n={idToken:e,validDuration:r/1e3};return this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_CREATE_SESSION_COOKIE,n).then(function(e){return e.sessionCookie})},e.prototype.getAccountInfoByUid=function(e){if(!n.isUid(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_UID));var r={localId:[e]};return this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_GET_ACCOUNT_INFO,r)},e.prototype.getAccountInfoByEmail=function(e){if(!n.isEmail(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_EMAIL));var r={email:[e]};return this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_GET_ACCOUNT_INFO,r)},e.prototype.getAccountInfoByPhoneNumber=function(e){if(!n.isPhoneNumber(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_PHONE_NUMBER));var r={phoneNumber:[e]};return this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_GET_ACCOUNT_INFO,r)},e.prototype.downloadAccount=function(e,r){void 0===e&&(e=1e3);var n={maxResults:e,nextPageToken:r};return void 0===n.nextPageToken&&delete n.nextPageToken,this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_DOWNLOAD_ACCOUNT,n).then(function(e){return e.users||(e.users=[]),e})},e.prototype.uploadAccount=function(e,r){var i=new a.UserImportBuilder(e,r,function(e){d(e,!0)}),s=i.buildRequest();if(n.isArray(e)&&e.length>1e3)throw new o.FirebaseAuthError(o.AuthClientErrorCode.MAXIMUM_USER_COUNT_EXCEEDED,"A maximum of 1000 users can be imported at once.");return 0===s.users.length?Promise.resolve(i.buildResponse([])):this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_UPLOAD_ACCOUNT,s).then(function(e){var t=e.error||[];return i.buildResponse(t)})},e.prototype.deleteAccount=function(e){if(!n.isUid(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_UID));var r={localId:e};return this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_DELETE_ACCOUNT,r)},e.prototype.setCustomUserClaims=function(e,r){if(!n.isUid(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_UID));if(!n.isObject(r))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ARGUMENT,"CustomUserClaims argument must be an object or null."));null===r&&(r={});var i={localId:e,customAttributes:JSON.stringify(r)};return this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_SET_ACCOUNT_INFO,i).then(function(e){return e.localId})},e.prototype.updateExistingAccount=function(e,r){if(!n.isUid(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_UID));if(!n.isNonNullObject(r))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ARGUMENT,"Properties argument must be a non-null object."));var s=i.deepCopy(r);s.localId=e;var a={displayName:"DISPLAY_NAME",photoURL:"PHOTO_URL"};for(var c in s.deleteAttribute=[],a)null===s[c]&&(s.deleteAttribute.push(a[c]),delete s[c]);return 0===s.deleteAttribute.length&&delete s.deleteAttribute,null===s.phoneNumber?(s.deleteProvider=["phone"],delete s.phoneNumber):delete s.deleteProvider,void 0!==s.photoURL&&(s.photoUrl=s.photoURL,delete s.photoURL),void 0!==s.disabled&&(s.disableUser=s.disabled,delete s.disabled),this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_SET_ACCOUNT_INFO,s).then(function(e){return e.localId})},e.prototype.revokeRefreshTokens=function(e){if(!n.isUid(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_UID));var r={localId:e,validSince:Math.ceil((new Date).getTime()/1e3)};return this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_SET_ACCOUNT_INFO,r).then(function(e){return e.localId})},e.prototype.createNewAccount=function(e){if(!n.isNonNullObject(e))return Promise.reject(new o.FirebaseAuthError(o.AuthClientErrorCode.INVALID_ARGUMENT,"Properties argument must be a non-null object."));var r=i.deepCopy(e);return void 0!==r.photoURL&&(r.photoUrl=r.photoURL,delete r.photoURL),void 0!==r.uid&&(r.localId=r.uid,delete r.uid),this.invokeRequestHandler(this.authUrlBuilder,t.FIREBASE_AUTH_SIGN_UP_NEW_USER,r).then(function(e){return e.localId})},e.prototype.getEmailActionLink=function(e,t,r){var n={requestType:e,email:t,returnOobLink:!0};if(void 0!==r||"EMAIL_SIGNIN"===e)try{var o=new u.ActionCodeSettingsBuilder(r);n=i.deepExtend(n,o.buildRequest())}catch(e){return Promise.reject(e)}return this.invokeRequestHandler(this.authUrlBuilder,g,n).then(function(e){return e.oobLink})},e.prototype.invokeRequestHandler=function(t,r,n,i){var a=this;return Promise.resolve().then(function(){r.getRequestValidator()(n);var e={method:r.getHttpMethod(),url:t.getUrl(r.getEndpoint(),i),headers:l,data:n,timeout:25e3};return a.httpClient.send(e)}).then(function(e){return r.getResponseValidator()(e.data),e.data}).catch(function(t){if(t instanceof s.HttpError){var r=t.response.data,n=e.getErrorCode(r);throw o.FirebaseAuthError.fromServerError(n,void 0,r)}throw t})},e}();t.FirebaseAuthRequestHandler=m},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(39),i=r(24),o=r(11),s=r(10);function a(e,t){if(void 0!==e[t]&&null!==e[t])return parseInt(e[t].toString(),10)}var c=function(){function e(e,t,r){this.users=e,this.options=t,this.userRequestValidator=r,this.requiresHashOptions=!1,this.validatedUsers=[],this.userImportResultErrors=[],this.indexMap={},this.validatedUsers=this.populateUsers(this.users,this.userRequestValidator),this.validatedOptions=this.populateOptions(this.options,this.requiresHashOptions)}return e.prototype.buildRequest=function(){var e=this.validatedUsers.map(function(e){return n.deepCopy(e)});return n.deepExtend({users:e},n.deepCopy(this.validatedOptions))},e.prototype.buildResponse=function(e){var t=this,r={successCount:this.users.length-this.userImportResultErrors.length,failureCount:this.userImportResultErrors.length,errors:n.deepCopy(this.userImportResultErrors)};return r.failureCount+=e.length,r.successCount-=e.length,e.forEach(function(e){r.errors.push({index:t.indexMap[e.index],error:new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_USER_IMPORT,e.message)})}),r.errors.sort(function(e,t){return e.index-t.index}),r},e.prototype.populateOptions=function(e,t){var r,n;if(!t)return{};if(!o.isNonNullObject(e.hash))throw new s.FirebaseAuthError(s.AuthClientErrorCode.MISSING_HASH_ALGORITHM,'"hash.algorithm" is missing from the provided "UserImportOptions".');if(void 0===e.hash.algorithm||!o.isNonEmptyString(e.hash.algorithm))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_ALGORITHM,'"hash.algorithm" must be a string matching the list of supported algorithms.');switch(e.hash.algorithm){case"HMAC_SHA512":case"HMAC_SHA256":case"HMAC_SHA1":case"HMAC_MD5":if(!o.isBuffer(e.hash.key))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_KEY,'A non-empty "hash.key" byte buffer must be provided for hash algorithm '+e.hash.algorithm+".");r={hashAlgorithm:e.hash.algorithm,signerKey:i.toWebSafeBase64(e.hash.key)};break;case"MD5":case"SHA1":case"SHA256":case"SHA512":case"PBKDF_SHA1":case"PBKDF2_SHA256":if(n=a(e.hash,"rounds"),isNaN(n)||n<0||n>12e4)throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_ROUNDS,'A valid "hash.rounds" number between 0 and 120000 must be provided for hash algorithm '+e.hash.algorithm+".");r={hashAlgorithm:e.hash.algorithm,rounds:n};break;case"SCRYPT":if(!o.isBuffer(e.hash.key))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_KEY,'A "hash.key" byte buffer must be provided for hash algorithm '+e.hash.algorithm+".");if(n=a(e.hash,"rounds"),isNaN(n)||n<=0||n>8)throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_ROUNDS,'A valid "hash.rounds" number between 1 and 8 must be provided for hash algorithm '+e.hash.algorithm+".");var c=a(e.hash,"memoryCost");if(isNaN(c)||c<=0||c>14)throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_MEMORY_COST,'A valid "hash.memoryCost" number between 1 and 14 must be provided for hash algorithm '+e.hash.algorithm+".");if(void 0!==e.hash.saltSeparator&&!o.isBuffer(e.hash.saltSeparator))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_SALT_SEPARATOR,'"hash.saltSeparator" must be a byte buffer.');r={hashAlgorithm:e.hash.algorithm,signerKey:i.toWebSafeBase64(e.hash.key),rounds:n,memoryCost:c,saltSeparator:i.toWebSafeBase64(e.hash.saltSeparator||Buffer.from(""))};break;case"BCRYPT":r={hashAlgorithm:e.hash.algorithm};break;case"STANDARD_SCRYPT":var u=a(e.hash,"memoryCost");if(isNaN(u))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_MEMORY_COST,'A valid "hash.memoryCost" number must be provided for hash algorithm '+e.hash.algorithm+".");var l=a(e.hash,"parallelization");if(isNaN(l))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_PARALLELIZATION,'A valid "hash.parallelization" number must be provided for hash algorithm '+e.hash.algorithm+".");var h=a(e.hash,"blockSize");if(isNaN(h))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_BLOCK_SIZE,'A valid "hash.blockSize" number must be provided for hash algorithm '+e.hash.algorithm+".");var p=a(e.hash,"derivedKeyLength");if(isNaN(p))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_DERIVED_KEY_LENGTH,'A valid "hash.derivedKeyLength" number must be provided for hash algorithm '+e.hash.algorithm+".");r={hashAlgorithm:e.hash.algorithm,cpuMemCost:u,parallelization:l,blockSize:h,dkLen:p};break;default:throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_HASH_ALGORITHM,'Unsupported hash algorithm provider "'+e.hash.algorithm+'".')}return r},e.prototype.populateUsers=function(e,t){var r=this,n=[];return e.forEach(function(e,a){try{var c=function(e,t){var r,n={localId:e.uid,email:e.email,emailVerified:e.emailVerified,displayName:e.displayName,disabled:e.disabled,photoUrl:e.photoURL,phoneNumber:e.phoneNumber,providerUserInfo:[],customAttributes:e.customClaims&&JSON.stringify(e.customClaims)};if(void 0!==e.passwordHash){if(!o.isBuffer(e.passwordHash))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_PASSWORD_HASH);n.passwordHash=i.toWebSafeBase64(e.passwordHash)}if(void 0!==e.passwordSalt){if(!o.isBuffer(e.passwordSalt))throw new s.FirebaseAuthError(s.AuthClientErrorCode.INVALID_PASSWORD_SALT);n.salt=i.toWebSafeBase64(e.passwordSalt)}for(r in o.isNonNullObject(e.metadata)&&(o.isNonEmptyString(e.metadata.creationTime)&&(n.createdAt=new Date(e.metadata.creationTime).getTime()),o.isNonEmptyString(e.metadata.lastSignInTime)&&(n.lastLoginAt=new Date(e.metadata.lastSignInTime).getTime())),o.isArray(e.providerData)&&e.providerData.forEach(function(e){n.providerUserInfo.push({providerId:e.providerId,rawId:e.uid,email:e.email,displayName:e.displayName,photoUrl:e.photoURL})}),n)void 0===n[r]&&delete n[r];return 0===n.providerUserInfo.length&&delete n.providerUserInfo,"function"==typeof t&&t(n),n}(e,t);void 0!==c.passwordHash&&(r.requiresHashOptions=!0),n.push(c),r.indexMap[n.length-1]=a}catch(e){r.userImportResultErrors.push({index:a,error:e})}}),n},e}();t.UserImportBuilder=c},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(10),o=function(){function e(e){if(!n.isNonNullObject(e))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings" must be a non-null object.');if(void 0===e.url)throw new i.FirebaseAuthError(i.AuthClientErrorCode.MISSING_CONTINUE_URI);if(!n.isURL(e.url))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_CONTINUE_URI);if(this.continueUrl=e.url,void 0!==e.handleCodeInApp&&!n.isBoolean(e.handleCodeInApp))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings.handleCodeInApp" must be a boolean.');if(this.canHandleCodeInApp=e.handleCodeInApp||!1,void 0!==e.dynamicLinkDomain&&!n.isNonEmptyString(e.dynamicLinkDomain))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_DYNAMIC_LINK_DOMAIN);if(this.dynamicLinkDomain=e.dynamicLinkDomain,void 0!==e.iOS){if(!n.isNonNullObject(e.iOS))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings.iOS" must be a valid non-null object.');if(void 0===e.iOS.bundleId)throw new i.FirebaseAuthError(i.AuthClientErrorCode.MISSING_IOS_BUNDLE_ID);if(!n.isNonEmptyString(e.iOS.bundleId))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings.iOS.bundleId" must be a valid non-empty string.');this.ibi=e.iOS.bundleId}if(void 0!==e.android){if(!n.isNonNullObject(e.android))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings.android" must be a valid non-null object.');if(void 0===e.android.packageName)throw new i.FirebaseAuthError(i.AuthClientErrorCode.MISSING_ANDROID_PACKAGE_NAME);if(!n.isNonEmptyString(e.android.packageName))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings.android.packageName" must be a valid non-empty string.');if(void 0!==e.android.minimumVersion&&!n.isNonEmptyString(e.android.minimumVersion))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings.android.minimumVersion" must be a valid non-empty string.');if(void 0!==e.android.installApp&&!n.isBoolean(e.android.installApp))throw new i.FirebaseAuthError(i.AuthClientErrorCode.INVALID_ARGUMENT,'"ActionCodeSettings.android.installApp" must be a valid boolean.');this.apn=e.android.packageName,this.amv=e.android.minimumVersion,this.installApp=e.android.installApp||!1}}return e.prototype.buildRequest=function(){var e={continueUrl:this.continueUrl,canHandleCodeInApp:this.canHandleCodeInApp,dynamicLinkDomain:this.dynamicLinkDomain,androidPackageName:this.apn,androidMinimumVersion:this.amv,androidInstallApp:this.installApp,iOSBundleId:this.ibi};for(var t in e)e.hasOwnProperty(t)&&(void 0!==e[t]&&null!==e[t]||delete e[t]);return e},e}();t.ActionCodeSettingsBuilder=o},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(11),o=r(187),s=r(50);t.ALGORITHM_RS256="RS256";var a="https://www.googleapis.com/robot/v1/metadata/x509/securetoken@system.gserviceaccount.com",c="https://www.googleapis.com/identitytoolkit/v3/relyingparty/publicKeys";t.ID_TOKEN_INFO={url:"https://firebase.google.com/docs/auth/admin/verify-id-tokens",verifyApiName:"verifyIdToken()",jwtName:"Firebase ID token",shortName:"ID token",expiredErrorCode:"auth/id-token-expired"},t.SESSION_COOKIE_INFO={url:"https://firebase.google.com/docs/auth/admin/manage-cookies",verifyApiName:"verifySessionCookie()",jwtName:"Firebase session cookie",shortName:"session cookie",expiredErrorCode:"auth/session-cookie-expired"};var u=function(){function e(e,t,r,o,s){if(this.clientCertUrl=e,this.algorithm=t,this.issuer=r,this.projectId=o,this.tokenInfo=s,!i.isURL(e))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The provided public client certificate URL is an invalid URL.");if(!i.isNonEmptyString(t))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The provided JWT algorithm is an empty string.");if(!i.isURL(r))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The provided JWT issuer is an invalid URL.");if(!i.isNonNullObject(s))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The provided JWT information is not an object or null.");if(!i.isURL(s.url))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The provided JWT verification documentation URL is invalid.");if(!i.isNonEmptyString(s.verifyApiName))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The JWT verify API name must be a non-empty string.");if(!i.isNonEmptyString(s.jwtName))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The JWT public full name must be a non-empty string.");if(!i.isNonEmptyString(s.shortName))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The JWT public short name must be a non-empty string.");if(!i.isNonEmptyString(s.expiredErrorCode))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"The JWT expiration error code must be a non-empty string.");this.shortNameArticle=s.shortName.charAt(0).match(/[aeiou]/i)?"an":"a"}return e.prototype.verifyJWT=function(e){var t=this;if(!i.isString(e))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,"First argument to "+this.tokenInfo.verifyApiName+" must be a "+this.tokenInfo.jwtName+" string.");if(!i.isNonEmptyString(this.projectId))throw new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_CREDENTIAL,"Must initialize app with a cert credential or set your Firebase project ID as the GOOGLE_CLOUD_PROJECT environment variable to call "+this.tokenInfo.verifyApiName+".");var r,s=o.decode(e,{complete:!0}),a=s&&s.header,c=s&&s.payload,u=" Make sure the "+this.tokenInfo.shortName+" comes from the same Firebase project as the service account used to authenticate this SDK.",l=" See "+this.tokenInfo.url+" for details on how to retrieve "+this.shortNameArticle+" "+this.tokenInfo.shortName+".";if(s)if(void 0===a.kid){var h="https://identitytoolkit.googleapis.com/google.identity.identitytoolkit.v1.IdentityToolkit"===c.aud,p="HS256"===a.alg&&0===c.v&&"d"in c&&"uid"in c.d;r=h?this.tokenInfo.verifyApiName+" expects "+this.shortNameArticle+" "+this.tokenInfo.shortName+", but was given a custom token.":p?this.tokenInfo.verifyApiName+" expects "+this.shortNameArticle+" "+this.tokenInfo.shortName+", but was given a legacy custom token.":'Firebase ID token has no "kid" claim.',r+=l}else a.alg!==this.algorithm?r=this.tokenInfo.jwtName+' has incorrect algorithm. Expected "'+this.algorithm+'" but got "'+a.alg+'".'+l:c.aud!==this.projectId?r=this.tokenInfo.jwtName+' has incorrect "aud" (audience) claim. Expected "'+this.projectId+'" but got "'+c.aud+'".'+u+l:c.iss!==this.issuer+this.projectId?r=this.tokenInfo.jwtName+' has incorrect "iss" (issuer) claim. Expected "'+this.issuer+'"'+this.projectId+'" but got "'+c.iss+'".'+u+l:"string"!=typeof c.sub?r=this.tokenInfo.jwtName+' has no "sub" (subject) claim.'+l:""===c.sub?r=this.tokenInfo.jwtName+' has an empty string "sub" (subject) claim.'+l:c.sub.length>128&&(r=this.tokenInfo.jwtName+' has "sub" (subject) claim longer than 128 characters.'+l);else r="Decoding "+this.tokenInfo.jwtName+" failed. Make sure you passed the entire string JWT which represents "+this.shortNameArticle+" "+this.tokenInfo.shortName+"."+l;return void 0!==r?Promise.reject(new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,r)):this.fetchPublicKeys().then(function(r){return r.hasOwnProperty(a.kid)?t.verifyJwtSignatureWithKey(e,r[a.kid]):Promise.reject(new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,t.tokenInfo.jwtName+' has "kid" claim which does not correspond to a known public key. Most likely the '+t.tokenInfo.shortName+" is expired, so get a fresh token from your client app and try again."))})},e.prototype.verifyJwtSignatureWithKey=function(e,t){var r,i=this,s=" See "+this.tokenInfo.url+" for details on how to retrieve "+this.shortNameArticle+" "+this.tokenInfo.shortName+".";return new Promise(function(a,c){o.verify(e,t,{algorithms:[i.algorithm]},function(e,t){if(e)return"TokenExpiredError"===e.name?r=i.tokenInfo.jwtName+" has expired. Get a fresh token from your client app and try again ("+i.tokenInfo.expiredErrorCode+")."+s:"JsonWebTokenError"===e.name&&(r=i.tokenInfo.jwtName+" has invalid signature."+s),c(new n.FirebaseAuthError(n.AuthClientErrorCode.INVALID_ARGUMENT,r));t.uid=t.sub,a(t)})})},e.prototype.fetchPublicKeys=function(){var e=this,t=void 0!==this.publicKeys,r=void 0!==this.publicKeysExpireAt&&Date.now()<this.publicKeysExpireAt;if(t&&r)return Promise.resolve(this.publicKeys);var i=new s.HttpClient,o={method:"GET",url:this.clientCertUrl};return i.send(o).then(function(t){if(!t.isJson()||t.data.error)throw new s.HttpError(t);t.headers.hasOwnProperty("cache-control")&&t.headers["cache-control"].split(",").forEach(function(t){var r=t.trim().split("=");if("max-age"===r[0]){var n=+r[1];e.publicKeysExpireAt=Date.now()+1e3*n}});return e.publicKeys=t.data,t.data}).catch(function(e){if(e instanceof s.HttpError){var t="Error fetching public keys for Google certs: ",r=e.response;throw r.isJson()&&r.data.error?(t+=""+r.data.error,r.data.error_description&&(t+=" ("+r.data.error_description+")")):t+=""+r.text,new n.FirebaseAuthError(n.AuthClientErrorCode.INTERNAL_ERROR,t)}throw e})},e}();t.FirebaseTokenVerifier=u,t.createIdTokenVerifier=function(e){return new u(a,t.ALGORITHM_RS256,"https://securetoken.google.com/",e,t.ID_TOKEN_INFO)},t.createSessionCookieVerifier=function(e){return new u(c,t.ALGORITHM_RS256,"https://session.firebase.google.com/",e,t.SESSION_COOKIE_INFO)}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(11),o=function(){function e(){this.databases={}}return e.prototype.delete=function(){for(var e=0,t=Object.keys(this.databases);e<t.length;e++){var r=t[e];this.databases[r].INTERNAL.delete()}return Promise.resolve(void 0)},e}(),s=function(){function e(e){if(this.INTERNAL=new o,!(i.isNonNullObject(e)&&"options"in e))throw new n.FirebaseDatabaseError({code:"invalid-argument",message:"First argument passed to admin.database() must be a valid Firebase app instance."});this.appInternal=e}return Object.defineProperty(e.prototype,"app",{get:function(){return this.appInternal},enumerable:!0,configurable:!0}),e.prototype.getDatabase=function(e){var t=this.ensureUrl(e);if(!i.isNonEmptyString(t))throw new n.FirebaseDatabaseError({code:"invalid-argument",message:"Database URL must be a valid, non-empty URL string."});var o=this.INTERNAL.databases[t];if(void 0===o){var s=r(198),a=r(199).version;o=s.initStandalone(this.appInternal,t,a).instance,this.INTERNAL.databases[t]=o}return o},e.prototype.ensureUrl=function(e){if(void 0!==e)return e;if(void 0!==this.appInternal.options.databaseURL)return this.appInternal.options.databaseURL;throw new n.FirebaseDatabaseError({code:"invalid-argument",message:"Can't determine Firebase Database URL."})},e}();t.DatabaseService=s},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(50),i=r(10),o=r(11),s={"Sdk-Version":"Node/Admin/6.3.0",access_token_auth:"true"},a=function(){function e(e){this.httpClient=new n.AuthorizedHttpClient(e)}return e.getErrorCode=function(e){if(o.isNonNullObject(e)&&"error"in e){if(o.isString(e.error))return e.error;if(o.isArray(e.error.details))for(var t=0,r=e.error.details;t<r.length;t++){var n=r[t];if("type.googleapis.com/google.firebase.fcm.v1.FcmError"===n["@type"])return n.errorCode}return"status"in e.error?e.error.status:e.error.message}return null},e.getErrorMessage=function(e){return o.isNonNullObject(e)&&"error"in e&&o.isNonEmptyString(e.error.message)?e.error.message:null},e.prototype.invokeRequestHandler=function(t,r,i){var o=this,a={method:"POST",url:"https://"+t+r,data:i,headers:s,timeout:1e4};return this.httpClient.send(a).then(function(t){if(!t.isJson())throw new n.HttpError(t);if(e.getErrorCode(t.data))throw new n.HttpError(t);return t.data}).catch(function(e){throw e instanceof n.HttpError&&o.handleHttpError(e),e})},e.prototype.handleHttpError=function(t){if(t.response.isJson()){var r=t.response.data,n=e.getErrorCode(r),o=e.getErrorMessage(r);throw i.FirebaseMessagingError.fromServerError(n,o,r)}var s;switch(t.response.status){case 400:s=i.MessagingClientErrorCode.INVALID_ARGUMENT;break;case 401:case 403:s=i.MessagingClientErrorCode.AUTHENTICATION_ERROR;break;case 500:s=i.MessagingClientErrorCode.INTERNAL_ERROR;break;case 503:s=i.MessagingClientErrorCode.SERVER_UNAVAILABLE;break;default:s=i.MessagingClientErrorCode.UNKNOWN_ERROR}throw new i.FirebaseMessagingError({code:s.code,message:s.message+' Raw server response: "'+t.response.text+'". Status code: '+t.response.status+"."})},e}();t.FirebaseMessagingRequestHandler=a},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(109),o=r(11),s=r(24),a=function(){function e(){}return e.prototype.delete=function(){return Promise.resolve()},e}(),c=function(){function e(e){this.INTERNAL=new a,this.firestoreClient=function(e){var t,i=u(e);try{t=r(202)}catch(e){throw new n.FirebaseFirestoreError({code:"missing-dependencies",message:'Failed to import the Cloud Firestore client library for Node.js. Make sure to install the "@google-cloud/firestore" npm package. Original error: '+e})}return new t(i)}(e),this.appInternal=e}return Object.defineProperty(e.prototype,"app",{get:function(){return this.appInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"client",{get:function(){return this.firestoreClient},enumerable:!0,configurable:!0}),e}();function u(e){if(!(o.isNonNullObject(e)&&"options"in e))throw new n.FirebaseFirestoreError({code:"invalid-argument",message:"First argument passed to admin.firestore() must be a valid Firebase app instance."});var t=s.getProjectId(e),a=e.options.credential.getCertificate(),c=r(199).version;if(null!=a){if(!o.isNonEmptyString(t))throw new n.FirebaseFirestoreError({code:"no-project-id",message:"Failed to determine project ID for Firestore. Initialize the SDK with service account credentials or set project ID as an app option. Alternatively set the GOOGLE_CLOUD_PROJECT environment variable."});return{credentials:{private_key:a.privateKey,client_email:a.clientEmail},projectId:t,firebaseVersion:c}}if(e.options.credential instanceof i.ApplicationDefaultCredential)return o.isNonEmptyString(t)?{projectId:t,firebaseVersion:c}:{firebaseVersion:c};throw new n.FirebaseFirestoreError({code:"invalid-credential",message:"Failed to initialize Google Cloud Firestore client with the available credentials. Must initialize the SDK with a certificate credential or application default credentials to use Cloud Firestore API."})}t.FirestoreService=c,t.getFirestoreOptions=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9);t.replaceProjectIdToken=function e(t,r){if(Array.isArray(t)&&(t=t.map(t=>e(t,r))),!(null===t||"object"!=typeof t||t instanceof Buffer||t instanceof n.Stream||"function"!=typeof t.hasOwnProperty))for(const n in t)t.hasOwnProperty(n)&&(t[n]=e(t[n],r));if("string"==typeof t&&t.indexOf("{{projectId}}")>-1){if(!r||"{{projectId}}"===r)throw new i;t=t.replace(/{{projectId}}/g,r)}return t};class i extends Error{constructor(){super(...arguments),this.message='Sorry, we cannot connect to Cloud Services without a project\n    ID. You may specify one with an environment variable named\n    "GOOGLE_CLOUD_PROJECT".'.replace(/ +/g," ")}}t.MissingProjectIdError=i},function(e,t,r){var n=r(9);(t=e.exports=r(204)).Stream=n,t.Readable=t,t.Writable=r(206),t.Duplex=r(136),t.Transform=r(207),t.PassThrough=r(328),process.browser||"disable"!==process.env.READABLE_STREAM||(e.exports=r(9))},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){e.exports=o;var n=r(207),i=r(25);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}i.inherits=r(19),i.inherits(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";var n=r(34).Buffer,i=r(4);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i,o=n.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,r=o,i=a,t.copy(r,i),a+=s.data.length,s=s.next;return o},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t,r){e.exports=r(4).deprecate},function(e,t,r){"use strict";e.exports=o;var n=r(213),i=r(25);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}i.inherits=r(19),i.inherits(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t){function r(e){var t=[];for(var r in e)t.push(r);return t}(e.exports="function"==typeof Object.keys?Object.keys:r).shim=r},function(e,t){var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function i(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=r?n:i).supported=n,t.unsupported=i},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(15);t.ClientPool=class{constructor(e,t){this.concurrentOperationLimit=e,this.clientFactory=t,this.activeClients=new Map}acquire(){let e=null,t=0;return this.activeClients.forEach((r,n)=>{!e&&r<this.concurrentOperationLimit&&(e=n,t=r)}),e||(e=this.clientFactory(),n(!this.activeClients.has(e),"The provided client factory returned an existing instance")),this.activeClients.set(e,t+1),e}release(e){let t=this.activeClients.get(e)||0;n(t>0,"No active request"),t-=1,this.activeClients.set(e,t),0===t&&this.garbageCollect()}get size(){return this.activeClients.size}run(e){const t=this.acquire();return e(t).catch(e=>(this.release(t),Promise.reject(e))).then(e=>(this.release(t),e))}garbageCollect(){let e=0;this.activeClients.forEach((t,r)=>{0===t&&++e>1&&this.activeClients.delete(r)})}}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(140),i=r(27),o=r(26);
/*!
 * The type order as defined by the backend.
 */
var s;
/*!
 * @private
 */
function a(e){switch(n.detectValueType(e)){case"nullValue":return s.NULL;case"integerValue":case"doubleValue":return s.NUMBER;case"stringValue":return s.STRING;case"booleanValue":return s.BOOLEAN;case"arrayValue":return s.ARRAY;case"timestampValue":return s.TIMESTAMP;case"geoPointValue":return s.GEO_POINT;case"bytesValue":return s.BLOB;case"referenceValue":return s.REF;case"mapValue":return s.OBJECT;default:throw o.customObjectError(e)}}
/*!
 * @private
 */function c(e,t){return e<t?-1:e>t?1:0}
/*!
 * @private
 */
function u(e,t){let r,n;
/*!
 * Utility function to compare doubles (using Firestore semantics for NaN).
 * @private
 */
return function(e,t){return e<t?-1:e>t?1:e===t?0:isNaN(e)?isNaN(t)?0:-1:1}(r=void 0!==e.integerValue?Number(e.integerValue):Number(e.doubleValue),n=void 0!==t.integerValue?Number(t.integerValue):Number(t.doubleValue))}
/*!
 * @private
 */
/*!
 * @private
 */
function l(e,t){const r=a(e),n=c(r,a(t));if(0!==n)return n;switch(r){case s.NULL:return 0;case s.BOOLEAN:return c(e.booleanValue,t.booleanValue);case s.STRING:return c(e.stringValue,t.stringValue);case s.NUMBER:return u(e,t);case s.TIMESTAMP:return function(e,t){const r=c(e.seconds||0,t.seconds||0);return 0!==r?r:c(e.nanos||0,t.nanos||0)}
/*!
 * @private
 */(e.timestampValue,t.timestampValue);case s.BLOB:return function(e,t){if(!(e instanceof Buffer&&t instanceof Buffer))throw new Error("Blobs can only be compared if they are Buffers.");return Buffer.compare(e,t)}
/*!
 * @private
 */(e.bytesValue,t.bytesValue);case s.REF:return function(e,t){const r=i.ResourcePath.fromSlashSeparatedString(e.referenceValue),n=i.ResourcePath.fromSlashSeparatedString(t.referenceValue);return r.compareTo(n)}
/*!
 * @private
 */(e,t);case s.GEO_POINT:return function(e,t){return c(e.latitude||0,t.latitude||0)||c(e.longitude||0,t.longitude||0)}
/*!
 * @private
 */(e.geoPointValue,t.geoPointValue);case s.ARRAY:return function(e,t){for(let r=0;r<e.length&&r<t.length;r++){const n=l(e[r],t[r]);if(0!==n)return n}return c(e.length,t.length)}
/*!
 * @private
 */(e.arrayValue.values||[],t.arrayValue.values||[]);case s.OBJECT:return function(e,t){const r=Object.keys(e),n=Object.keys(t);r.sort(),n.sort();for(let i=0;i<r.length&&i<n.length;i++){const o=c(r[i],n[i]);if(0!==o)return o;const s=r[i],a=l(e[s],t[s]);if(0!==a)return a}return c(r.length,n.length)}(e.mapValue.fields||{},t.mapValue.fields||{});default:throw new Error(`Encountered unknown type order: ${r}`)}}!function(e){e[e.NULL=0]="NULL",e[e.BOOLEAN=1]="BOOLEAN",e[e.NUMBER=2]="NUMBER",e[e.TIMESTAMP=3]="TIMESTAMP",e[e.STRING=4]="STRING",e[e.BLOB=5]="BLOB",e[e.REF=6]="REF",e[e.GEO_POINT=7]="GEO_POINT",e[e.ARRAY=8]="ARRAY",e[e.OBJECT=9]="OBJECT"}(s||(s={})),t.primitiveComparator=c,t.compare=l},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(15),i=r(338),o=r(138),s=r(339),a=r(77),c=r(143),u=r(61),l=r(27),h=r(54),p=r(62),f=r(340),d=1,g={added:"added",modified:"modified",removed:"removed"},m={OK:0,CANCELLED:1,UNKNOWN:2,INVALID_ARGUMENT:3,DEADLINE_EXCEEDED:4,NOT_FOUND:5,ALREADY_EXISTS:6,PERMISSION_DENIED:7,UNAUTHENTICATED:16,RESOURCE_EXHAUSTED:8,FAILED_PRECONDITION:9,ABORTED:10,OUT_OF_RANGE:11,UNIMPLEMENTED:12,INTERNAL:13,UNAVAILABLE:14,DATA_LOSS:15,DO_NOT_USE:-1},y=(e,t)=>(n(e===t,"Document watches only support one document."),0);class v{constructor(e,t,r){this._firestore=e,this._target=t,this._comparator=r,this._backoff=new s.ExponentialBackoff,this._requestTag=p.requestTag()}static forDocument(e){return new v(e.firestore,{documents:{documents:[e.formattedName]},targetId:d},y)}static forQuery(e){return new v(e.firestore,{query:e.toProto(),targetId:d},e.comparator())}isPermanentError(e){if(void 0===e.code)return u.logger("Watch.onSnapshot",this._requestTag,"Unable to determine error code: ",e),!1;switch(e.code){case m.CANCELLED:case m.UNKNOWN:case m.DEADLINE_EXCEEDED:case m.RESOURCE_EXHAUSTED:case m.INTERNAL:case m.UNAVAILABLE:case m.UNAUTHENTICATED:return!1;default:return!0}}isResourceExhaustedError(e){return e.code===m.RESOURCE_EXHAUSTED}onSnapshot(e,t){let r=i(this._comparator),s=new Map;const p=new Map;let y=!1,v=!1,b=null,_=!0;const E={},C={database:this._firestore.formattedName,addTarget:this._target},w=o.obj();let S=null;const T=()=>{u.logger("Watch.onSnapshot",this._requestTag,"Resetting documents"),p.clear(),b=null,r.forEach(e=>{p.set(e.ref.formattedName,E)}),y=!1},A=e=>{S&&(S.unpipe(w),S.end(),S=null),w.end(),_&&(_=!1,u.logger("Watch.onSnapshot",this._requestTag,"Invoking onError: ",e),t(e))},I=e=>{_&&!this.isPermanentError(e)?(u.logger("Watch.onSnapshot",this._requestTag,"Stream ended, re-opening after retryable error: ",e),C.addTarget.resumeToken=b,p.clear(),this.isResourceExhaustedError(e)&&this._backoff.resetToMax(),N()):A(e)},N=()=>{u.logger("Watch.onSnapshot",this._requestTag,"Opening new stream"),S&&(S.unpipe(w),S.end(),S=null,k())},k=()=>{this._backoff.backoffAndWait().then(()=>{_?this._firestore.readWriteStream("listen",C,this._requestTag,!0).then(e=>{if(!_)return u.logger("Watch.onSnapshot",this._requestTag,"Closing inactive stream"),void e.end();u.logger("Watch.onSnapshot",this._requestTag,"Opened new stream"),(S=e).on("error",e=>{I(e)}),S.on("end",()=>{const e=new f.GrpcError("Stream ended unexpectedly");e.code=m.UNKNOWN,I(e)}),S.pipe(w),S.resume()}).catch(A):u.logger("Watch.onSnapshot",this._requestTag,"Not initializing inactive stream")})};function R(e,t,r){const n=[],i=[],o=[];return t.forEach((t,s)=>{t===E?e.has(s)&&n.push(s):e.has(s)?(t.readTime=r,o.push(t.build())):(t.readTime=r,i.push(t.build()))}),{deletes:n,adds:i,updates:o}}const O=(e,t,r)=>{let i=e;const o=t;function s(e){n(o.has(e),"Document to delete does not exist");const t=o.get(e),r=i.find(t),s=r.index;return i=r.remove(),o.delete(e),new c.DocumentChange(g.removed,t,s,-1)}function a(e){const t=e.ref.formattedName;n(!o.has(t),"Document to add already exists");const r=(i=i.insert(e,null)).find(e).index;return o.set(t,e),new c.DocumentChange(g.added,e,-1,r)}n(e.length===t.size,"The document tree and document map should have the same number of entries.");const u=[];return r.deletes.sort((e,t)=>this._comparator(o.get(e),o.get(t))),r.deletes.forEach(e=>{const t=s(e);u.push(t)}),r.adds.sort(this._comparator),r.adds.forEach(e=>{const t=a(e);u.push(t)}),r.updates.sort(this._comparator),r.updates.forEach(e=>{const t=function(e){const t=e.ref.formattedName;if(n(o.has(t),"Document to modify does not exist"),!o.get(t).updateTime.isEqual(e.updateTime)){const r=s(t),n=a(e);return new c.DocumentChange(g.modified,e,r.oldIndex,n.newIndex)}return null}(e);t&&u.push(t)}),n(i.length===o.size,"The update document tree and document map should have the same number of entries."),{updatedTree:i,updatedMap:o,appliedChanges:u}},x=(t,n)=>{const i=R(s,p,t),o=O(r,s,i);(!v||o.appliedChanges.length>0)&&(u.logger("Watch.onSnapshot",this._requestTag,"Sending snapshot with %d changes and %d documents",String(o.appliedChanges.length),o.updatedTree.length),e(t,o.updatedTree.length,()=>o.updatedTree.keys,()=>o.appliedChanges),v=!0),r=o.updatedTree,s=o.updatedMap,p.clear(),b=n};return k(),w.on("data",e=>{if(e.targetChange){u.logger("Watch.onSnapshot",this._requestTag,"Processing target change");const t=e.targetChange,r=!t.targetIds||0===t.targetIds.length;if("NO_CHANGE"===t.targetChangeType)r&&t.readTime&&y&&x(h.Timestamp.fromProto(t.readTime),t.resumeToken);else if("ADD"===t.targetChangeType)d!==t.targetIds[0]&&A(Error("Unexpected target ID sent by server"));else if("REMOVE"===t.targetChangeType){let e=13,r="internal error";t.cause&&(e=t.cause.code,r=t.cause.message),A(new Error("Error "+e+": "+r))}else"RESET"===t.targetChangeType?T():"CURRENT"===t.targetChangeType?y=!0:A(new Error("Unknown target change type: "+JSON.stringify(t)));t.resumeToken&&function(e,t){if(void 0===e||0===e.length)return!0;for(const r of e)if(r===t)return!0;return!1}(t.targetIds,d)&&this._backoff.reset()}else if(e.documentChange){u.logger("Watch.onSnapshot",this._requestTag,"Processing change event");const t=e.documentChange.targetIds||[],r=e.documentChange.removedTargetIds||[];let n=!1,i=!1;for(let e=0;e<t.length;e++)t[e]===d&&(n=!0);for(let e=0;e<r.length;e++)r[e]===d&&(i=!0);const o=e.documentChange.document,s=o.name;if(n){u.logger("Watch.onSnapshot",this._requestTag,"Received document change");const e=new a.DocumentSnapshotBuilder;e.ref=this._firestore.doc(l.ResourcePath.fromSlashSeparatedString(s).relativeName),e.fieldsProto=o.fields||{},e.createTime=h.Timestamp.fromProto(o.createTime),e.updateTime=h.Timestamp.fromProto(o.updateTime),p.set(s,e)}else i&&(u.logger("Watch.onSnapshot",this._requestTag,"Received document remove"),p.set(s,E))}else if(e.documentDelete||e.documentRemove){u.logger("Watch.onSnapshot",this._requestTag,"Processing remove event");const t=(e.documentDelete||e.documentRemove).document;p.set(t,E)}else e.filter?(u.logger("Watch.onSnapshot",this._requestTag,"Processing filter update"),e.filter.count!==function(){const e=R(s,p,h.Timestamp.now());return s.size+e.adds.length-e.deletes.length}()&&(T(),N())):A(new Error("Unknown listen response type: "+JSON.stringify(e)))}).on("end",()=>{u.logger("Watch.onSnapshot",this._requestTag,"Processing stream end"),S&&S.end()}),()=>{u.logger("Watch.onSnapshot",this._requestTag,"Ending stream"),_=!1,e=(()=>{}),t=(()=>{}),w.end()}}}t.Watch=v},function(e,t,r){"use strict";e.exports=function(e){return new u(e||d,null)};var n=0,i=1;function o(e,t,r,n,i,o){this._color=e,this.key=t,this.value=r,this.left=n,this.right=i,this._count=o}function s(e){return new o(e._color,e.key,e.value,e.left,e.right,e._count)}function a(e,t){return new o(e,t.key,t.value,t.left,t.right,t._count)}function c(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function u(e,t){this._compare=e,this.root=t}var l=u.prototype;function h(e,t){this.tree=e,this._stack=t}Object.defineProperty(l,"keys",{get:function(){var e=[];return this.forEach(function(t,r){e.push(t)}),e}}),Object.defineProperty(l,"values",{get:function(){var e=[];return this.forEach(function(t,r){e.push(r)}),e}}),Object.defineProperty(l,"length",{get:function(){return this.root?this.root._count:0}}),l.insert=function(e,t){for(var r=this._compare,s=this.root,l=[],h=[];s;){var p=r(e,s.key);l.push(s),h.push(p),s=p<=0?s.left:s.right}l.push(new o(n,e,t,null,null,1));for(var f=l.length-2;f>=0;--f){s=l[f];h[f]<=0?l[f]=new o(s._color,s.key,s.value,l[f+1],s.right,s._count+1):l[f]=new o(s._color,s.key,s.value,s.left,l[f+1],s._count+1)}for(f=l.length-1;f>1;--f){var d=l[f-1];s=l[f];if(d._color===i||s._color===i)break;var g=l[f-2];if(g.left===d)if(d.left===s){if(!(m=g.right)||m._color!==n){if(g._color=n,g.left=d.right,d._color=i,d.right=g,l[f-2]=d,l[f-1]=s,c(g),c(d),f>=3)(y=l[f-3]).left===g?y.left=d:y.right=d;break}d._color=i,g.right=a(i,m),g._color=n,f-=1}else{if(!(m=g.right)||m._color!==n){if(d.right=s.left,g._color=n,g.left=s.right,s._color=i,s.left=d,s.right=g,l[f-2]=s,l[f-1]=d,c(g),c(d),c(s),f>=3)(y=l[f-3]).left===g?y.left=s:y.right=s;break}d._color=i,g.right=a(i,m),g._color=n,f-=1}else if(d.right===s){if(!(m=g.left)||m._color!==n){if(g._color=n,g.right=d.left,d._color=i,d.left=g,l[f-2]=d,l[f-1]=s,c(g),c(d),f>=3)(y=l[f-3]).right===g?y.right=d:y.left=d;break}d._color=i,g.left=a(i,m),g._color=n,f-=1}else{var m;if(!(m=g.left)||m._color!==n){var y;if(d.left=s.right,g._color=n,g.right=s.left,s._color=i,s.right=d,s.left=g,l[f-2]=s,l[f-1]=d,c(g),c(d),c(s),f>=3)(y=l[f-3]).right===g?y.right=s:y.left=s;break}d._color=i,g.left=a(i,m),g._color=n,f-=1}}return l[0]._color=i,new u(r,l[0])},l.forEach=function(e,t,r){if(this.root)switch(arguments.length){case 1:return function e(t,r){var n;if(r.left&&(n=e(t,r.left)))return n;return(n=t(r.key,r.value))||(r.right?e(t,r.right):void 0)}(e,this.root);case 2:return function e(t,r,n,i){if(r(t,i.key)<=0){var o;if(i.left&&(o=e(t,r,n,i.left)))return o;if(o=n(i.key,i.value))return o}if(i.right)return e(t,r,n,i.right)}(t,this._compare,e,this.root);case 3:if(this._compare(t,r)>=0)return;return function e(t,r,n,i,o){var s,a=n(t,o.key),c=n(r,o.key);if(a<=0){if(o.left&&(s=e(t,r,n,i,o.left)))return s;if(c>0&&(s=i(o.key,o.value)))return s}if(c>0&&o.right)return e(t,r,n,i,o.right)}(t,r,this._compare,e,this.root)}},Object.defineProperty(l,"begin",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.left;return new h(this,e)}}),Object.defineProperty(l,"end",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.right;return new h(this,e)}}),l.at=function(e){if(e<0)return new h(this,[]);for(var t=this.root,r=[];;){if(r.push(t),t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e)return new h(this,r);if(e-=1,!t.right)break;if(e>=t.right._count)break;t=t.right}return new h(this,[])},l.ge=function(e){for(var t=this._compare,r=this.root,n=[],i=0;r;){var o=t(e,r.key);n.push(r),o<=0&&(i=n.length),r=o<=0?r.left:r.right}return n.length=i,new h(this,n)},l.gt=function(e){for(var t=this._compare,r=this.root,n=[],i=0;r;){var o=t(e,r.key);n.push(r),o<0&&(i=n.length),r=o<0?r.left:r.right}return n.length=i,new h(this,n)},l.lt=function(e){for(var t=this._compare,r=this.root,n=[],i=0;r;){var o=t(e,r.key);n.push(r),o>0&&(i=n.length),r=o<=0?r.left:r.right}return n.length=i,new h(this,n)},l.le=function(e){for(var t=this._compare,r=this.root,n=[],i=0;r;){var o=t(e,r.key);n.push(r),o>=0&&(i=n.length),r=o<0?r.left:r.right}return n.length=i,new h(this,n)},l.find=function(e){for(var t=this._compare,r=this.root,n=[];r;){var i=t(e,r.key);if(n.push(r),0===i)return new h(this,n);r=i<=0?r.left:r.right}return new h(this,[])},l.remove=function(e){var t=this.find(e);return t?t.remove():this},l.get=function(e){for(var t=this._compare,r=this.root;r;){var n=t(e,r.key);if(0===n)return r.value;r=n<=0?r.left:r.right}};var p=h.prototype;function f(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e._color=t._color,e._count=t._count}function d(e,t){return e<t?-1:e>t?1:0}Object.defineProperty(p,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(p,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),p.clone=function(){return new h(this.tree,this._stack.slice())},p.remove=function(){var e=this._stack;if(0===e.length)return this.tree;var t=new Array(e.length),r=e[e.length-1];t[t.length-1]=new o(r._color,r.key,r.value,r.left,r.right,r._count);for(var l=e.length-2;l>=0;--l){(r=e[l]).left===e[l+1]?t[l]=new o(r._color,r.key,r.value,t[l+1],r.right,r._count):t[l]=new o(r._color,r.key,r.value,r.left,t[l+1],r._count)}if((r=t[t.length-1]).left&&r.right){var h=t.length;for(r=r.left;r.right;)t.push(r),r=r.right;var p=t[h-1];t.push(new o(r._color,p.key,p.value,r.left,r.right,r._count)),t[h-1].key=r.key,t[h-1].value=r.value;for(l=t.length-2;l>=h;--l)r=t[l],t[l]=new o(r._color,r.key,r.value,r.left,t[l+1],r._count);t[h-1].left=t[h]}if((r=t[t.length-1])._color===n){var d=t[t.length-2];d.left===r?d.left=null:d.right===r&&(d.right=null),t.pop();for(l=0;l<t.length;++l)t[l]._count--;return new u(this.tree._compare,t[0])}if(r.left||r.right){r.left?f(r,r.left):r.right&&f(r,r.right),r._color=i;for(l=0;l<t.length-1;++l)t[l]._count--;return new u(this.tree._compare,t[0])}if(1===t.length)return new u(this.tree._compare,null);for(l=0;l<t.length;++l)t[l]._count--;var g=t[t.length-2];return function(e){for(var t,r,o,u,l=e.length-1;l>=0;--l){if(t=e[l],0===l)return void(t._color=i);if((r=e[l-1]).left===t){if((o=r.right).right&&o.right._color===n)return u=(o=r.right=s(o)).right=s(o.right),r.right=o.left,o.left=r,o.right=u,o._color=r._color,t._color=i,r._color=i,u._color=i,c(r),c(o),l>1&&((h=e[l-2]).left===r?h.left=o:h.right=o),void(e[l-1]=o);if(o.left&&o.left._color===n)return u=(o=r.right=s(o)).left=s(o.left),r.right=u.left,o.left=u.right,u.left=r,u.right=o,u._color=r._color,r._color=i,o._color=i,t._color=i,c(r),c(o),c(u),l>1&&((h=e[l-2]).left===r?h.left=u:h.right=u),void(e[l-1]=u);if(o._color===i){if(r._color===n)return r._color=i,void(r.right=a(n,o));r.right=a(n,o);continue}o=s(o),r.right=o.left,o.left=r,o._color=r._color,r._color=n,c(r),c(o),l>1&&((h=e[l-2]).left===r?h.left=o:h.right=o),e[l-1]=o,e[l]=r,l+1<e.length?e[l+1]=t:e.push(t),l+=2}else{if((o=r.left).left&&o.left._color===n)return u=(o=r.left=s(o)).left=s(o.left),r.left=o.right,o.right=r,o.left=u,o._color=r._color,t._color=i,r._color=i,u._color=i,c(r),c(o),l>1&&((h=e[l-2]).right===r?h.right=o:h.left=o),void(e[l-1]=o);if(o.right&&o.right._color===n)return u=(o=r.left=s(o)).right=s(o.right),r.left=u.right,o.right=u.left,u.right=r,u.left=o,u._color=r._color,r._color=i,o._color=i,t._color=i,c(r),c(o),c(u),l>1&&((h=e[l-2]).right===r?h.right=u:h.left=u),void(e[l-1]=u);if(o._color===i){if(r._color===n)return r._color=i,void(r.left=a(n,o));r.left=a(n,o);continue}var h;o=s(o),r.left=o.right,o.right=r,o._color=r._color,r._color=n,c(r),c(o),l>1&&((h=e[l-2]).right===r?h.right=o:h.left=o),e[l-1]=o,e[l]=r,l+1<e.length?e[l+1]=t:e.push(t),l+=2}}}(t),g.left===r?g.left=null:g.right=null,new u(this.tree._compare,t[0])},Object.defineProperty(p,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(p,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(p,"index",{get:function(){var e=0,t=this._stack;if(0===t.length){var r=this.tree.root;return r?r._count:0}t[t.length-1].left&&(e=t[t.length-1].left._count);for(var n=t.length-2;n>=0;--n)t[n+1]===t[n].right&&(++e,t[n].left&&(e+=t[n].left._count));return e},enumerable:!0}),p.next=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.right)for(t=t.right;t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(p,"hasNext",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].right)return!0;for(var t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}}),p.update=function(e){var t=this._stack;if(0===t.length)throw new Error("Can't update empty node!");var r=new Array(t.length),n=t[t.length-1];r[r.length-1]=new o(n._color,n.key,e,n.left,n.right,n._count);for(var i=t.length-2;i>=0;--i)(n=t[i]).left===t[i+1]?r[i]=new o(n._color,n.key,n.value,r[i+1],n.right,n._count):r[i]=new o(n._color,n.key,n.value,n.left,r[i+1],n._count);return new u(this.tree._compare,r[0])},p.prev=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.left)for(t=t.left;t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(p,"hasPrev",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].left)return!0;for(var t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}})},function(e,t,r){"use strict";
/*!
 * Copyright 2017 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(61),i=1e3,o=6e4,s=1.5,a=1;
/*!
 * The default initial backoff time in milliseconds after an error.
 * Set to 1s according to https://cloud.google.com/apis/design/errors.
 */
/*!
 * The timeout handler used by `ExponentialBackoff`.
 */
let c=setTimeout;t.setTimeoutHandler=function(e){c=e};t.ExponentialBackoff=class{constructor(e={}){this.currentBaseMs=0,this.initialDelayMs=void 0!==e.initialDelayMs?e.initialDelayMs:i,this.backoffFactor=void 0!==e.backoffFactor?e.backoffFactor:s,this.maxDelayMs=void 0!==e.maxDelayMs?e.maxDelayMs:o,this.jitterFactor=void 0!==e.jitterFactor?e.jitterFactor:a}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndWait(){const e=this.currentBaseMs+this.jitterDelayMs();return this.currentBaseMs>0&&n.logger("ExponentialBackoff.backoffAndWait",null,`Backing off for ${e} ms `+`(base delay: ${this.currentBaseMs} ms)`),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs=Math.max(this.currentBaseMs,this.initialDelayMs),this.currentBaseMs=Math.min(this.currentBaseMs,this.maxDelayMs),new Promise(t=>{c(t,e)})}jitterDelayMs(){return(Math.random()-.5)*this.jitterFactor*this.currentBaseMs}}},function(e,t,r){"use strict";
/*!
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});t.GrpcError=class extends Error{}},function(e,t,r){"use strict";const n=r(342);e.exports=n},function(e,t,r){"use strict";(function(t){const n=r(343),i=r(344),o=r(488),s=r(7),a=r(215).version;e.exports=class{constructor(e){this._descriptors={},(e=Object.assign({clientConfig:{},port:this.constructor.port,servicePath:this.constructor.servicePath},e)).scopes=this.constructor.scopes;const r=new i.GrpcClient(e);this.auth=r.auth;const c=[`gl-node/${process.version}`,`grpc/${r.grpcVersion}`,`gax/${i.version}`,`gapic/${a}`];e.libName&&e.libVersion&&c.push(`${e.libName}/${e.libVersion}`);const u=o({},r.loadProto(s.join(t,"..","..","protos"),"google/firestore/v1beta1/firestore.proto"));this._pathTemplates={databaseRootPathTemplate:new i.PathTemplate("projects/{project}/databases/{database}"),documentRootPathTemplate:new i.PathTemplate("projects/{project}/databases/{database}/documents"),documentPathPathTemplate:new i.PathTemplate("projects/{project}/databases/{database}/documents/{document_path=**}"),anyPathPathTemplate:new i.PathTemplate("projects/{project}/databases/{database}/documents/{document}/{any_path=**}")},this._descriptors.page={listDocuments:new i.PageDescriptor("pageToken","nextPageToken","documents"),listCollectionIds:new i.PageDescriptor("pageToken","nextPageToken","collectionIds")},this._descriptors.stream={batchGetDocuments:new i.StreamDescriptor(i.StreamType.SERVER_STREAMING),runQuery:new i.StreamDescriptor(i.StreamType.SERVER_STREAMING),write:new i.StreamDescriptor(i.StreamType.BIDI_STREAMING),listen:new i.StreamDescriptor(i.StreamType.BIDI_STREAMING)};const l=r.constructSettings("google.firestore.v1beta1.Firestore",n,e.clientConfig,{"x-goog-api-client":c.join(" ")});this._innerApiCalls={};const h=r.createStub(u.google.firestore.v1beta1.Firestore,e),p=["getDocument","listDocuments","createDocument","updateDocument","deleteDocument","batchGetDocuments","beginTransaction","commit","rollback","runQuery","write","listen","listCollectionIds"];for(const e of p)this._innerApiCalls[e]=i.createApiCall(h.then(t=>(function(){const r=Array.prototype.slice.call(arguments,0);return t[e].apply(t,r)})),l[e],this._descriptors.page[e]||this._descriptors.stream[e])}static get servicePath(){return"firestore.googleapis.com"}static get port(){return 443}static get scopes(){return["https://www.googleapis.com/auth/cloud-platform","https://www.googleapis.com/auth/datastore"]}getProjectId(e){return this.auth.getProjectId(e)}getDocument(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.getDocument(e,t,r)}listDocuments(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.listDocuments(e,t,r)}listDocumentsStream(e,t){return t=t||{},this._descriptors.page.listDocuments.createStream(this._innerApiCalls.listDocuments,e,t)}createDocument(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.createDocument(e,t,r)}updateDocument(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.updateDocument(e,t,r)}deleteDocument(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.deleteDocument(e,t,r)}batchGetDocuments(e,t){return t=t||{},this._innerApiCalls.batchGetDocuments(e,t)}beginTransaction(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.beginTransaction(e,t,r)}commit(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.commit(e,t,r)}rollback(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.rollback(e,t,r)}runQuery(e,t){return t=t||{},this._innerApiCalls.runQuery(e,t)}write(e){return e=e||{},this._innerApiCalls.write(e)}listen(e){return e=e||{},this._innerApiCalls.listen({},e)}listCollectionIds(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),t=t||{},this._innerApiCalls.listCollectionIds(e,t,r)}listCollectionIdsStream(e,t){return t=t||{},this._descriptors.page.listCollectionIds.createStream(this._innerApiCalls.listCollectionIds,e,t)}databaseRootPath(e,t){return this._pathTemplates.databaseRootPathTemplate.render({project:e,database:t})}documentRootPath(e,t){return this._pathTemplates.documentRootPathTemplate.render({project:e,database:t})}documentPathPath(e,t,r){return this._pathTemplates.documentPathPathTemplate.render({project:e,database:t,document_path:r})}anyPathPath(e,t,r,n){return this._pathTemplates.anyPathPathTemplate.render({project:e,database:t,document:r,any_path:n})}matchProjectFromDatabaseRootName(e){return this._pathTemplates.databaseRootPathTemplate.match(e).project}matchDatabaseFromDatabaseRootName(e){return this._pathTemplates.databaseRootPathTemplate.match(e).database}matchProjectFromDocumentRootName(e){return this._pathTemplates.documentRootPathTemplate.match(e).project}matchDatabaseFromDocumentRootName(e){return this._pathTemplates.documentRootPathTemplate.match(e).database}matchProjectFromDocumentPathName(e){return this._pathTemplates.documentPathPathTemplate.match(e).project}matchDatabaseFromDocumentPathName(e){return this._pathTemplates.documentPathPathTemplate.match(e).database}matchDocumentPathFromDocumentPathName(e){return this._pathTemplates.documentPathPathTemplate.match(e).document_path}matchProjectFromAnyPathName(e){return this._pathTemplates.anyPathPathTemplate.match(e).project}matchDatabaseFromAnyPathName(e){return this._pathTemplates.anyPathPathTemplate.match(e).database}matchDocumentFromAnyPathName(e){return this._pathTemplates.anyPathPathTemplate.match(e).document}matchAnyPathFromAnyPathName(e){return this._pathTemplates.anyPathPathTemplate.match(e).any_path}}}).call(this,"/")},function(e){e.exports={interfaces:{"google.firestore.v1beta1.Firestore":{retry_codes:{idempotent:["DEADLINE_EXCEEDED","UNAVAILABLE"],non_idempotent:[]},retry_params:{default:{initial_retry_delay_millis:100,retry_delay_multiplier:1.3,max_retry_delay_millis:6e4,initial_rpc_timeout_millis:2e4,rpc_timeout_multiplier:1,max_rpc_timeout_millis:2e4,total_timeout_millis:6e5},streaming:{initial_retry_delay_millis:100,retry_delay_multiplier:1.3,max_retry_delay_millis:6e4,initial_rpc_timeout_millis:3e5,rpc_timeout_multiplier:1,max_rpc_timeout_millis:3e5,total_timeout_millis:6e5}},methods:{GetDocument:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},ListDocuments:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},CreateDocument:{timeout_millis:6e4,retry_codes_name:"non_idempotent",retry_params_name:"default"},UpdateDocument:{timeout_millis:6e4,retry_codes_name:"non_idempotent",retry_params_name:"default"},DeleteDocument:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},BatchGetDocuments:{timeout_millis:3e5,retry_codes_name:"idempotent",retry_params_name:"streaming"},BeginTransaction:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},Commit:{timeout_millis:6e4,retry_codes_name:"non_idempotent",retry_params_name:"default"},Rollback:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},RunQuery:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},Write:{timeout_millis:864e5,retry_codes_name:"non_idempotent",retry_params_name:"streaming"},Listen:{timeout_millis:864e5,retry_codes_name:"idempotent",retry_params_name:"streaming"},ListCollectionIds:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"}}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(216),i=r(470),o=r(475);t.routingHeader=o;var s=r(229);t.GoogleAuth=s.GoogleAuth;var a=r(107);t.createApiCall=a.createApiCall;var c=r(476);t.BundleDescriptor=c.BundleDescriptor,t.BundleExecutor=c.BundleExecutor;var u=r(127);t.constructSettings=u.constructSettings;var l=r(283);t.GoogleError=l.GoogleError;var h=r(216);t.ClientStub=h.ClientStub,t.GoogleProtoFilesRoot=h.GoogleProtoFilesRoot,t.GrpcClient=h.GrpcClient;var p=r(478);t.LongrunningDescriptor=p.LongrunningDescriptor,t.operation=p.operation;var f=r(280);t.PageDescriptor=f.PageDescriptor;var d=r(281);t.PathTemplate=d.PathTemplate;var g=r(479);function m(e){e=Object.assign({scopes:m.ALL_SCOPES},e);const t=new n.GrpcClient(e);return new i.OperationsClientBuilder(t)}t.StreamDescriptor=g.StreamDescriptor,t.StreamType=g.StreamType,t.lro=m,m.SERVICE_ADDRESS=i.SERVICE_ADDRESS,m.ALL_SCOPES=i.ALL_SCOPES,t.createByteLengthFunction=n.GrpcClient.createByteLengthFunction,t.version=r(487).version},function(e,t,r){"use strict";var n=e.exports=r(346);n.build="full",n.tokenize=r(227),n.parse=r(360),n.common=r(361),n.Root._configure(n.Type,n.parse,n.common)},function(e,t,r){"use strict";var n=e.exports=r(347);n.build="light",n.load=function(e,t,r){return"function"==typeof t?(r=t,t=new n.Root):t||(t=new n.Root),t.load(e,r)},n.loadSync=function(e,t){return t||(t=new n.Root),t.loadSync(e)},n.encoder=r(222),n.decoder=r(223),n.verifier=r(224),n.converter=r(225),n.ReflectionObject=r(63),n.Namespace=r(79),n.Root=r(152),n.Enum=r(28),n.Type=r(147),n.Field=r(55),n.OneOf=r(119),n.MapField=r(148),n.Service=r(149),n.Method=r(150),n.Message=r(151),n.wrappers=r(226),n.types=r(64),n.util=r(13),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service,n.Enum),n.Root._configure(n.Type),n.Field._configure(n.Type)},function(e,t,r){"use strict";var n=t;function i(){n.Reader._configure(n.BufferReader),n.util._configure()}n.build="minimal",n.Writer=r(145),n.BufferWriter=r(354),n.Reader=r(146),n.BufferReader=r(355),n.util=r(36),n.rpc=r(220),n.roots=r(221),n.configure=i,n.Writer._configure(n.BufferWriter),i()},function(e,t,r){"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var i=new Array(64),o=new Array(123),s=0;s<64;)o[i[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;n.encode=function(e,t,r){for(var n,o=null,s=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:s[a++]=i[u>>2],n=(3&u)<<4,c=1;break;case 1:s[a++]=i[n|u>>4],n=(15&u)<<2,c=2;break;case 2:s[a++]=i[n|u>>6],s[a++]=i[63&u],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=i[n],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};n.decode=function(e,t,r){for(var n,i=r,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=o[c]))throw Error("invalid encoding");switch(s){case 0:n=c,s=1;break;case 1:t[r++]=n<<2|(48&c)>>4,n=c,s=2;break;case 2:t[r++]=(15&n)<<4|(60&c)>>2,n=c,s=3;break;case 3:t[r++]=(3&n)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return r-i},n.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)}},function(e,t,r){"use strict";function n(){this._listeners={}}e.exports=n,n.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},n.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},n.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},function(e,t,r){"use strict";function n(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>3.4028234663852886e38)e((i<<31|2139095040)>>>0,r,n);else if(t<1.1754943508222875e-38)e((i<<31|Math.round(t/1.401298464324817e-45))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1.401298464324817e-45*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,o),e.readFloatLE=r.bind(null,s),e.readFloatBE=r.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>1.7976931348623157e308)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<2.2250738585072014e-308)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,i,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function r(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+o;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=r.bind(null,s,0,4),e.readDoubleBE=r.bind(null,a,4,0)}(),e}function i(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function o(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=n(n)},function(e,t,r){"use strict";var n=t;n.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},n.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},n.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}},function(e,t,r){"use strict";e.exports=i;var n=r(36);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?o:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},function(e,t,r){"use strict";e.exports=s;var n=r(145);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(36),o=i.Buffer;function s(){n.call(this)}s.alloc=function(e){return(s.alloc=i._Buffer_allocUnsafe)(e)};var a=o&&o.prototype instanceof Uint8Array&&"set"===o.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]};function c(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write(e,r)}s.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(a,t,e),this},s.prototype.string=function(e){var t=o.byteLength(e);return this.uint32(t),t&&this._push(c,t,e),this}},function(e,t,r){"use strict";e.exports=o;var n=r(146);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(36);function o(e){n.call(this,e)}i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice),o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},function(e,t,r){"use strict";e.exports=i;var n=r(36);function i(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return n.asPromise(e,a,t,r,i,o);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)})}catch(e){return a.emit("error",e,t),void setTimeout(function(){s(e)},0)}else setTimeout(function(){s(Error("already ended"))},0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,r){"use strict";function n(e,t){"string"==typeof e&&(t=e,e=void 0);var r=[];function i(e){if("string"!=typeof e){var t=o();if(n.verbose&&console.log("codegen: "+t),t="return "+t,e){for(var s=Object.keys(e),a=new Array(s.length+1),c=new Array(s.length),u=0;u<s.length;)a[u]=s[u],c[u]=e[s[u++]];return a[u]=t,Function.apply(null,a).apply(null,c)}return Function(t)()}for(var l=new Array(arguments.length-1),h=0;h<l.length;)l[h]=arguments[++h];if(h=0,e=e.replace(/%([%dfijs])/g,function(e,t){var r=l[h++];switch(t){case"d":case"f":return String(Number(r));case"i":return String(Math.floor(r));case"j":return JSON.stringify(r);case"s":return String(r)}return"%"}),h!==l.length)throw Error("parameter count mismatch");return r.push(e),i}function o(n){return"function "+(n||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return i.toString=o,i}e.exports=n,n.verbose=!1},function(e,t,r){"use strict";e.exports=o;var n=r(218),i=r(219)("fs");function o(e,t,r){return"function"==typeof t?(r=t,t={}):t||(t={}),r?!t.xhr&&i&&i.readFile?i.readFile(e,function(n,i){return n&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,r):n?r(n):r(null,t.binary?i:i.toString("utf8"))}):o.xhr(e,t,r):n(o,this,e,t)}o.xhr=function(e,t,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){if(0!==n.status&&200!==n.status)return r(Error("status "+n.status));if(t.binary){var e=n.response;if(!e){e=[];for(var i=0;i<n.responseText.length;++i)e.push(255&n.responseText.charCodeAt(i))}return r(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return r(null,n.responseText)}},t.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}},function(e,t,r){"use strict";var n=t,i=n.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},o=n.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),r=i(e),n="";r&&(n=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):r?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return n+t.join("/")};n.resolve=function(e,t,r){return r||(t=o(t)),i(t)?t:(r||(e=o(e)),(e=e.replace(/(?:\/|^)[^\/]+$/,"")).length?o(e+"/"+t):t)}},function(e,t,r){"use strict";e.exports=S,S.filename=null,S.defaults={keepCase:!1};var n=r(227),i=r(152),o=r(147),s=r(55),a=r(148),c=r(119),u=r(28),l=r(149),h=r(150),p=r(64),f=r(13),d=/^[1-9][0-9]*$/,g=/^-?[1-9][0-9]*$/,m=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,v=/^0[0-7]+$/,b=/^-?0[0-7]+$/,_=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,E=/^[a-zA-Z_][a-zA-Z_0-9]*$/,C=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,w=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function S(e,t,r){t instanceof i||(r=t,t=new i),r||(r=S.defaults);var T,A,I,N,k,R=n(e,r.alternateCommentMode||!1),O=R.next,x=R.push,B=R.peek,D=R.skip,P=R.cmnt,L=!0,j=!1,U=t,M=r.keepCase?function(e){return e}:f.camelCase;function F(e,t,r){var n=S.filename;return r||(S.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(n?n+", ":"")+"line "+R.line+")")}function V(){var e,t=[];do{if('"'!==(e=O())&&"'"!==e)throw F(e);t.push(O()),D(e),e=B()}while('"'===e||"'"===e);return t.join("")}function q(e){var t=O();switch(t){case"'":case'"':return x(t),V();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var r=1;"-"===e.charAt(0)&&(r=-1,e=e.substring(1));switch(e){case"inf":case"INF":case"Inf":return r*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(d.test(e))return r*parseInt(e,10);if(m.test(e))return r*parseInt(e,16);if(v.test(e))return r*parseInt(e,8);if(_.test(e))return r*parseFloat(e);throw F(e,"number",t)}(t,!0)}catch(r){if(e&&C.test(t))return t;throw F(t,"value")}}function K(e,t){var r,n;do{!t||'"'!==(r=B())&&"'"!==r?e.push([n=H(O()),D("to",!0)?H(O()):n]):e.push(V())}while(D(",",!0));D(";")}function H(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw F(e,"id");if(g.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw F(e,"id")}function G(){if(void 0!==T)throw F("package");if(T=O(),!C.test(T))throw F(T,"name");U=U.define(T),D(";")}function z(){var e,t=B();switch(t){case"weak":e=I||(I=[]),O();break;case"public":O();default:e=A||(A=[])}t=V(),D(";"),e.push(t)}function W(){if(D("="),N=V(),!(j="proto3"===N)&&"proto2"!==N)throw F(N,"syntax");D(";")}function Y(e,t){switch(t){case"option":return J(e,t),D(";"),!0;case"message":return function(e,t){if(!E.test(t=O()))throw F(t,"type name");var r=new o(t);Q(r,function(e){if(!Y(r,e))switch(e){case"map":!function(e){D("<");var t=O();if(void 0===p.mapKey[t])throw F(t,"type");D(",");var r=O();if(!C.test(r))throw F(r,"type");D(">");var n=O();if(!E.test(n))throw F(n,"name");D("=");var i=new a(M(n),H(O()),t,r);Q(i,function(e){if("option"!==e)throw F(e);J(i,e),D(";")},function(){ee(i)}),e.add(i)}(r);break;case"required":case"optional":case"repeated":$(r,e);break;case"oneof":!function(e,t){if(!E.test(t=O()))throw F(t,"name");var r=new c(M(t));Q(r,function(e){"option"===e?(J(r,e),D(";")):(x(e),$(r,"optional"))}),e.add(r)}(r,e);break;case"extensions":K(r.extensions||(r.extensions=[]));break;case"reserved":K(r.reserved||(r.reserved=[]),!0);break;default:if(!j||!C.test(e))throw F(e);x(e),$(r,"optional")}}),e.add(r)}(e,t),!0;case"enum":return function(e,t){if(!E.test(t=O()))throw F(t,"name");var r=new u(t);Q(r,function(e){switch(e){case"option":J(r,e),D(";");break;case"reserved":K(r.reserved||(r.reserved=[]),!0);break;default:!function(e,t){if(!E.test(t))throw F(t,"name");D("=");var r=H(O(),!0),n={};Q(n,function(e){if("option"!==e)throw F(e);J(n,e),D(";")},function(){ee(n)}),e.add(t,r,n.comment)}(r,e)}}),e.add(r)}(e,t),!0;case"service":return function(e,t){if(!E.test(t=O()))throw F(t,"service name");var r=new l(t);Q(r,function(e){if(!Y(r,e)){if("rpc"!==e)throw F(e);!function(e,t){var r=t;if(!E.test(t=O()))throw F(t,"name");var n,i,o,s,a=t;D("("),D("stream",!0)&&(i=!0);if(!C.test(t=O()))throw F(t);n=t,D(")"),D("returns"),D("("),D("stream",!0)&&(s=!0);if(!C.test(t=O()))throw F(t);o=t,D(")");var c=new h(a,r,n,o,i,s);Q(c,function(e){if("option"!==e)throw F(e);J(c,e),D(";")}),e.add(c)}(r,e)}}),e.add(r)}(e,t),!0;case"extend":return function(e,t){if(!C.test(t=O()))throw F(t,"reference");var r=t;Q(null,function(t){switch(t){case"required":case"repeated":case"optional":$(e,t,r);break;default:if(!j||!C.test(t))throw F(t);x(t),$(e,"optional",r)}})}(e,t),!0}return!1}function Q(e,t,r){var n=R.line;if(e&&(e.comment=P(),e.filename=S.filename),D("{",!0)){for(var i;"}"!==(i=O());)t(i);D(";",!0)}else r&&r(),D(";"),e&&"string"!=typeof e.comment&&(e.comment=P(n))}function $(e,t,r){var n=O();if("group"!==n){if(!C.test(n))throw F(n,"type");var i=O();if(!E.test(i))throw F(i,"name");i=M(i),D("=");var a=new s(i,H(O()),n,t,r);Q(a,function(e){if("option"!==e)throw F(e);J(a,e),D(";")},function(){ee(a)}),e.add(a),j||!a.repeated||void 0===p.packed[n]&&void 0!==p.basic[n]||a.setOption("packed",!1,!0)}else!function(e,t){var r=O();if(!E.test(r))throw F(r,"name");var n=f.lcFirst(r);r===n&&(r=f.ucFirst(r));D("=");var i=H(O()),a=new o(r);a.group=!0;var c=new s(n,i,r,t);c.filename=S.filename,Q(a,function(e){switch(e){case"option":J(a,e),D(";");break;case"required":case"optional":case"repeated":$(a,e);break;default:throw F(e)}}),e.add(a).add(c)}(e,t)}function J(e,t){var r=D("(",!0);if(!C.test(t=O()))throw F(t,"name");var n=t;r&&(D(")"),n="("+n+")",t=B(),w.test(t)&&(n+=t,O())),D("="),X(e,n)}function X(e,t){if(D("{",!0))do{if(!E.test(k=O()))throw F(k,"name");"{"===B()?X(e,t+"."+k):(D(":"),"{"===B()?X(e,t+"."+k):Z(e,t+"."+k,q(!0))),D(",",!0)}while(!D("}",!0));else Z(e,t,q(!0))}function Z(e,t,r){e.setOption&&e.setOption(t,r)}function ee(e){if(D("[",!0)){do{J(e,"option")}while(D(",",!0));D("]")}return e}for(;null!==(k=O());)switch(k){case"package":if(!L)throw F(k);G();break;case"import":if(!L)throw F(k);z();break;case"syntax":if(!L)throw F(k);W();break;case"option":if(!L)throw F(k);J(U,k),D(";");break;default:if(Y(U,k)){L=!1;continue}throw F(k)}return S.filename=null,{package:T,imports:A,weakImports:I,syntax:N,root:t}}},function(e,t,r){"use strict";e.exports=o;var n,i=/\/|\./;function o(e,t){i.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),o[e]=t}o("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),o("duration",{Duration:n={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),o("timestamp",{Timestamp:n}),o("empty",{Empty:{fields:{}}}),o("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),o("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),o("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),o.get=function(e){return o[e]||null}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(230),o=r(33),s=r(8),a=r(153),c=r(29),u=r(7),l=r(4),h=r(68),p=r(155),f=r(232),d=r(379),g=r(234),m=r(251);t.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com";class y{constructor(e){this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,e=e||{},this._cachedProjectId=e.projectId||null,this.keyFilename=e.keyFilename||e.keyFile,this.scopes=e.scopes,this.jsonContent=e.credentials||null}get isGCE(){return this.checkIsGCE}getDefaultProjectId(e){if(h.warn(h.DEFAULT_PROJECT_ID_DEPRECATED),!e)return this.getProjectIdAsync();this.getProjectIdAsync().then(t=>e(null,t),e)}getProjectId(e){if(!e)return this.getProjectIdAsync();this.getProjectIdAsync().then(t=>e(null,t),e)}getProjectIdAsync(){return this._cachedProjectId?Promise.resolve(this._cachedProjectId):(this._getDefaultProjectIdPromise||(this._getDefaultProjectIdPromise=new Promise((e,t)=>n(this,void 0,void 0,function*(){try{const r=this.getProductionProjectId()||(yield this.getFileProjectId())||(yield this.getDefaultServiceProjectId())||(yield this.getGCEProjectId());this._cachedProjectId=r,e(r)}catch(e){t(e)}}))),this._getDefaultProjectIdPromise)}getApplicationDefault(e={},t){let r;if("function"==typeof e?t=e:r=e,!t)return this.getApplicationDefaultAsync(r);this.getApplicationDefaultAsync(r).then(e=>t(null,e.credential,e.projectId),t)}getApplicationDefaultAsync(e){return n(this,void 0,void 0,function*(){if(this.cachedCredential)return{credential:this.cachedCredential,projectId:yield this.getProjectIdAsync()};let t,r,n;if(t=yield this._tryGetApplicationCredentialsFromEnvironmentVariable(e))return t instanceof g.JWT&&(t.scopes=this.scopes),this.cachedCredential=t,{credential:t,projectId:r=yield this.getProjectId()};if(t=yield this._tryGetApplicationCredentialsFromWellKnownFile(e))return t instanceof g.JWT&&(t.scopes=this.scopes),this.cachedCredential=t,{credential:t,projectId:r=yield this.getProjectId()};try{n=yield this._checkIsGCE()}catch(e){throw new Error("Unexpected error determining execution environment: "+e.message)}if(!n)throw new Error("Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.");return this.cachedCredential=new f.Compute(e),{projectId:r=yield this.getProjectId(),credential:this.cachedCredential}})}_checkIsGCE(){return n(this,void 0,void 0,function*(){return void 0===this.checkIsGCE&&(this.checkIsGCE=yield a.isAvailable()),this.checkIsGCE})}_tryGetApplicationCredentialsFromEnvironmentVariable(e){return n(this,void 0,void 0,function*(){const t=process.env.GOOGLE_APPLICATION_CREDENTIALS;if(!t||0===t.length)return null;try{return this._getApplicationCredentialsFromFilePath(t,e)}catch(e){throw this.createError("Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable.",e)}})}_tryGetApplicationCredentialsFromWellKnownFile(e){return n(this,void 0,void 0,function*(){let t=null;if(this._isWindows())t=process.env.APPDATA;else{const e=process.env.HOME;e&&(t=this._pathJoin(e,".config"))}if(t&&(t=this._pathJoin(t,"gcloud"),t=this._pathJoin(t,"application_default_credentials.json"),t=this._mockWellKnownFilePath(t),this._fileExists(t)||(t=null)),!t)return null;const r=yield this._getApplicationCredentialsFromFilePath(t,e);return this.warnOnProblematicCredentials(r),r})}_getApplicationCredentialsFromFilePath(e,t={}){return n(this,void 0,void 0,function*(){if(!e||0===e.length)throw new Error("The file path is invalid.");try{if(e=s.realpathSync(e),!s.lstatSync(e).isFile())throw new Error}catch(t){throw this.createError(l.format("The file at %s does not exist, or it is not a file.",e),t)}try{const r=this._createReadStream(e);return this.fromStream(r,t)}catch(t){throw this.createError(l.format("Unable to read the file at %s.",e),t)}})}warnOnProblematicCredentials(e){e.email===t.CLOUD_SDK_CLIENT_ID&&h.warn(h.PROBLEMATIC_CREDENTIALS_WARNING)}fromJSON(e,t){let r;if(!e)throw new Error("Must pass in a JSON object containing the Google auth settings.");return this.jsonContent=e,t=t||{},"authorized_user"===e.type?r=new m.UserRefreshClient(t):(t.scopes=this.scopes,r=new g.JWT(t)),r.fromJSON(e),r}fromStream(e,t={},r){let n={};if("function"==typeof t?r=t:n=t,!r)return this.fromStreamAsync(e,n);this.fromStreamAsync(e,n).then(e=>r(null,e),r)}fromStreamAsync(e,t){return new Promise((r,n)=>{if(!e)throw new Error("Must pass in a stream containing the Google auth settings.");let i="";e.setEncoding("utf8").on("error",n).on("data",e=>i+=e).on("end",()=>{try{const e=JSON.parse(i),o=this.fromJSON(e,t);return r(o)}catch(e){return n(e)}})})}fromAPIKey(e,t){t=t||{};const r=new g.JWT(t);return r.fromAPIKey(e),r}_isWindows(){const e=this._osPlatform();return!!(e&&e.length>=3&&"win"===e.substring(0,3).toLowerCase())}_createReadStream(e){return s.createReadStream(e)}_osPlatform(){return c.platform()}_fileExists(e){return s.existsSync(e)}_pathJoin(e,t){return u.join(e,t)}_mockWellKnownFilePath(e){return e}createError(e,t){let r=e||"";if(t){const e=String(t);e&&e.length>0&&(r.length>0&&(r+=" "),r+=e)}return Error(r)}getDefaultServiceProjectId(){return n(this,void 0,void 0,function*(){return new Promise(e=>{i.exec("gcloud config config-helper --format json",(t,r,n)=>{if(!t&&r)try{const t=JSON.parse(r).configuration.properties.core.project;return void e(t)}catch(e){}e(null)})})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT}getFileProjectId(){return n(this,void 0,void 0,function*(){if(this.cachedCredential)return this.cachedCredential.projectId;const e=yield this._tryGetApplicationCredentialsFromEnvironmentVariable();return e?e.projectId:null})}getGCEProjectId(){return n(this,void 0,void 0,function*(){try{return(yield a.project("project-id")).data}catch(e){return null}})}getCredentials(e){if(!e)return this.getCredentialsAsync();this.getCredentialsAsync().then(t=>e(null,t),e)}getCredentialsAsync(){return n(this,void 0,void 0,function*(){if(this.jsonContent){return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key}}if(!(yield this._checkIsGCE()))throw new Error("Unknown error.");const{data:e}=yield a.instance({property:"service-accounts/",params:{recursive:!0}});if(!e||!e.default||!e.default.email)throw new Error("Failure from metadata server.");return{client_email:e.default.email}})}getClient(e){return n(this,void 0,void 0,function*(){if(e&&(this.keyFilename=e.keyFilename||e.keyFile||this.keyFilename,this.scopes=e.scopes||this.scopes,this.jsonContent=e.credentials||this.jsonContent),!this.cachedCredential)if(this.jsonContent)this.cachedCredential=yield this.fromJSON(this.jsonContent);else if(this.keyFilename){const e=u.resolve(this.keyFilename),t=s.createReadStream(e);this.cachedCredential=yield this.fromStreamAsync(t)}else yield this.getApplicationDefaultAsync();return this.cachedCredential})}getAccessToken(){return n(this,void 0,void 0,function*(){const e=yield this.getClient();return(yield e.getAccessToken()).token})}getRequestHeaders(e){return n(this,void 0,void 0,function*(){return(yield this.getClient()).getRequestHeaders(e)})}authorizeRequest(e){return n(this,void 0,void 0,function*(){const t=(e=e||{}).url||e.uri,r=yield this.getClient(),n=yield r.getRequestHeaders(t);return e.headers=Object.assign(e.headers||{},n),e})}request(e){return n(this,void 0,void 0,function*(){return(yield this.getClient()).request(e)})}getEnv(){return d.getEnv()}sign(e){return n(this,void 0,void 0,function*(){const t=yield this.getClient();if(t instanceof g.JWT&&t.key){const r=o.createSign("RSA-SHA256");return r.update(e),r.sign(t.key,"base64")}const r=yield this.getProjectId();if(!r)throw new Error("Cannot sign data without a project ID.");const n=yield this.getCredentials();if(!n.client_email)throw new Error("Cannot sign data without `client_email`.");const i=`projects/${r}/serviceAccounts/${n.client_email}`;return(yield this.request({method:"POST",url:`https://iam.googleapis.com/v1/${i}:signBlob`,data:{bytesToSign:Buffer.from(e).toString("base64")}})).data.signature})}}y.DefaultTransporter=p.DefaultTransporter,t.GoogleAuth=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(40);function i(e){return e}function o(e){var t=e.config.raxConfig||{};t.currentRetryAttempt=t.currentRetryAttempt||0,t.retry=void 0===t.retry||null===t.retry?3:t.retry,t.retryDelay=t.retryDelay||100,t.instance=t.instance||n.default,t.httpMethodsToRetry=t.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],t.noResponseRetries=void 0===t.noResponseRetries||null===t.noResponseRetries?2:t.noResponseRetries;if(t.statusCodesToRetry=t.statusCodesToRetry||[[100,199],[429,429],[500,599]],e.config.raxConfig=t,!(t.shouldRetry||s)(e))return Promise.reject(e);var r=(Math.pow(2,t.currentRetryAttempt)-1)/2*1e3;e.config.raxConfig.currentRetryAttempt+=1;var i=new Promise(function(e){setTimeout(e,r)});return t.onRetryAttempt&&t.onRetryAttempt(e),i.then(function(){return t.instance.request(e.config)})}function s(e){var t=e.config.raxConfig;if(!t||0===t.retry)return!1;if(!e.response&&(t.currentRetryAttempt||0)>=t.noResponseRetries)return!1;if(!e.config.method||t.httpMethodsToRetry.indexOf(e.config.method.toUpperCase())<0)return!1;if(e.response&&e.response.status){for(var r=!1,n=0,i=t.statusCodesToRetry;n<i.length;n++){var o=i[n],s=o[0],a=o[1],c=e.response.status;if(c>=s&&c<=a){r=!0;break}}if(!r)return!1}return t.currentRetryAttempt=t.currentRetryAttempt||0,!(t.currentRetryAttempt>=t.retry)}t.attach=function(e){return(e=e||n.default).interceptors.response.use(i,o)},t.detach=function(e,t){(t=t||n.default).interceptors.response.eject(e)},t.getConfig=function(e){if(e&&e.config)return e.config.raxConfig}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validate=function(e){const t=[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}];for(const r of t)if(e[r.invalid]){const e=`'${r.invalid}' is not a valid configuration option. Please use '${r.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`;throw new Error(e)}}},function(e,t,r){var n=r(366),i=r(156),o=r(14),s=r(367),a=r(4).inherits,c=r(372)("https-proxy-agent");function u(e){if(!(this instanceof u))return new u(e);if("string"==typeof e&&(e=o.parse(e)),!e)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");c("creating new HttpsProxyAgent instance: %o",e),s.call(this,e);var t=Object.assign({},e);this.secureProxy=!!t.protocol&&/^https:?$/i.test(t.protocol),t.host=t.hostname||t.host,t.port=+t.port||(this.secureProxy?443:80),!this.secureProxy||"ALPNProtocols"in t||(t.ALPNProtocols=["http 1.1"]),t.host&&t.path&&(delete t.path,delete t.pathname),this.proxy=t,this.defaultPort=443}e.exports=u,a(u,s),u.prototype.callback=function(e,t,r){var o,s=this.proxy;o=this.secureProxy?i.connect(s):n.connect(s);var a=[],u=0;function l(){var e=o.read();e?g(e):o.once("readable",l)}function h(){o.removeListener("data",g),o.removeListener("end",f),o.removeListener("error",d),o.removeListener("close",p),o.removeListener("readable",l)}function p(e){c("onclose had error %o",e)}function f(){c("onend")}function d(e){h(),r(e)}function g(n){a.push(n),u+=n.length;var s=Buffer.concat(a,u),p=s.toString("ascii");if(!~p.indexOf("\r\n\r\n"))return c("have not received end of HTTP headers yet..."),void(o.read?l():o.once("data",g));var f=p.substring(0,p.indexOf("\r\n")),d=+f.split(" ")[1];if(c("got proxy server response: %o",f),200==d){var y=o;a=s=null,t.secureEndpoint&&(c("upgrading proxy-connected socket to TLS connection: %o",t.host),t.socket=o,t.servername=t.servername||t.host,t.host=null,t.hostname=null,t.port=null,y=i.connect(t)),h(),r(null,y)}else h(),a=s,e.once("socket",m),r(null,o)}function m(e){if("function"==typeof e.ondata)e.ondata(a,0,a.length);else{if(!(e.listeners("data").length>0))throw new Error("should not happen...");e.emit("data",a)}a=null}o.on("error",d),o.on("close",p),o.on("end",f),o.read?l():o.once("data",g);var y="CONNECT "+(t.host+":"+t.port)+" HTTP/1.1\r\n",v=Object.assign({},s.headers);s.auth&&(v["Proxy-Authorization"]="Basic "+Buffer.from(s.auth).toString("base64"));var b,_,E=t.host;b=t.port,_=t.secureEndpoint,Boolean(!_&&80===b||_&&443===b)||(E+=":"+t.port),v.Host=E,v.Connection="close",Object.keys(v).forEach(function(e){y+=e+": "+v[e]+"\r\n"}),o.write(y+"\r\n")}},function(e,t){e.exports=require("net")},function(e,t,r){"use strict";r(368);const n=r(4).inherits,i=r(369),o=r(12).EventEmitter;function s(e,t){if(!(this instanceof s))return new s(e,t);o.call(this),this._promisifiedCallback=!1;let r=t;"function"==typeof e?this.callback=e:e&&(r=e),this.timeout=r&&r.timeout||null,this.options=r}e.exports=s,n(s,o),s.prototype.callback=function(e,t){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')},s.prototype.addRequest=function(e,t){const r=Object.assign({},t);null==r.host&&(r.host="localhost"),null==r.port&&(r.port=r.secureEndpoint?443:80);const n=Object.assign({},this.options,r);let o;n.host&&n.path&&delete n.path,delete n.agent,delete n.hostname,delete n._defaultAgent,delete n.defaultPort,delete n.createConnection,e._last=!0,e.shouldKeepAlive=!1;let s=!1;const a=this.timeout,c=this.freeSocket;function u(t){e._hadError||(e.emit("error",t),e._hadError=!0)}function l(e){s||(null!=o&&(clearTimeout(o),o=null),u(e))}!this._promisifiedCallback&&this.callback.length>=3&&(this.callback=i(this.callback,this),this._promisifiedCallback=!0),a>0&&(o=setTimeout(function(){o=null,s=!0;const e=new Error('A "socket" was not created for HTTP request before '+a+"ms");e.code="ETIMEOUT",u(e)},a));try{Promise.resolve(this.callback(e,n)).then(function(t){var r;s||(null!=o&&(clearTimeout(o),o=null),(r=t)&&"function"==typeof r.addRequest?t.addRequest(e,n):t?(t.on("free",function(){c(t,n)}),e.onSocket(t)):u(new Error("no Duplex stream was returned to agent-base for `"+e.method+" "+e.path+"`")))},l)}catch(e){Promise.reject(e).catch(l)}},s.prototype.freeSocket=function(e,t){e.destroy()}},function(e,t,r){"use strict";const n=r(14),i=r(23);var o;i.request=(o=i.request,function(e,t){let r;return null==(r="string"==typeof e?n.parse(e):Object.assign({},e)).port&&(r.port=443),r.secureEndpoint=!0,o.call(i,r,t)}),i.get=function(e,t){const r=i.request(e,t);return r.end(),r}},function(e,t,r){"use strict";e.exports=function(){var e=r(370);return function(t,r){return function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=r&&r.multiArgs,a=void 0;return r&&r.thisArg?a=r.thisArg:r&&(a=r),new e(function(e,r){i.push(function(t){if(t)return r(t);for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(!1==!!s)return e(i[0]);e(i)});var n,o=t.apply(a,i);(n=o)&&"function"==typeof n.then&&"function"==typeof n.catch&&e(o)})}}}()},function(e,t,r){"use strict";e.exports=function(){var e=void 0;return e=void 0!==global?global:void 0!==window&&window.document?window:self,function(){if(!e.hasOwnProperty("Promise"))return!1;var t,r=e.Promise;return!(!r.hasOwnProperty("resolve")||!r.hasOwnProperty("reject"))&&(!(!r.hasOwnProperty("all")||!r.hasOwnProperty("race"))&&(t=void 0,!!new e.Promise(function(e){t=e})&&"function"==typeof t))}()?e.Promise:r(371).Promise}()},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.5+7f2b526d
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,i=void 0,o=function(e,t){p[r]=e,p[r+1]=t,2===(r+=2)&&(i?i(f):v())},s="undefined"!=typeof window?window:void 0,a=s||{},c=a.MutationObserver||a.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(f,1)}}var p=new Array(1e3);function f(){for(var e=0;e<r;e+=2){(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0}r=0}var d,g,m,y,v=void 0;function b(e,t){var r=this,n=new this.constructor(C);void 0===n[E]&&j(n);var i=r._state;if(i){var s=arguments[i-1];o(function(){return P(i,n,s,r._result)})}else B(r,n,e,t);return n}function _(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(C);return k(t,e),t}u?v=function(){return process.nextTick(f)}:c?(g=0,m=new c(f),y=document.createTextNode(""),m.observe(y,{characterData:!0}),v=function(){y.data=g=++g%2}):l?((d=new MessageChannel).port1.onmessage=f,v=function(){return d.port2.postMessage(0)}):v=void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(f)}:h()}catch(e){return h()}}():h();var E=Math.random().toString(36).substring(2);function C(){}var w=void 0,S=1,T=2,A={error:null};function I(e){try{return e.then}catch(e){return A.error=e,A}}function N(t,r,n){r.constructor===t.constructor&&n===b&&r.constructor.resolve===_?function(e,t){t._state===S?O(e,t._result):t._state===T?x(e,t._result):B(t,void 0,function(t){return k(e,t)},function(t){return x(e,t)})}(t,r):n===A?(x(t,A.error),A.error=null):void 0===n?O(t,r):e(n)?function(e,t,r){o(function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,function(r){n||(n=!0,t!==r?k(e,r):O(e,r))},function(t){n||(n=!0,x(e,t))},e._label);!n&&i&&(n=!0,x(e,i))},e)}(t,r,n):O(t,r)}function k(e,t){var r,n;e===t?x(e,new TypeError("You cannot resolve a promise with itself")):(n=typeof(r=t),null===r||"object"!==n&&"function"!==n?O(e,t):N(e,t,I(t)))}function R(e){e._onerror&&e._onerror(e._result),D(e)}function O(e,t){e._state===w&&(e._result=t,e._state=S,0!==e._subscribers.length&&o(D,e))}function x(e,t){e._state===w&&(e._state=T,e._result=t,o(R,e))}function B(e,t,r,n){var i=e._subscribers,s=i.length;e._onerror=null,i[s]=t,i[s+S]=r,i[s+T]=n,0===s&&e._state&&o(D,e)}function D(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?P(r,n,i,o):i(o);e._subscribers.length=0}}function P(t,r,n,i){var o=e(n),s=void 0,a=void 0,c=void 0,u=void 0;if(o){if((s=function(e,t){try{return e(t)}catch(e){return A.error=e,A}}(n,i))===A?(u=!0,a=s.error,s.error=null):c=!0,r===s)return void x(r,new TypeError("A promises callback cannot return that same promise."))}else s=i,c=!0;r._state!==w||(o&&c?k(r,s):u?x(r,a):t===S?O(r,s):t===T&&x(r,s))}var L=0;function j(e){e[E]=L++,e._state=void 0,e._result=void 0,e._subscribers=[]}var U=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(C),this.promise[E]||j(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&O(this.promise,this._result))):x(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===w&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===_){var i=I(e);if(i===b&&e._state!==w)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===M){var o=new r(C);N(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===w&&(this._remaining--,e===T?x(n,r):this._result[t]=r),0===this._remaining&&O(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;B(e,void 0,function(e){return r._settledAt(S,t,e)},function(e){return r._settledAt(T,t,e)})},e}(),M=function(){function t(e){this[E]=L++,this._result=this._state=void 0,this._subscribers=[],C!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t(function(t){k(e,t)},function(t){x(e,t)})}catch(t){x(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):this.then(t,t)},t}();return M.prototype.then=b,M.all=function(e){return new U(this,e).promise},M.race=function(e){var r=this;return t(e)?new r(function(t,n){for(var i=e.length,o=0;o<i;o++)r.resolve(e[o]).then(t,n)}):new r(function(e,t){return t(new TypeError("You must pass an array to race."))})},M.resolve=_,M.reject=function(e){var t=new this(C);return x(t,e),t},M._setScheduler=function(e){i=e},M._setAsap=function(e){o=e},M._asap=o,M.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=M},M.Promise=M,M},e.exports=n()},function(e,t,r){"use strict";"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(373):e.exports=r(374)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))}),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=r(231)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t,r){"use strict";var n=r(66),i=r(4);t.init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return process.stderr.write(i.format.apply(i,arguments)+"\n")},t.formatArgs=function(r){var n=this.namespace;if(this.useColors){var i=this.color,o="[3"+(i<8?i:"8;5;"+i),s="  ".concat(o,";1m").concat(n," [0m");r[0]=s+r[0].split("\n").join("\n"+s),r.push(o+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var o=r(67);o&&(o.stderr||o).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),e.exports=r(231)(t);var s=e.exports.formatters;s.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},function(e){e.exports={_from:"google-auth-library@^2.0.0",_id:"google-auth-library@2.0.1",_inBundle:!1,_integrity:"sha512-CWLKZxqYw4SE+fE3GWbVT9r/10h75w8lB3cdmmLpLtCfccFDcsI84qI5rx7npemlrHtKJh3C2HUz4s6SihCeIQ==",_location:"/google-auth-library",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"google-auth-library@^2.0.0",name:"google-auth-library",escapedName:"google-auth-library",rawSpec:"^2.0.0",saveSpec:null,fetchSpec:"^2.0.0"},_requiredBy:["/google-gax"],_resolved:"https://registry.npmjs.org/google-auth-library/-/google-auth-library-2.0.1.tgz",_shasum:"32c6215e771538ef826cb65391a984a2c62ba57c",_spec:"google-auth-library@^2.0.0",_where:"D:\\Projects\\webhooks\\node_modules\\google-gax",author:{name:"Google Inc."},bugs:{url:"https://github.com/google/google-auth-library-nodejs/issues"},bundleDependencies:!1,dependencies:{axios:"^0.18.0","gcp-metadata":"^0.7.0",gtoken:"^2.3.0","https-proxy-agent":"^2.2.1",jws:"^3.1.5","lodash.isstring":"^4.0.1","lru-cache":"^4.1.3",semver:"^5.5.0"},deprecated:!1,description:"Google APIs Authentication Client Library for Node.js",devDependencies:{"@types/jws":"^3.1.0","@types/lodash.isstring":"^4.0.3","@types/lru-cache":"^4.1.0","@types/mocha":"^5.2.1","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/nock":"^9.1.3","@types/node":"^10.5.1","@types/pify":"^3.0.2","@types/semver":"^5.5.0","@types/sinon":"^5.0.1","@types/tmp":"^0.0.33","assert-rejects":"^1.0.0",codecov:"^3.0.2","gh-pages":"^2.0.0",gts:"^0.8.0","intelli-espower-loader":"^1.0.1","js-green-licenses":"^0.5.0",keypair:"^1.0.1",mocha:"^5.2.0",mv:"^2.1.1",ncp:"^2.0.0",nock:"^10.0.0",nyc:"^13.0.0",pify:"^4.0.0",prettier:"^1.13.4",sinon:"^7.0.0","source-map-support":"^0.5.6",tmp:"^0.0.33",typedoc:"^0.13.0",typescript:"~3.1.0"},engines:{node:">=6"},files:["LICENSE","README.md","build/src","!build/src/**/*.map","package.json"],homepage:"https://github.com/google/google-auth-library-nodejs#readme",keywords:["google","api","google apis","client","client library"],license:"Apache-2.0",main:"./build/src/index.js",name:"google-auth-library",nyc:{exclude:["build/test"]},repository:{type:"git",url:"git+https://github.com/google/google-auth-library-nodejs.git"},scripts:{check:"gts check",clean:"gts clean",codecov:"nyc report --reporter=json && codecov -f coverage/*.json",compile:"tsc -p .",docs:"exit 0; typedoc --excludePrivate --excludeExternals --mode modules --out docs src && touch docs/.nojekyll",fix:"gts fix && npm run fix-samples","fix-samples":"prettier --write --single-quote samples/*.js","license-check":"jsgl --local .",lint:"npm run check",posttest:"npm run check && npm run license-check",prepare:"npm run compile","presystem-test":"npm run compile",pretest:"npm run compile","publish-docs":"gh-pages --dotfiles --dist docs --remote upstream","samples-test":"mocha samples/system-test","system-test":"mocha build/system-test",test:"npm run test-only","test-only":"nyc mocha build/test"},types:"./build/src/index.d.ts",version:"2.0.1"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(33);t.PemVerifier=class{verify(e,t,r,i){const o=n.createVerify("sha256");return o.update(t),o.verify(e,r,i)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12),i=r(155);t.AuthClient=class extends n.EventEmitter{constructor(){super(...arguments),this.transporter=new i.DefaultTransporter,this.credentials={}}setCredentials(e){this.credentials=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LoginTicket=class{constructor(e,t){this.envelope=e,this.payload=t}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){const e=this.getPayload();return e&&e.sub?e.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(153);var o;let s;!function(e){e.APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.NONE="NONE"}(o=t.GCPEnv||(t.GCPEnv={})),t.clear=function(){s=void 0},t.getEnv=function(){return n(this,void 0,void 0,function*(){return s||(s=process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?o.APP_ENGINE:process.env.FUNCTION_NAME?o.CLOUD_FUNCTIONS:(yield function(){return n(this,void 0,void 0,function*(){try{return yield i.instance("attributes/cluster-name"),!0}catch(e){return!1}})}())?o.KUBERNETES_ENGINE:(yield function(){return n(this,void 0,void 0,function*(){return i.isAvailable()})}())?o.COMPUTE_ENGINE:o.NONE),s})}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=n[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var a,c=r(40),u=r(8),l=r(76),h=r(381),p=r(385),f=r(233),d=p(u.readFile),g=function(e){function t(t,r){var n=e.call(this,t)||this;return n.code=r,n}return i(t,e),t}(Error),m=function(){function e(e){this.token=null,this.expiresAt=null,this.rawToken=null,this.tokenExpires=null,this.configure(e)}return e.prototype.hasExpired=function(){var e=(new Date).getTime();return!this.token||!this.expiresAt||e>=this.expiresAt},e.prototype.getToken=function(e){if(!e)return this.getTokenAsync();this.getTokenAsync().then(function(t){e(null,t)}).catch(e)},e.prototype.getCredentials=function(e){return o(this,void 0,void 0,function(){var t,n,i,o,c;return s(this,function(s){switch(s.label){case 0:switch(t=h.getType(e),t){case"application/json":return[3,1];case"application/x-x509-ca-cert":return[3,3];case"application/x-pkcs12":return[3,5]}return[3,9];case 1:return[4,d(e,"utf8")];case 2:if(n=s.sent(),i=JSON.parse(n),c=i.private_key,o=i.client_email,!c||!o)throw new g("private_key and client_email are required.","MISSING_CREDENTIALS");return[2,{privateKey:c,clientEmail:o}];case 3:return[4,d(e,"utf8")];case 4:return[2,{privateKey:c=s.sent()}];case 5:return a?[3,7]:[4,Promise.resolve().then(function(){return r(386)})];case 6:a=s.sent().getPem,s.label=7;case 7:return[4,a(e)];case 8:return[2,{privateKey:c=s.sent()}];case 9:throw new g("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, *.pem, and *.p12.","UNKNOWN_CERTIFICATE_TYPE")}})})},e.prototype.getTokenAsync=function(){return o(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:if(!this.hasExpired())return[2,Promise.resolve(this.token)];if(!this.key&&!this.keyFile)throw new Error("No key or keyFile set.");return this.key||!this.keyFile?[3,2]:[4,this.getCredentials(this.keyFile)];case 1:e=t.sent(),this.key=e.privateKey,this.iss=e.clientEmail||this.iss,e.clientEmail||this.ensureEmail(),t.label=2;case 2:return[2,this.requestToken()]}})})},e.prototype.ensureEmail=function(){if(!this.iss)throw new g("email is required.","MISSING_CREDENTIALS")},e.prototype.revokeToken=function(e){if(!e)return this.revokeTokenAsync();this.revokeTokenAsync().then(function(){return e()}).catch(e)},e.prototype.revokeTokenAsync=function(){return o(this,void 0,void 0,function(){var e=this;return s(this,function(t){if(!this.token)throw new Error("No token to revoke.");return[2,c.default.get("https://accounts.google.com/o/oauth2/revoke?token="+this.token).then(function(t){e.configure({email:e.iss,sub:e.sub,key:e.key,keyFile:e.keyFile,scope:e.scope,additionalClaims:e.additionalClaims})})]})})},e.prototype.configure=function(e){void 0===e&&(e={}),this.keyFile=e.keyFile,this.key=e.key,this.token=this.expiresAt=this.rawToken=null,this.iss=e.email||e.iss,this.sub=e.sub,this.additionalClaims=e.additionalClaims,"object"==typeof e.scope?this.scope=e.scope.join(" "):this.scope=e.scope},e.prototype.requestToken=function(){return o(this,void 0,void 0,function(){var e,t,r,n,i=this;return s(this,function(o){return e=Math.floor((new Date).getTime()/1e3),t=this.additionalClaims||{},r=Object.assign({iss:this.iss,scope:this.scope,aud:"https://www.googleapis.com/oauth2/v4/token",exp:e+3600,iat:e,sub:this.sub},t),n=l.sign({header:{alg:"RS256"},payload:r,secret:this.key}),[2,c.default.post("https://www.googleapis.com/oauth2/v4/token",f.stringify({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:n}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){return i.rawToken=t.data,i.token=t.data.access_token,i.expiresAt=null===t.data.expires_in||void 0===t.data.expires_in?null:1e3*(e+t.data.expires_in),i.token}).catch(function(e){i.token=null,i.tokenExpires=null;var t=e.response&&e.response.data?e.response.data:{},r=e;if(t.error){var n=t.error_description?": "+t.error_description:"";r=new Error(""+t.error+n)}throw r})]})})},e}();t.GoogleToken=m},function(e,t,r){"use strict";var n=r(382);e.exports=new n(r(383),r(384))},function(e,t,r){"use strict";function n(){this._types=Object.create(null),this._extensions=Object.create(null);for(var e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}n.prototype.define=function(e,t){for(var r in e){for(var n=e[r],i=0;i<n.length;i++){if("*"!=(o=n[i])[0]){if(!t&&o in this._types)throw new Error('Attempt to change mapping for "'+o+'" extension from "'+this._types[o]+'" to "'+r+'". Pass `force=true` to allow this, otherwise remove "'+o+'" from the list of extensions for "'+r+'".');this._types[o]=r}}if(t||!this._extensions[r]){var o=n[0];this._extensions[r]="*"!=o[0]?o:o.substr(1)}}},n.prototype.getType=function(e){var t=(e=String(e)).replace(/^.*[\/\\]/,"").toLowerCase(),r=t.replace(/^.*\./,"").toLowerCase(),n=t.length<e.length;return(r.length<t.length-1||!n)&&this._types[r]||null},n.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=n},function(e){e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomsvc+xml":["atomsvc"],"application/bdoc":["bdoc"],"application/ccxml+xml":["ccxml"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma","es"],"application/emma+xml":["emma"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-diff+xml":["xdf"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/ktx":["ktx"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["x3db","x3dbz"],"model/x3d+vrml":["x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},function(e){e.exports={"application/prs.cww":["cww"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["keynote"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}},function(e,t,r){"use strict";const n=(e,t)=>(function(){const r=t.promiseModule,n=new Array(arguments.length);for(let e=0;e<arguments.length;e++)n[e]=arguments[e];return new r((r,i)=>{t.errorFirst?n.push(function(e,n){if(t.multiArgs){const t=new Array(arguments.length-1);for(let e=1;e<arguments.length;e++)t[e-1]=arguments[e];e?(t.unshift(e),i(t)):r(t)}else e?i(e):r(n)}):n.push(function(e){if(t.multiArgs){const e=new Array(arguments.length-1);for(let t=0;t<arguments.length;t++)e[t]=arguments[t];r(e)}else r(e)}),e.apply(this,n)})});e.exports=((e,t)=>{t=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},t);const r=e=>{const r=t=>"string"==typeof t?e===t:t.test(e);return t.include?t.include.some(r):!t.exclude.some(r)};let i;i="function"==typeof e?function(){return t.excludeMain?e.apply(this,arguments):n(e,t).apply(this,arguments)}:Object.create(Object.getPrototypeOf(e));for(const o in e){const s=e[o];i[o]="function"==typeof s&&r(o)?n(s,t):s}return i})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(387),o=r(397)(n.readFile);function s(e){return o(e,{encoding:"base64"}).then(e=>(function(e){const t=i.util.decode64(e),r=i.asn1.fromDer(t),n=i.pkcs12.pkcs12FromAsn1(r,"notasecret").getBags({friendlyName:"privatekey"});if(n.friendlyName){const e=n.friendlyName[0].key,t=i.pki.privateKeyToPem(e);return t.replace(/\r\n/g,"\n")}throw new Error("Unable to get friendly name.")})(e))}t.getPem=function(e,t){if(!t)return s(e);s(e).then(e=>t(null,e)).catch(e=>t(e,null))}},function(e,t,r){e.exports=r(3),r(56),r(389),r(37),r(157),r(247),r(121),r(391),r(102),r(392),r(249),r(393),r(246),r(159),r(69),r(242),r(244),r(394),r(237),r(243),r(240),r(161),r(22),r(241),r(395),r(396),r(236),r(6)},function(e,t){var r={};e.exports=r;var n={};r.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,u=e[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%o,u=u/o|0;for(;u>0;)a.push(u%o),u=u/o|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),o=[0];for(r=0;r<e.length();++r){for(var s=0,a=e.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var c="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)c+=i;for(r=o.length-1;r>=0;--r)c+=t[o[r]];return c}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},r.decode=function(e,t){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');var r=n[t];if(!r){r=n[t]=[];for(var i=0;i<t.length;++i)r[t.charCodeAt(i)]=i}e=e.replace(/\s/g,"");var o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;i++){var c=r[e.charCodeAt(i)];if(void 0===c)return;for(var u=0,l=c;u<a.length;++u)l+=a[u]*o,a[u]=255&l,l>>=8;for(;l>0;)a.push(255&l),l>>=8}for(var h=0;e[h]===s&&h<e.length-1;++h)a.push(0);return"undefined"!=typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())}},function(e,t,r){var n=r(3);r(56),r(236);var i=e.exports=n.tls;function o(e,t,r){var o=t.entity===n.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:n.cipher.createDecipher("AES-CBC",o?r.keys.server_write_key:r.keys.client_write_key),iv:o?r.keys.server_write_IV:r.keys.client_write_IV},e.write.cipherState={init:!1,cipher:n.cipher.createCipher("AES-CBC",o?r.keys.client_write_key:r.keys.server_write_key),iv:o?r.keys.client_write_IV:r.keys.server_write_IV},e.read.cipherFunction=u,e.write.cipherFunction=s,e.read.macLength=e.write.macLength=r.mac_length,e.read.macFunction=e.write.macFunction=i.hmac_sha1}function s(e,t){var r,o=!1,s=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(s),t.updateSequenceNumber(),r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:n.random.getBytesSync(16),t.cipherState.init=!0;var c=t.cipherState.cipher;return c.start({iv:r}),e.version.minor>=i.Versions.TLS_1_1.minor&&c.output.putBytes(r),c.update(e.fragment),c.finish(a)&&(e.fragment=c.output,e.length=e.fragment.length(),o=!0),o}function a(e,t,r){if(!r){var n=e-t.length()%e;t.fillWithByte(n-1,n)}return!0}function c(e,t,r){var n=!0;if(r){for(var i=t.length(),o=t.last(),s=i-1-o;s<i-1;++s)n=n&&t.at(s)==o;n&&t.truncate(o+1)}return n}i.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:o},i.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:o};function u(e,t){var r,o=!1;0,r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:e.fragment.getBytes(16),t.cipherState.init=!0;var s=t.cipherState.cipher;s.start({iv:r}),s.update(e.fragment),o=s.finish(c);var a=t.macLength,u=n.random.getBytesSync(a),l=s.output.length();l>=a?(e.fragment=s.output.getBytes(l-a),u=s.output.getBytes(a)):e.fragment=s.output.getBytes(),e.fragment=n.util.createBuffer(e.fragment),e.length=e.fragment.length();var h=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),o=function(e,t,r){var i=n.hmac.create();return i.start("SHA1",e),i.update(t),t=i.digest().getBytes(),i.start(null,null),i.update(r),r=i.digest().getBytes(),t===r}(t.macKey,u,h)&&o}},function(e,t,r){var n=r(3);r(246),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},function(e,t,r){var n=r(3);if(r(123),r(22),r(248),r(6),void 0===i)var i=n.jsbn.BigInteger;var o=n.util.ByteBuffer,s="undefined"==typeof Buffer?Uint8Array:Buffer;n.pki=n.pki||{},e.exports=n.pki.ed25519=n.ed25519=n.ed25519||{};var a=n.ed25519;function c(e){var t=e.message;if(t instanceof Uint8Array)return t;var r=e.encoding;if(void 0===t){if(!e.md)throw new TypeError('"options.message" or "options.md" not specified.');t=e.md.digest().getBytes(),r="binary"}if("string"==typeof t&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if("string"==typeof t){if("undefined"!=typeof Buffer)return new Buffer(t,r);t=new o(t,r)}else if(!(t instanceof o))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new s(t.length()),i=0;i<n.length;++i)n[i]=t.at(i);return n}a.constants={},a.constants.PUBLIC_KEY_BYTE_LENGTH=32,a.constants.PRIVATE_KEY_BYTE_LENGTH=64,a.constants.SEED_BYTE_LENGTH=32,a.constants.SIGN_BYTE_LENGTH=64,a.constants.HASH_BYTE_LENGTH=64,a.generateKeyPair=function(e){var t=(e=e||{}).seed;if(void 0===t)t=n.random.getBytesSync(a.constants.SEED_BYTE_LENGTH);else if("string"==typeof t){if(t.length!==a.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+a.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=c({message:t,encoding:"binary"});for(var r=new s(a.constants.PUBLIC_KEY_BYTE_LENGTH),i=new s(a.constants.PRIVATE_KEY_BYTE_LENGTH),o=0;o<32;++o)i[o]=t[o];return function(e,t){var r,n=[x(),x(),x(),x()],i=y(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,N(n,i),C(e,n),r=0;r<32;++r)t[r+32]=e[r]}(r,i),{publicKey:r,privateKey:i}},a.publicKeyFromPrivateKey=function(e){var t=c({message:(e=e||{}).privateKey,encoding:"binary"});if(t.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new s(a.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=t[32+n];return r},a.sign=function(e){var t=c(e=e||{}),r=c({message:e.privateKey,encoding:"binary"});if(r.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new s(a.constants.SIGN_BYTE_LENGTH+t.length);!function(e,t,r,n){var i,o,s=new Float64Array(64),a=[x(),x(),x(),x()],c=y(n,32);c[0]&=248,c[31]&=127,c[31]|=64;var u=r+64;for(i=0;i<r;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=c[32+i];var l=y(e.subarray(32),r+32);for(b(l),N(a,l),C(e,a),i=32;i<64;++i)e[i]=n[i];var h=y(e,r+64);for(b(h),i=32;i<64;++i)s[i]=0;for(i=0;i<32;++i)s[i]=l[i];for(i=0;i<32;++i)for(o=0;o<32;o++)s[i+o]+=h[i]*c[o];v(e.subarray(32),s)}(n,t,t.length,r);for(var i=new s(a.constants.SIGN_BYTE_LENGTH),o=0;o<i.length;++o)i[o]=n[o];return i},a.verify=function(e){var t=c(e=e||{});if(void 0===e.signature)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=c({message:e.signature,encoding:"binary"});if(r.length!==a.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+a.constants.SIGN_BYTE_LENGTH);var n=c({message:e.publicKey,encoding:"binary"});if(n.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+a.constants.PUBLIC_KEY_BYTE_LENGTH);var i,o=new s(a.constants.SIGN_BYTE_LENGTH+t.length),p=new s(a.constants.SIGN_BYTE_LENGTH+t.length);for(i=0;i<a.constants.SIGN_BYTE_LENGTH;++i)o[i]=r[i];for(i=0;i<t.length;++i)o[i+a.constants.SIGN_BYTE_LENGTH]=t[i];return function(e,t,r,n){var i,o=new s(32),a=[x(),x(),x(),x()],c=[x(),x(),x(),x()];if(-1,r<64)return-1;if(function(e,t){var r=x(),n=x(),i=x(),o=x(),s=x(),a=x(),c=x();k(e[2],l),function(e,t){var r;for(r=0;r<16;++r)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(e[1],t),P(i,e[1]),L(o,i,h),D(i,i,e[2]),B(o,e[2],o),P(s,o),P(a,s),L(c,a,s),L(r,c,i),L(r,r,o),function(e,t){var r,n=x();for(r=0;r<16;++r)n[r]=t[r];for(r=250;r>=0;--r)P(n,n),1!==r&&L(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(r,r),L(r,r,i),L(r,r,o),L(r,r,o),L(e[0],r,o),P(n,e[0]),L(n,n,o),S(n,i)&&L(e[0],e[0],m);if(P(n,e[0]),L(n,n,o),S(n,i))return-1;A(e[0])===t[31]>>7&&D(e[0],u,e[0]);return L(e[3],e[0],e[1]),0}(c,n))return-1;for(i=0;i<r;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=n[i];var p=y(e,r);if(b(p),I(a,c,p),N(c,t.subarray(32)),_(a,c),C(o,a),r-=64,T(t,0,o,0)){for(i=0;i<r;++i)e[i]=0;return-1}for(i=0;i<r;++i)e[i]=t[i+64];return r}(p,o,o.length,n)>=0};var u=x(),l=x([1]),h=x([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=x([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=x([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),d=x([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),m=x([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(e,t){var r=n.md.sha512.create(),i=new o(e);r.update(i.getBytes(t),"binary");var c=r.digest().getBytes();if("undefined"!=typeof Buffer)return new Buffer(c,"binary");for(var u=new s(a.constants.HASH_BYTE_LENGTH),l=0;l<64;++l)u[l]=c.charCodeAt(l);return u}function v(e,t){var r,n,i,o;for(n=63;n>=32;--n){for(r=0,i=n-32,o=n-12;i<o;++i)t[i]+=r-16*t[n]*g[i-(n-32)],r=t[i]+128>>8,t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;++i)t[i]+=r-(t[31]>>4)*g[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=r*g[i];for(n=0;n<32;++n)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function b(e){for(var t=new Float64Array(64),r=0;r<64;++r)t[r]=e[r],e[r]=0;v(e,t)}function _(e,t){var r=x(),n=x(),i=x(),o=x(),s=x(),a=x(),c=x(),u=x(),l=x();D(r,e[1],e[0]),D(l,t[1],t[0]),L(r,r,l),B(n,e[0],e[1]),B(l,t[0],t[1]),L(n,n,l),L(i,e[3],t[3]),L(i,i,p),L(o,e[2],t[2]),B(o,o,o),D(s,n,r),D(a,o,i),B(c,o,i),B(u,n,r),L(e[0],s,a),L(e[1],u,c),L(e[2],c,a),L(e[3],s,u)}function E(e,t,r){for(var n=0;n<4;++n)O(e[n],t[n],r)}function C(e,t){var r=x(),n=x(),i=x();!function(e,t){var r,n=x();for(r=0;r<16;++r)n[r]=t[r];for(r=253;r>=0;--r)P(n,n),2!==r&&4!==r&&L(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(i,t[2]),L(r,t[0],i),L(n,t[1],i),w(e,n),e[31]^=A(r)<<7}function w(e,t){var r,n,i,o=x(),s=x();for(r=0;r<16;++r)s[r]=t[r];for(R(s),R(s),R(s),n=0;n<2;++n){for(o[0]=s[0]-65517,r=1;r<15;++r)o[r]=s[r]-65535-(o[r-1]>>16&1),o[r-1]&=65535;o[15]=s[15]-32767-(o[14]>>16&1),i=o[15]>>16&1,o[14]&=65535,O(s,o,1-i)}for(r=0;r<16;r++)e[2*r]=255&s[r],e[2*r+1]=s[r]>>8}function S(e,t){var r=new s(32),n=new s(32);return w(r,e),w(n,t),T(r,0,n,0)}function T(e,t,r,n){return function(e,t,r,n,i){var o,s=0;for(o=0;o<i;++o)s|=e[t+o]^r[n+o];return(1&s-1>>>8)-1}(e,t,r,n,32)}function A(e){var t=new s(32);return w(t,e),1&t[0]}function I(e,t,r){var n,i;for(k(e[0],u),k(e[1],l),k(e[2],l),k(e[3],u),i=255;i>=0;--i)E(e,t,n=r[i/8|0]>>(7&i)&1),_(t,e),_(e,e),E(e,t,n)}function N(e,t){var r=[x(),x(),x(),x()];k(r[0],f),k(r[1],d),k(r[2],l),L(r[3],f,d),I(e,r,t)}function k(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function R(e){var t,r,n=1;for(t=0;t<16;++t)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function O(e,t,r){for(var n,i=~(r-1),o=0;o<16;++o)n=i&(e[o]^t[o]),e[o]^=n,t[o]^=n}function x(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;++t)r[t]=e[t];return r}function B(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]+r[n]}function D(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]-r[n]}function P(e,t){L(e,t,t)}function L(e,t,r){var n,i,o=0,s=0,a=0,c=0,u=0,l=0,h=0,p=0,f=0,d=0,g=0,m=0,y=0,v=0,b=0,_=0,E=0,C=0,w=0,S=0,T=0,A=0,I=0,N=0,k=0,R=0,O=0,x=0,B=0,D=0,P=0,L=r[0],j=r[1],U=r[2],M=r[3],F=r[4],V=r[5],q=r[6],K=r[7],H=r[8],G=r[9],z=r[10],W=r[11],Y=r[12],Q=r[13],$=r[14],J=r[15];o+=(n=t[0])*L,s+=n*j,a+=n*U,c+=n*M,u+=n*F,l+=n*V,h+=n*q,p+=n*K,f+=n*H,d+=n*G,g+=n*z,m+=n*W,y+=n*Y,v+=n*Q,b+=n*$,_+=n*J,s+=(n=t[1])*L,a+=n*j,c+=n*U,u+=n*M,l+=n*F,h+=n*V,p+=n*q,f+=n*K,d+=n*H,g+=n*G,m+=n*z,y+=n*W,v+=n*Y,b+=n*Q,_+=n*$,E+=n*J,a+=(n=t[2])*L,c+=n*j,u+=n*U,l+=n*M,h+=n*F,p+=n*V,f+=n*q,d+=n*K,g+=n*H,m+=n*G,y+=n*z,v+=n*W,b+=n*Y,_+=n*Q,E+=n*$,C+=n*J,c+=(n=t[3])*L,u+=n*j,l+=n*U,h+=n*M,p+=n*F,f+=n*V,d+=n*q,g+=n*K,m+=n*H,y+=n*G,v+=n*z,b+=n*W,_+=n*Y,E+=n*Q,C+=n*$,w+=n*J,u+=(n=t[4])*L,l+=n*j,h+=n*U,p+=n*M,f+=n*F,d+=n*V,g+=n*q,m+=n*K,y+=n*H,v+=n*G,b+=n*z,_+=n*W,E+=n*Y,C+=n*Q,w+=n*$,S+=n*J,l+=(n=t[5])*L,h+=n*j,p+=n*U,f+=n*M,d+=n*F,g+=n*V,m+=n*q,y+=n*K,v+=n*H,b+=n*G,_+=n*z,E+=n*W,C+=n*Y,w+=n*Q,S+=n*$,T+=n*J,h+=(n=t[6])*L,p+=n*j,f+=n*U,d+=n*M,g+=n*F,m+=n*V,y+=n*q,v+=n*K,b+=n*H,_+=n*G,E+=n*z,C+=n*W,w+=n*Y,S+=n*Q,T+=n*$,A+=n*J,p+=(n=t[7])*L,f+=n*j,d+=n*U,g+=n*M,m+=n*F,y+=n*V,v+=n*q,b+=n*K,_+=n*H,E+=n*G,C+=n*z,w+=n*W,S+=n*Y,T+=n*Q,A+=n*$,I+=n*J,f+=(n=t[8])*L,d+=n*j,g+=n*U,m+=n*M,y+=n*F,v+=n*V,b+=n*q,_+=n*K,E+=n*H,C+=n*G,w+=n*z,S+=n*W,T+=n*Y,A+=n*Q,I+=n*$,N+=n*J,d+=(n=t[9])*L,g+=n*j,m+=n*U,y+=n*M,v+=n*F,b+=n*V,_+=n*q,E+=n*K,C+=n*H,w+=n*G,S+=n*z,T+=n*W,A+=n*Y,I+=n*Q,N+=n*$,k+=n*J,g+=(n=t[10])*L,m+=n*j,y+=n*U,v+=n*M,b+=n*F,_+=n*V,E+=n*q,C+=n*K,w+=n*H,S+=n*G,T+=n*z,A+=n*W,I+=n*Y,N+=n*Q,k+=n*$,R+=n*J,m+=(n=t[11])*L,y+=n*j,v+=n*U,b+=n*M,_+=n*F,E+=n*V,C+=n*q,w+=n*K,S+=n*H,T+=n*G,A+=n*z,I+=n*W,N+=n*Y,k+=n*Q,R+=n*$,O+=n*J,y+=(n=t[12])*L,v+=n*j,b+=n*U,_+=n*M,E+=n*F,C+=n*V,w+=n*q,S+=n*K,T+=n*H,A+=n*G,I+=n*z,N+=n*W,k+=n*Y,R+=n*Q,O+=n*$,x+=n*J,v+=(n=t[13])*L,b+=n*j,_+=n*U,E+=n*M,C+=n*F,w+=n*V,S+=n*q,T+=n*K,A+=n*H,I+=n*G,N+=n*z,k+=n*W,R+=n*Y,O+=n*Q,x+=n*$,B+=n*J,b+=(n=t[14])*L,_+=n*j,E+=n*U,C+=n*M,w+=n*F,S+=n*V,T+=n*q,A+=n*K,I+=n*H,N+=n*G,k+=n*z,R+=n*W,O+=n*Y,x+=n*Q,B+=n*$,D+=n*J,_+=(n=t[15])*L,s+=38*(C+=n*U),a+=38*(w+=n*M),c+=38*(S+=n*F),u+=38*(T+=n*V),l+=38*(A+=n*q),h+=38*(I+=n*K),p+=38*(N+=n*H),f+=38*(k+=n*G),d+=38*(R+=n*z),g+=38*(O+=n*W),m+=38*(x+=n*Y),y+=38*(B+=n*Q),v+=38*(D+=n*$),b+=38*(P+=n*J),o=(n=(o+=38*(E+=n*j))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=(o+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),o+=i-1+37*(i-1),e[0]=o,e[1]=s,e[2]=a,e[3]=c,e[4]=u,e[5]=l,e[6]=h,e[7]=p,e[8]=f,e[9]=d,e[10]=g,e[11]=m,e[12]=y,e[13]=v,e[14]=b,e[15]=_}},function(e,t,r){var n=r(3);r(6),r(22),r(123),e.exports=n.kem=n.kem||{};var i=n.jsbn.BigInteger;function o(e,t,r,i){e.generate=function(e,o){for(var s=new n.util.ByteBuffer,a=Math.ceil(o/i)+r,c=new n.util.ByteBuffer,u=r;u<a;++u){c.putInt32(u),t.start(),t.update(e+c.getBytes());var l=t.digest();s.putBytes(l.getBytes(i))}return s.truncate(s.length()-o),s.getBytes()}}n.kem.rsa={},n.kem.rsa.create=function(e,t){var r=(t=t||{}).prng||n.random,o={encrypt:function(t,o){var s,a=Math.ceil(t.n.bitLength()/8);do{s=new i(n.util.bytesToHex(r.getBytesSync(a)),16).mod(t.n)}while(s.equals(i.ZERO));var c=a-(s=n.util.hexToBytes(s.toString(16))).length;return c>0&&(s=n.util.fillString(String.fromCharCode(0),c)+s),{encapsulation:t.encrypt(s,"NONE"),key:e.generate(s,o)}},decrypt:function(t,r,n){var i=t.decrypt(r,"NONE");return e.generate(i,n)}};return o},n.kem.kdf1=function(e,t){o(this,e,0,t||e.digestLength)},n.kem.kdf2=function(e,t){o(this,e,1,t||e.digestLength)}},function(e,t,r){e.exports=r(38),r(158),r(103),r(239),r(248)},function(e,t,r){var n=r(3);r(56),r(37),r(121),r(57),r(69),r(245),r(22),r(6),r(160);var i=n.asn1,o=e.exports=n.pkcs7=n.pkcs7||{};function s(e){var t={},r=[];if(!i.validate(e,o.asn1.recipientInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw s.errors=r,s}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function a(e){for(var t,r=[],o=0;o<e.length;++o)r.push((t=e[o],i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:t.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(t.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function c(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),o=0;o<e.unauthenticatedAttributes.length;++o){var s=e.unauthenticatedAttributes[o];r.values.push(u(s))}t.value.push(r)}return t}function u(e){var t;if(e.type===n.pki.oids.contentType)t=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),o=new Date("2050-01-01T00:00:00Z"),s=e.value;if("string"==typeof s){var a=Date.parse(s);s=isNaN(a)?13===s.length?i.utcTimeToDate(s):i.generalizedTimeToDate(s):new Date(a)}t=s>=r&&s<o?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(s)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(s))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[t])])}function l(e,t,r){var o={};if(!i.validate(t,r,o,[])){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}if(i.derToOid(o.contentType)!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(o.encryptedContent){var a="";if(n.util.isArray(o.encryptedContent))for(var c=0;c<o.encryptedContent.length;++c){if(o.encryptedContent[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=o.encryptedContent[c].value}else a=o.encryptedContent;e.encryptedContent={algorithm:i.derToOid(o.encAlgorithm),parameter:n.util.createBuffer(o.encParameter.value),content:n.util.createBuffer(a)}}if(o.content){a="";if(n.util.isArray(o.content))for(c=0;c<o.content.length;++c){if(o.content[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=o.content[c].value}else a=o.content;e.content=n.util.createBuffer(a)}return e.version=o.version.charCodeAt(0),e.rawCapture=o,o}function h(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}o.messageFromPem=function(e){var t=n.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.messageFromAsn1(s)},o.messageToPem=function(e,t){var r={type:"PKCS7",body:i.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},o.messageFromAsn1=function(e){var t={},r=[];if(!i.validate(e,o.asn1.contentInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw s.errors=r,s}var a,c=i.derToOid(t.contentType);switch(c){case n.pki.oids.envelopedData:a=o.createEnvelopedData();break;case n.pki.oids.encryptedData:a=o.createEncryptedData();break;case n.pki.oids.signedData:a=o.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},o.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(l(e,t,o.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,i=0;i<r.length;++i)e.certificates.push(n.pki.certificateFromAsn1(r[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var o=[],s=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,t)),o.length>0&&s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,o)),s.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),s])},addSigner:function(t){var r=t.issuer,i=t.serialNumber;if(t.certificate){var o=t.certificate;"string"==typeof o&&(o=n.pki.certificateFromPem(o)),r=o.issuer.attributes,i=o.serialNumber}var s=t.key;if(!s)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof s&&(s=n.pki.privateKeyFromPem(s));var a=t.digestAlgorithm||n.pki.oids.sha1;switch(a){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var u=!1,l=!1,h=0;h<c.length;++h){var p=c[h];if(u||p.type!==n.pki.oids.contentType){if(l||p.type!==n.pki.oids.messageDigest);else if(l=!0,u)break}else if(u=!0,l)break}if(!u||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:s,version:1,issuer:r,serialNumber:i,digestAlgorithm:a,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var r;(t=t||{},"object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof n.util.ByteBuffer?r=e.content.bytes():"string"==typeof e.content&&(r=n.util.encodeUtf8(e.content)),t.detached?e.detachedContent=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)]))));0!==e.signers.length&&function(t){var r;r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0];if(!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var o=i.derToOid(e.contentInfo.value[0].value),s=i.toDer(r);for(var a in s.getByte(),i.getBerValueLength(s),s=s.getBytes(),t)t[a].start().update(s);for(var l=new Date,h=0;h<e.signers.length;++h){var p=e.signers[h];if(0===p.authenticatedAttributes.length){if(o!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{p.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),d=0;d<p.authenticatedAttributes.length;++d){var g=p.authenticatedAttributes[d];g.type===n.pki.oids.messageDigest?g.value=t[p.digestAlgorithm].digest():g.type===n.pki.oids.signingTime&&(g.value||(g.value=l)),f.value.push(u(g)),p.authenticatedAttributesAsn1.value.push(u(g))}s=i.toDer(f).getBytes(),p.md.start().update(s)}p.signature=p.key.sign(p.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(c(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var o=e.signers[r],s=o.digestAlgorithm;s in t||(t[s]=n.md[n.pki.oids[s]].create()),0===o.authenticatedAttributes.length?o.md=t[s]:o.md=n.md[n.pki.oids[s]].create()}for(var s in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},o.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){l(e,t,o.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),h(e)}}},o.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=l(e,t,o.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(s(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,a(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,(t=e.encryptedContent,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.parameter.getBytes())]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],o=i.issuer;if(i.serialNumber===t.serialNumber&&o.length===r.length){for(var s=!0,a=0;a<r.length;++a)if(o[a].type!==r[a].type||o[a].value!==r[a].value){s=!1;break}if(s)return i}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var i=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}h(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var i,o,s;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids["aes128-CBC"]:i=16,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:i=24,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:i=32,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:i=24,o=8,s=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(i));else if(t.length()!=i)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+i+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(o));var a=s(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var u=e.recipients[c];if(void 0===u.encryptedContent.content)switch(u.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}}}},function(e,t,r){var n=r(3);r(56),r(102),r(158),r(103),r(6);var i=e.exports=n.ssh=n.ssh||{};function o(e,t){var r=t.toString(16);r[0]>="8"&&(r="00"+r);var i=n.util.hexToBytes(r);e.putInt32(i.length),e.putBytes(i)}function s(e,t){e.putInt32(t.length),e.putString(t)}function a(){for(var e=n.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}i.privateKeyToPutty=function(e,t,r){var i=""===(t=t||"")?"none":"aes256-cbc",c="PuTTY-User-Key-File-2: ssh-rsa\r\n";c+="Encryption: "+i+"\r\n",c+="Comment: "+(r=r||"")+"\r\n";var u=n.util.createBuffer();s(u,"ssh-rsa"),o(u,e.e),o(u,e.n);var l=n.util.encode64(u.bytes(),64),h=Math.floor(l.length/66)+1;c+="Public-Lines: "+h+"\r\n",c+=l;var p,f=n.util.createBuffer();if(o(f,e.d),o(f,e.p),o(f,e.q),o(f,e.qInv),t){var d=f.length()+16-1;d-=d%16;var g=a(f.bytes());g.truncate(g.length()-d+f.length()),f.putBuffer(g);var m=n.util.createBuffer();m.putBuffer(a("\0\0\0\0",t)),m.putBuffer(a("\0\0\0",t));var y=n.aes.createEncryptionCipher(m.truncate(8),"CBC");y.start(n.util.createBuffer().fillWithByte(0,16)),y.update(f.copy()),y.finish();var v=y.output;v.truncate(16),p=n.util.encode64(v.bytes(),64)}else p=n.util.encode64(f.bytes(),64);c+="\r\nPrivate-Lines: "+(h=Math.floor(p.length/66)+1)+"\r\n",c+=p;var b=a("putty-private-key-file-mac-key",t),_=n.util.createBuffer();s(_,"ssh-rsa"),s(_,i),s(_,r),_.putInt32(u.length()),_.putBuffer(u),_.putInt32(f.length()),_.putBuffer(f);var E=n.hmac.create();return E.start("sha1",b),E.update(_.bytes()),c+="\r\nPrivate-MAC: "+E.digest().toHex()+"\r\n"},i.publicKeyToOpenSSH=function(e,t){t=t||"";var r=n.util.createBuffer();return s(r,"ssh-rsa"),o(r,e.e),o(r,e.n),"ssh-rsa "+n.util.encode64(r.bytes())+" "+t},i.privateKeyToOpenSSH=function(e,t){return t?n.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):n.pki.privateKeyToPem(e)},i.getPublicKeyFingerprint=function(e,t){var r=(t=t||{}).md||n.md.md5.create(),i=n.util.createBuffer();s(i,"ssh-rsa"),o(i,e.e),o(i,e.n),r.start(),r.update(i.getBytes());var a=r.digest();if("hex"===t.encoding){var c=a.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a}},function(e,t,r){var n=r(3);r(247),r(249),r(6);var i="forge.task",o={},s=0;n.debug.set(i,"tasks",o);var a={};n.debug.set(i,"queues",a);var c="ready",u="running",l="blocked",h="sleeping",p="done",f="error",d={ready:{}};d.ready.stop=c,d.ready.start=u,d.ready.cancel=p,d.ready.fail=f,d.running={},d.running.stop=c,d.running.start=u,d.running.block=l,d.running.unblock=u,d.running.sleep=h,d.running.wakeup=u,d.running.cancel=p,d.running.fail=f,d.blocked={},d.blocked.stop=l,d.blocked.start=l,d.blocked.block=l,d.blocked.unblock=l,d.blocked.sleep=l,d.blocked.wakeup=l,d.blocked.cancel=p,d.blocked.fail=f,d.sleeping={},d.sleeping.stop=h,d.sleeping.start=h,d.sleeping.block=h,d.sleeping.unblock=h,d.sleeping.sleep=h,d.sleeping.wakeup=h,d.sleeping.cancel=p,d.sleeping.fail=f,d.done={},d.done.stop=p,d.done.start=p,d.done.block=p,d.done.unblock=p,d.done.sleep=p,d.done.wakeup=p,d.done.cancel=p,d.done.fail=f,d.error={},d.error.stop=f,d.error.start=f,d.error.block=f,d.error.unblock=f,d.error.sleep=f,d.error.wakeup=f,d.error.cancel=f,d.error.fail=f;var g=function(e){this.id=-1,this.name=e.name||"?",this.parent=e.parent||null,this.run=e.run,this.subtasks=[],this.error=!1,this.state=c,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=s++,o[this.id]=this};g.prototype.debug=function(e){e=e||"",n.log.debug(i,e,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",a)},g.prototype.next=function(e,t){"function"==typeof e&&(t=e,e=this.name);var r=new g({run:t,name:e,parent:this});return r.state=u,r.type=this.type,r.successCallback=this.successCallback||null,r.failureCallback=this.failureCallback||null,this.subtasks.push(r),this},g.prototype.parallel=function(e,t){return n.util.isArray(e)&&(t=e,e=this.name),this.next(e,function(r){var i=r;i.block(t.length);for(var o=function(e,r){n.task.start({type:e,run:function(e){t[r](e)},success:function(e){i.unblock()},failure:function(e){i.unblock()}})},s=0;s<t.length;s++){o(e+"__parallel-"+r.id+"-"+s,s)}})},g.prototype.stop=function(){this.state=d[this.state].stop},g.prototype.start=function(){this.error=!1,this.state=d[this.state].start,this.state===u&&(this.start=new Date,this.run(this),m(this,0))},g.prototype.block=function(e){e=void 0===e?1:e,this.blocks+=e,this.blocks>0&&(this.state=d[this.state].block)},g.prototype.unblock=function(e){return e=void 0===e?1:e,this.blocks-=e,0===this.blocks&&this.state!==p&&(this.state=u,m(this,0)),this.blocks},g.prototype.sleep=function(e){e=void 0===e?0:e,this.state=d[this.state].sleep;var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=null,t.state=u,m(t,0)},e)},g.prototype.wait=function(e){e.wait(this)},g.prototype.wakeup=function(){this.state===h&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=u,m(this,0))},g.prototype.cancel=function(){this.state=d[this.state].cancel,this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},g.prototype.fail=function(e){if(this.error=!0,y(this,!0),e)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,m(e,0);else{if(null!==this.parent){for(var t=this.parent;null!==t.parent;)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;y(t,!0)}this.failureCallback&&this.failureCallback(this)}};var m=function(e,t){var r=t>30||+new Date-e.swapTime>20,n=function(t){if(t++,e.state===u)if(r&&(e.swapTime=+new Date),e.subtasks.length>0){var n=e.subtasks.shift();n.error=e.error,n.swapTime=e.swapTime,n.userData=e.userData,n.run(n),n.error||m(n,t)}else y(e),e.error||null!==e.parent&&(e.parent.error=e.error,e.parent.swapTime=e.swapTime,e.parent.userData=e.userData,m(e.parent,t))};r?setTimeout(n,0):n(t)},y=function(e,t){e.state=p,delete o[e.id],null===e.parent&&(e.type in a?0===a[e.type].length?n.log.error(i,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type):a[e.type][0]!==e?n.log.error(i,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type):(a[e.type].shift(),0===a[e.type].length?delete a[e.type]:a[e.type][0].start()):n.log.error(i,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type),t||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};e.exports=n.task=n.task||{},n.task.start=function(e){var t=new g({run:e.run,name:e.name||"?"});t.type=e.type,t.successCallback=e.success||null,t.failureCallback=e.failure||null,t.type in a?a[e.type].push(t):(a[t.type]=[t],function(e){e.error=!1,e.state=d[e.state].start,setTimeout(function(){e.state===u&&(e.swapTime=+new Date,e.run(e),m(e,0))},0)}(t))},n.task.cancel=function(e){e in a&&(a[e]=[a[e][0]])},n.task.createCondition=function(){var e={tasks:{},wait:function(t){t.id in e.tasks||(t.block(),e.tasks[t.id]=t)},notify:function(){var t=e.tasks;for(var r in e.tasks={},t)t[r].unblock()}};return e}},function(e,t,r){"use strict";const n=(e,t)=>(function(...r){return new(0,t.promiseModule)((n,i)=>{t.multiArgs?r.push((...e)=>{t.errorFirst?e[0]?i(e):(e.shift(),n(e)):n(e)}):t.errorFirst?r.push((e,t)=>{e?i(e):n(t)}):r.push(n),e.apply(this,r)})});e.exports=((e,t)=>{t=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},t);const r=typeof e;if(null===e||"object"!==r&&"function"!==r)throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${null===e?"null":r}\``);const i=e=>{const r=t=>"string"==typeof t?e===t:t.test(e);return t.include?t.include.some(r):!t.exclude.some(r)};let o;o="function"===r?function(...r){return t.excludeMain?e(...r):n(e,t).apply(this,r)}:Object.create(Object.getPrototypeOf(e));for(const r in e){const s=e[r];o[r]="function"==typeof s&&i(r)?n(s,t):s}return o})},function(e,t,r){"use strict";e.exports=y;var n,i=r(399),o=r(4),s=r(401),a=(n="function"==typeof Symbol&&"1"!==process.env._nodeLRUCacheForceNoSymbol?function(e){return Symbol(e)}:function(e){return"_"+e})("max"),c=n("length"),u=n("lengthCalculator"),l=n("allowStale"),h=n("maxAge"),p=n("dispose"),f=n("noDisposeOnSet"),d=n("lruList"),g=n("cache");function m(){return 1}function y(e){if(!(this instanceof y))return new y(e);"number"==typeof e&&(e={max:e}),e||(e={});var t=this[a]=e.max;(!t||"number"!=typeof t||t<=0)&&(this[a]=1/0);var r=e.length||m;"function"!=typeof r&&(r=m),this[u]=r,this[l]=e.stale||!1,this[h]=e.maxAge||0,this[p]=e.dispose,this[f]=e.noDisposeOnSet||!1,this.reset()}function v(e,t,r,n){var i=r.value;_(e,i)&&(C(e,r),e[l]||(i=void 0)),i&&t.call(n,i.value,i.key,e)}function b(e,t,r){var n=e[g].get(t);if(n){var i=n.value;_(e,i)?(C(e,n),e[l]||(i=void 0)):r&&e[d].unshiftNode(n),i&&(i=i.value)}return i}function _(e,t){if(!t||!t.maxAge&&!e[h])return!1;var r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[h]&&r>e[h]}function E(e){if(e[c]>e[a])for(var t=e[d].tail;e[c]>e[a]&&null!==t;){var r=t.prev;C(e,t),t=r}}function C(e,t){if(t){var r=t.value;e[p]&&e[p](r.key,r.value),e[c]-=r.length,e[g].delete(r.key),e[d].removeNode(t)}}function w(e,t,r,n,i){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=i||0}Object.defineProperty(y.prototype,"max",{set:function(e){(!e||"number"!=typeof e||e<=0)&&(e=1/0),this[a]=e,E(this)},get:function(){return this[a]},enumerable:!0}),Object.defineProperty(y.prototype,"allowStale",{set:function(e){this[l]=!!e},get:function(){return this[l]},enumerable:!0}),Object.defineProperty(y.prototype,"maxAge",{set:function(e){(!e||"number"!=typeof e||e<0)&&(e=0),this[h]=e,E(this)},get:function(){return this[h]},enumerable:!0}),Object.defineProperty(y.prototype,"lengthCalculator",{set:function(e){"function"!=typeof e&&(e=m),e!==this[u]&&(this[u]=e,this[c]=0,this[d].forEach(function(e){e.length=this[u](e.value,e.key),this[c]+=e.length},this)),E(this)},get:function(){return this[u]},enumerable:!0}),Object.defineProperty(y.prototype,"length",{get:function(){return this[c]},enumerable:!0}),Object.defineProperty(y.prototype,"itemCount",{get:function(){return this[d].length},enumerable:!0}),y.prototype.rforEach=function(e,t){t=t||this;for(var r=this[d].tail;null!==r;){var n=r.prev;v(this,e,r,t),r=n}},y.prototype.forEach=function(e,t){t=t||this;for(var r=this[d].head;null!==r;){var n=r.next;v(this,e,r,t),r=n}},y.prototype.keys=function(){return this[d].toArray().map(function(e){return e.key},this)},y.prototype.values=function(){return this[d].toArray().map(function(e){return e.value},this)},y.prototype.reset=function(){this[p]&&this[d]&&this[d].length&&this[d].forEach(function(e){this[p](e.key,e.value)},this),this[g]=new i,this[d]=new s,this[c]=0},y.prototype.dump=function(){return this[d].map(function(e){if(!_(this,e))return{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}},this).toArray().filter(function(e){return e})},y.prototype.dumpLru=function(){return this[d]},y.prototype.inspect=function(e,t){var r="LRUCache {",n=!1;this[l]&&(r+="\n  allowStale: true",n=!0);var i=this[a];i&&i!==1/0&&(n&&(r+=","),r+="\n  max: "+o.inspect(i,t),n=!0);var s=this[h];s&&(n&&(r+=","),r+="\n  maxAge: "+o.inspect(s,t),n=!0);var p=this[u];p&&p!==m&&(n&&(r+=","),r+="\n  length: "+o.inspect(this[c],t),n=!0);var f=!1;return this[d].forEach(function(e){f?r+=",\n  ":(n&&(r+=",\n"),f=!0,r+="\n  ");var i=o.inspect(e.key).split("\n").join("\n  "),a={value:e.value};e.maxAge!==s&&(a.maxAge=e.maxAge),p!==m&&(a.length=e.length),_(this,e)&&(a.stale=!0),a=o.inspect(a,t).split("\n").join("\n  "),r+=i+" => "+a}),(f||n)&&(r+="\n"),r+="}"},y.prototype.set=function(e,t,r){var n=(r=r||this[h])?Date.now():0,i=this[u](t,e);if(this[g].has(e)){if(i>this[a])return C(this,this[g].get(e)),!1;var o=this[g].get(e).value;return this[p]&&(this[f]||this[p](e,o.value)),o.now=n,o.maxAge=r,o.value=t,this[c]+=i-o.length,o.length=i,this.get(e),E(this),!0}var s=new w(e,t,i,n,r);return s.length>this[a]?(this[p]&&this[p](e,t),!1):(this[c]+=s.length,this[d].unshift(s),this[g].set(e,this[d].head),E(this),!0)},y.prototype.has=function(e){return!!this[g].has(e)&&!_(this,this[g].get(e).value)},y.prototype.get=function(e){return b(this,e,!0)},y.prototype.peek=function(e){return b(this,e,!1)},y.prototype.pop=function(){var e=this[d].tail;return e?(C(this,e),e.value):null},y.prototype.del=function(e){C(this,this[g].get(e))},y.prototype.load=function(e){this.reset();for(var t=Date.now(),r=e.length-1;r>=0;r--){var n=e[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{var o=i-t;o>0&&this.set(n.k,n.v,o)}}},y.prototype.prune=function(){var e=this;this[g].forEach(function(t,r){b(e,r,!1)})}},function(e,t,r){"pseudomap"===process.env.npm_package_name&&"test"===process.env.npm_lifecycle_script&&(process.env.TEST_PSEUDOMAP="true"),"function"!=typeof Map||process.env.TEST_PSEUDOMAP?e.exports=r(400):e.exports=Map},function(e,t){var r=Object.prototype.hasOwnProperty;function n(e){if(!(this instanceof n))throw new TypeError("Constructor PseudoMap requires 'new'");if(this.clear(),e)if(e instanceof n||"function"==typeof Map&&e instanceof Map)e.forEach(function(e,t){this.set(t,e)},this);else{if(!Array.isArray(e))throw new TypeError("invalid argument");e.forEach(function(e){this.set(e[0],e[1])},this)}}function i(e,t){return e===t||e!=e&&t!=t}function o(e,t,r){this.key=e,this.value=t,this._index=r}function s(e,t){for(var n=0,o="_"+t,s=o;r.call(e,s);s=o+n++)if(i(e[s].key,t))return e[s]}e.exports=n,n.prototype.forEach=function(e,t){t=t||this,Object.keys(this._data).forEach(function(r){"size"!==r&&e.call(t,this._data[r].value,this._data[r].key)},this)},n.prototype.has=function(e){return!!s(this._data,e)},n.prototype.get=function(e){var t=s(this._data,e);return t&&t.value},n.prototype.set=function(e,t){!function(e,t,n){for(var s=0,a="_"+t,c=a;r.call(e,c);c=a+s++)if(i(e[c].key,t))return void(e[c].value=n);e.size++,e[c]=new o(t,n,c)}(this._data,e,t)},n.prototype.delete=function(e){var t=s(this._data,e);t&&(delete this._data[t._index],this._data.size--)},n.prototype.clear=function(){var e=Object.create(null);e.size=0,Object.defineProperty(this,"_data",{value:e,enumerable:!1,configurable:!0,writable:!1})},Object.defineProperty(n.prototype,"size",{get:function(){return this._data.size},set:function(e){},enumerable:!0,configurable:!0}),n.prototype.values=n.prototype.keys=n.prototype.entries=function(){throw new Error("iterators are not implemented in this version")}},function(e,t){function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function n(e,t){e.tail=new o(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function i(e,t){e.head=new o(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function o(e,t,r,n){if(!(this instanceof o))return new o(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=r,r.Node=o,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)n(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},r.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},r.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},r.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)n.push(o.value);return n},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(68);t.IAMAuth=class{constructor(e,t){this.selector=e,this.token=t,this.selector=e,this.token=t}createScopedRequired(){return n.warn(n.IAM_CREATE_SCOPED_DEPRECATED),!1}getRequestMetadata(e,t){n.warn(n.IAM_GET_REQUEST_METADATA_DEPRECATED),t(null,this.getRequestHeaders())}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(7),i=r(144),o=r(253);let s;class a extends i.Root{constructor(e){super(e)}static getCommonProtoFiles(){const t=["api",n.join("logging","type"),"longrunning","protobuf","rpc","type"].map(t=>n.join(e,"../../","google",t));return s||(s=t.map(e=>o.sync(e).filter(e=>".proto"===n.extname(e)).map(n.normalize)).reduce((e,t)=>e.concat(t),[])),s}resolvePath(t,r){if(r=n.normalize(r),n.isAbsolute(r))return r;const o=n.join(e,n.relative(e,r));return a.getCommonProtoFiles().indexOf(o)>-1?o:i.util.path.resolve.apply(null,[].slice.call(arguments))}}t.GoogleProtoFilesRoot=a,t.loadSync=function(e,t){return(new a).loadSync(e,t)},t.load=function(e,t){return(new a).load(e,t)}}).call(this,"/")},function(e,t,r){var n,i,o;
/**
 * @license protobuf.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/protobuf.js for details
 */i=[r(405)],void 0===(o="function"==typeof(n=function(e,t){"use strict";var n,i={};return i.ByteBuffer=e,i.Long=e.Long||null,i.VERSION="5.0.3",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},float:{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=((n={}).IS_NODE=!("object"!=typeof process||process+""!="[object process]"||process.browser),n.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,r=0;r<e.length;r++){try{t=e[r]()}catch(e){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},n.fetch=function(e,t){if(t&&"function"!=typeof t&&(t=null),n.IS_NODE){var i=r(8);if(t)i.readFile(e,function(e,r){t(e?null:""+r)});else try{return i.readFileSync(e)}catch(e){return null}}else{var o=n.XHR();if(o.open("GET",e,!!t),o.setRequestHeader("Accept","text/plain"),"function"==typeof o.overrideMimeType&&o.overrideMimeType("text/plain"),!t)return o.send(null),200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null;if(o.onreadystatechange=function(){4==o.readyState&&(200==o.status||0==o.status&&"string"==typeof o.responseText?t(o.responseText):t(null))},4==o.readyState)return;o.send(null)}},n.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,function(e,t){return t.toUpperCase()})},n),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,FQTYPEREF:/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.DotProto=function(e,t){var r={},n=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},i=n.prototype;i._readString=function(){var e='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;e.lastIndex=this.index-1;var r=e.exec(this.source);if(!r)throw Error("unterminated string");return this.index=e.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,r[1]},i.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var e,r,n;do{for(e=!1;t.WHITESPACE.test(n=this.source.charAt(this.index));)if("\n"===n&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(n=this.source.charAt(this.index)))return"/";do{if("\n"===n&&++this.line,++this.index===this.source.length)return null;r=n,n=this.source.charAt(this.index)}while("*"!==r||"/"!==n);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;var i=this.index;if(t.DELIM.lastIndex=0,!t.DELIM.test(this.source.charAt(i++)))for(;i<this.source.length&&!t.DELIM.test(this.source.charAt(i));)++i;var o=this.source.substring(this.index,this.index=i);return'"'!==o&&"'"!==o||(this._stringOpen=o),o},i.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},i.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},i.omit=function(e){return this.peek()===e&&(this.next(),!0)},i.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},r.Tokenizer=n;var o=function(e){this.tn=new n(e),this.proto3=!1},s=o.prototype;function a(e,r){var n=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))n=parseInt(e);else if(t.NUMBER_HEX.test(e))n=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(i<0?"-":"")+e);n=parseInt(e.substring(1),8)}if(n=i*n|0,!r&&n<0)throw Error("illegal id value: "+(i<0?"-":"")+e);return n}function c(e){var r=1;if("-"==e.charAt(0)&&(r=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return r*parseInt(e,10);if(t.NUMBER_HEX.test(e))return r*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return r*parseInt(e.substring(1),8);if("inf"===e)return r*(1/0);if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return r*parseFloat(e);throw Error("illegal number value: "+(r<0?"-":"")+e)}function u(e,t,r){void 0===e[t]?e[t]=r:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(r))}return s.parse=function(){var e,r,n={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},i=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!i||null!==n.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),n.package=e;break;case"import":if(!i)throw Error("unexpected 'import'");("public"===(e=this.tn.peek())||(r="weak"===e))&&this.tn.next(),e=this._readString(),this.tn.skip(";"),r||n.imports.push(e);break;case"syntax":if(!i)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(n.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(n,null),i=!1;break;case"enum":this._parseEnum(n),i=!1;break;case"option":this._parseOption(n);break;case"service":this._parseService(n);break;case"extend":this._parseExtend(n);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete n.name,n},o.parse=function(e){return new o(e).parse()},s._readString=function(){var e,t,r="";do{if("'"!==(t=this.tn.next())&&'"'!==t)throw Error("illegal string delimiter: "+t);r+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return r},s._readValue=function(e){var r=this.tn.peek();if('"'===r||"'"===r)return this._readString();if(this.tn.next(),t.NUMBER.test(r))return c(r);if(t.BOOL.test(r))return"true"===r.toLowerCase();if(e&&t.TYPEREF.test(r))return r;throw Error("illegal value: "+r)},s._parseOption=function(e,r){var n=this.tn.next(),i=!1;if("("===n&&(i=!0,n=this.tn.next()),!t.TYPEREF.test(n))throw Error("illegal option name: "+n);var o=n;i&&(this.tn.skip(")"),o="("+o+")",n=this.tn.peek(),t.FQTYPEREF.test(n)&&(o+=n,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,o),r||this.tn.skip(";")},s._parseOptionValue=function(e,r){var n=this.tn.peek();if("{"!==n)u(e.options,r,this._readValue(!0));else for(this.tn.skip("{");"}"!==(n=this.tn.next());){if(!t.NAME.test(n))throw Error("illegal option name: "+r+"."+n);this.tn.omit(":")?u(e.options,r+"."+n,this._readValue(!0)):this._parseOptionValue(e,r+"."+n)}},s._parseService=function(e){var r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal service name at line "+this.tn.line+": "+r);var n={name:r,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if("rpc"!==r)throw Error("illegal service token: "+r);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},s._parseServiceRPC=function(e){var r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal rpc service method name: "+r);var n=r,i={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),"stream"===(r=this.tn.next()).toLowerCase()&&(i.request_stream=!0,r=this.tn.next()),!t.TYPEREF.test(r))throw Error("illegal rpc service request type: "+r);if(i.request=r,this.tn.skip(")"),"returns"!==(r=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+r);if(this.tn.skip("("),"stream"===(r=this.tn.next()).toLowerCase()&&(i.response_stream=!0,r=this.tn.next()),i.response=r,this.tn.skip(")"),"{"===(r=this.tn.peek())){for(this.tn.next();"}"!==(r=this.tn.next());){if("option"!==r)throw Error("illegal rpc service token: "+r);this._parseOption(i)}this.tn.omit(";")}else this.tn.skip(";");void 0===e.rpc&&(e.rpc={}),e.rpc[n]=i},s._parseMessage=function(e,r){var n=!!r,i=this.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(i))throw Error("illegal "+(n?"group":"message")+" name: "+i);for(o.name=i,n&&(this.tn.skip("="),r.id=a(this.tn.next()),o.isGroup=!0),"["===(i=this.tn.peek())&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(i=this.tn.next());)if(t.RULE.test(i))this._parseMessageField(o,i);else if("oneof"===i)this._parseMessageOneOf(o);else if("enum"===i)this._parseEnum(o);else if("message"===i)this._parseMessage(o);else if("option"===i)this._parseOption(o);else if("service"===i)this._parseService(o);else if("extensions"===i)o.hasOwnProperty("extensions")?o.extensions=o.extensions.concat(this._parseExtensionRanges()):o.extensions=this._parseExtensionRanges();else if("reserved"===i)this._parseIgnored();else if("extend"===i)this._parseExtend(o);else{if(!t.TYPEREF.test(i))throw Error("illegal message token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(o,"optional",i)}return this.tn.omit(";"),e.messages.push(o),o},s._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},s._parseMessageField=function(e,r,n){if(!t.RULE.test(r))throw Error("illegal message field rule: "+r);var i,o={rule:r,type:"",name:"",options:{},id:0};if("map"===r){if(n)throw Error("illegal type: "+n);if(this.tn.skip("<"),i=this.tn.next(),!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field type: "+i);if(o.keytype=i,this.tn.skip(","),i=this.tn.next(),!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field: "+i);if(o.type=i,this.tn.skip(">"),i=this.tn.next(),!t.NAME.test(i))throw Error("illegal message field name: "+i);o.name=i,this.tn.skip("="),o.id=a(this.tn.next()),"["===(i=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}else if("group"===(n=void 0!==n?n:this.tn.next())){var s=this._parseMessage(e,o);if(!/^[A-Z]/.test(s.name))throw Error("illegal group name: "+s.name);o.type=s.name,o.name=s.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(n)&&!t.TYPEREF.test(n))throw Error("illegal message field type: "+n);if(o.type=n,i=this.tn.next(),!t.NAME.test(i))throw Error("illegal message field name: "+i);o.name=i,this.tn.skip("="),o.id=a(this.tn.next()),"["===(i=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}return e.fields.push(o),o},s._parseMessageOneOf=function(e){var r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal oneof name: "+r);var n,i=r,o=[];for(this.tn.skip("{");"}"!==(r=this.tn.next());)(n=this._parseMessageField(e,"optional",r)).oneof=i,o.push(n.id);this.tn.omit(";"),e.oneofs[i]=o},s._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},s._parseEnum=function(e){var r={name:"",values:[],options:{}},n=this.tn.next();if(!t.NAME.test(n))throw Error("illegal name: "+n);for(r.name=n,this.tn.skip("{");"}"!==(n=this.tn.next());)if("option"===n)this._parseOption(r);else{if(!t.NAME.test(n))throw Error("illegal name: "+n);this.tn.skip("=");var i={name:n,id:a(this.tn.next(),!0)};"["===(n=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),r.values.push(i)}this.tn.omit(";"),e.enums.push(r)},s._parseExtensionRanges=function(){var t,r,n,i=[];do{for(r=[];;){switch(t=this.tn.next()){case"min":n=e.ID_MIN;break;case"max":n=e.ID_MAX;break;default:n=c(t)}if(r.push(n),2===r.length)break;if("to"!==this.tn.peek()){r.push(n);break}this.tn.next()}i.push(r)}while(this.tn.omit(","));return this.tn.skip(";"),i},s._parseExtend=function(e){var r=this.tn.next();if(!t.TYPEREF.test(r))throw Error("illegal extend reference: "+r);var n={ref:r,fields:[]};for(this.tn.skip("{");"}"!==(r=this.tn.next());)if(t.RULE.test(r))this._parseMessageField(n,r);else{if(!t.TYPEREF.test(r))throw Error("illegal extend token: "+r);if(!this.proto3)throw Error("illegal field rule: "+r);this._parseMessageField(n,"optional",r)}return this.tn.omit(";"),e.messages.push(n),n},s.toString=function(){return"Parser at line "+this.tn.line},r.Parser=o,r}(i,i.Lang),i.Reflect=function(t){var r={},n=function(e,t,r){this.builder=e,this.parent=t,this.name=r,this.className},i=n.prototype;i.fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},i.toString=function(e){return(e?this.className+" ":"")+this.fqn()},i.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},r.T=n;var o=function(e,t,r,i,o){n.call(this,e,t,r),this.className="Namespace",this.children=[],this.options=i||{},this.syntax=o||"proto2"},s=o.prototype=Object.create(n.prototype);s.getChildren=function(e){if(null==(e=e||null))return this.children.slice();for(var t=[],r=0,n=this.children.length;r<n;++r)this.children[r]instanceof e&&t.push(this.children[r]);return t},s.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof l.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof l.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},s.getChild=function(e){for(var t="number"==typeof e?"id":"name",r=0,n=this.children.length;r<n;++r)if(this.children[r][t]===e)return this.children[r];return null},s.resolve=function(e,t){var n,i="string"==typeof e?e.split("."):e,o=this,s=0;if(""===i[s]){for(;null!==o.parent;)o=o.parent;s++}do{do{if(!(o instanceof r.Namespace)){o=null;break}if(!(n=o.getChild(i[s]))||!(n instanceof r.T)||t&&!(n instanceof r.Namespace)){o=null;break}o=n,s++}while(s<i.length);if(null!=o)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=o);return o},s.qn=function(e){var t=[],n=e;do{t.unshift(n.name),n=n.parent}while(null!==n);for(var i=1;i<=t.length;i++){var o=t.slice(t.length-i);if(e===this.resolve(o,e instanceof r.Namespace))return o.join(".")}return e.fqn()},s.build=function(){for(var e,t={},r=this.children,n=0,i=r.length;n<i;++n)(e=r[n])instanceof o&&(t[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},s.buildOpt=function(){for(var e={},t=Object.keys(this.options),r=0,n=t.length;r<n;++r){var i=t[r],o=this.options[t[r]];e[i]=o}return e},s.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},r.Namespace=o;var a=function(e,r,n,i,o){if(this.type=e,this.resolvedType=r,this.isMapKey=n,this.syntax=i,this.name=o,n&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},c=a.prototype;function u(e,r){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low==e.low&&e.high==e.high)return new t.Long(e.low,e.high,void 0===r?e.unsigned:r);if("string"==typeof e)return t.Long.fromString(e,r||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,r||!1);throw Error("not convertible to Long")}a.defaultFieldValue=function(r){if("string"==typeof r&&(r=t.TYPES[r]),void 0===r.defaultValue)throw Error("default value for type "+r.name+" is not supported");return r==t.TYPES.bytes?new e(0):r.defaultValue},c.toString=function(){return(this.name||"")+(this.isMapKey?"map":"value")+" element"},c.verifyValue=function(r){var n=this;function i(e,t){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+e+" ("+t+")")}switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof r||r==r&&r%1!=0)&&i(typeof r,"not an integer"),r>4294967295?0|r:r;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof r||r==r&&r%1!=0)&&i(typeof r,"not an integer"),r<0?r>>>0:r;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return u(r,!1)}catch(e){i(typeof r,e.message)}else i(typeof r,"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return u(r,!0)}catch(e){i(typeof r,e.message)}else i(typeof r,"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof r&&i(typeof r,"not a boolean"),r;case t.TYPES.float:case t.TYPES.double:return"number"!=typeof r&&i(typeof r,"not a number"),r;case t.TYPES.string:return"string"==typeof r||r&&r instanceof String||i(typeof r,"not a string"),""+r;case t.TYPES.bytes:return e.isByteBuffer(r)?r:e.wrap(r,"base64");case t.TYPES.enum:var o=this.resolvedType.getChildren(t.Reflect.Enum.Value);for(a=0;a<o.length;a++){if(o[a].name==r)return o[a].id;if(o[a].id==r)return o[a].id}if("proto3"===this.syntax)return("number"!=typeof r||r==r&&r%1!=0)&&i(typeof r,"not an integer"),(r>4294967295||r<0)&&i(typeof r,"not in range for uint32"),r;i(r,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(r&&"object"==typeof r||i(typeof r,"object expected"),r instanceof this.resolvedType.clazz)return r;if(r instanceof t.Builder.Message){var s={};for(var a in r)r.hasOwnProperty(a)&&(s[a]=r[a]);r=s}return new this.resolvedType.clazz(r)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+r+" (undefined type "+this.type+")")},c.calculateLength=function(r,n){if(null===n)return 0;var i;switch(this.type){case t.TYPES.int32:return n<0?e.calculateVarint64(n):e.calculateVarint32(n);case t.TYPES.uint32:return e.calculateVarint32(n);case t.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(n));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES.float:return 4;case t.TYPES.int64:case t.TYPES.uint64:return e.calculateVarint64(n);case t.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(n));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES.enum:return e.calculateVarint32(n);case t.TYPES.double:return 8;case t.TYPES.string:return i=e.calculateUTF8Bytes(n),e.calculateVarint32(i)+i;case t.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");return e.calculateVarint32(n.remaining())+n.remaining();case t.TYPES.message:return i=this.resolvedType.calculate(n),e.calculateVarint32(i)+i;case t.TYPES.group:return(i=this.resolvedType.calculate(n))+e.calculateVarint32(r<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")},c.encodeValue=function(r,n,i){if(null===n)return i;switch(this.type){case t.TYPES.int32:n<0?i.writeVarint64(n):i.writeVarint32(n);break;case t.TYPES.uint32:i.writeVarint32(n);break;case t.TYPES.sint32:i.writeVarint32ZigZag(n);break;case t.TYPES.fixed32:i.writeUint32(n);break;case t.TYPES.sfixed32:i.writeInt32(n);break;case t.TYPES.int64:case t.TYPES.uint64:i.writeVarint64(n);break;case t.TYPES.sint64:i.writeVarint64ZigZag(n);break;case t.TYPES.fixed64:i.writeUint64(n);break;case t.TYPES.sfixed64:i.writeInt64(n);break;case t.TYPES.bool:"string"==typeof n?i.writeVarint32("false"===n.toLowerCase()?0:!!n):i.writeVarint32(n?1:0);break;case t.TYPES.enum:i.writeVarint32(n);break;case t.TYPES.float:i.writeFloat32(n);break;case t.TYPES.double:i.writeFloat64(n);break;case t.TYPES.string:i.writeVString(n);break;case t.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");var o=n.offset;i.writeVarint32(n.remaining()),i.append(n),n.offset=o;break;case t.TYPES.message:var s=(new e).LE();this.resolvedType.encode(n,s),i.writeVarint32(s.offset),i.append(s.flip());break;case t.TYPES.group:this.resolvedType.encode(n,i),i.writeVarint32(r<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")}return i},c.decode=function(e,r,n){if(r!=this.type.wireType)throw Error("Unexpected wire type for element");var i,o;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES.enum:return e.readVarint32();case t.TYPES.float:return e.readFloat();case t.TYPES.double:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(o=e.readVarint32(),e.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+e.remaining());return(i=e.clone()).limit=i.offset+o,e.offset+=o,i;case t.TYPES.message:return o=e.readVarint32(),this.resolvedType.decode(e,o);case t.TYPES.group:return this.resolvedType.decode(e,-1,n)}throw Error("[INTERNAL] Illegal decode type")},c.valueFromString=function(r){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(r));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(r);case t.TYPES.bool:return"true"===r;case t.TYPES.string:return this.verifyValue(r);case t.TYPES.bytes:return e.fromBinary(r)}},c.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},r.Element=a;var l=function(e,t,r,n,i,s){o.call(this,e,t,r,n,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null},h=l.prototype=Object.create(o.prototype);function p(e,r){var n=r.readVarint32(),i=7&n,o=n>>>3;switch(i){case t.WIRE_TYPES.VARINT:do{n=r.readUint8()}while(128==(128&n));break;case t.WIRE_TYPES.BITS64:r.offset+=8;break;case t.WIRE_TYPES.LDELIM:n=r.readVarint32(),r.offset+=n;break;case t.WIRE_TYPES.STARTGROUP:p(o,r);break;case t.WIRE_TYPES.ENDGROUP:if(o===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:r.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+i)}return!0}h.build=function(r){if(this.clazz&&!r)return this.clazz;var n=function(t,r){var n=r.getChildren(t.Reflect.Message.Field),i=r.getChildren(t.Reflect.Message.OneOf),o=function(s,a){t.Builder.Message.call(this);for(var c=0,u=i.length;c<u;++c)this[i[c].name]=null;for(c=0,u=n.length;c<u;++c){var l=n[c];this[l.name]=l.repeated?[]:l.map?new t.Map(l):null,!l.required&&"proto3"!==r.syntax||null===l.defaultValue||(this[l.name]=l.defaultValue)}var h;if(arguments.length>0)if(1!==arguments.length||null===s||"object"!=typeof s||!("function"!=typeof s.encode||s instanceof o)||Array.isArray(s)||s instanceof t.Map||e.isByteBuffer(s)||s instanceof ArrayBuffer||t.Long&&s instanceof t.Long)for(c=0,u=arguments.length;c<u;++c)void 0!==(h=arguments[c])&&this.$set(n[c].name,h);else this.$set(s)},s=o.prototype=Object.create(t.Builder.Message.prototype);s.add=function(e,n,i){var o=r._fieldsByName[e];if(!i){if(!o)throw Error(this+"#"+e+" is undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+e+" is not a repeated field");n=o.verifyValue(n,!0)}return null===this[e]&&(this[e]=[]),this[e].push(n),this},s.$add=s.add,s.set=function(e,n,i){if(e&&"object"==typeof e){for(var o in i=n,e)e.hasOwnProperty(o)&&void 0!==(n=e[o])&&void 0===r._oneofsByName[o]&&this.$set(o,n,i);return this}var s=r._fieldsByName[e];if(i)this[e]=n;else{if(!s)throw Error(this+"#"+e+" is not a field: undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));this[s.name]=n=s.verifyValue(n)}if(s&&s.oneof){var a=this[s.oneof.name];null!==n?(null!==a&&a!==s.name&&(this[a]=null),this[s.oneof.name]=s.name):a===e&&(this[s.oneof.name]=null)}return this},s.$set=s.set,s.get=function(e,n){if(n)return this[e];var i=r._fieldsByName[e];if(!(i&&i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));return this[i.name]},s.$get=s.get;for(var a=0;a<n.length;a++){var c=n[a];c instanceof t.Reflect.Message.ExtensionField||r.builder.options.populateAccessors&&function(e){var t=e.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});t=t.substring(0,1).toUpperCase()+t.substring(1);var n=e.originalName.replace(/([A-Z])/g,function(e){return"_"+e}),i=function(t,r){return this[e.name]=r?t:e.verifyValue(t),this},o=function(){return this[e.name]};null===r.getChild("set"+t)&&(s["set"+t]=i),null===r.getChild("set_"+n)&&(s["set_"+n]=i),null===r.getChild("get"+t)&&(s["get"+t]=o),null===r.getChild("get_"+n)&&(s["get_"+n]=o)}(c)}function u(r,n,i,o){if(null===r||"object"!=typeof r){if(o&&o instanceof t.Reflect.Enum){var s=t.Reflect.Enum.getName(o.object,r);if(null!==s)return s}return r}if(e.isByteBuffer(r))return n?r.toBase64():r.toBuffer();if(t.Long.isLong(r))return i?r.toString():t.Long.fromValue(r);var a;if(Array.isArray(r))return a=[],r.forEach(function(e,t){a[t]=u(e,n,i,o)}),a;if(a={},r instanceof t.Map){for(var c=r.entries(),l=c.next();!l.done;l=c.next())a[r.keyElem.valueToString(l.value[0])]=u(l.value[1],n,i,r.valueElem.resolvedType);return a}var h=r.$type,p=void 0;for(var f in r)r.hasOwnProperty(f)&&(h&&(p=h.getChild(f))?a[f]=u(r[f],n,i,p.resolvedType):a[f]=u(r[f],n,i));return a}return s.encode=function(t,n){"boolean"==typeof t&&(n=t,t=void 0);var i=!1;t||(t=new e,i=!0);var o=t.littleEndian;try{return r.encode(this,t.LE(),n),(i?t.flip():t).LE(o)}catch(e){throw t.LE(o),e}},o.encode=function(e,t,r){return new o(e).encode(t,r)},s.calculate=function(){return r.calculate(this)},s.encodeDelimited=function(t,n){var i=!1;t||(t=new e,i=!0);var o=(new e).LE();return r.encode(this,o,n).flip(),t.writeVarint32(o.remaining()),t.append(o),i?t.flip():t},s.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},s.toArrayBuffer=s.encodeAB,s.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},s.toBuffer=s.encodeNB,s.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},s.toBase64=s.encode64,s.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},s.toHex=s.encodeHex,s.toRaw=function(e,t){return u(this,!!e,!!t,this.$type)},s.encodeJSON=function(){return JSON.stringify(u(this,!0,!0,this.$type))},o.decode=function(t,n,i){"string"==typeof n&&(i=n,n=-1),"string"==typeof t?t=e.wrap(t,i||"base64"):e.isByteBuffer(t)||(t=e.wrap(t));var o=t.littleEndian;try{var s=r.decode(t.LE(),n);return t.LE(o),s}catch(e){throw t.LE(o),e}},o.decodeDelimited=function(t,n){if("string"==typeof t?t=e.wrap(t,n||"base64"):e.isByteBuffer(t)||(t=e.wrap(t)),t.remaining()<1)return null;var i=t.offset,o=t.readVarint32();if(t.remaining()<o)return t.offset=i,null;try{var s=r.decode(t.slice(t.offset,t.offset+o).LE());return t.offset+=o,s}catch(e){throw t.offset+=o,e}},o.decode64=function(e){return o.decode(e,"base64")},o.decodeHex=function(e){return o.decode(e,"hex")},o.decodeJSON=function(e){return new o(JSON.parse(e))},s.toString=function(){return r.toString()},Object.defineProperty&&(Object.defineProperty(o,"$options",{value:r.buildOpt()}),Object.defineProperty(s,"$options",{value:o.$options}),Object.defineProperty(o,"$type",{value:r}),Object.defineProperty(s,"$type",{value:r})),o}(t,this);this._fields=[],this._fieldsById={},this._fieldsByName={},this._oneofsByName={};for(var i,o=0,s=this.children.length;o<s;o++)if((i=this.children[o])instanceof m||i instanceof l||i instanceof b){if(n.hasOwnProperty(i.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+i.toString(!0)+" cannot override static property '"+i.name+"'");n[i.name]=i.build()}else if(i instanceof l.Field)i.build(),this._fields.push(i),this._fieldsById[i.id]=i,this._fieldsByName[i.name]=i;else if(i instanceof l.OneOf)this._oneofsByName[i.name]=i;else if(!(i instanceof l.OneOf||i instanceof v))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[o].toString(!0));return this.clazz=n},h.encode=function(e,t,r){for(var n,i,o=null,s=0,a=this._fields.length;s<a;++s)i=e[(n=this._fields[s]).name],n.required&&null===i?null===o&&(o=n):n.encode(r?i:n.verifyValue(i),t,e);if(null!==o){var c=Error("Missing at least one required field for "+this.toString(!0)+": "+o);throw c.encoded=t,c}return t},h.calculate=function(e){for(var t,r,n=0,i=0,o=this._fields.length;i<o;++i){if(r=e[(t=this._fields[i]).name],t.required&&null===r)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);n+=t.calculate(r,e)}return n},h.decode=function(e,r,n){"number"!=typeof r&&(r=-1);for(var i,o,s,a,c=e.offset,u=new this.clazz;e.offset<c+r||-1===r&&e.remaining()>0;){if(s=(i=e.readVarint32())>>>3,(o=7&i)===t.WIRE_TYPES.ENDGROUP){if(s!==n)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+s+" ("+(n?n+" expected":"not a group")+")");break}if(a=this._fieldsById[s]){if(a.repeated&&!a.options.packed)u[a.name].push(a.decode(o,e));else if(a.map){var l=a.decode(o,e);u[a.name].set(l[0],l[1])}else if(u[a.name]=a.decode(o,e),a.oneof){var h=u[a.oneof.name];null!==h&&h!==a.name&&(u[h]=null),u[a.oneof.name]=a.name}}else switch(o){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:var f=e.readVarint32();e.offset+=f;break;case t.WIRE_TYPES.STARTGROUP:for(;p(s,e););break;default:throw Error("Illegal wire type for unknown field "+s+" in "+this.toString(!0)+"#decode: "+o)}}for(var d=0,g=this._fields.length;d<g;++d)if(null===u[(a=this._fields[d]).name])if("proto3"===this.syntax)u[a.name]=a.defaultValue;else{if(a.required){var m=Error("Missing at least one required field for "+this.toString(!0)+": "+a.name);throw m.decoded=u,m}t.populateDefaults&&null!==a.defaultValue&&(u[a.name]=a.defaultValue)}return u},r.Message=l;var f=function(e,r,i,o,s,a,c,u,h,p){n.call(this,e,r,a),this.className="Message.Field",this.required="required"===i,this.repeated="repeated"===i,this.map="map"===i,this.keyType=o||null,this.type=s,this.resolvedType=null,this.id=c,this.options=u||{},this.defaultValue=null,this.oneof=h||null,this.syntax=p||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof l.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},d=f.prototype=Object.create(n.prototype);d.build=function(){this.element=new a(this.type,this.resolvedType,!1,this.syntax,this.name),this.map&&(this.keyElement=new a(this.keyType,void 0,!0,this.syntax,this.name)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=a.defaultFieldValue(this.type)},d.verifyValue=function(e,r){r=r||!1;var n,i=this;function o(e,t){throw Error("Illegal value for "+i.toString(!0)+" of type "+i.type.name+": "+e+" ("+t+")")}if(null===e)return this.required&&o(typeof e,"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&o(typeof e,"proto3 field without field presence cannot be null"),null;if(this.repeated&&!r){Array.isArray(e)||(e=[e]);var s=[];for(n=0;n<e.length;n++)s.push(this.element.verifyValue(e[n]));return s}return this.map&&!r?e instanceof t.Map?e:(e instanceof Object||o(typeof e,"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&o(typeof e,"no array expected"),this.element.verifyValue(e))},d.hasWirePresence=function(e,r){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&r[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES.float:case t.TYPES.double:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES.enum:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},d.encode=function(r,n,i){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===r||this.repeated&&0==r.length)return n;try{var o;if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){n.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1);var s=n.offset;for(o=0;o<r.length;o++)this.element.encodeValue(this.id,r[o],n);var a=n.offset-s,c=e.calculateVarint32(a);if(c>1){var u=n.slice(s,n.offset);s+=c-1,n.offset=s,n.append(u)}n.writeVarint32(a,s-c)}else for(o=0;o<r.length;o++)n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,r[o],n);else this.map?r.forEach(function(r,i,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,i)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,r);n.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),n.writeVarint32(s),n.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,i,n),n.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,r,n)},this):this.hasWirePresence(r,i)&&(n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,r,n))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+r+" ("+e+")")}return n},d.calculate=function(r,n){if(r=this.verifyValue(r),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===r||this.repeated&&0==r.length)return 0;var i=0;try{var o,s;if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(i+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),s=0,o=0;o<r.length;o++)s+=this.element.calculateLength(this.id,r[o]);i+=e.calculateVarint32(s),i+=s}else for(o=0;o<r.length;o++)i+=e.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,r[o]);else this.map?r.forEach(function(r,n,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,r);i+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i+=e.calculateVarint32(s),i+=s},this):this.hasWirePresence(r,n)&&(i+=e.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,r))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+r+" ("+e+")")}return i},d.decode=function(e,r,n){var i,o;if(!(!this.map&&e==this.type.wireType||!n&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!n){o=r.readVarint32(),o=r.offset+o;for(var s=[];r.offset<o;)s.push(this.decode(this.type.wireType,r,!0));return s}if(this.map){var c=a.defaultFieldValue(this.keyType);if(i=a.defaultFieldValue(this.type),o=r.readVarint32(),r.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+r.remaining());var u=r.clone();for(u.limit=u.offset+o,r.offset+=o;u.remaining()>0;){var l=u.readVarint32();e=7&l;var h=l>>>3;if(1===h)c=this.keyElement.decode(u,e,h);else{if(2!==h)throw Error("Unexpected tag in map field key/value submessage");i=this.element.decode(u,e,h)}}return[c,i]}return this.element.decode(r,e,this.id)},r.Message.Field=f;var g=function(e,t,r,n,i,o,s){f.call(this,e,t,r,null,n,i,o,s),this.extension};g.prototype=Object.create(f.prototype),r.Message.ExtensionField=g,r.Message.OneOf=function(e,t,r){n.call(this,e,t,r),this.fields=[]};var m=function(e,t,r,n,i){o.call(this,e,t,r,n,i),this.className="Enum",this.object=null};m.getName=function(e,t){for(var r,n=Object.keys(e),i=0;i<n.length;++i)if(e[r=n[i]]===t)return r;return null},(m.prototype=Object.create(o.prototype)).build=function(e){if(this.object&&!e)return this.object;for(var r=new t.Builder.Enum,n=this.getChildren(m.Value),i=0,o=n.length;i<o;++i)r[n[i].name]=n[i].id;return Object.defineProperty&&Object.defineProperty(r,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=r},r.Enum=m;var y=function(e,t,r,i){n.call(this,e,t,r),this.className="Enum.Value",this.id=i};y.prototype=Object.create(n.prototype),r.Enum.Value=y;var v=function(e,t,r,i){n.call(this,e,t,r),this.field=i};v.prototype=Object.create(n.prototype),r.Extension=v;var b=function(e,t,r,n){o.call(this,e,t,r,n),this.className="Service",this.clazz=null};(b.prototype=Object.create(o.prototype)).build=function(r){return this.clazz&&!r?this.clazz:this.clazz=function(t,r){for(var n=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(e,t,r){setTimeout(r.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},i=n.prototype=Object.create(t.Builder.Service.prototype),o=r.getChildren(t.Reflect.Service.RPCMethod),s=0;s<o.length;s++)!function(t){i[t.name]=function(n,i){try{try{n=t.resolvedRequestType.clazz.decode(e.wrap(n))}catch(e){if(!(e instanceof TypeError))throw e}if(null===n||"object"!=typeof n)throw Error("Illegal arguments");n instanceof t.resolvedRequestType.clazz||(n=new t.resolvedRequestType.clazz(n)),this.rpcImpl(t.fqn(),n,function(e,n){if(e)i(e);else{null===n&&(n="");try{n=t.resolvedResponseType.clazz.decode(n)}catch(e){}n&&n instanceof t.resolvedResponseType.clazz?i(null,n):i(Error("Illegal response type received in service method "+r.name+"#"+t.name))}})}catch(e){setTimeout(i.bind(this,e),0)}},n[t.name]=function(e,r,i){new n(e)[t.name](r,i)},Object.defineProperty&&(Object.defineProperty(n[t.name],"$options",{value:t.buildOpt()}),Object.defineProperty(i[t.name],"$options",{value:n[t.name].$options}))}(o[s]);return Object.defineProperty&&(Object.defineProperty(n,"$options",{value:r.buildOpt()}),Object.defineProperty(i,"$options",{value:n.$options}),Object.defineProperty(n,"$type",{value:r}),Object.defineProperty(i,"$type",{value:r})),n}(t,this)},r.Service=b;var _=function(e,t,r,i){n.call(this,e,t,r),this.className="Service.Method",this.options=i||{}};(_.prototype=Object.create(n.prototype)).buildOpt=s.buildOpt,r.Service.Method=_;var E=function(e,t,r,n,i,o,s,a){_.call(this,e,t,r,a),this.className="Service.RPCMethod",this.requestName=n,this.responseName=i,this.requestStream=o,this.responseStream=s,this.resolvedRequestType=null,this.resolvedResponseType=null};return E.prototype=Object.create(_.prototype),r.Service.RPCMethod=E,r}(i),i.Builder=function(e,t,n){var i=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},o=i.prototype;return i.isMessage=function(e){return"string"==typeof e.name&&void 0===e.values&&void 0===e.rpc},i.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},i.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},i.isService=function(e){return!("string"!=typeof e.name||"object"!=typeof e.rpc||!e.rpc)},i.isExtend=function(e){return"string"==typeof e.ref},o.reset=function(){return this.ptr=this.ns,this},o.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach(function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t},this),this},o.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){var o=t.shift();if(i.isMessage(o)){var s=new n.Message(this,this.ptr,o.name,o.options,o.isGroup,o.syntax),a={};o.oneofs&&Object.keys(o.oneofs).forEach(function(e){s.addChild(a[e]=new n.Message.OneOf(this,s,e))},this),o.fields&&o.fields.forEach(function(e){if(null!==s.getChild(0|e.id))throw Error("duplicate or invalid field id in "+s.name+": "+e.id);if(e.options&&"object"!=typeof e.options)throw Error("illegal field options in "+s.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+s.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,s,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,o.syntax),t&&t.fields.push(e),s.addChild(e)},this);var c=[];if(o.enums&&o.enums.forEach(function(e){c.push(e)}),o.messages&&o.messages.forEach(function(e){c.push(e)}),o.services&&o.services.forEach(function(e){c.push(e)}),o.extensions&&("number"==typeof o.extensions[0]?s.extensions=[o.extensions]:s.extensions=o.extensions),this.ptr.addChild(s),c.length>0){r.push(t),t=c,c=null,this.ptr=s,s=null;continue}c=null}else if(i.isEnum(o))s=new n.Enum(this,this.ptr,o.name,o.options,o.syntax),o.values.forEach(function(e){s.addChild(new n.Enum.Value(this,s,e.name,e.id))},this),this.ptr.addChild(s);else if(i.isService(o))s=new n.Service(this,this.ptr,o.name,o.options),Object.keys(o.rpc).forEach(function(e){var t=o.rpc[e];s.addChild(new n.Service.RPCMethod(this,s,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))},this),this.ptr.addChild(s);else{if(!i.isExtend(o))throw Error("not a valid definition: "+JSON.stringify(o));if(s=this.ptr.resolve(o.ref,!0))o.fields.forEach(function(t){if(null!==s.getChild(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(s.extensions){var r=!1;if(s.extensions.forEach(function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)}),!r)throw Error("illegal extended field id in "+s.name+": "+t.id+" (not within valid ranges)")}var i=t.name;this.options.convertFieldsToCamelCase&&(i=e.Util.toCamelCase(i));var o=new n.Message.ExtensionField(this,s,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),a=new n.Extension(this,this.ptr,t.name,o);o.extension=a,this.ptr.addChild(a),s.addChild(o)},this);else if(!/\.?google\.protobuf\./.test(o.ref))throw Error("extended message "+o.ref+" is not defined")}o=null,s=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},o.import=function(t,n){var i="/";if("string"==typeof n){if(e.Util.IS_NODE&&(n=r(7).resolve(n)),!0===this.files[n])return this.reset();this.files[n]=!0}else if("object"==typeof n){var o,s=n.root;if(e.Util.IS_NODE&&(s=r(7).resolve(s)),(s.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(i="\\"),o=e.Util.IS_NODE?r(7).join(s,n.file):s+i+n.file,!0===this.files[o])return this.reset();this.files[o]=!0}if(t.imports&&t.imports.length>0){var a,c=!1;"object"==typeof n?(this.importRoot=n.root,c=!0,a=this.importRoot,n=n.file,(a.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(i="\\")):"string"==typeof n?this.importRoot?a=this.importRoot:n.indexOf("/")>=0?""===(a=n.replace(/\/[^\/]*$/,""))&&(a="/"):n.indexOf("\\")>=0?(a=n.replace(/\\[^\\]*$/,""),i="\\"):a=".":a=null;for(var u=0;u<t.imports.length;u++)if("string"==typeof t.imports[u]){if(!a)throw Error("cannot determine import root");var l=t.imports[u];if("google/protobuf/descriptor.proto"===l)continue;if(l=e.Util.IS_NODE?r(7).join(a,l):a+i+l,!0===this.files[l])continue;/\.proto$/i.test(l)&&!e.DotProto&&(l=l.replace(/\.proto$/,".json"));var h=e.Util.fetch(l);if(null===h)throw Error("failed to import '"+l+"' in '"+n+"': file not found");/\.json$/i.test(l)?this.import(JSON.parse(h+""),l):this.import(e.DotProto.Parser.parse(h),l)}else n?/\.(\w+)$/.test(n)?this.import(t.imports[u],n.replace(/^(.+)\.(\w+)$/,function(e,t,r){return t+"_import"+u+"."+r})):this.import(t.imports[u],n+"_import"+u):this.import(t.imports[u]);c&&(this.importRoot=null)}t.package&&this.define(t.package),t.syntax&&function e(t){t.messages&&t.messages.forEach(function(r){r.syntax=t.syntax,e(r)}),t.enums&&t.enums.forEach(function(e){e.syntax=t.syntax})}(t);var p=this.ptr;return t.options&&Object.keys(t.options).forEach(function(e){p.options[e]=t.options[e]}),t.messages&&(this.create(t.messages),this.ptr=p),t.enums&&(this.create(t.enums),this.ptr=p),t.services&&(this.create(t.services),this.ptr=p),t.extends&&this.create(t.extends),this.reset()},o.resolveAll=function(){var r;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach(function(e){this.ptr=e,this.resolveAll()},this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(r=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof n.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}"proto3"===this.ptr.syntax&&this.ptr.repeated&&void 0===this.ptr.options.packed&&-1!==e.PACKABLE_WIRE_TYPES.indexOf(this.ptr.type.wireType)&&(this.ptr.options.packed=!0)}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((r=this.ptr.parent.resolve(this.ptr.requestName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,!((r=this.ptr.parent.resolve(this.ptr.responseName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},o.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,r=this.result,n=0;n<t.length;n++){if(!r[t[n]]){r=null;break}r=r[t[n]]}return r},o.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},o.toString=function(){return"Builder"},i.Message=function(){},i.Enum=function(){},i.Service=function(){},i}(i,i.Lang,i.Reflect),i.Map=function(e,t){var r=function(e,r){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),r)for(var n=Object.keys(r),i=0;i<n.length;i++){var o=this.keyElem.valueFromString(n[i]),s=this.valueElem.verifyValue(r[n[i]]);this.map[this.keyElem.valueToString(o)]={key:o,value:s}}},n=r.prototype;function i(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}return n.clear=function(){this.map={}},n.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),r=t in this.map;return delete this.map[t],r},n.entries=function(){for(var e,t=[],r=Object.keys(this.map),n=0;n<r.length;n++)t.push([(e=this.map[r[n]]).key,e.value]);return i(t)},n.keys=function(){for(var e=[],t=Object.keys(this.map),r=0;r<t.length;r++)e.push(this.map[t[r]].key);return i(e)},n.values=function(){for(var e=[],t=Object.keys(this.map),r=0;r<t.length;r++)e.push(this.map[t[r]].value);return i(e)},n.forEach=function(e,t){for(var r,n=Object.keys(this.map),i=0;i<n.length;i++)e.call(t,(r=this.map[n[i]]).value,r.key,this)},n.set=function(e,t){var r=this.keyElem.verifyValue(e),n=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(r)]={key:r,value:n},this},n.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));if(t in this.map)return this.map[t].value},n.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},r}(0,i.Reflect),i.loadProto=function(e,t,r){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(r=t,t=void 0),i.loadJson(i.DotProto.Parser.parse(e),t,r)},i.protoFromString=i.loadProto,i.loadProtoFile=function(e,t,r){if(t&&"object"==typeof t?(r=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(n){if(null!==n)try{t(null,i.loadProto(n,r,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))});var n=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===n?null:i.loadProto(n,r,e)},i.protoFromFile=i.loadProtoFile,i.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,r){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(r=t,t=null),t&&"object"==typeof t||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,r),t.resolveAll(),t},i.loadJsonFile=function(e,t,r){if(t&&"object"==typeof t?(r=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(n){if(null!==n)try{t(null,i.loadJson(JSON.parse(n),r,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))});var n=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===n?null:i.loadJson(JSON.parse(n),r,e)},i})?n.apply(t,i):n)||(e.exports=o)},function(e,t,r){
/**
 * @license bytebuffer.js (c) 2015 Daniel Wirtz <dcode@dcode.io>
 * Backing buffer / Accessor: node Buffer
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/bytebuffer.js for details
 */
e.exports=function(){"use strict";var e=r(35).Buffer,t=r(406),n=null;try{n=r(!function(){var e=new Error("Cannot find module 'memcpy'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){}var i=function(t,r,n){if(void 0===t&&(t=i.DEFAULT_CAPACITY),void 0===r&&(r=i.DEFAULT_ENDIAN),void 0===n&&(n=i.DEFAULT_NOASSERT),!n){if((t|=0)<0)throw RangeError("Illegal capacity");r=!!r,n=!!n}this.buffer=0===t?s:new e(t),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=r,this.noAssert=n};i.VERSION="5.0.1",i.LITTLE_ENDIAN=!0,i.BIG_ENDIAN=!1,i.DEFAULT_CAPACITY=16,i.DEFAULT_ENDIAN=i.BIG_ENDIAN,i.DEFAULT_NOASSERT=!1,i.Long=t;var o=i.prototype;o.__isByteBuffer__,Object.defineProperty(o,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var s=new e(0),a=String.fromCharCode;i.accessor=function(){return e},i.allocate=function(e,t,r){return new i(e,t,r)},i.concat=function(e,t,r,n){"boolean"!=typeof t&&"string"==typeof t||(n=r,r=t,t=void 0);for(var o,s=0,a=0,c=e.length;a<c;++a)i.isByteBuffer(e[a])||(e[a]=i.wrap(e[a],t)),(o=e[a].limit-e[a].offset)>0&&(s+=o);if(0===s)return new i(0,r,n);var u,l=new i(s,r,n);for(a=0;a<c;)(o=(u=e[a++]).limit-u.offset)<=0||(u.buffer.copy(l.buffer,l.offset,u.offset,u.limit),l.offset+=o);return l.limit=l.offset,l.offset=0,l},i.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},i.type=function(){return e},i.wrap=function(t,r,s,a){if("string"!=typeof r&&(a=s,s=r,r=void 0),"string"==typeof t)switch(void 0===r&&(r="utf8"),r){case"base64":return i.fromBase64(t,s);case"hex":return i.fromHex(t,s);case"binary":return i.fromBinary(t,s);case"utf8":return i.fromUTF8(t,s);case"debug":return i.fromDebug(t,s);default:throw Error("Unsupported encoding: "+r)}if(null===t||"object"!=typeof t)throw TypeError("Illegal buffer");var c;if(i.isByteBuffer(t))return(c=o.clone.call(t)).markedOffset=-1,c;var u,l=0,h=0;if(t instanceof Uint8Array){if(u=new e(t.length),n)n(u,0,t.buffer,t.byteOffset,t.byteOffset+t.length);else for(l=0,h=t.length;l<h;++l)u[l]=t[l];t=u}else if(t instanceof ArrayBuffer){if(u=new e(t.byteLength),n)n(u,0,t,0,t.byteLength);else for(l=0,h=(t=new Uint8Array(t)).length;l<h;++l)u[l]=t[l];t=u}else if(!(t instanceof e)){if("[object Array]"!==Object.prototype.toString.call(t))throw TypeError("Illegal buffer");t=new e(t)}return c=new i(0,s,a),t.length>0&&(c.buffer=t,c.limit=t.length),c},o.writeBitSet=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}var n,i=t,o=e.length,s=o>>3,a=0;for(t+=this.writeVarint32(o,t);s--;)n=1&!!e[a++]|(1&!!e[a++])<<1|(1&!!e[a++])<<2|(1&!!e[a++])<<3|(1&!!e[a++])<<4|(1&!!e[a++])<<5|(1&!!e[a++])<<6|(1&!!e[a++])<<7,this.writeByte(n,t++);if(a<o){var c=0;for(n=0;a<o;)n|=(1&!!e[a++])<<c++;this.writeByte(n,t++)}return r?(this.offset=t,this):t-i},o.readBitSet=function(e){var t=void 0===e;t&&(e=this.offset);var r,n=this.readVarint32(e),i=n.value,o=i>>3,s=0,a=[];for(e+=n.length;o--;)r=this.readByte(e++),a[s++]=!!(1&r),a[s++]=!!(2&r),a[s++]=!!(4&r),a[s++]=!!(8&r),a[s++]=!!(16&r),a[s++]=!!(32&r),a[s++]=!!(64&r),a[s++]=!!(128&r);if(s<i){var c=0;for(r=this.readByte(e++);s<i;)a[s++]=!!(r>>c++&1)}return t&&(this.offset=e),a},o.readBytes=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.length)}var n=this.slice(t,t+e);return r&&(this.offset+=e),n},o.writeBytes=o.append,o.writeInt8=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=1;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=1,this.buffer[t]=e,r&&(this.offset+=1),this},o.writeByte=o.writeInt8,o.readInt8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.length)}var r=this.buffer[e];return 128==(128&r)&&(r=-(255-r+1)),t&&(this.offset+=1),r},o.readByte=o.readInt8,o.writeUint8=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=1;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=1,this.buffer[t]=e,r&&(this.offset+=1),this},o.writeUInt8=o.writeUint8,o.readUint8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.length)}var r=this.buffer[e];return t&&(this.offset+=1),r},o.readUInt8=o.readUint8,o.writeInt16=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=2;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.buffer[t+1]=(65280&e)>>>8,this.buffer[t]=255&e):(this.buffer[t]=(65280&e)>>>8,this.buffer[t+1]=255&e),r&&(this.offset+=2),this},o.writeShort=o.writeInt16,o.readInt16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.length)}var r=0;return this.littleEndian?(r=this.buffer[e],r|=this.buffer[e+1]<<8):(r=this.buffer[e]<<8,r|=this.buffer[e+1]),32768==(32768&r)&&(r=-(65535-r+1)),t&&(this.offset+=2),r},o.readShort=o.readInt16,o.writeUint16=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=2;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.buffer[t+1]=(65280&e)>>>8,this.buffer[t]=255&e):(this.buffer[t]=(65280&e)>>>8,this.buffer[t+1]=255&e),r&&(this.offset+=2),this},o.writeUInt16=o.writeUint16,o.readUint16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.length)}var r=0;return this.littleEndian?(r=this.buffer[e],r|=this.buffer[e+1]<<8):(r=this.buffer[e]<<8,r|=this.buffer[e+1]),t&&(this.offset+=2),r},o.readUInt16=o.readUint16,o.writeInt32=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=4;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.buffer[t+3]=e>>>24&255,this.buffer[t+2]=e>>>16&255,this.buffer[t+1]=e>>>8&255,this.buffer[t]=255&e):(this.buffer[t]=e>>>24&255,this.buffer[t+1]=e>>>16&255,this.buffer[t+2]=e>>>8&255,this.buffer[t+3]=255&e),r&&(this.offset+=4),this},o.writeInt=o.writeInt32,o.readInt32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.length)}var r=0;return this.littleEndian?(r=this.buffer[e+2]<<16,r|=this.buffer[e+1]<<8,r|=this.buffer[e],r+=this.buffer[e+3]<<24>>>0):(r=this.buffer[e+1]<<16,r|=this.buffer[e+2]<<8,r|=this.buffer[e+3],r+=this.buffer[e]<<24>>>0),r|=0,t&&(this.offset+=4),r},o.readInt=o.readInt32,o.writeUint32=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=4;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.buffer[t+3]=e>>>24&255,this.buffer[t+2]=e>>>16&255,this.buffer[t+1]=e>>>8&255,this.buffer[t]=255&e):(this.buffer[t]=e>>>24&255,this.buffer[t+1]=e>>>16&255,this.buffer[t+2]=e>>>8&255,this.buffer[t+3]=255&e),r&&(this.offset+=4),this},o.writeUInt32=o.writeUint32,o.readUint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.length)}var r=0;return this.littleEndian?(r=this.buffer[e+2]<<16,r|=this.buffer[e+1]<<8,r|=this.buffer[e],r+=this.buffer[e+3]<<24>>>0):(r=this.buffer[e+1]<<16,r|=this.buffer[e+2]<<8,r|=this.buffer[e+3],r+=this.buffer[e]<<24>>>0),t&&(this.offset+=4),r},o.readUInt32=o.readUint32,t&&(o.writeInt64=function(e,r){var n=void 0===r;if(n&&(r=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e)),r+=8;var i=this.buffer.length;r>i&&this.resize((i*=2)>r?i:r),r-=8;var o=e.low,s=e.high;return this.littleEndian?(this.buffer[r+3]=o>>>24&255,this.buffer[r+2]=o>>>16&255,this.buffer[r+1]=o>>>8&255,this.buffer[r]=255&o,r+=4,this.buffer[r+3]=s>>>24&255,this.buffer[r+2]=s>>>16&255,this.buffer[r+1]=s>>>8&255,this.buffer[r]=255&s):(this.buffer[r]=s>>>24&255,this.buffer[r+1]=s>>>16&255,this.buffer[r+2]=s>>>8&255,this.buffer[r+3]=255&s,r+=4,this.buffer[r]=o>>>24&255,this.buffer[r+1]=o>>>16&255,this.buffer[r+2]=o>>>8&255,this.buffer[r+3]=255&o),n&&(this.offset+=8),this},o.writeLong=o.writeInt64,o.readInt64=function(e){var r=void 0===e;if(r&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.length)}var n=0,i=0;this.littleEndian?(n=this.buffer[e+2]<<16,n|=this.buffer[e+1]<<8,n|=this.buffer[e],n+=this.buffer[e+3]<<24>>>0,e+=4,i=this.buffer[e+2]<<16,i|=this.buffer[e+1]<<8,i|=this.buffer[e],i+=this.buffer[e+3]<<24>>>0):(i=this.buffer[e+1]<<16,i|=this.buffer[e+2]<<8,i|=this.buffer[e+3],i+=this.buffer[e]<<24>>>0,e+=4,n=this.buffer[e+1]<<16,n|=this.buffer[e+2]<<8,n|=this.buffer[e+3],n+=this.buffer[e]<<24>>>0);var o=new t(n,i,!1);return r&&(this.offset+=8),o},o.readLong=o.readInt64,o.writeUint64=function(e,r){var n=void 0===r;if(n&&(r=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e)),r+=8;var i=this.buffer.length;r>i&&this.resize((i*=2)>r?i:r),r-=8;var o=e.low,s=e.high;return this.littleEndian?(this.buffer[r+3]=o>>>24&255,this.buffer[r+2]=o>>>16&255,this.buffer[r+1]=o>>>8&255,this.buffer[r]=255&o,r+=4,this.buffer[r+3]=s>>>24&255,this.buffer[r+2]=s>>>16&255,this.buffer[r+1]=s>>>8&255,this.buffer[r]=255&s):(this.buffer[r]=s>>>24&255,this.buffer[r+1]=s>>>16&255,this.buffer[r+2]=s>>>8&255,this.buffer[r+3]=255&s,r+=4,this.buffer[r]=o>>>24&255,this.buffer[r+1]=o>>>16&255,this.buffer[r+2]=o>>>8&255,this.buffer[r+3]=255&o),n&&(this.offset+=8),this},o.writeUInt64=o.writeUint64,o.readUint64=function(e){var r=void 0===e;if(r&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.length)}var n=0,i=0;this.littleEndian?(n=this.buffer[e+2]<<16,n|=this.buffer[e+1]<<8,n|=this.buffer[e],n+=this.buffer[e+3]<<24>>>0,e+=4,i=this.buffer[e+2]<<16,i|=this.buffer[e+1]<<8,i|=this.buffer[e],i+=this.buffer[e+3]<<24>>>0):(i=this.buffer[e+1]<<16,i|=this.buffer[e+2]<<8,i|=this.buffer[e+3],i+=this.buffer[e]<<24>>>0,e+=4,n=this.buffer[e+1]<<16,n|=this.buffer[e+2]<<8,n|=this.buffer[e+3],n+=this.buffer[e]<<24>>>0);var o=new t(n,i,!0);return r&&(this.offset+=8),o},o.readUInt64=o.readUint64),o.writeFloat32=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=4;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?this.buffer.writeFloatLE(e,t,!0):this.buffer.writeFloatBE(e,t,!0),r&&(this.offset+=4),this},o.writeFloat=o.writeFloat32,o.readFloat32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.length)}var r=this.littleEndian?this.buffer.readFloatLE(e,!0):this.buffer.readFloatBE(e,!0);return t&&(this.offset+=4),r},o.readFloat=o.readFloat32,o.writeFloat64=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}t+=8;var n=this.buffer.length;return t>n&&this.resize((n*=2)>t?n:t),t-=8,this.littleEndian?this.buffer.writeDoubleLE(e,t,!0):this.buffer.writeDoubleBE(e,t,!0),r&&(this.offset+=8),this},o.writeDouble=o.writeFloat64,o.readFloat64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.length)}var r=this.littleEndian?this.buffer.readDoubleLE(e,!0):this.buffer.readDoubleBE(e,!0);return t&&(this.offset+=8),r},o.readDouble=o.readFloat64,i.MAX_VARINT32_BYTES=5,i.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5},i.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},i.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},o.writeVarint32=function(e,t){var r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.length)}var n,o=i.calculateVarint32(e);t+=o;var s=this.buffer.length;for(t>s&&this.resize((s*=2)>t?s:t),t-=o,e>>>=0;e>=128;)n=127&e|128,this.buffer[t++]=n,e>>>=7;return this.buffer[t++]=e,r?(this.offset=t,this):o},o.writeVarint32ZigZag=function(e,t){return this.writeVarint32(i.zigZagEncode32(e),t)},o.readVarint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.length)}var r,n=0,i=0;do{if(!this.noAssert&&e>this.limit){var o=Error("Truncated");throw o.truncated=!0,o}r=this.buffer[e++],n<5&&(i|=(127&r)<<7*n),++n}while(0!=(128&r));return i|=0,t?(this.offset=e,i):{value:i,length:n}},o.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"==typeof t?t.value=i.zigZagDecode32(t.value):t=i.zigZagDecode32(t),t},t&&(i.MAX_VARINT64_BYTES=10,i.calculateVarint64=function(e){"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e));var r=e.toInt()>>>0,n=e.shiftRightUnsigned(28).toInt()>>>0,i=e.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==n?r<16384?r<128?1:2:r<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:i<128?9:10},i.zigZagEncode64=function(e){return"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftLeft(1).xor(e.shiftRight(63)).toUnsigned()},i.zigZagDecode64=function(e){return"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftRightUnsigned(1).xor(e.and(t.ONE).toSigned().negate()).toSigned()},o.writeVarint64=function(e,r){var n=void 0===r;if(n&&(r=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned());var o=i.calculateVarint64(e),s=e.toInt()>>>0,a=e.shiftRightUnsigned(28).toInt()>>>0,c=e.shiftRightUnsigned(56).toInt()>>>0;r+=o;var u=this.buffer.length;switch(r>u&&this.resize((u*=2)>r?u:r),r-=o,o){case 10:this.buffer[r+9]=c>>>7&1;case 9:this.buffer[r+8]=9!==o?128|c:127&c;case 8:this.buffer[r+7]=8!==o?a>>>21|128:a>>>21&127;case 7:this.buffer[r+6]=7!==o?a>>>14|128:a>>>14&127;case 6:this.buffer[r+5]=6!==o?a>>>7|128:a>>>7&127;case 5:this.buffer[r+4]=5!==o?128|a:127&a;case 4:this.buffer[r+3]=4!==o?s>>>21|128:s>>>21&127;case 3:this.buffer[r+2]=3!==o?s>>>14|128:s>>>14&127;case 2:this.buffer[r+1]=2!==o?s>>>7|128:s>>>7&127;case 1:this.buffer[r]=1!==o?128|s:127&s}return n?(this.offset+=o,this):o},o.writeVarint64ZigZag=function(e,t){return this.writeVarint64(i.zigZagEncode64(e),t)},o.readVarint64=function(e){var r=void 0===e;if(r&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.length)}var n=e,i=0,o=0,s=0,a=0;if(i=127&(a=this.buffer[e++]),128&a&&(i|=(127&(a=this.buffer[e++]))<<7,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.buffer[e++]))<<14,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.buffer[e++]))<<21,(128&a||this.noAssert&&void 0===a)&&(o=127&(a=this.buffer[e++]),(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.buffer[e++]))<<7,(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.buffer[e++]))<<14,(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.buffer[e++]))<<21,(128&a||this.noAssert&&void 0===a)&&(s=127&(a=this.buffer[e++]),(128&a||this.noAssert&&void 0===a)&&(s|=(127&(a=this.buffer[e++]))<<7,128&a||this.noAssert&&void 0===a))))))))))throw Error("Buffer overrun");var c=t.fromBits(i|o<<28,o>>>4|s<<24,!1);return r?(this.offset=e,c):{value:c,length:e-n}},o.readVarint64ZigZag=function(e){var r=this.readVarint64(e);return r&&r.value instanceof t?r.value=i.zigZagDecode64(r.value):r=i.zigZagDecode64(r),r}),o.writeCString=function(t,r){var n=void 0===r;n&&(r=this.offset);var i,o=t.length;if(!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");for(i=0;i<o;++i)if(0===t.charCodeAt(i))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}r+=(o=e.byteLength(t,"utf8"))+1;var s=this.buffer.length;return r>s&&this.resize((s*=2)>r?s:r),r-=o+1,r+=this.buffer.write(t,r,o,"utf8"),this.buffer[r++]=0,n?(this.offset=r,this):o},o.readCString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.length)}var r,n=e;do{if(e>=this.buffer.length)throw RangeError("Index out of range: "+e+" <= "+this.buffer.length);r=this.buffer[e++]}while(0!==r);var i=this.buffer.toString("utf8",n,e-1);return t?(this.offset=e,i):{string:i,length:e-n}},o.writeIString=function(t,r){var n=void 0===r;if(n&&(r=this.offset),!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}var i,o=r;r+=4+(i=e.byteLength(t,"utf8"));var s=this.buffer.length;return r>s&&this.resize((s*=2)>r?s:r),r-=4+i,this.littleEndian?(this.buffer[r+3]=i>>>24&255,this.buffer[r+2]=i>>>16&255,this.buffer[r+1]=i>>>8&255,this.buffer[r]=255&i):(this.buffer[r]=i>>>24&255,this.buffer[r+1]=i>>>16&255,this.buffer[r+2]=i>>>8&255,this.buffer[r+3]=255&i),r+=4,r+=this.buffer.write(t,r,i,"utf8"),n?(this.offset=r,this):r-o},o.readIString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.length)}var r=e,n=this.readUint32(e),o=this.readUTF8String(n,i.METRICS_BYTES,e+=4);return e+=o.length,t?(this.offset=e,o.string):{string:o.string,length:e-r}},i.METRICS_CHARS="c",i.METRICS_BYTES="b",o.writeUTF8String=function(t,r){var n,i=void 0===r;if(i&&(r=this.offset),!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}r+=n=e.byteLength(t,"utf8");var o=this.buffer.length;return r>o&&this.resize((o*=2)>r?o:r),r-=n,r+=this.buffer.write(t,r,n,"utf8"),i?(this.offset=r,this):n},o.writeString=o.writeUTF8String,i.calculateUTF8Chars=function(e){return c.calculateUTF16asUTF8((t=e,r=0,function(){return r<t.length?t.charCodeAt(r++):null}))[0];var t,r},i.calculateUTF8Bytes=function(t){if("string"!=typeof t)throw TypeError("Illegal argument: "+typeof t);return e.byteLength(t,"utf8")},i.calculateString=i.calculateUTF8Bytes,o.readUTF8String=function(e,t,r){"number"==typeof t&&(r=t,t=void 0);var n=void 0===r;if(n&&(r=this.offset),void 0===t&&(t=i.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}var o,s,u,l,h=0,p=r;if(t===i.METRICS_CHARS){if(u=[],l=[],s=function(){if(0===arguments.length)return l.join("")+a.apply(String,u);u.length+arguments.length>1024&&(l.push(a.apply(String,u)),u.length=0),Array.prototype.push.apply(u,arguments)},c.decodeUTF8(function(){return h<e&&r<this.limit?this.buffer[r++]:null}.bind(this),function(e){++h,c.UTF8toUTF16(e,s)}),h!==e)throw RangeError("Illegal range: Truncated data, "+h+" == "+e);return n?(this.offset=r,s()):{string:s(),length:r-p}}if(t===i.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+e>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.length)}return o=this.buffer.toString("utf8",r,r+e),n?(this.offset+=e,o):{string:o,length:e}}throw TypeError("Unsupported metrics: "+t)},o.readString=o.readUTF8String,o.writeVString=function(t,r){var n=void 0===r;if(n&&(r=this.offset),!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}var o,s,a=r;o=e.byteLength(t,"utf8"),r+=(s=i.calculateVarint32(o))+o;var c=this.buffer.length;return r>c&&this.resize((c*=2)>r?c:r),r-=s+o,r+=this.writeVarint32(o,r),r+=this.buffer.write(t,r,o,"utf8"),n?(this.offset=r,this):r-a},o.readVString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.length)}var r=e,n=this.readVarint32(e),o=this.readUTF8String(n.value,i.METRICS_BYTES,e+=n.length);return e+=o.length,t?(this.offset=e,o.string):{string:o.string,length:e-r}},o.append=function(e,t,r){"number"!=typeof t&&"string"==typeof t||(r=t,t=void 0);var n=void 0===r;if(n&&(r=this.offset),!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.length)}e instanceof i||(e=i.wrap(e,t));var o=e.limit-e.offset;if(o<=0)return this;r+=o;var s=this.buffer.length;return r>s&&this.resize((s*=2)>r?s:r),r-=o,e.buffer.copy(this.buffer,r,e.offset,e.limit),e.offset+=o,n&&(this.offset+=o),this},o.appendTo=function(e,t){return e.append(this,t),this},o.assert=function(e){return this.noAssert=!e,this},o.capacity=function(){return this.buffer.length},o.clear=function(){return this.offset=0,this.limit=this.buffer.length,this.markedOffset=-1,this},o.clone=function(t){var r=new i(0,this.littleEndian,this.noAssert);if(t){var n=new e(this.buffer.length);this.buffer.copy(n),r.buffer=n}else r.buffer=this.buffer;return r.offset=this.offset,r.markedOffset=this.markedOffset,r.limit=this.limit,r},o.compact=function(t,r){if(void 0===t&&(t=this.offset),void 0===r&&(r=this.limit),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal end: Not an integer");if(r>>>=0,t<0||t>r||r>this.buffer.length)throw RangeError("Illegal range: 0 <= "+t+" <= "+r+" <= "+this.buffer.length)}if(0===t&&r===this.buffer.length)return this;var n=r-t;if(0===n)return this.buffer=s,this.markedOffset>=0&&(this.markedOffset-=t),this.offset=0,this.limit=0,this;var i=new e(n);return this.buffer.copy(i,0,t,r),this.buffer=i,this.markedOffset>=0&&(this.markedOffset-=t),this.offset=0,this.limit=n,this},o.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.length)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.length)}if(e===t)return new i(0,this.littleEndian,this.noAssert);var r=t-e,n=new i(r,this.littleEndian,this.noAssert);return n.offset=0,n.limit=r,n.markedOffset>=0&&(n.markedOffset-=e),this.copyTo(n,0,e,t),n},o.copyTo=function(e,t,r,n){var o,s;if(!this.noAssert&&!i.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(s=void 0===t)?e.offset:0|t,r=(o=void 0===r)?this.offset:0|r,n=void 0===n?this.limit:0|n,t<0||t>e.buffer.length)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.length);if(r<0||n>this.buffer.length)throw RangeError("Illegal source range: 0 <= "+r+" <= "+this.buffer.length);var a=n-r;return 0===a?e:(e.ensureCapacity(t+a),this.buffer.copy(e.buffer,t,r,n),o&&(this.offset+=a),s&&(e.offset+=a),this)},o.ensureCapacity=function(e){var t=this.buffer.length;return t<e?this.resize((t*=2)>e?t:e):this},o.fill=function(e,t,r){var n=void 0===t;if(n&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===r&&(r=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal end: Not an integer");if(r>>>=0,t<0||t>r||r>this.buffer.length)throw RangeError("Illegal range: 0 <= "+t+" <= "+r+" <= "+this.buffer.length)}return t>=r?this:(this.buffer.fill(e,t,r),t=r,n&&(this.offset=t),this)},o.flip=function(){return this.limit=this.offset,this.offset=0,this},o.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.length)}return this.markedOffset=e,this},o.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},o.LE=function(e){return this.littleEndian=void 0===e||!!e,this},o.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},o.prepend=function(t,r,n){"number"!=typeof r&&"string"==typeof r||(n=r,r=void 0);var o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.length)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.length)}t instanceof i||(t=i.wrap(t,r));var s=t.limit-t.offset;if(s<=0)return this;var a=s-n;if(a>0){var c=new e(this.buffer.length+a);this.buffer.copy(c,s,n,this.buffer.length),this.buffer=c,this.offset+=a,this.markedOffset>=0&&(this.markedOffset+=a),this.limit+=a,n+=a}return t.buffer.copy(this.buffer,n-s,t.offset,t.limit),t.offset=t.limit,o&&(this.offset-=s),this},o.prependTo=function(e,t){return e.prepend(this,t),this},o.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},o.remaining=function(){return this.limit-this.offset},o.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},o.resize=function(t){if(!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal capacity: "+t+" (not an integer)");if((t|=0)<0)throw RangeError("Illegal capacity: 0 <= "+t)}if(this.buffer.length<t){var r=new e(t);this.buffer.copy(r),this.buffer=r}return this},o.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.length)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.length)}return e===t?this:(Array.prototype.reverse.call(this.buffer.slice(e,t)),this)},o.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.length))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.length);return this.offset=t,this},o.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.length)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.length)}var r=this.clone();return r.offset=e,r.limit=t,r},o.toBuffer=function(t){var r=this.offset,n=this.limit;if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: Not an integer");if(r>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,r<0||r>n||n>this.buffer.length)throw RangeError("Illegal range: 0 <= "+r+" <= "+n+" <= "+this.buffer.length)}if(t){var i=new e(n-r);return this.buffer.copy(i,0,r,n),i}return 0===r&&n===this.buffer.length?this.buffer:this.buffer.slice(r,n)},o.toArrayBuffer=function(){var e=this.offset,t=this.limit;if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal limit: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.length)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.length)}var r=new ArrayBuffer(t-e);if(n)n(r,0,this.buffer,e,t);else for(var i=new Uint8Array(r),o=e;o<t;++o)i[o-e]=this.buffer[o];return r},o.toString=function(e,t,r){if(void 0===e)return"ByteBufferNB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(r=t=e="utf8"),e){case"utf8":return this.toUTF8(t,r);case"base64":return this.toBase64(t,r);case"hex":return this.toHex(t,r);case"binary":return this.toBinary(t,r);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}},o.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||e>t)throw RangeError("begin, end");return this.buffer.toString("base64",e,t)},i.fromBase64=function(t,r){return i.wrap(new e(t,"base64"),r)},i.btoa=function(e){return i.fromBinary(e).toBase64()},i.atob=function(e){return i.fromBase64(e).toBinary()},o.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||e>t)throw RangeError("begin, end");return this.buffer.toString("binary",e,t)},i.fromBinary=function(t,r){return i.wrap(new e(t,"binary"),r)},o.toDebug=function(e){for(var t,r=-1,n=this.buffer.length,i="",o="",s="";r<n;){if(-1!==r&&(i+=(t=this.buffer[r])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=t>32&&t<127?String.fromCharCode(t):".")),++r,e&&r>0&&r%16==0&&r!==n){for(;i.length<51;)i+=" ";s+=i+o+"\n",i=o=""}r===this.offset&&r===this.limit?i+=r===this.markedOffset?"!":"|":r===this.offset?i+=r===this.markedOffset?"[":"<":r===this.limit?i+=r===this.markedOffset?"]":">":i+=r===this.markedOffset?"'":e||0!==r&&r!==n?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";s+=i+o+"\n"}return e?s:i},i.fromDebug=function(e,t,r){for(var n,o,s=e.length,a=new i((s+1)/3|0,t,r),c=0,u=0,l=!1,h=!1,p=!1,f=!1,d=!1;c<s;){switch(n=e.charAt(c++)){case"!":if(!r){if(h||p||f){d=!0;break}h=p=f=!0}a.offset=a.markedOffset=a.limit=u,l=!1;break;case"|":if(!r){if(h||f){d=!0;break}h=f=!0}a.offset=a.limit=u,l=!1;break;case"[":if(!r){if(h||p){d=!0;break}h=p=!0}a.offset=a.markedOffset=u,l=!1;break;case"<":if(!r){if(h){d=!0;break}h=!0}a.offset=u,l=!1;break;case"]":if(!r){if(f||p){d=!0;break}f=p=!0}a.limit=a.markedOffset=u,l=!1;break;case">":if(!r){if(f){d=!0;break}f=!0}a.limit=u,l=!1;break;case"'":if(!r){if(p){d=!0;break}p=!0}a.markedOffset=u,l=!1;break;case" ":l=!1;break;default:if(!r&&l){d=!0;break}if(o=parseInt(n+e.charAt(c++),16),!r&&(isNaN(o)||o<0||o>255))throw TypeError("Illegal str: Not a debug encoded string");a.buffer[u++]=o,l=!0}if(d)throw TypeError("Illegal str: Invalid symbol at "+c)}if(!r){if(!h||!f)throw TypeError("Illegal str: Missing offset or limit");if(u<a.buffer.length)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+s)}return a},o.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.length)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.length)}return this.buffer.toString("hex",e,t)},i.fromHex=function(t,r,n){if(!n){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if(t.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}var o=new i(0,r,!0);return o.buffer=new e(t,"hex"),o.limit=o.buffer.length,o};var c=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<128?t(127&r):r<2048?(t(r>>6&31|192),t(63&r|128)):r<65536?(t(r>>12&15|224),t(r>>6&63|128),t(63&r|128)):(t(r>>18&7|240),t(r>>12&63|128),t(r>>6&63|128),t(63&r|128)),r=null},decodeUTF8:function(e,t){for(var r,n,i,o,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(r=e());)if(0==(128&r))t(r);else if(192==(224&r))null===(n=e())&&s([r,n]),t((31&r)<<6|63&n);else if(224==(240&r))(null===(n=e())||null===(i=e()))&&s([r,n,i]),t((15&r)<<12|(63&n)<<6|63&i);else{if(240!=(248&r))throw RangeError("Illegal starting byte: "+r);(null===(n=e())||null===(i=e())||null===(o=e()))&&s([r,n,i,o]),t((7&r)<<18|(63&n)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var r,n=null;null!==(r=null!==n?n:e());)r>=55296&&r<=57343&&null!==(n=e())&&n>=56320&&n<=57343?(t(1024*(r-55296)+n-56320+65536),n=null):t(r);null!==n&&t(n)},UTF8toUTF16:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<=65535?t(r):(t(55296+((r-=65536)>>10)),t(r%1024+56320)),r=null},encodeUTF16toUTF8:function(t,r){e.UTF16toUTF8(t,function(t){e.encodeUTF8(t,r)})},decodeUTF8toUTF16:function(t,r){e.decodeUTF8(t,function(t){e.UTF8toUTF16(t,r)})},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,r=0;null!==(t=e());)r+=t<128?1:t<2048?2:t<65536?3:4;return r},calculateUTF16asUTF8:function(t){var r=0,n=0;return e.UTF16toUTF8(t,function(e){++r,n+=e<128?1:e<2048?2:e<65536?3:4}),[r,n]}};return e}();return o.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.length)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.length)}return this.buffer.toString("utf8",e,t)},i.fromUTF8=function(t,r,n){if(!n&&"string"!=typeof t)throw TypeError("Illegal str: Not a string");var o=new i(0,r,n);return o.buffer=new e(t,"utf8"),o.limit=o.buffer.length,o},i.memcpy=n,i}()},function(e,t,r){var n,i,o;
/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */i=[],void 0===(o="function"==typeof(n=function(){"use strict";function e(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function t(e){return!0===(e&&e.__isLong__)}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var r={},n={};function i(e,t){var i,o,a;return t?(a=0<=(e>>>=0)&&e<256)&&(o=n[e])?o:(i=s(e,(0|e)<0?-1:0,!0),a&&(n[e]=i),i):(a=-128<=(e|=0)&&e<128)&&(o=r[e])?o:(i=s(e,e<0?-1:0,!1),a&&(r[e]=i),i)}function o(e,t){if(isNaN(e)||!isFinite(e))return t?g:d;if(t){if(e<0)return g;if(e>=h)return _}else{if(e<=-p)return E;if(e+1>=p)return b}return e<0?o(-e,t).neg():s(e%l|0,e/l|0,t)}function s(t,r,n){return new e(t,r,n)}e.fromInt=i,e.fromNumber=o,e.fromBits=s;var a=Math.pow;function c(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return d;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return c(e.substring(1),t,r).neg();for(var i=o(a(r,8)),s=d,u=0;u<e.length;u+=8){var l=Math.min(8,e.length-u),h=parseInt(e.substring(u,u+l),r);if(l<8){var p=o(a(r,l));s=s.mul(p).add(o(h))}else s=(s=s.mul(i)).add(o(h))}return s.unsigned=t,s}function u(t){return t instanceof e?t:"number"==typeof t?o(t):"string"==typeof t?c(t):s(t.low,t.high,t.unsigned)}e.fromString=c,e.fromValue=u;var l=4294967296,h=l*l,p=h/2,f=i(1<<24),d=i(0);e.ZERO=d;var g=i(0,!0);e.UZERO=g;var m=i(1);e.ONE=m;var y=i(1,!0);e.UONE=y;var v=i(-1);e.NEG_ONE=v;var b=s(-1,2147483647,!1);e.MAX_VALUE=b;var _=s(-1,-1,!0);e.MAX_UNSIGNED_VALUE=_;var E=s(0,-2147483648,!1);e.MIN_VALUE=E;var C=e.prototype;return C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(E)){var t=o(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=o(a(e,6),this.unsigned),s=this,c="";;){var u=s.div(i),l=(s.sub(u.mul(i)).toInt()>>>0).toString(e);if((s=u).isZero())return l+c;for(;l.length<6;)l="0"+l;c=""+l+c}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(e){return t(e)||(e=u(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.compare=function(e){if(t(e)||(e=u(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(m)},C.neg=C.negate,C.add=function(e){t(e)||(e=u(e));var r=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,a=e.high>>>16,c=65535&e.high,l=e.low>>>16,h=0,p=0,f=0,d=0;return f+=(d+=o+(65535&e.low))>>>16,p+=(f+=i+l)>>>16,h+=(p+=n+c)>>>16,h+=r+a,s((f&=65535)<<16|(d&=65535),(h&=65535)<<16|(p&=65535),this.unsigned)},C.subtract=function(e){return t(e)||(e=u(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return d;if(t(e)||(e=u(e)),e.isZero())return d;if(this.eq(E))return e.isOdd()?E:d;if(e.eq(E))return this.isOdd()?E:d;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f)&&e.lt(f))return o(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,n=65535&this.high,i=this.low>>>16,a=65535&this.low,c=e.high>>>16,l=65535&e.high,h=e.low>>>16,p=65535&e.low,g=0,m=0,y=0,v=0;return y+=(v+=a*p)>>>16,m+=(y+=i*p)>>>16,y&=65535,m+=(y+=a*h)>>>16,g+=(m+=n*p)>>>16,m&=65535,g+=(m+=i*h)>>>16,m&=65535,g+=(m+=a*l)>>>16,g+=r*p+n*h+i*l+a*c,s((y&=65535)<<16|(v&=65535),(g&=65535)<<16|(m&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(t(e)||(e=u(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:d;var r,n,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return y;i=g}else{if(this.eq(E))return e.eq(m)||e.eq(v)?E:e.eq(E)?m:(r=this.shr(1).div(e).shl(1)).eq(d)?e.isNegative()?m:v:(n=this.sub(e.mul(r)),i=r.add(n.div(e)));if(e.eq(E))return this.unsigned?g:d;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=d}for(n=this;n.gte(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),c=s<=48?1:a(2,s-48),l=o(r),h=l.mul(e);h.isNegative()||h.gt(n);)h=(l=o(r-=c,this.unsigned)).mul(e);l.isZero()&&(l=m),i=i.add(l),n=n.sub(h)}return i},C.div=C.divide,C.modulo=function(e){return t(e)||(e=u(e)),this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.not=function(){return s(~this.low,~this.high,this.unsigned)},C.and=function(e){return t(e)||(e=u(e)),s(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return t(e)||(e=u(e)),s(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return t(e)||(e=u(e)),s(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):s(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):s(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),0==(e&=63))return this;var r=this.high;return e<32?s(this.low>>>e|r<<32-e,r>>>e,this.unsigned):s(32===e?r:r>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&e,e>>>8&255,e>>>16&255,e>>>24&255]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t]},e})?n.apply(t,i):n)||(e.exports=o)},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(16),i=r(70),o=r(105),s=r(73),a=r(106),c=s.methodTypes,u=r(12).EventEmitter,l=function(e,t){Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e,this.extra=t};function h(){this.code=null,this.details=null,this.metadata=null}function p(){this.metadata=null,this.message=null,this.status=null}function f(){this.start=null,this.message=null,this.half_close=null,this.cancel=null}r(4).inherits(l,Error),h.prototype.withCode=function(e){return this.code=e,this},h.prototype.withDetails=function(e){return this.details=e,this},h.prototype.withMetadata=function(e){return this.metadata=e,this},h.prototype.build=function(){var e={};return void 0!==this.code&&(e.code=this.code),this.details&&(e.details=this.details),this.metadata&&(e.metadata=this.metadata),e},p.prototype.withOnReceiveMetadata=function(e){return this.metadata=e,this},p.prototype.withOnReceiveMessage=function(e){return this.message=e,this},p.prototype.withOnReceiveStatus=function(e){return this.status=e,this},p.prototype.build=function(){var e={};return e.onReceiveMetadata=this.metadata,e.onReceiveMessage=this.message,e.onReceiveStatus=this.status,e},f.prototype.withStart=function(e){return this.start=e,this},f.prototype.withSendMessage=function(e){return this.message=e,this},f.prototype.withHalfClose=function(e){return this.half_close=e,this},f.prototype.withCancel=function(e){return this.cancel=e,this},f.prototype.build=function(){var e={};return e.start=this.start,e.sendMessage=this.message,e.halfClose=this.half_close,e.cancel=this.cancel,e};function d(e,t){this.next_call=e,this.requester=t}function g(e,t){this.delegate=t||{},this.next_listener=e}function m(){}function y(e,t,r){var i,o,s,a,c;r&&(i=r.deadline,o=r.host,s=n.get(r,"parent.call"),a=r.propagate_flags,c=r.credentials),void 0===i&&(i=1/0);var u=e.createCall(t,i,o,s,a);return c&&u.setCredentials(c),u}d.prototype._getNextCall=function(e){return this.next_call?this.next_call[e].bind(this.next_call):function(){}},d.prototype._callNext=function(e,t,r){var n=t||[],i=r||this._getNextCall(e);if(!this.requester||!this.requester[e])return i(n[0],n[1]);switch(n.length){case 0:return this.requester[e](i);case 1:return this.requester[e](n[0],i);case 2:return this.requester[e](n[0],n[1],i)}},d.prototype.start=function(e,t){var r=this,n=S(t,new m);this._callNext("start",[e,n],function(e,t){if(r.next_call){var i=S(t,n);r.next_call.start(e,i)}})},d.prototype.sendMessage=function(e){this._callNext("sendMessage",[e])},d.prototype.halfClose=function(){this._callNext("halfClose")},d.prototype.cancel=function(){this._callNext("cancel")},d.prototype.cancelWithStatus=function(e,t){this._callNext("cancelWithStatus",[e,t])},d.prototype.getPeer=function(){return this._callNext("getPeer")},d.prototype.sendMessageWithContext=function(e,t){var r=this.next_call?this.next_call.sendMessageWithContext.bind(this.next_call,e):e;this._callNext("sendMessage",[t],r)},d.prototype.recvMessageWithContext=function(e){this._callNext("recvMessageWithContext",[e])},g.prototype._getNextListener=function(e){return this.next_listener?this.next_listener[e].bind(this.next_listener):function(){}},g.prototype._callNext=function(e,t,r){var n=t||[],i=r||this._getNextListener(e);if(!this.delegate||!this.delegate[e])return i(n[0],n[1]);switch(n.length){case 0:return this.delegate[e](i);case 1:return this.delegate[e](n[0],i);case 2:return this.delegate[e](n[0],n[1],i)}},g.prototype.onReceiveMetadata=function(e){this._callNext("onReceiveMetadata",[e])},g.prototype.onReceiveMessage=function(e){this._callNext("onReceiveMessage",[e])},g.prototype.recvMessageWithContext=function(e,t){var r=this.next_listener.recvMessageWithContext,n=this.next_listener?r.bind(this.next_listener,e):e;this.delegate.onReceiveMessage?this.delegate.onReceiveMessage(t,n,e):n(t)},g.prototype.onReceiveStatus=function(e){this._callNext("onReceiveStatus",[e])},m.prototype.onReceiveMetadata=function(){},m.prototype.onReceiveMessage=function(){},m.prototype.onReceiveStatus=function(){},m.prototype.recvMessageWithContext=function(){};var v={[i.opType.SEND_MESSAGE]:[i.opType.SEND_INITIAL_METADATA],[i.opType.SEND_CLOSE_FROM_CLIENT]:[i.opType.SEND_MESSAGE],[i.opType.RECV_MESSAGE]:[i.opType.SEND_INITIAL_METADATA]};function b(e,t,r,n){return function(i,o){if(i)return e.finished=!0,void e._readsDone();var a,c=o.read;try{a=n(c)}catch(t){return void e._readsDone({code:s.status.INTERNAL,details:"Failed to parse server response"})}if(null!==c){var u=r(),l={call:t,listener:u};u.recvMessageWithContext(l,a)}else e._readsDone()}}function _(e,t){for(var r=n.flatMap(e,function(e){return v[e]||[]}),i=0;i<r.length;i++){var o=r[i];if(-1===e.indexOf(o)&&-1===t.indexOf(o))return!1}return!0}function E(e,t,r,i){var o=r.completed_ops,s=r.deferred_batches,a=n.map(n.keys(t),Number);return _(a,o)?(e.startBatch(t,i),o=n.union(o,a),s=n.flatMap(s,function(t){return _(n.map(n.keys(t),Number),o)?(e.startBatch(t.batch,t.callback),[]):[t]})):s=s.concat({batch:t,callback:i}),{completed_ops:o,deferred_batches:s}}var C={[c.UNARY]:function(e,t,r,n){var a=e.requestSerialize,c=e.responseDeserialize;return function(r){var n,u=y(t,e.path,r),l={},h={completed_ops:[],deferred_batches:[]};return l.start=function(e,t){var r={[i.opType.SEND_INITIAL_METADATA]:e._getCoreRepresentation()};n=t,h=E(u,r,h,function(){})},l.sendMessage=function(e){var t={[i.opType.SEND_MESSAGE]:a(e)};h=E(u,t,h,function(){})},l.halfClose=function(){var e=function(t,r){r.status.metadata=o._fromCoreRepresentation(r.status.metadata);var i,a=r.status;if(a.code===s.status.OK){if(t)return void e(t);try{i=c(r.read)}catch(e){a={code:s.status.INTERNAL,details:"Failed to parse server response"}}}r.metadata=o._fromCoreRepresentation(r.metadata),n.onReceiveMetadata(r.metadata),n.onReceiveMessage(i),n.onReceiveStatus(a)};h=E(u,{[i.opType.SEND_CLOSE_FROM_CLIENT]:!0,[i.opType.RECV_INITIAL_METADATA]:!0,[i.opType.RECV_MESSAGE]:!0,[i.opType.RECV_STATUS_ON_CLIENT]:!0},h,e)},l.cancel=function(){u.cancel()},l.getPeer=function(){return u.getPeer()},new d(null,l)}},[c.CLIENT_STREAMING]:function(e,t,r,c){var u=a.wrapIgnoreNull(e.requestSerialize),l=e.responseDeserialize;return function(r){var a=y(t,e.path,r),h={start:function(e,t){var r={[i.opType.SEND_INITIAL_METADATA]:e._getCoreRepresentation(),[i.opType.RECV_INITIAL_METADATA]:!0};a.startBatch(r,function(e,r){e||(r.metadata=o._fromCoreRepresentation(r.metadata),t.onReceiveMetadata(r.metadata))});var n={};n[i.opType.RECV_MESSAGE]=!0,n[i.opType.RECV_STATUS_ON_CLIENT]=!0,a.startBatch(n,function(e,r){r.status.metadata=o._fromCoreRepresentation(r.status.metadata);var n,i=r.status;if(i.code===s.status.OK){if(e)return void c(e);try{n=l(r.read)}catch(e){i={code:s.status.INTERNAL,details:"Failed to parse server response"}}}t.onReceiveMessage(n),t.onReceiveStatus(i)})},sendMessage:function(e,t){var r,o=t&&t.callback?t.callback:function(){},c=t&&t.encoding?t.encoding:"";try{r=u(e)}catch(e){return a.cancelWithStatus(s.status.INTERNAL,"Serialization failure"),void o(e)}n.isFinite(c)&&(r.grpcWriteFlags=c);var l={[i.opType.SEND_MESSAGE]:r};a.startBatch(l,function(e,t){o(e,t)})},halfClose:function(){var e={[i.opType.SEND_CLOSE_FROM_CLIENT]:!0};a.startBatch(e,function(){})},cancel:function(){a.cancel()},getPeer:function(){return a.getPeer()}};return new d(null,h)}},[c.SERVER_STREAMING]:function(e,t,r){var n=a.wrapIgnoreNull(e.responseDeserialize),s=e.requestSerialize;return function(a){var c,u={completed_ops:[],deferred_batches:[]},l=y(t,e.path,a),h={},p=function(){return c};return h.start=function(e,t){c=t,e=e.clone();var n={[i.opType.SEND_INITIAL_METADATA]:e._getCoreRepresentation(),[i.opType.RECV_INITIAL_METADATA]:!0};u=E(l,n,u,function(e,t){e||c.onReceiveMetadata(o._fromCoreRepresentation(t.metadata))});var s={[i.opType.RECV_STATUS_ON_CLIENT]:!0};l.startBatch(s,function(e,t){e?r.emit("error",e):(t.status.metadata=o._fromCoreRepresentation(t.status.metadata),c.onReceiveStatus(t.status))})},h.sendMessage=function(e){var t=s(e);a&&(t.grpcWriteFlags=a.flags),u=E(l,{[i.opType.SEND_MESSAGE]:t},u,function(e,t){})},h.halfClose=function(){u=E(l,{[i.opType.SEND_CLOSE_FROM_CLIENT]:!0},u,function(){})},h.recvMessageWithContext=function(e){var t={[i.opType.RECV_MESSAGE]:!0},o=b(r,l,p,n);u=E(l,t,u,o)},h.cancel=function(){l.cancel()},h.getPeer=function(){return l.getPeer()},new d(null,h)}},[c.BIDI_STREAMING]:function(e,t,r){var c=a.wrapIgnoreNull(e.requestSerialize),u=a.wrapIgnoreNull(e.responseDeserialize);return function(a){var l,h=function(){return l},p=y(t,e.path,a),f={start:function(e,t){var n={[i.opType.SEND_INITIAL_METADATA]:e._getCoreRepresentation(),[i.opType.RECV_INITIAL_METADATA]:!0};l=t,p.startBatch(n,function(e,r){e||(r.metadata=o._fromCoreRepresentation(r.metadata),t.onReceiveMetadata(r.metadata))});var a={};a[i.opType.RECV_STATUS_ON_CLIENT]=!0,p.startBatch(a,function(e,n){var i=n.status;i.code===s.status.OK&&e?r.emit("error",e):(n.status.metadata=o._fromCoreRepresentation(n.status.metadata),t.onReceiveStatus(i))})},sendMessage:function(e,t){var r,o=t&&t.callback?t.callback:function(){},a=t&&t.encoding?t.encoding:"";try{r=c(e)}catch(e){return p.cancelWithStatus(s.status.INTERNAL,"Serialization failure"),void o(e)}n.isFinite(a)&&(r.grpcWriteFlags=a);var u={[i.opType.SEND_MESSAGE]:r};p.startBatch(u,function(e,t){o(e,t)})},halfClose:function(){var e={[i.opType.SEND_CLOSE_FROM_CLIENT]:!0};p.startBatch(e,function(){})},recvMessageWithContext:function(e){var t={[i.opType.RECV_MESSAGE]:!0};p.startBatch(t,b(r,p,h,u))},cancel:function(){p.cancel()},getPeer:function(){return p.getPeer()}};return new d(null,f)}}},w={[c.UNARY]:function(e,t,r){var n;return{onReceiveMetadata:function(e){t.emit("metadata",e)},onReceiveMessage:function(e){n=e},onReceiveStatus:function(e){if(e.code!==s.status.OK){var i=a.createStatusError(e);r(i)}else r(null,n);t.emit("status",e)}}},[c.CLIENT_STREAMING]:function(e,t,r){var n;return{onReceiveMetadata:function(e){t.emit("metadata",e)},onReceiveMessage:function(e){n=e},onReceiveStatus:function(e){if(e.code!==s.status.OK){var i=a.createStatusError(e);r(i)}else r(null,n);t.emit("status",e)}}},[c.SERVER_STREAMING]:function(e,t){var r=a.wrapIgnoreNull(e.responseDeserialize);return{onReceiveMetadata:function(e){t.emit("metadata",e)},onReceiveMessage:function(e,n,o){if(t.push(e)&&null!==e){var s=o.call,a={};a[i.opType.RECV_MESSAGE]=!0,s.startBatch(a,b(t,s,function(){return o.listener},r))}else t.reading=!1},onReceiveStatus:function(e){t._receiveStatus(e)}}},[c.BIDI_STREAMING]:function(e,t){var r=a.wrapIgnoreNull(e.responseDeserialize);return{onReceiveMetadata:function(e){t.emit("metadata",e)},onReceiveMessage:function(e,n,o){if(t.push(e)&&null!==e){var s=o.call,a={};a[i.opType.RECV_MESSAGE]=!0,s.startBatch(a,b(t,s,function(){return o.listener},r))}else t.reading=!1},onReceiveStatus:function(e){t._receiveStatus(e)}}}};function S(e,t){return(r=e)&&"InterceptingListener"===r.constructor.name?e:new g(t,e);var r}t.resolveInterceptorProviders=function(e,t){if(!n.isArray(e))return null;for(var r=[],i=0;i<e.length;i++){var o=(0,e[i])(t);o&&r.push(o)}return r},t.InterceptingCall=d,t.ListenerBuilder=p,t.RequesterBuilder=f,t.StatusBuilder=h,t.InterceptorConfigurationError=l,t.getInterceptingCall=function(e,t,r,n,i){var o=function(e,t,r){var n=r instanceof Function?r:function(){},i=r instanceof u?r:new u,o=a.getMethodType(e);return(0,C[o])(e,t,i,n)}(e,n,i);return function(e,t){var r=function(e){if(0===e.length)return function(e){};var t=e[0],n=e.slice(1);return function(e){return t(e,r(n))}};return new d(r(e)(t))}(r.concat(o),t)},t.getLastListener=function(e,t,r){if(t instanceof Function&&(r=t,r=function(){}),r instanceof Function||(r=function(){}),!(t instanceof u&&r instanceof Function))throw new Error("Argument mismatch in getLastListener");var n=a.getMethodType(e);return(0,w[n])(e,t,r)}},function(e,t,r){"use strict";var n=r(409),i=r(255),o=r(8).existsSync||r(7).existsSync,s=r(7);e.exports=t,t.usage="Finds the require path for the node-pre-gyp installed module",t.validate=function(e,t){n.validate_config(e,t)},t.find=function(e,t){if(!o(e))throw new Error("package.json does not exist at "+e);var a,c=r(452)(e);return n.validate_config(c,t),i.get_napi_build_versions(c,t)&&(a=i.get_best_napi_build_version(c,t)),(t=t||{}).module_root||(t.module_root=s.dirname(e)),n.evaluate(c,t,a).module}},function(e,t,r){"use strict";e.exports=t;var n,i=r(7),o=r(410),s=r(14),a=r(411),c=r(255);n=process.env.NODE_PRE_GYP_ABI_CROSSWALK?r(450)(process.env.NODE_PRE_GYP_ABI_CROSSWALK):r(451);var u={};function l(e,t){if(!e)throw new Error("get_electron_abi requires valid runtime arg");if(void 0===t)throw new Error("Empty target version is not supported if electron is the target.");var r=o.parse(t);return e+"-v"+r.major+"."+r.minor}function h(e,t){if(!e)throw new Error("get_node_webkit_abi requires valid runtime arg");if(void 0===t)throw new Error("Empty target version is not supported if node-webkit is the target.");return e+"-v"+t}function p(e,t){if(!e)throw new Error("get_node_abi requires valid runtime arg");if(!t)throw new Error("get_node_abi requires valid process.versions object");var r=o.parse(t.node);return 0===r.major&&r.minor%2?e+"-v"+t.node:t.modules?e+"-v"+ +t.modules:"v8-"+t.v8.split(".").slice(0,2).join(".")}function f(e,t){if(!e)throw new Error("get_runtime_abi requires valid runtime arg");if("node-webkit"===e)return h(e,t||process.versions["node-webkit"]);if("electron"===e)return l(e,t||process.versions.electron);if("node"!=e)throw new Error("Unknown Runtime: '"+e+"'");if(t){var r;if(n[t])r=n[t];else{var i=t.split(".").map(function(e){return+e});if(3!=i.length)throw new Error("Unknown target version: "+t);var o=i[0],s=i[1],a=i[2];if(1===o)for(;;){s>0&&--s,a>0&&--a;var c=o+"."+s+"."+a;if(n[c]){r=n[c],console.log("Warning: node-pre-gyp could not find exact match for "+t),console.log("Warning: but node-pre-gyp successfully choose "+c+" as ABI compatible target");break}if(0===s&&0===a)break}else if(o>=2)u[o]&&(r=n[u[o]],console.log("Warning: node-pre-gyp could not find exact match for "+t),console.log("Warning: but node-pre-gyp successfully choose "+u[o]+" as ABI compatible target"));else if(0===o&&i[1]%2==0)for(;--a>0;){var f=o+"."+s+"."+a;if(n[f]){r=n[f],console.log("Warning: node-pre-gyp could not find exact match for "+t),console.log("Warning: but node-pre-gyp successfully choose "+f+" as ABI compatible target");break}}}if(!r)throw new Error("Unsupported target version: "+t);return p(e,{node:t,v8:r.v8+".0",modules:r.node_abi>1?r.node_abi:void 0})}return p(e,process.versions)}Object.keys(n).forEach(function(e){var t=e.split(".")[0];u[t]||(u[t]=e)}),e.exports.get_electron_abi=l,e.exports.get_node_webkit_abi=h,e.exports.get_node_abi=p,e.exports.get_runtime_abi=f;var d=["module_name","module_path","host"];function g(e,t){var r=e.name+" package.json is not node-pre-gyp ready:\n",n=[];e.main||n.push("main"),e.version||n.push("version"),e.name||n.push("name"),e.binary||n.push("binary");var i=e.binary;if(d.forEach(function(e){n.indexOf("binary")>-1&&n.pop("binary"),i&&void 0!==i[e]&&""!==i[e]||n.push("binary."+e)}),n.length>=1)throw new Error(r+"package.json must declare these properties: \n"+n.join("\n"));if(i){var o=s.parse(i.host).protocol;if("http:"===o)throw new Error("'host' protocol ("+o+") is invalid - only 'https:' is accepted")}c.validate_package_json(e,t)}function m(e,t){return Object.keys(t).forEach(function(r){for(var n="{"+r+"}";e.indexOf(n)>-1;)e=e.replace(n,t[r])}),e}function y(e){return"/"!=e.slice(-1)?e+"/":e}function v(e){var t="node";return e["node-webkit"]?t="node-webkit":e.electron&&(t="electron"),t}e.exports.validate_config=g,e.exports.get_process_runtime=v;e.exports.evaluate=function(e,t,r){g(e,t=t||{});var n=e.version,u=o.parse(n),l=t.runtime||v(process.versions),h={name:e.name,configuration:Boolean(t.debug)?"Debug":"Release",debug:t.debug,module_name:e.binary.module_name,version:u.version,prerelease:u.prerelease.length?u.prerelease.join("."):"",build:u.build.length?u.build.join("."):"",major:u.major,minor:u.minor,patch:u.patch,runtime:l,node_abi:f(l,t.target),node_abi_napi:c.get_napi_version(t.target)?"napi":f(l,t.target),napi_version:c.get_napi_version(t.target),napi_build_version:r||"",node_napi_label:r?"napi-v"+r:f(l,t.target),target:t.target||"",platform:t.target_platform||process.platform,target_platform:t.target_platform||process.platform,arch:t.target_arch||process.arch,target_arch:t.target_arch||process.arch,libc:t.target_libc||a.family||"unknown",module_main:e.main,toolset:t.toolset||""},p=process.env["npm_config_"+h.module_name+"_binary_host_mirror"]||e.binary.host;h.host=y(m(p,h)),h.module_path=m(e.binary.module_path,h),t.module_root?h.module_path=i.join(t.module_root,h.module_path):h.module_path=i.resolve(h.module_path),h.module=i.join(h.module_path,h.module_name+".node"),h.remote_path=e.binary.remote_path?y(m(e.binary.remote_path,h)).replace(/\/\//g,"/"):"";var d=e.binary.package_name?e.binary.package_name:"{module_name}-v{version}-{node_abi}-{platform}-{arch}.tar.gz";return h.package_name=m(d,h),h.staged_tarball=i.join("build/stage",h.remote_path,h.package_name),h.hosted_path=s.resolve(h.host,h.remote_path),h.hosted_tarball=s.resolve(h.hosted_path,h.package_name),h}},function(e,t){var r;t=e.exports=W,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=t.re=[],s=t.src=[],a=0,c=a++;s[c]="0|[1-9]\\d*";var u=a++;s[u]="[0-9]+";var l=a++;s[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var h=a++;s[h]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var p=a++;s[p]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var f=a++;s[f]="(?:"+s[c]+"|"+s[l]+")";var d=a++;s[d]="(?:"+s[u]+"|"+s[l]+")";var g=a++;s[g]="(?:-("+s[f]+"(?:\\."+s[f]+")*))";var m=a++;s[m]="(?:-?("+s[d]+"(?:\\."+s[d]+")*))";var y=a++;s[y]="[0-9A-Za-z-]+";var v=a++;s[v]="(?:\\+("+s[y]+"(?:\\."+s[y]+")*))";var b=a++,_="v?"+s[h]+s[g]+"?"+s[v]+"?";s[b]="^"+_+"$";var E="[v=\\s]*"+s[p]+s[m]+"?"+s[v]+"?",C=a++;s[C]="^"+E+"$";var w=a++;s[w]="((?:<|>)?=?)";var S=a++;s[S]=s[u]+"|x|X|\\*";var T=a++;s[T]=s[c]+"|x|X|\\*";var A=a++;s[A]="[v=\\s]*("+s[T]+")(?:\\.("+s[T]+")(?:\\.("+s[T]+")(?:"+s[g]+")?"+s[v]+"?)?)?";var I=a++;s[I]="[v=\\s]*("+s[S]+")(?:\\.("+s[S]+")(?:\\.("+s[S]+")(?:"+s[m]+")?"+s[v]+"?)?)?";var N=a++;s[N]="^"+s[w]+"\\s*"+s[A]+"$";var k=a++;s[k]="^"+s[w]+"\\s*"+s[I]+"$";var R=a++;s[R]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var O=a++;s[O]="(?:~>?)";var x=a++;s[x]="(\\s*)"+s[O]+"\\s+",o[x]=new RegExp(s[x],"g");var B=a++;s[B]="^"+s[O]+s[A]+"$";var D=a++;s[D]="^"+s[O]+s[I]+"$";var P=a++;s[P]="(?:\\^)";var L=a++;s[L]="(\\s*)"+s[P]+"\\s+",o[L]=new RegExp(s[L],"g");var j=a++;s[j]="^"+s[P]+s[A]+"$";var U=a++;s[U]="^"+s[P]+s[I]+"$";var M=a++;s[M]="^"+s[w]+"\\s*("+E+")$|^$";var F=a++;s[F]="^"+s[w]+"\\s*("+_+")$|^$";var V=a++;s[V]="(\\s*)"+s[w]+"\\s*("+E+"|"+s[A]+")",o[V]=new RegExp(s[V],"g");var q=a++;s[q]="^\\s*("+s[A]+")\\s+-\\s+("+s[A]+")\\s*$";var K=a++;s[K]="^\\s*("+s[I]+")\\s+-\\s+("+s[I]+")\\s*$";var H=a++;s[H]="(<|>)?=?\\s*\\*";for(var G=0;G<35;G++)r(G,s[G]),o[G]||(o[G]=new RegExp(s[G]));function z(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof W)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?o[C]:o[b]).test(e))return null;try{return new W(e,t)}catch(e){return null}}function W(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof W){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof W))return new W(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var s=e.trim().match(t.loose?o[C]:o[b]);if(!s)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}t.parse=z,t.valid=function(e,t){var r=z(e,t);return r?r.version:null},t.clean=function(e,t){var r=z(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=W,W.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},W.prototype.toString=function(){return this.version},W.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof W||(e=new W(e,this.options)),this.compareMain(e)||this.comparePre(e)},W.prototype.compareMain=function(e){return e instanceof W||(e=new W(e,this.options)),Q(this.major,e.major)||Q(this.minor,e.minor)||Q(this.patch,e.patch)},W.prototype.comparePre=function(e){if(e instanceof W||(e=new W(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return Q(n,i)}while(++t)},W.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new W(e,r).inc(t,n).version}catch(e){return null}},t.diff=function(e,t){if(Z(e,t))return null;var r=z(e),n=z(t);if(r.prerelease.length||n.prerelease.length){for(var i in r)if(("major"===i||"minor"===i||"patch"===i)&&r[i]!==n[i])return"pre"+i;return"prerelease"}for(var i in r)if(("major"===i||"minor"===i||"patch"===i)&&r[i]!==n[i])return i},t.compareIdentifiers=Q;var Y=/^[0-9]+$/;function Q(e,t){var r=Y.test(e),n=Y.test(t);return r&&n&&(e=+e,t=+t),r&&!n?-1:n&&!r?1:e<t?-1:e>t?1:0}function $(e,t,r){return new W(e,r).compare(new W(t,r))}function J(e,t,r){return $(e,t,r)>0}function X(e,t,r){return $(e,t,r)<0}function Z(e,t,r){return 0===$(e,t,r)}function ee(e,t,r){return 0!==$(e,t,r)}function te(e,t,r){return $(e,t,r)>=0}function re(e,t,r){return $(e,t,r)<=0}function ne(e,t,r,n){var i;switch(t){case"===":"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),i=e===r;break;case"!==":"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),i=e!==r;break;case"":case"=":case"==":i=Z(e,r,n);break;case"!=":i=ee(e,r,n);break;case">":i=J(e,r,n);break;case">=":i=te(e,r,n);break;case"<":i=X(e,r,n);break;case"<=":i=re(e,r,n);break;default:throw new TypeError("Invalid operator: "+t)}return i}function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ie))return new ie(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return Q(t,e)},t.major=function(e,t){return new W(e,t).major},t.minor=function(e,t){return new W(e,t).minor},t.patch=function(e,t){return new W(e,t).patch},t.compare=$,t.compareLoose=function(e,t){return $(e,t,!0)},t.rcompare=function(e,t,r){return $(t,e,r)},t.sort=function(e,r){return e.sort(function(e,n){return t.compare(e,n,r)})},t.rsort=function(e,r){return e.sort(function(e,n){return t.rcompare(e,n,r)})},t.gt=J,t.lt=X,t.eq=Z,t.neq=ee,t.gte=te,t.lte=re,t.cmp=ne,t.Comparator=ie;var oe={};function se(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof se)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new se(e.raw,t);if(e instanceof ie)return new se(e.value,t);if(!(this instanceof se))return new se(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ce(e,t,r,n,i,o,s,a,c,u,l,h,p){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(i)?">="+r+"."+n+".0":">="+t)+" "+(a=ae(c)?"":ae(u)?"<"+(+c+1)+".0.0":ae(l)?"<"+c+"."+(+u+1)+".0":h?"<="+c+"."+u+"."+l+"-"+h:"<="+a)).trim()}function ue(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(n||(n={}),t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==oe&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new se(t,r)}catch(e){return!1}return t.test(e)}function he(e,t,r,n){var i,o,s,a,c;switch(e=new W(e,n),t=new se(t,n),r){case">":i=J,o=re,s=X,a=">",c=">=";break;case"<":i=X,o=te,s=J,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],h=null,p=null;if(l.forEach(function(e){e.semver===oe&&(e=new ie(">=0.0.0")),h=h||e,p=p||e,i(e.semver,h.semver,n)?h=e:s(e.semver,p.semver,n)&&(p=e)}),h.operator===a||h.operator===c)return!1;if((!p.operator||p.operator===a)&&o(e,p.semver))return!1;if(p.operator===c&&s(e,p.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?o[M]:o[F],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new W(r[2],this.options.loose):this.semver=oe},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new W(e,this.options)),ne(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new se(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new se(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=ne(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=ne(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&s||a||c},t.Range=se,se.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},se.prototype.toString=function(){return this.range},se.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[K]:o[q];e=e.replace(n,ce),r("hyphen replace",e),e=e.replace(o[V],"$1$2$3"),r("comparator trim",e,o[V]),e=(e=(e=e.replace(o[x],"$1~")).replace(o[L],"$1^")).split(/\s+/).join(" ");var i=t?o[M]:o[F],s=e.split(" ").map(function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){r("caret",e,t),t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1});var n=t.loose?o[U]:o[j];return e.replace(n,function(t,n,i,o,s){var a;return r("caret",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":s?(r("replaceCaret pr",s),"-"!==s.charAt(0)&&(s="-"+s),a="0"===n?"0"===i?">="+n+"."+i+"."+o+s+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+s+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+s+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",a),a})}(e,t)}).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1});var n=t.loose?o[D]:o[B];return e.replace(n,function(t,n,i,o,s){var a;return r("tilde",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":s?(r("replaceTilde pr",s),"-"!==s.charAt(0)&&(s="-"+s),a=">="+n+"."+i+"."+o+s+" <"+n+"."+(+i+1)+".0"):a=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",a),a})}(e,t)}).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map(function(e){return function(e,t){e=e.trim(),t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1});var n=t.loose?o[k]:o[N];return e.replace(n,function(t,n,i,o,s,a){r("xRange",e,t,n,i,o,s,a);var c=ae(i),u=c||ae(o),l=u||ae(s),h=l;return"="===n&&h&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&h?(u&&(o=0),l&&(s=0),">"===n?(n=">=",u?(i=+i+1,o=0,s=0):l&&(o=+o+1,s=0)):"<="===n&&(n="<",u?i=+i+1:o=+o+1),t=n+i+"."+o+"."+s):u?t=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(t=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),r("xRange return",t),t})}(e,t)}).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[H],"")}(e,t),r("stars",e),e}(e,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(s=s.filter(function(e){return!!e.match(i)})),s=s.map(function(e){return new ie(e,this.options)},this)},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(r){return e.set.some(function(e){return e.every(function(e){return r.intersects(e,t)})})})})},t.toComparators=function(e,t){return new se(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})},se.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new W(e,this.options));for(var t=0;t<this.set.length;t++)if(ue(this.set[t],e,this.options))return!0;return!1},t.satisfies=le,t.maxSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(n&&-1!==i.compare(e)||(i=new W(n=e,r)))}),n},t.minSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(n&&1!==i.compare(e)||(i=new W(n=e,r)))}),n},t.validRange=function(e,t){try{return new se(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,r){return he(e,t,"<",r)},t.gtr=function(e,t,r){return he(e,t,">",r)},t.outside=he,t.prerelease=function(e,t){var r=z(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new se(e,r),t=new se(t,r),e.intersects(t)},t.coerce=function(e){if(e instanceof W)return e;if("string"!=typeof e)return null;var t=e.match(o[R]);return null==t?null:z((t[1]||"0")+"."+(t[2]||"0")+"."+(t[3]||"0"))}},function(e,t,r){"use strict";var n=r(29).platform(),i=r(230).spawnSync,o=r(8).readdirSync,s="musl",a={encoding:"utf8",env:process.env};function c(e){return function(t){return-1!==t.indexOf(e)}}function u(e){return e.split(/[\r\n]+/)[1].trim().split(/\s/)[1]}function l(e){try{return o(e)}catch(e){}return[]}i||(i=function(){return{status:126,stdout:"",stderr:""}});var h="",p="",f="";if("linux"===n){var d=i("getconf",["GNU_LIBC_VERSION"],a);if(0===d.status)h="glibc",p=d.stdout.trim().split(" ")[1],f="getconf";else{var g=i("ldd",["--version"],a);if(0===g.status&&-1!==g.stdout.indexOf(s))h=s,p=u(g.stdout),f="ldd";else if(1===g.status&&-1!==g.stderr.indexOf(s))h=s,p=u(g.stderr),f="ldd";else{var m=l("/lib");if(m.some(c("-linux-gnu")))h="glibc",f="filesystem";else if(m.some(c("libc.musl-")))h=s,f="filesystem";else if(m.some(c("ld-musl-")))h=s,f="filesystem";else{l("/usr/sbin").some(c("glibc"))&&(h="glibc",f="filesystem")}}}}var y=""!==h&&"glibc"!==h;e.exports={GLIBC:"glibc",MUSL:s,family:h,version:p,method:f,isNonGlibcLinux:y}},function(e,t,r){e.exports=p,p.sync=y;var n=r(15),i=r(7),o=r(8),s=r(256),a=parseInt("666",8),c={nosort:!0,silent:!0},u=0,l="win32"===process.platform;function h(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(function(t){e[t]=e[t]||o[t],e[t+="Sync"]=e[t]||o[t]}),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,!1===e.glob&&(e.disableGlob=!0),e.disableGlob=e.disableGlob||!1,e.glob=e.glob||c}function p(e,t,r){"function"==typeof t&&(r=t,t={}),n(e,"rimraf: missing path"),n.equal(typeof e,"string","rimraf: path should be a string"),n.equal(typeof r,"function","rimraf: callback function required"),n(t,"rimraf: invalid options argument provided"),n.equal(typeof t,"object","rimraf: options should be object"),h(t);var i=0,o=null,a=0;if(t.disableGlob||!s.hasMagic(e))return c(null,[e]);function c(e,n){return e?r(e):0===(a=n.length)?r():void n.forEach(function(e){f(e,t,function n(s){if(s){if(("EBUSY"===s.code||"ENOTEMPTY"===s.code||"EPERM"===s.code)&&i<t.maxBusyTries)return i++,setTimeout(function(){f(e,t,n)},100*i);if("EMFILE"===s.code&&u<t.emfileWait)return setTimeout(function(){f(e,t,n)},u++);"ENOENT"===s.code&&(s=null)}u=0,function(e){o=o||e,0==--a&&r(o)}(s)})})}t.lstat(e,function(r,n){if(!r)return c(null,[e]);s(e,t.glob,c)})}function f(e,t,r){n(e),n(t),n("function"==typeof r),t.lstat(e,function(n,i){return n&&"ENOENT"===n.code?r(null):(n&&"EPERM"===n.code&&l&&d(e,t,n,r),i&&i.isDirectory()?m(e,t,n,r):void t.unlink(e,function(n){if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return l?d(e,t,n,r):m(e,t,n,r);if("EISDIR"===n.code)return m(e,t,n,r)}return r(n)}))})}function d(e,t,r,i){n(e),n(t),n("function"==typeof i),r&&n(r instanceof Error),t.chmod(e,a,function(n){n?i("ENOENT"===n.code?null:r):t.stat(e,function(n,o){n?i("ENOENT"===n.code?null:r):o.isDirectory()?m(e,t,r,i):t.unlink(e,i)})})}function g(e,t,r){n(e),n(t),r&&n(r instanceof Error);try{t.chmodSync(e,a)}catch(e){if("ENOENT"===e.code)return;throw r}try{var i=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw r}i.isDirectory()?v(e,t,r):t.unlinkSync(e)}function m(e,t,r,o){n(e),n(t),r&&n(r instanceof Error),n("function"==typeof o),t.rmdir(e,function(s){!s||"ENOTEMPTY"!==s.code&&"EEXIST"!==s.code&&"EPERM"!==s.code?s&&"ENOTDIR"===s.code?o(r):o(s):function(e,t,r){n(e),n(t),n("function"==typeof r),t.readdir(e,function(n,o){if(n)return r(n);var s,a=o.length;if(0===a)return t.rmdir(e,r);o.forEach(function(n){p(i.join(e,n),t,function(n){if(!s)return n?r(s=n):void(0==--a&&t.rmdir(e,r))})})})}(e,t,o)})}function y(e,t){var r;if(h(t=t||{}),n(e,"rimraf: missing path"),n.equal(typeof e,"string","rimraf: path should be a string"),n(t,"rimraf: missing options"),n.equal(typeof t,"object","rimraf: options should be object"),t.disableGlob||!s.hasMagic(e))r=[e];else try{t.lstatSync(e),r=[e]}catch(n){r=s.sync(e,t.glob)}if(r.length)for(var i=0;i<r.length;i++){e=r[i];try{var o=t.lstatSync(e)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&l&&g(e,t,r)}try{o&&o.isDirectory()?v(e,t,null):t.unlinkSync(e)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return l?g(e,t,r):v(e,t,r);if("EISDIR"!==r.code)throw r;v(e,t,r)}}}function v(e,t,r){n(e),n(t),r&&n(r instanceof Error);try{t.rmdirSync(e)}catch(o){if("ENOENT"===o.code)return;if("ENOTDIR"===o.code)throw r;"ENOTEMPTY"!==o.code&&"EEXIST"!==o.code&&"EPERM"!==o.code||function(e,t){n(e),n(t),t.readdirSync(e).forEach(function(r){y(i.join(e,r),t)});var r=l?100:1,o=0;for(;;){var s=!0;try{var a=t.rmdirSync(e,t);return s=!1,a}finally{if(++o<r&&s)continue}}}(e,t)}}},function(e,t,r){var n=r(7),i="win32"===process.platform,o=r(8),s=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function a(e){return"function"==typeof e?e:function(){var e;if(s){var t=new Error;e=function(e){e&&(t.message=e.message,r(e=t))}}else e=r;return e;function r(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}n.normalize;if(i)var c=/(.*?)(?:[\/\\]+|$)/g;else c=/(.*?)(?:[\/]+|$)/g;if(i)var u=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else u=/^[\/]*/;t.realpathSync=function(e,t){if(e=n.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var r,s,a,l,h=e,p={},f={};function d(){var t=u.exec(e);r=t[0].length,s=t[0],a=t[0],l="",i&&!f[a]&&(o.lstatSync(a),f[a]=!0)}for(d();r<e.length;){c.lastIndex=r;var g=c.exec(e);if(l=s,s+=g[0],a=l+g[1],r=c.lastIndex,!(f[a]||t&&t[a]===a)){var m;if(t&&Object.prototype.hasOwnProperty.call(t,a))m=t[a];else{var y=o.lstatSync(a);if(!y.isSymbolicLink()){f[a]=!0,t&&(t[a]=a);continue}var v=null;if(!i){var b=y.dev.toString(32)+":"+y.ino.toString(32);p.hasOwnProperty(b)&&(v=p[b])}null===v&&(o.statSync(a),v=o.readlinkSync(a)),m=n.resolve(l,v),t&&(t[a]=m),i||(p[b]=v)}e=n.resolve(m,e.slice(r)),d()}}return t&&(t[h]=e),e},t.realpath=function(e,t,r){if("function"!=typeof r&&(r=a(t),t=null),e=n.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(r.bind(null,null,t[e]));var s,l,h,p,f=e,d={},g={};function m(){var t=u.exec(e);s=t[0].length,l=t[0],h=t[0],p="",i&&!g[h]?o.lstat(h,function(e){if(e)return r(e);g[h]=!0,y()}):process.nextTick(y)}function y(){if(s>=e.length)return t&&(t[f]=e),r(null,e);c.lastIndex=s;var n=c.exec(e);return p=l,l+=n[0],h=p+n[1],s=c.lastIndex,g[h]||t&&t[h]===h?process.nextTick(y):t&&Object.prototype.hasOwnProperty.call(t,h)?_(t[h]):o.lstat(h,v)}function v(e,n){if(e)return r(e);if(!n.isSymbolicLink())return g[h]=!0,t&&(t[h]=h),process.nextTick(y);if(!i){var s=n.dev.toString(32)+":"+n.ino.toString(32);if(d.hasOwnProperty(s))return b(null,d[s],h)}o.stat(h,function(e){if(e)return r(e);o.readlink(h,function(e,t){i||(d[s]=t),b(e,t)})})}function b(e,i,o){if(e)return r(e);var s=n.resolve(p,i);t&&(t[o]=s),_(s)}function _(t){e=n.resolve(t,e.slice(s)),m()}m()}},function(e,t,r){var n=r(415),i=r(416);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,r){var o=[];var s=i("{","}",t);if(!s||/\$$/.test(s.pre))return[t];var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body);var u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body);var h=c||u;var m=s.body.indexOf(",")>=0;if(!h&&!m)return s.post.match(/,.*\}/)?(t=s.pre+"{"+s.body+a+s.post,e(t)):[t];var y;if(h)y=s.body.split(/\.\./);else if(1===(y=function e(t){if(!t)return[""];var r=[];var n=i("{","}",t);if(!n)return t.split(",");var o=n.pre;var s=n.body;var a=n.post;var c=o.split(",");c[c.length-1]+="{"+s+"}";var u=e(a);a.length&&(c[c.length-1]+=u.shift(),c.push.apply(c,u));r.push.apply(r,c);return r}(s.body)).length&&1===(y=e(y[0],!1).map(p)).length){var v=s.post.length?e(s.post,!1):[""];return v.map(function(e){return s.pre+y[0]+e})}var b=s.pre;var v=s.post.length?e(s.post,!1):[""];var _;if(h){var E=l(y[0]),C=l(y[1]),w=Math.max(y[0].length,y[1].length),S=3==y.length?Math.abs(l(y[2])):1,T=d,A=C<E;A&&(S*=-1,T=g);var I=y.some(f);_=[];for(var N=E;T(N,C);N+=S){var k;if(u)"\\"===(k=String.fromCharCode(N))&&(k="");else if(k=String(N),I){var R=w-k.length;if(R>0){var O=new Array(R+1).join("0");k=N<0?"-"+O+k.slice(1):O+k}}_.push(k)}}else _=n(y,function(t){return e(t,!1)});for(var x=0;x<_.length;x++)for(var B=0;B<v.length;B++){var D=b+_[x]+v[B];(!r||h||D)&&o.push(D)}return o}(function(e){return e.split("\\\\").join(o).split("\\{").join(s).split("\\}").join(a).split("\\,").join(c).split("\\.").join(u)}(e),!0).map(h)};var o="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function h(e){return e.split(o).join("\\").split(s).join("{").split(a).join("}").split(c).join(",").split(u).join(".")}function p(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function d(e,t){return e<=t}function g(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var n=[],i=0;i<e.length;i++){var o=t(e[i],i);r(o)?n.push.apply(n,o):n.push(o)}return n};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";function n(e,t,r){e instanceof RegExp&&(e=i(e,r)),t instanceof RegExp&&(t=i(t,r));var n=o(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function i(e,t){var r=t.match(e);return r?r[0]:null}function o(e,t,r){var n,i,o,s,a,c=r.indexOf(e),u=r.indexOf(t,c+1),l=c;if(c>=0&&u>0){for(n=[],o=r.length;l>=0&&!a;)l==c?(n.push(l),c=r.indexOf(e,l+1)):1==n.length?a=[n.pop(),u]:((i=n.pop())<o&&(o=i,s=u),u=r.indexOf(t,l+1)),l=c<u&&c>=0?c:u;n.length&&(a=[o,s])}return a}e.exports=n,n.range=o},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){e.exports=d,d.GlobSync=g;var n=r(8),i=r(257),o=r(163),s=(o.Minimatch,r(256).Glob,r(4),r(7)),a=r(15),c=r(164),u=r(258),l=(u.alphasort,u.alphasorti,u.setopts),h=u.ownProp,p=u.childrenIgnored,f=u.isIgnored;function d(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new g(e,t).found}function g(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof g))return new g(e,t);if(l(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}g.prototype._finish=function(){if(a(this instanceof g),this.realpath){var e=this;this.matches.forEach(function(t,r){var n=e.matches[r]=Object.create(null);for(var o in t)try{o=e._makeAbs(o),n[i.realpathSync(o,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;n[e._makeAbs(o)]=!0}})}u.finish(this)},g.prototype._process=function(e,t,r){a(this instanceof g);for(var n,i=0;"string"==typeof e[i];)i++;switch(i){case e.length:return void this._processSimple(e.join("/"),t);case 0:n=null;break;default:n=e.slice(0,i).join("/")}var s,u=e.slice(i);null===n?s=".":c(n)||c(e.join("/"))?(n&&c(n)||(n="/"+n),s=n):s=n;var l=this._makeAbs(s);p(this,s)||(u[0]===o.GLOBSTAR?this._processGlobStar(n,s,l,u,t,r):this._processReaddir(n,s,l,u,t,r))},g.prototype._processReaddir=function(e,t,r,n,i,o){var a=this._readdir(r,o);if(a){for(var c=n[0],u=!!this.minimatch.negate,l=c._glob,h=this.dot||"."===l.charAt(0),p=[],f=0;f<a.length;f++){if("."!==(m=a[f]).charAt(0)||h)(u&&!e?!m.match(c):m.match(c))&&p.push(m)}var d=p.length;if(0!==d)if(1!==n.length||this.mark||this.stat){n.shift();for(f=0;f<d;f++){var g;m=p[f];g=e?[e,m]:[m],this._process(g.concat(n),i,o)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var f=0;f<d;f++){var m=p[f];e&&(m="/"!==e.slice(-1)?e+"/"+m:e+m),"/"!==m.charAt(0)||this.nomount||(m=s.join(this.root,m)),this._emitMatch(i,m)}}}},g.prototype._emitMatch=function(e,t){if(!f(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},g.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r;try{r=n.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var i=r&&r.isSymbolicLink();return this.symlinks[e]=i,i||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},g.prototype._readdir=function(e,t){if(t&&!h(this.symlinks,e))return this._readdirInGlobStar(e);if(h(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,n.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},g.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t},g.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},g.prototype._processGlobStar=function(e,t,r,n,i,o){var s=this._readdir(r,o);if(s){var a=n.slice(1),c=e?[e]:[],u=c.concat(a);this._process(u,i,!1);var l=s.length;if(!this.symlinks[r]||!o)for(var h=0;h<l;h++){if("."!==s[h].charAt(0)||this.dot){var p=c.concat(s[h],a);this._process(p,i,!0);var f=c.concat(s[h],n);this._process(f,i,!0)}}}},g.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),r){if(e&&c(e)&&!this.nomount){var n=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=s.join(this.root,e):(e=s.resolve(this.root,e),n&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},g.prototype._stat=function(e){var t=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&h(this.cache,t)){var i=this.cache[t];if(Array.isArray(i)&&(i="DIR"),!r||"DIR"===i)return i;if(r&&"FILE"===i)return!1}var o=this.statCache[t];if(!o){var s;try{s=n.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(s&&s.isSymbolicLink())try{o=n.statSync(t)}catch(e){o=s}else o=s}this.statCache[t]=o;i=!0;return o&&(i=o.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||i,(!r||"FILE"!==i)&&i},g.prototype._mark=function(e){return u.mark(this,e)},g.prototype._makeAbs=function(e){return u.makeAbs(this,e)}},function(e,t,r){var n=r(259),i=Object.create(null),o=r(260);e.exports=n(function(e,t){return i[e]?(i[e].push(t),null):(i[e]=[t],function(e){return o(function t(){var r=i[e],n=r.length,o=function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}(arguments);try{for(var s=0;s<n;s++)r[s].apply(null,o)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){t.apply(null,o)})):delete i[e]}})}(e))})},function(e,t,r){"use strict";var n=r(421),i=r(429),o=r(12).EventEmitter,s=e.exports=new o,a=r(4),c=r(449),u=r(166);c(!0);var l,h,p=process.stderr;Object.defineProperty(s,"stream",{set:function(e){p=e,this.gauge&&this.gauge.setWriteTo(p,p)},get:function(){return p}}),s.useColor=function(){return null!=l?l:p.isTTY},s.enableColor=function(){l=!0,this.gauge.setTheme({hasColor:l,hasUnicode:h})},s.disableColor=function(){l=!1,this.gauge.setTheme({hasColor:l,hasUnicode:h})},s.level="info",s.gauge=new i(p,{enabled:!1,theme:{hasColor:s.useColor()},template:[{type:"progressbar",length:20},{type:"activityIndicator",kerning:1,length:1},{type:"section",default:""},":",{type:"logline",kerning:1,default:""}]}),s.tracker=new n.TrackerGroup,s.progressEnabled=s.gauge.isEnabled(),s.enableUnicode=function(){h=!0,this.gauge.setTheme({hasColor:this.useColor(),hasUnicode:h})},s.disableUnicode=function(){h=!1,this.gauge.setTheme({hasColor:this.useColor(),hasUnicode:h})},s.setGaugeThemeset=function(e){this.gauge.setThemeset(e)},s.setGaugeTemplate=function(e){this.gauge.setTemplate(e)},s.enableProgress=function(){this.progressEnabled||(this.progressEnabled=!0,this.tracker.on("change",this.showProgress),this._pause||this.gauge.enable())},s.disableProgress=function(){this.progressEnabled&&(this.progressEnabled=!1,this.tracker.removeListener("change",this.showProgress),this.gauge.disable())};var f=["newGroup","newItem","newStream"],d=function(e){return Object.keys(s).forEach(function(t){if("_"!==t[0]&&!f.filter(function(e){return e===t}).length&&!e[t]&&"function"==typeof s[t]){var r=s[t];e[t]=function(){return r.apply(s,arguments)}}}),e instanceof n.TrackerGroup&&f.forEach(function(t){var r=e[t];e[t]=function(){return d(r.apply(e,arguments))}}),e};f.forEach(function(e){s[e]=function(){return d(this.tracker[e].apply(this.tracker,arguments))}}),s.clearProgress=function(e){if(!this.progressEnabled)return e&&process.nextTick(e);this.gauge.hide(e)},s.showProgress=function(e,t){if(this.progressEnabled){var r={};e&&(r.section=e);var n=s.record[s.record.length-1];if(n){r.subsection=n.prefix;var i=s.disp[n.level]||n.level,o=this._format(i,s.style[n.level]);n.prefix&&(o+=" "+this._format(n.prefix,this.prefixStyle)),o+=" "+n.message.split(/\r?\n/)[0],r.logline=o}r.completed=t||this.tracker.completed(),this.gauge.show(r)}}.bind(s),s.pause=function(){this._paused=!0,this.progressEnabled&&this.gauge.disable()},s.resume=function(){if(this._paused){this._paused=!1;var e=this._buffer;this._buffer=[],e.forEach(function(e){this.emitLog(e)},this),this.progressEnabled&&this.gauge.enable()}},s._buffer=[];var g=0;s.record=[],s.maxRecordSize=1e4,s.log=function(e,t,r){if(void 0===this.levels[e])return this.emit("error",new Error(a.format("Undefined log level: %j",e)));for(var n=new Array(arguments.length-2),i=null,o=2;o<arguments.length;o++){var s=n[o-2]=arguments[o];"object"==typeof s&&s&&s instanceof Error&&s.stack&&Object.defineProperty(s,"stack",{value:i=s.stack+"",enumerable:!0,writable:!0})}i&&n.unshift(i+"\n"),r=a.format.apply(a,n);var c={id:g++,level:e,prefix:String(t||""),message:r,messageRaw:n};this.emit("log",c),this.emit("log."+e,c),c.prefix&&this.emit(c.prefix,c),this.record.push(c);var u=this.maxRecordSize;if(this.record.length-u>u/10){var l=Math.floor(.9*u);this.record=this.record.slice(-1*l)}this.emitLog(c)}.bind(s),s.emitLog=function(e){if(this._paused)this._buffer.push(e);else{this.progressEnabled&&this.gauge.pulse(e.prefix);var t=this.levels[e.level];if(void 0!==t&&!(t<this.levels[this.level])&&(!(t>0)||isFinite(t))){var r=null!=s.disp[e.level]?s.disp[e.level]:e.level;this.clearProgress(),e.message.split(/\r?\n/).forEach(function(t){this.heading&&(this.write(this.heading,this.headingStyle),this.write(" ")),this.write(r,s.style[e.level]);var n=e.prefix||"";n&&this.write(" "),this.write(n,this.prefixStyle),this.write(" "+t+"\n")},this),this.showProgress()}}},s._format=function(e,t){if(p){var r="";if(this.useColor()){var n=[];(t=t||{}).fg&&n.push(t.fg),t.bg&&n.push("bg"+t.bg[0].toUpperCase()+t.bg.slice(1)),t.bold&&n.push("bold"),t.underline&&n.push("underline"),t.inverse&&n.push("inverse"),n.length&&(r+=u.color(n)),t.beep&&(r+=u.beep())}return r+=e,this.useColor()&&(r+=u.color("reset")),r}},s.write=function(e,t){p&&p.write(this._format(e,t))},s.addLevel=function(e,t,r,n){null==n&&(n=e),this.levels[e]=t,this.style[e]=r,this[e]||(this[e]=function(){var t=new Array(arguments.length+1);t[0]=e;for(var r=0;r<arguments.length;r++)t[r+1]=arguments[r];return this.log.apply(this,t)}.bind(this)),this.disp[e]=n},s.prefixStyle={fg:"magenta"},s.headingStyle={fg:"white",bg:"black"},s.style={},s.levels={},s.disp={},s.addLevel("silly",-1/0,{inverse:!0},"sill"),s.addLevel("verbose",1e3,{fg:"blue",bg:"black"},"verb"),s.addLevel("info",2e3,{fg:"green"}),s.addLevel("timing",2500,{fg:"green",bg:"black"}),s.addLevel("http",3e3,{fg:"green",bg:"black"}),s.addLevel("notice",3500,{fg:"blue",bg:"black"}),s.addLevel("warn",4e3,{fg:"black",bg:"yellow"},"WARN"),s.addLevel("error",5e3,{fg:"red",bg:"black"},"ERR!"),s.addLevel("silent",1/0),s.on("error",function(){})},function(e,t,r){"use strict";t.TrackerGroup=r(422),t.Tracker=r(165),t.TrackerStream=r(262)},function(e,t,r){"use strict";var n=r(4),i=r(261),o=r(165),s=r(262),a=e.exports=function(e){var t;i.call(this,e),this.parentGroup=null,this.trackers=[],this.completion={},this.weight={},this.totalWeight=0,this.finished=!1,this.bubbleChange=(t=this,function(e,r,n){t.completion[n.id]=r,t.finished||t.emit("change",e||t.name,t.completed(),t)})};n.inherits(a,i),a.prototype.nameInTree=function(){for(var e=[],t=this;t;)e.unshift(t.name),t=t.parentGroup;return e.join("/")},a.prototype.addUnit=function(e,t){if(e.addUnit){for(var r=this;r;){if(e===r)throw new Error("Attempted to add tracker group "+e.name+" to tree that already includes it "+this.nameInTree(this));r=r.parentGroup}e.parentGroup=this}return this.weight[e.id]=t||1,this.totalWeight+=this.weight[e.id],this.trackers.push(e),this.completion[e.id]=e.completed(),e.on("change",this.bubbleChange),this.finished||this.emit("change",e.name,this.completion[e.id],e),e},a.prototype.completed=function(){if(0===this.trackers.length)return 0;for(var e=1/this.totalWeight,t=0,r=0;r<this.trackers.length;r++){var n=this.trackers[r].id;t+=e*this.weight[n]*this.completion[n]}return t},a.prototype.newGroup=function(e,t){return this.addUnit(new a(e),t)},a.prototype.newItem=function(e,t,r){return this.addUnit(new o(e,t),r)},a.prototype.newStream=function(e,t,r){return this.addUnit(new s(e,t),r)},a.prototype.finish=function(){this.finished=!0,this.trackers.length||this.addUnit(new o,1,!0);for(var e=0;e<this.trackers.length;e++){var t=this.trackers[e];t.finish(),t.removeListener("change",this.bubbleChange)}this.emit("change",this.name,1,this)};a.prototype.debug=function(e){var t=(e=e||0)?"                                  ".substr(0,e):"",r=t+(this.name||"top")+": "+this.completed()+"\n";return this.trackers.forEach(function(n){r+=n instanceof a?n.debug(e+1):t+" "+n.name+": "+n.completed()+"\n"}),r}},function(e,t,r){var n=r(9);"disable"===process.env.READABLE_STREAM&&n?(e.exports=n,(t=e.exports=n.Readable).Readable=n.Readable,t.Writable=n.Writable,t.Duplex=n.Duplex,t.Transform=n.Transform,t.PassThrough=n.PassThrough,t.Stream=n):((t=e.exports=r(263)).Stream=n||t,t.Readable=t,t.Writable=r(266),t.Duplex=r(72),t.Transform=r(268),t.PassThrough=r(427))},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";var n=r(125).Buffer,i=r(4);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i,o=n.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,r=o,i=a,t.copy(r,i),a+=s.data.length,s=s.next;return o},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t,r){e.exports=r(4).deprecate},function(e,t,r){"use strict";e.exports=o;var n=r(268),i=r(104);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}i.inherits=r(71),i.inherits(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t){function r(e,t){if(!(this instanceof r))return new r(e,t);this.proto=e,this.target=t,this.methods=[],this.getters=[],this.setters=[],this.fluents=[]}e.exports=r,r.prototype.method=function(e){var t=this.proto,r=this.target;return this.methods.push(e),t[e]=function(){return this[r][e].apply(this[r],arguments)},this},r.prototype.access=function(e){return this.getter(e).setter(e)},r.prototype.getter=function(e){var t=this.proto,r=this.target;return this.getters.push(e),t.__defineGetter__(e,function(){return this[r][e]}),this},r.prototype.setter=function(e){var t=this.proto,r=this.target;return this.setters.push(e),t.__defineSetter__(e,function(t){return this[r][e]=t}),this},r.prototype.fluent=function(e){var t=this.proto,r=this.target;return this.fluents.push(e),t[e]=function(t){return void 0!==t?(this[r][e]=t,this):this[r][e]},this}},function(e,t,r){"use strict";var n=r(430),i=r(438),o=r(439),s=r(440),a=r(442),c=r(447),u=r(273),l=r(448);function h(e,t){return function(){return t.call(e)}}function p(e,t){var r,i;e&&e.write?(i=e,r=t||{}):t&&t.write?(i=t,r=e||{}):(i=u.stderr,r=e||t||{}),this._status={spun:0,section:"",subsection:""},this._paused=!1,this._disabled=!0,this._showing=!1,this._onScreen=!1,this._needsRedraw=!1,this._hideCursor=null==r.hideCursor||r.hideCursor,this._fixedFramerate=null==r.fixedFramerate?!/^v0\.8\./.test(u.version):r.fixedFramerate,this._lastUpdateAt=null,this._updateInterval=null==r.updateInterval?50:r.updateInterval,this._themes=r.themes||a,this._theme=r.theme;var o=this._computeTheme(r.theme),s=r.template||[{type:"progressbar",length:20},{type:"activityIndicator",kerning:1,length:1},{type:"section",kerning:1,default:""},{type:"subsection",kerning:1,default:""}];this.setWriteTo(i,r.tty);var c=r.Plumbing||n;this._gauge=new c(o,s,this.getWidth()),this._$$doRedraw=h(this,this._doRedraw),this._$$handleSizeChange=h(this,this._handleSizeChange),this._cleanupOnExit=null==r.cleanupOnExit||r.cleanupOnExit,this._removeOnExit=null,r.enabled||null==r.enabled&&this._tty&&this._tty.isTTY?this.enable():this.disable()}e.exports=p,p.prototype={},p.prototype.isEnabled=function(){return!this._disabled},p.prototype.setTemplate=function(e){this._gauge.setTemplate(e),this._showing&&this._requestRedraw()},p.prototype._computeTheme=function(e){if(e||(e={}),"string"==typeof e)e=this._themes.getTheme(e);else if(e&&(0===Object.keys(e).length||null!=e.hasUnicode||null!=e.hasColor)){var t=null==e.hasUnicode?i():e.hasUnicode,r=null==e.hasColor?o:e.hasColor;e=this._themes.getDefault({hasUnicode:t,hasColor:r,platform:e.platform})}return e},p.prototype.setThemeset=function(e){this._themes=e,this.setTheme(this._theme)},p.prototype.setTheme=function(e){this._gauge.setTheme(this._computeTheme(e)),this._showing&&this._requestRedraw(),this._theme=e},p.prototype._requestRedraw=function(){this._needsRedraw=!0,this._fixedFramerate||this._doRedraw()},p.prototype.getWidth=function(){return(this._tty&&this._tty.columns||80)-1},p.prototype.setWriteTo=function(e,t){var r=!this._disabled;r&&this.disable(),this._writeTo=e,this._tty=t||e===u.stderr&&u.stdout.isTTY&&u.stdout||e.isTTY&&e||this._tty,this._gauge&&this._gauge.setWidth(this.getWidth()),r&&this.enable()},p.prototype.enable=function(){this._disabled&&(this._disabled=!1,this._tty&&this._enableEvents(),this._showing&&this.show())},p.prototype.disable=function(){this._disabled||(this._showing&&(this._lastUpdateAt=null,this._showing=!1,this._doRedraw(),this._showing=!0),this._disabled=!0,this._tty&&this._disableEvents())},p.prototype._enableEvents=function(){this._cleanupOnExit&&(this._removeOnExit=s(h(this,this.disable))),this._tty.on("resize",this._$$handleSizeChange),this._fixedFramerate&&(this.redrawTracker=c(this._$$doRedraw,this._updateInterval),this.redrawTracker.unref&&this.redrawTracker.unref())},p.prototype._disableEvents=function(){this._tty.removeListener("resize",this._$$handleSizeChange),this._fixedFramerate&&clearInterval(this.redrawTracker),this._removeOnExit&&this._removeOnExit()},p.prototype.hide=function(e){return this._disabled?e&&u.nextTick(e):this._showing?(this._showing=!1,this._doRedraw(),void(e&&l(e))):e&&u.nextTick(e)},p.prototype.show=function(e,t){if(this._showing=!0,"string"==typeof e)this._status.section=e;else if("object"==typeof e)for(var r=Object.keys(e),n=0;n<r.length;++n){var i=r[n];this._status[i]=e[i]}null!=t&&(this._status.completed=t),this._disabled||this._requestRedraw()},p.prototype.pulse=function(e){this._status.subsection=e||"",this._status.spun++,this._disabled||this._showing&&this._requestRedraw()},p.prototype._handleSizeChange=function(){this._gauge.setWidth(this._tty.columns-1),this._requestRedraw()},p.prototype._doRedraw=function(){if(!this._disabled&&!this._paused){if(!this._fixedFramerate){var e=Date.now();if(this._lastUpdateAt&&e-this._lastUpdateAt<this._updateInterval)return;this._lastUpdateAt=e}if(!this._showing&&this._onScreen){this._onScreen=!1;var t=this._gauge.hide();return this._hideCursor&&(t+=this._gauge.showCursor()),this._writeTo.write(t)}(this._showing||this._onScreen)&&(this._showing&&!this._onScreen&&(this._onScreen=!0,this._needsRedraw=!0,this._hideCursor&&this._writeTo.write(this._gauge.hideCursor())),this._needsRedraw&&(this._writeTo.write(this._gauge.show(this._status))||(this._paused=!0,this._writeTo.on("drain",h(this,function(){this._paused=!1,this._doRedraw()})))))}}},function(e,t,r){"use strict";var n=r(166),i=r(269),o=r(167),s=e.exports=function(e,t,r){r||(r=80),o("OAN",[e,t,r]),this.showing=!1,this.theme=e,this.width=r,this.template=t};s.prototype={},s.prototype.setTheme=function(e){o("O",[e]),this.theme=e},s.prototype.setTemplate=function(e){o("A",[e]),this.template=e},s.prototype.setWidth=function(e){o("N",[e]),this.width=e},s.prototype.hide=function(){return n.gotoSOL()+n.eraseLine()},s.prototype.hideCursor=n.hideCursor,s.prototype.showCursor=n.showCursor,s.prototype.show=function(e){var t=Object.create(this.theme);for(var r in e)t[r]=e[r];return i(this.width,this.template,t).trim()+n.color("reset")+n.eraseLine()+n.gotoSOL()}},function(e,t,r){"use strict";var n=r(126);function i(e){var t="",r=" ",n=e;do{n%2&&(t+=r),n=Math.floor(n/2),r+=r}while(n);return t}t.center=function(e,t){var r=e.trim();if(0===r.length&&e.length>=t)return e;var o="",s="",a=n(r);if(a<t){var c=parseInt((t-a)/2,10);o=i(c),s=i(t-(a+c))}return o+r+s},t.left=function(e,t){var r=e.trimRight();if(0===r.length&&e.length>=t)return e;var o="",s=n(r);s<t&&(o=i(t-s));return r+o},t.right=function(e,t){var r=e.trimLeft();if(0===r.length&&e.length>=t)return e;var o="",s=n(r);s<t&&(o=i(t-s));return o+r}},function(e,t,r){"use strict";e.exports=function(){return/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]/g}},function(e,t,r){"use strict";e.exports=function(e,t){if(null==e)throw TypeError();var r=(e=String(e)).length,n=t?Number(t):0;if(Number.isNaN(n)&&(n=0),!(n<0||n>=r)){var i=e.charCodeAt(n);if(i>=55296&&i<=56319&&r>n+1){var o=e.charCodeAt(n+1);if(o>=56320&&o<=57343)return 1024*(i-55296)+o-56320+65536}return i}}},function(e,t,r){"use strict";var n=r(435);e.exports=function(e){return!n(e)&&(e>=4352&&(e<=4447||9001===e||9002===e||11904<=e&&e<=12871&&12351!==e||12880<=e&&e<=19903||19968<=e&&e<=42182||43360<=e&&e<=43388||44032<=e&&e<=55203||63744<=e&&e<=64255||65040<=e&&e<=65049||65072<=e&&e<=65131||65281<=e&&e<=65376||65504<=e&&e<=65510||110592<=e&&e<=110593||127488<=e&&e<=127569||131072<=e&&e<=262141))}},function(e,t,r){"use strict";e.exports=Number.isNaN||function(e){return e!=e}},function(e,t,r){"use strict";var n=r(4),i=t.User=function e(t){var r=new Error(t);return Error.captureStackTrace(r,e),r.code="EGAUGE",r};t.MissingTemplateValue=function e(t,r){var o=new i(n.format('Missing template value "%s"',t.type));return Error.captureStackTrace(o,e),o.template=t,o.values=r,o},t.Internal=function e(t){var r=new Error(t);return Error.captureStackTrace(r,e),r.code="EGAUGEINTERNAL",r}},function(e,t,r){"use strict";var n=r(126);function i(e){return"string"==typeof e&&"%"===e.slice(-1)}function o(e){return Number(e.slice(0,-1))/100}function s(e,t){if(this.overallOutputLength=t,this.finished=!1,this.type=null,this.value=null,this.length=null,this.maxLength=null,this.minLength=null,this.kerning=null,this.align="left",this.padLeft=0,this.padRight=0,this.index=null,this.first=null,this.last=null,"string"==typeof e)this.value=e;else for(var r in e)this[r]=e[r];return i(this.length)&&(this.length=Math.round(this.overallOutputLength*o(this.length))),i(this.minLength)&&(this.minLength=Math.round(this.overallOutputLength*o(this.minLength))),i(this.maxLength)&&(this.maxLength=Math.round(this.overallOutputLength*o(this.maxLength))),this}e.exports=s,s.prototype={},s.prototype.getBaseLength=function(){var e=this.length;return null==e&&"string"==typeof this.value&&null==this.maxLength&&null==this.minLength&&(e=n(this.value)),e},s.prototype.getLength=function(){var e=this.getBaseLength();return null==e?null:e+this.padLeft+this.padRight},s.prototype.getMaxLength=function(){return null==this.maxLength?null:this.maxLength+this.padLeft+this.padRight},s.prototype.getMinLength=function(){return null==this.minLength?null:this.minLength+this.padLeft+this.padRight}},function(e,t,r){"use strict";var n=r(29);e.exports=function(){if("Windows_NT"==n.type())return!1;var e=process.env.LC_ALL||process.env.LC_CTYPE||process.env.LANG;return/UTF-?8$/i.test(e)}},function(e,t,r){"use strict";e.exports="win32"===process.platform||!!process.env.COLORTERM||/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(process.env.TERM)},function(e,t,r){var n,i=r(15),o=r(441),s=r(12);function a(){l&&(l=!1,o.forEach(function(e){try{process.removeListener(e,u[e])}catch(e){}}),process.emit=d,process.reallyExit=p,n.count-=1)}function c(e,t,r){n.emitted[e]||(n.emitted[e]=!0,n.emit(e,t,r))}"function"!=typeof s&&(s=s.EventEmitter),process.__signal_exit_emitter__?n=process.__signal_exit_emitter__:((n=process.__signal_exit_emitter__=new s).count=0,n.emitted={}),n.infinite||(n.setMaxListeners(1/0),n.infinite=!0),e.exports=function(e,t){i.equal(typeof e,"function","a callback must be provided for exit handler"),!1===l&&h();var r="exit";t&&t.alwaysLast&&(r="afterexit");return n.on(r,e),function(){n.removeListener(r,e),0===n.listeners("exit").length&&0===n.listeners("afterexit").length&&a()}},e.exports.unload=a;var u={};o.forEach(function(e){u[e]=function(){process.listeners(e).length===n.count&&(a(),c("exit",null,e),c("afterexit",null,e),process.kill(process.pid,e))}}),e.exports.signals=function(){return o},e.exports.load=h;var l=!1;function h(){l||(l=!0,n.count+=1,o=o.filter(function(e){try{return process.on(e,u[e]),!0}catch(e){return!1}}),process.emit=g,process.reallyExit=f)}var p=process.reallyExit;function f(e){process.exitCode=e||0,c("exit",process.exitCode,null),c("afterexit",process.exitCode,null),p.call(process,process.exitCode)}var d=process.emit;function g(e,t){if("exit"===e){void 0!==t&&(process.exitCode=t);var r=d.apply(this,arguments);return c("exit",process.exitCode,null),c("afterexit",process.exitCode,null),r}return d.apply(this,arguments)}},function(e,t){e.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"],"win32"!==process.platform&&e.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),"linux"===process.platform&&e.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")},function(e,t,r){"use strict";var n=r(166),i=r(443),o=e.exports=new i;o.addTheme("ASCII",{preProgressbar:"[",postProgressbar:"]",progressbarTheme:{complete:"#",remaining:"."},activityIndicatorTheme:"-\\|/",preSubsection:">"}),o.addTheme("colorASCII",o.getTheme("ASCII"),{progressbarTheme:{preComplete:n.color("inverse"),complete:" ",postComplete:n.color("stopInverse"),preRemaining:n.color("brightBlack"),remaining:".",postRemaining:n.color("reset")}}),o.addTheme("brailleSpinner",{preProgressbar:"",postProgressbar:"",progressbarTheme:{complete:"",remaining:""},activityIndicatorTheme:"",preSubsection:">"}),o.addTheme("colorBrailleSpinner",o.getTheme("brailleSpinner"),{progressbarTheme:{preComplete:n.color("inverse"),complete:" ",postComplete:n.color("stopInverse"),preRemaining:n.color("brightBlack"),remaining:"",postRemaining:n.color("reset")}}),o.setDefault({},"ASCII"),o.setDefault({hasColor:!0},"colorASCII"),o.setDefault({platform:"darwin",hasUnicode:!0},"brailleSpinner"),o.setDefault({platform:"darwin",hasUnicode:!0,hasColor:!0},"colorBrailleSpinner")},function(e,t,r){"use strict";var n=r(271);e.exports=function(){return i.newThemeSet()};var i={};i.baseTheme=r(444),i.newTheme=function(e,t){return t||(t=e,e=this.baseTheme),n({},e,t)},i.getThemeNames=function(){return Object.keys(this.themes)},i.addTheme=function(e,t,r){this.themes[e]=this.newTheme(t,r)},i.addToAllThemes=function(e){var t=this.themes;Object.keys(t).forEach(function(r){n(t[r],e)}),n(this.baseTheme,e)},i.getTheme=function(e){if(!this.themes[e])throw this.newMissingThemeError(e);return this.themes[e]},i.setDefault=function(e,t){null==t&&(t=e,e={});var r=null==e.platform?"fallback":e.platform,n=!!e.hasUnicode,i=!!e.hasColor;this.defaults[r]||(this.defaults[r]={true:{},false:{}}),this.defaults[r][n][i]=t},i.getDefault=function(e){e||(e={});var t=e.platform||process.platform,r=this.defaults[t]||this.defaults.fallback,i=!!e.hasUnicode,o=!!e.hasColor;if(!r)throw this.newMissingDefaultThemeError(t,i,o);if(!r[i][o])if(i&&o&&r[!i][o])i=!1;else if(i&&o&&r[i][!o])o=!1;else if(i&&o&&r[!i][!o])i=!1,o=!1;else if(i&&!o&&r[!i][o])i=!1;else if(!i&&o&&r[i][!o])o=!1;else if(r===this.defaults.fallback)throw this.newMissingDefaultThemeError(t,i,o);return r[i][o]?this.getTheme(r[i][o]):this.getDefault(n({},e,{platform:"fallback"}))},i.newMissingThemeError=function e(t){var r=new Error('Could not find a gauge theme named "'+t+'"');return Error.captureStackTrace.call(r,e),r.theme=t,r.code="EMISSINGTHEME",r},i.newMissingDefaultThemeError=function e(t,r,n){var i=new Error("Could not find a gauge theme for your platform/unicode/color use combo:\n    platform = "+t+"\n    hasUnicode = "+r+"\n    hasColor = "+n);return Error.captureStackTrace.call(i,e),i.platform=t,i.hasUnicode=r,i.hasColor=n,i.code="EMISSINGTHEME",i},i.newThemeSet=function(){var e=function(t){return e.getDefault(t)};return n(e,i,{themes:n({},this.themes),baseTheme:n({},this.baseTheme),defaults:JSON.parse(JSON.stringify(this.defaults||{}))})}},function(e,t,r){"use strict";var n=r(445),i=r(446);e.exports={activityIndicator:function(e,t,r){if(null!=e.spun)return n(t,e.spun)},progressbar:function(e,t,r){if(null!=e.completed)return i(t,r,e.completed)}}},function(e,t,r){"use strict";e.exports=function(e,t){return e[t%e.length]}},function(e,t,r){"use strict";var n=r(167),i=r(269),o=r(272),s=r(126);function a(e,t){var r="",n=t;do{n%2&&(r+=e),n=Math.floor(n/2),e+=e}while(n&&s(r)<t);return o(r,t)}e.exports=function(e,t,r){if(n("ONN",[e,t,r]),r<0&&(r=0),r>1&&(r=1),t<=0)return"";var o=Math.round(t*r),s=t-o,c=[{type:"complete",value:a(e.complete,o),length:o},{type:"remaining",value:a(e.remaining,s),length:s}];return i(t,c,e)}},function(e,t,r){"use strict";e.exports=setInterval},function(e,t,r){"use strict";var n=r(273);try{e.exports=setImmediate}catch(t){e.exports=n.nextTick}},function(e,t){e.exports=function(e){[process.stdout,process.stderr].forEach(function(t){t._handle&&t.isTTY&&"function"==typeof t._handle.setBlocking&&t._handle.setBlocking(e)})}},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=450},function(e){e.exports={"0.1.14":{node_abi:null,v8:"1.3"},"0.1.15":{node_abi:null,v8:"1.3"},"0.1.16":{node_abi:null,v8:"1.3"},"0.1.17":{node_abi:null,v8:"1.3"},"0.1.18":{node_abi:null,v8:"1.3"},"0.1.19":{node_abi:null,v8:"2.0"},"0.1.20":{node_abi:null,v8:"2.0"},"0.1.21":{node_abi:null,v8:"2.0"},"0.1.22":{node_abi:null,v8:"2.0"},"0.1.23":{node_abi:null,v8:"2.0"},"0.1.24":{node_abi:null,v8:"2.0"},"0.1.25":{node_abi:null,v8:"2.0"},"0.1.26":{node_abi:null,v8:"2.0"},"0.1.27":{node_abi:null,v8:"2.1"},"0.1.28":{node_abi:null,v8:"2.1"},"0.1.29":{node_abi:null,v8:"2.1"},"0.1.30":{node_abi:null,v8:"2.1"},"0.1.31":{node_abi:null,v8:"2.1"},"0.1.32":{node_abi:null,v8:"2.1"},"0.1.33":{node_abi:null,v8:"2.1"},"0.1.90":{node_abi:null,v8:"2.2"},"0.1.91":{node_abi:null,v8:"2.2"},"0.1.92":{node_abi:null,v8:"2.2"},"0.1.93":{node_abi:null,v8:"2.2"},"0.1.94":{node_abi:null,v8:"2.2"},"0.1.95":{node_abi:null,v8:"2.2"},"0.1.96":{node_abi:null,v8:"2.2"},"0.1.97":{node_abi:null,v8:"2.2"},"0.1.98":{node_abi:null,v8:"2.2"},"0.1.99":{node_abi:null,v8:"2.2"},"0.1.100":{node_abi:null,v8:"2.2"},"0.1.101":{node_abi:null,v8:"2.3"},"0.1.102":{node_abi:null,v8:"2.3"},"0.1.103":{node_abi:null,v8:"2.3"},"0.1.104":{node_abi:null,v8:"2.3"},"0.2.0":{node_abi:1,v8:"2.3"},"0.2.1":{node_abi:1,v8:"2.3"},"0.2.2":{node_abi:1,v8:"2.3"},"0.2.3":{node_abi:1,v8:"2.3"},"0.2.4":{node_abi:1,v8:"2.3"},"0.2.5":{node_abi:1,v8:"2.3"},"0.2.6":{node_abi:1,v8:"2.3"},"0.3.0":{node_abi:1,v8:"2.5"},"0.3.1":{node_abi:1,v8:"2.5"},"0.3.2":{node_abi:1,v8:"3.0"},"0.3.3":{node_abi:1,v8:"3.0"},"0.3.4":{node_abi:1,v8:"3.0"},"0.3.5":{node_abi:1,v8:"3.0"},"0.3.6":{node_abi:1,v8:"3.0"},"0.3.7":{node_abi:1,v8:"3.0"},"0.3.8":{node_abi:1,v8:"3.1"},"0.4.0":{node_abi:1,v8:"3.1"},"0.4.1":{node_abi:1,v8:"3.1"},"0.4.2":{node_abi:1,v8:"3.1"},"0.4.3":{node_abi:1,v8:"3.1"},"0.4.4":{node_abi:1,v8:"3.1"},"0.4.5":{node_abi:1,v8:"3.1"},"0.4.6":{node_abi:1,v8:"3.1"},"0.4.7":{node_abi:1,v8:"3.1"},"0.4.8":{node_abi:1,v8:"3.1"},"0.4.9":{node_abi:1,v8:"3.1"},"0.4.10":{node_abi:1,v8:"3.1"},"0.4.11":{node_abi:1,v8:"3.1"},"0.4.12":{node_abi:1,v8:"3.1"},"0.5.0":{node_abi:1,v8:"3.1"},"0.5.1":{node_abi:1,v8:"3.4"},"0.5.2":{node_abi:1,v8:"3.4"},"0.5.3":{node_abi:1,v8:"3.4"},"0.5.4":{node_abi:1,v8:"3.5"},"0.5.5":{node_abi:1,v8:"3.5"},"0.5.6":{node_abi:1,v8:"3.6"},"0.5.7":{node_abi:1,v8:"3.6"},"0.5.8":{node_abi:1,v8:"3.6"},"0.5.9":{node_abi:1,v8:"3.6"},"0.5.10":{node_abi:1,v8:"3.7"},"0.6.0":{node_abi:1,v8:"3.6"},"0.6.1":{node_abi:1,v8:"3.6"},"0.6.2":{node_abi:1,v8:"3.6"},"0.6.3":{node_abi:1,v8:"3.6"},"0.6.4":{node_abi:1,v8:"3.6"},"0.6.5":{node_abi:1,v8:"3.6"},"0.6.6":{node_abi:1,v8:"3.6"},"0.6.7":{node_abi:1,v8:"3.6"},"0.6.8":{node_abi:1,v8:"3.6"},"0.6.9":{node_abi:1,v8:"3.6"},"0.6.10":{node_abi:1,v8:"3.6"},"0.6.11":{node_abi:1,v8:"3.6"},"0.6.12":{node_abi:1,v8:"3.6"},"0.6.13":{node_abi:1,v8:"3.6"},"0.6.14":{node_abi:1,v8:"3.6"},"0.6.15":{node_abi:1,v8:"3.6"},"0.6.16":{node_abi:1,v8:"3.6"},"0.6.17":{node_abi:1,v8:"3.6"},"0.6.18":{node_abi:1,v8:"3.6"},"0.6.19":{node_abi:1,v8:"3.6"},"0.6.20":{node_abi:1,v8:"3.6"},"0.6.21":{node_abi:1,v8:"3.6"},"0.7.0":{node_abi:1,v8:"3.8"},"0.7.1":{node_abi:1,v8:"3.8"},"0.7.2":{node_abi:1,v8:"3.8"},"0.7.3":{node_abi:1,v8:"3.9"},"0.7.4":{node_abi:1,v8:"3.9"},"0.7.5":{node_abi:1,v8:"3.9"},"0.7.6":{node_abi:1,v8:"3.9"},"0.7.7":{node_abi:1,v8:"3.9"},"0.7.8":{node_abi:1,v8:"3.9"},"0.7.9":{node_abi:1,v8:"3.11"},"0.7.10":{node_abi:1,v8:"3.9"},"0.7.11":{node_abi:1,v8:"3.11"},"0.7.12":{node_abi:1,v8:"3.11"},"0.8.0":{node_abi:1,v8:"3.11"},"0.8.1":{node_abi:1,v8:"3.11"},"0.8.2":{node_abi:1,v8:"3.11"},"0.8.3":{node_abi:1,v8:"3.11"},"0.8.4":{node_abi:1,v8:"3.11"},"0.8.5":{node_abi:1,v8:"3.11"},"0.8.6":{node_abi:1,v8:"3.11"},"0.8.7":{node_abi:1,v8:"3.11"},"0.8.8":{node_abi:1,v8:"3.11"},"0.8.9":{node_abi:1,v8:"3.11"},"0.8.10":{node_abi:1,v8:"3.11"},"0.8.11":{node_abi:1,v8:"3.11"},"0.8.12":{node_abi:1,v8:"3.11"},"0.8.13":{node_abi:1,v8:"3.11"},"0.8.14":{node_abi:1,v8:"3.11"},"0.8.15":{node_abi:1,v8:"3.11"},"0.8.16":{node_abi:1,v8:"3.11"},"0.8.17":{node_abi:1,v8:"3.11"},"0.8.18":{node_abi:1,v8:"3.11"},"0.8.19":{node_abi:1,v8:"3.11"},"0.8.20":{node_abi:1,v8:"3.11"},"0.8.21":{node_abi:1,v8:"3.11"},"0.8.22":{node_abi:1,v8:"3.11"},"0.8.23":{node_abi:1,v8:"3.11"},"0.8.24":{node_abi:1,v8:"3.11"},"0.8.25":{node_abi:1,v8:"3.11"},"0.8.26":{node_abi:1,v8:"3.11"},"0.8.27":{node_abi:1,v8:"3.11"},"0.8.28":{node_abi:1,v8:"3.11"},"0.9.0":{node_abi:1,v8:"3.11"},"0.9.1":{node_abi:10,v8:"3.11"},"0.9.2":{node_abi:10,v8:"3.11"},"0.9.3":{node_abi:10,v8:"3.13"},"0.9.4":{node_abi:10,v8:"3.13"},"0.9.5":{node_abi:10,v8:"3.13"},"0.9.6":{node_abi:10,v8:"3.15"},"0.9.7":{node_abi:10,v8:"3.15"},"0.9.8":{node_abi:10,v8:"3.15"},"0.9.9":{node_abi:11,v8:"3.15"},"0.9.10":{node_abi:11,v8:"3.15"},"0.9.11":{node_abi:11,v8:"3.14"},"0.9.12":{node_abi:11,v8:"3.14"},"0.10.0":{node_abi:11,v8:"3.14"},"0.10.1":{node_abi:11,v8:"3.14"},"0.10.2":{node_abi:11,v8:"3.14"},"0.10.3":{node_abi:11,v8:"3.14"},"0.10.4":{node_abi:11,v8:"3.14"},"0.10.5":{node_abi:11,v8:"3.14"},"0.10.6":{node_abi:11,v8:"3.14"},"0.10.7":{node_abi:11,v8:"3.14"},"0.10.8":{node_abi:11,v8:"3.14"},"0.10.9":{node_abi:11,v8:"3.14"},"0.10.10":{node_abi:11,v8:"3.14"},"0.10.11":{node_abi:11,v8:"3.14"},"0.10.12":{node_abi:11,v8:"3.14"},"0.10.13":{node_abi:11,v8:"3.14"},"0.10.14":{node_abi:11,v8:"3.14"},"0.10.15":{node_abi:11,v8:"3.14"},"0.10.16":{node_abi:11,v8:"3.14"},"0.10.17":{node_abi:11,v8:"3.14"},"0.10.18":{node_abi:11,v8:"3.14"},"0.10.19":{node_abi:11,v8:"3.14"},"0.10.20":{node_abi:11,v8:"3.14"},"0.10.21":{node_abi:11,v8:"3.14"},"0.10.22":{node_abi:11,v8:"3.14"},"0.10.23":{node_abi:11,v8:"3.14"},"0.10.24":{node_abi:11,v8:"3.14"},"0.10.25":{node_abi:11,v8:"3.14"},"0.10.26":{node_abi:11,v8:"3.14"},"0.10.27":{node_abi:11,v8:"3.14"},"0.10.28":{node_abi:11,v8:"3.14"},"0.10.29":{node_abi:11,v8:"3.14"},"0.10.30":{node_abi:11,v8:"3.14"},"0.10.31":{node_abi:11,v8:"3.14"},"0.10.32":{node_abi:11,v8:"3.14"},"0.10.33":{node_abi:11,v8:"3.14"},"0.10.34":{node_abi:11,v8:"3.14"},"0.10.35":{node_abi:11,v8:"3.14"},"0.10.36":{node_abi:11,v8:"3.14"},"0.10.37":{node_abi:11,v8:"3.14"},"0.10.38":{node_abi:11,v8:"3.14"},"0.10.39":{node_abi:11,v8:"3.14"},"0.10.40":{node_abi:11,v8:"3.14"},"0.10.41":{node_abi:11,v8:"3.14"},"0.10.42":{node_abi:11,v8:"3.14"},"0.10.43":{node_abi:11,v8:"3.14"},"0.10.44":{node_abi:11,v8:"3.14"},"0.10.45":{node_abi:11,v8:"3.14"},"0.10.46":{node_abi:11,v8:"3.14"},"0.10.47":{node_abi:11,v8:"3.14"},"0.10.48":{node_abi:11,v8:"3.14"},"0.11.0":{node_abi:12,v8:"3.17"},"0.11.1":{node_abi:12,v8:"3.18"},"0.11.2":{node_abi:12,v8:"3.19"},"0.11.3":{node_abi:12,v8:"3.19"},"0.11.4":{node_abi:12,v8:"3.20"},"0.11.5":{node_abi:12,v8:"3.20"},"0.11.6":{node_abi:12,v8:"3.20"},"0.11.7":{node_abi:12,v8:"3.20"},"0.11.8":{node_abi:13,v8:"3.21"},"0.11.9":{node_abi:13,v8:"3.22"},"0.11.10":{node_abi:13,v8:"3.22"},"0.11.11":{node_abi:14,v8:"3.22"},"0.11.12":{node_abi:14,v8:"3.22"},"0.11.13":{node_abi:14,v8:"3.25"},"0.11.14":{node_abi:14,v8:"3.26"},"0.11.15":{node_abi:14,v8:"3.28"},"0.11.16":{node_abi:14,v8:"3.28"},"0.12.0":{node_abi:14,v8:"3.28"},"0.12.1":{node_abi:14,v8:"3.28"},"0.12.2":{node_abi:14,v8:"3.28"},"0.12.3":{node_abi:14,v8:"3.28"},"0.12.4":{node_abi:14,v8:"3.28"},"0.12.5":{node_abi:14,v8:"3.28"},"0.12.6":{node_abi:14,v8:"3.28"},"0.12.7":{node_abi:14,v8:"3.28"},"0.12.8":{node_abi:14,v8:"3.28"},"0.12.9":{node_abi:14,v8:"3.28"},"0.12.10":{node_abi:14,v8:"3.28"},"0.12.11":{node_abi:14,v8:"3.28"},"0.12.12":{node_abi:14,v8:"3.28"},"0.12.13":{node_abi:14,v8:"3.28"},"0.12.14":{node_abi:14,v8:"3.28"},"0.12.15":{node_abi:14,v8:"3.28"},"0.12.16":{node_abi:14,v8:"3.28"},"0.12.17":{node_abi:14,v8:"3.28"},"0.12.18":{node_abi:14,v8:"3.28"},"1.0.0":{node_abi:42,v8:"3.31"},"1.0.1":{node_abi:42,v8:"3.31"},"1.0.2":{node_abi:42,v8:"3.31"},"1.0.3":{node_abi:42,v8:"4.1"},"1.0.4":{node_abi:42,v8:"4.1"},"1.1.0":{node_abi:43,v8:"4.1"},"1.2.0":{node_abi:43,v8:"4.1"},"1.3.0":{node_abi:43,v8:"4.1"},"1.4.1":{node_abi:43,v8:"4.1"},"1.4.2":{node_abi:43,v8:"4.1"},"1.4.3":{node_abi:43,v8:"4.1"},"1.5.0":{node_abi:43,v8:"4.1"},"1.5.1":{node_abi:43,v8:"4.1"},"1.6.0":{node_abi:43,v8:"4.1"},"1.6.1":{node_abi:43,v8:"4.1"},"1.6.2":{node_abi:43,v8:"4.1"},"1.6.3":{node_abi:43,v8:"4.1"},"1.6.4":{node_abi:43,v8:"4.1"},"1.7.1":{node_abi:43,v8:"4.1"},"1.8.1":{node_abi:43,v8:"4.1"},"1.8.2":{node_abi:43,v8:"4.1"},"1.8.3":{node_abi:43,v8:"4.1"},"1.8.4":{node_abi:43,v8:"4.1"},"2.0.0":{node_abi:44,v8:"4.2"},"2.0.1":{node_abi:44,v8:"4.2"},"2.0.2":{node_abi:44,v8:"4.2"},"2.1.0":{node_abi:44,v8:"4.2"},"2.2.0":{node_abi:44,v8:"4.2"},"2.2.1":{node_abi:44,v8:"4.2"},"2.3.0":{node_abi:44,v8:"4.2"},"2.3.1":{node_abi:44,v8:"4.2"},"2.3.2":{node_abi:44,v8:"4.2"},"2.3.3":{node_abi:44,v8:"4.2"},"2.3.4":{node_abi:44,v8:"4.2"},"2.4.0":{node_abi:44,v8:"4.2"},"2.5.0":{node_abi:44,v8:"4.2"},"3.0.0":{node_abi:45,v8:"4.4"},"3.1.0":{node_abi:45,v8:"4.4"},"3.2.0":{node_abi:45,v8:"4.4"},"3.3.0":{node_abi:45,v8:"4.4"},"3.3.1":{node_abi:45,v8:"4.4"},"4.0.0":{node_abi:46,v8:"4.5"},"4.1.0":{node_abi:46,v8:"4.5"},"4.1.1":{node_abi:46,v8:"4.5"},"4.1.2":{node_abi:46,v8:"4.5"},"4.2.0":{node_abi:46,v8:"4.5"},"4.2.1":{node_abi:46,v8:"4.5"},"4.2.2":{node_abi:46,v8:"4.5"},"4.2.3":{node_abi:46,v8:"4.5"},"4.2.4":{node_abi:46,v8:"4.5"},"4.2.5":{node_abi:46,v8:"4.5"},"4.2.6":{node_abi:46,v8:"4.5"},"4.3.0":{node_abi:46,v8:"4.5"},"4.3.1":{node_abi:46,v8:"4.5"},"4.3.2":{node_abi:46,v8:"4.5"},"4.4.0":{node_abi:46,v8:"4.5"},"4.4.1":{node_abi:46,v8:"4.5"},"4.4.2":{node_abi:46,v8:"4.5"},"4.4.3":{node_abi:46,v8:"4.5"},"4.4.4":{node_abi:46,v8:"4.5"},"4.4.5":{node_abi:46,v8:"4.5"},"4.4.6":{node_abi:46,v8:"4.5"},"4.4.7":{node_abi:46,v8:"4.5"},"4.5.0":{node_abi:46,v8:"4.5"},"4.6.0":{node_abi:46,v8:"4.5"},"4.6.1":{node_abi:46,v8:"4.5"},"4.6.2":{node_abi:46,v8:"4.5"},"4.7.0":{node_abi:46,v8:"4.5"},"4.7.1":{node_abi:46,v8:"4.5"},"4.7.2":{node_abi:46,v8:"4.5"},"4.7.3":{node_abi:46,v8:"4.5"},"4.8.0":{node_abi:46,v8:"4.5"},"4.8.1":{node_abi:46,v8:"4.5"},"4.8.2":{node_abi:46,v8:"4.5"},"4.8.3":{node_abi:46,v8:"4.5"},"4.8.4":{node_abi:46,v8:"4.5"},"4.8.5":{node_abi:46,v8:"4.5"},"4.8.6":{node_abi:46,v8:"4.5"},"4.8.7":{node_abi:46,v8:"4.5"},"4.9.0":{node_abi:46,v8:"4.5"},"4.9.1":{node_abi:46,v8:"4.5"},"5.0.0":{node_abi:47,v8:"4.6"},"5.1.0":{node_abi:47,v8:"4.6"},"5.1.1":{node_abi:47,v8:"4.6"},"5.2.0":{node_abi:47,v8:"4.6"},"5.3.0":{node_abi:47,v8:"4.6"},"5.4.0":{node_abi:47,v8:"4.6"},"5.4.1":{node_abi:47,v8:"4.6"},"5.5.0":{node_abi:47,v8:"4.6"},"5.6.0":{node_abi:47,v8:"4.6"},"5.7.0":{node_abi:47,v8:"4.6"},"5.7.1":{node_abi:47,v8:"4.6"},"5.8.0":{node_abi:47,v8:"4.6"},"5.9.0":{node_abi:47,v8:"4.6"},"5.9.1":{node_abi:47,v8:"4.6"},"5.10.0":{node_abi:47,v8:"4.6"},"5.10.1":{node_abi:47,v8:"4.6"},"5.11.0":{node_abi:47,v8:"4.6"},"5.11.1":{node_abi:47,v8:"4.6"},"5.12.0":{node_abi:47,v8:"4.6"},"6.0.0":{node_abi:48,v8:"5.0"},"6.1.0":{node_abi:48,v8:"5.0"},"6.2.0":{node_abi:48,v8:"5.0"},"6.2.1":{node_abi:48,v8:"5.0"},"6.2.2":{node_abi:48,v8:"5.0"},"6.3.0":{node_abi:48,v8:"5.0"},"6.3.1":{node_abi:48,v8:"5.0"},"6.4.0":{node_abi:48,v8:"5.0"},"6.5.0":{node_abi:48,v8:"5.1"},"6.6.0":{node_abi:48,v8:"5.1"},"6.7.0":{node_abi:48,v8:"5.1"},"6.8.0":{node_abi:48,v8:"5.1"},"6.8.1":{node_abi:48,v8:"5.1"},"6.9.0":{node_abi:48,v8:"5.1"},"6.9.1":{node_abi:48,v8:"5.1"},"6.9.2":{node_abi:48,v8:"5.1"},"6.9.3":{node_abi:48,v8:"5.1"},"6.9.4":{node_abi:48,v8:"5.1"},"6.9.5":{node_abi:48,v8:"5.1"},"6.10.0":{node_abi:48,v8:"5.1"},"6.10.1":{node_abi:48,v8:"5.1"},"6.10.2":{node_abi:48,v8:"5.1"},"6.10.3":{node_abi:48,v8:"5.1"},"6.11.0":{node_abi:48,v8:"5.1"},"6.11.1":{node_abi:48,v8:"5.1"},"6.11.2":{node_abi:48,v8:"5.1"},"6.11.3":{node_abi:48,v8:"5.1"},"6.11.4":{node_abi:48,v8:"5.1"},"6.11.5":{node_abi:48,v8:"5.1"},"6.12.0":{node_abi:48,v8:"5.1"},"6.12.1":{node_abi:48,v8:"5.1"},"6.12.2":{node_abi:48,v8:"5.1"},"6.12.3":{node_abi:48,v8:"5.1"},"6.13.0":{node_abi:48,v8:"5.1"},"6.13.1":{node_abi:48,v8:"5.1"},"6.14.0":{node_abi:48,v8:"5.1"},"6.14.1":{node_abi:48,v8:"5.1"},"6.14.2":{node_abi:48,v8:"5.1"},"6.14.3":{node_abi:48,v8:"5.1"},"6.14.4":{node_abi:48,v8:"5.1"},"7.0.0":{node_abi:51,v8:"5.4"},"7.1.0":{node_abi:51,v8:"5.4"},"7.2.0":{node_abi:51,v8:"5.4"},"7.2.1":{node_abi:51,v8:"5.4"},"7.3.0":{node_abi:51,v8:"5.4"},"7.4.0":{node_abi:51,v8:"5.4"},"7.5.0":{node_abi:51,v8:"5.4"},"7.6.0":{node_abi:51,v8:"5.5"},"7.7.0":{node_abi:51,v8:"5.5"},"7.7.1":{node_abi:51,v8:"5.5"},"7.7.2":{node_abi:51,v8:"5.5"},"7.7.3":{node_abi:51,v8:"5.5"},"7.7.4":{node_abi:51,v8:"5.5"},"7.8.0":{node_abi:51,v8:"5.5"},"7.9.0":{node_abi:51,v8:"5.5"},"7.10.0":{node_abi:51,v8:"5.5"},"7.10.1":{node_abi:51,v8:"5.5"},"8.0.0":{node_abi:57,v8:"5.8"},"8.1.0":{node_abi:57,v8:"5.8"},"8.1.1":{node_abi:57,v8:"5.8"},"8.1.2":{node_abi:57,v8:"5.8"},"8.1.3":{node_abi:57,v8:"5.8"},"8.1.4":{node_abi:57,v8:"5.8"},"8.2.0":{node_abi:57,v8:"5.8"},"8.2.1":{node_abi:57,v8:"5.8"},"8.3.0":{node_abi:57,v8:"6.0"},"8.4.0":{node_abi:57,v8:"6.0"},"8.5.0":{node_abi:57,v8:"6.0"},"8.6.0":{node_abi:57,v8:"6.0"},"8.7.0":{node_abi:57,v8:"6.1"},"8.8.0":{node_abi:57,v8:"6.1"},"8.8.1":{node_abi:57,v8:"6.1"},"8.9.0":{node_abi:57,v8:"6.1"},"8.9.1":{node_abi:57,v8:"6.1"},"8.9.2":{node_abi:57,v8:"6.1"},"8.9.3":{node_abi:57,v8:"6.1"},"8.9.4":{node_abi:57,v8:"6.1"},"8.10.0":{node_abi:57,v8:"6.2"},"8.11.0":{node_abi:57,v8:"6.2"},"8.11.1":{node_abi:57,v8:"6.2"},"8.11.2":{node_abi:57,v8:"6.2"},"8.11.3":{node_abi:57,v8:"6.2"},"8.11.4":{node_abi:57,v8:"6.2"},"8.12.0":{node_abi:57,v8:"6.2"},"9.0.0":{node_abi:59,v8:"6.2"},"9.1.0":{node_abi:59,v8:"6.2"},"9.2.0":{node_abi:59,v8:"6.2"},"9.2.1":{node_abi:59,v8:"6.2"},"9.3.0":{node_abi:59,v8:"6.2"},"9.4.0":{node_abi:59,v8:"6.2"},"9.5.0":{node_abi:59,v8:"6.2"},"9.6.0":{node_abi:59,v8:"6.2"},"9.6.1":{node_abi:59,v8:"6.2"},"9.7.0":{node_abi:59,v8:"6.2"},"9.7.1":{node_abi:59,v8:"6.2"},"9.8.0":{node_abi:59,v8:"6.2"},"9.9.0":{node_abi:59,v8:"6.2"},"9.10.0":{node_abi:59,v8:"6.2"},"9.10.1":{node_abi:59,v8:"6.2"},"9.11.0":{node_abi:59,v8:"6.2"},"9.11.1":{node_abi:59,v8:"6.2"},"9.11.2":{node_abi:59,v8:"6.2"},"10.0.0":{node_abi:64,v8:"6.6"},"10.1.0":{node_abi:64,v8:"6.6"},"10.2.0":{node_abi:64,v8:"6.6"},"10.2.1":{node_abi:64,v8:"6.6"},"10.3.0":{node_abi:64,v8:"6.6"},"10.4.0":{node_abi:64,v8:"6.7"},"10.4.1":{node_abi:64,v8:"6.7"},"10.5.0":{node_abi:64,v8:"6.7"},"10.6.0":{node_abi:64,v8:"6.7"},"10.7.0":{node_abi:64,v8:"6.7"},"10.8.0":{node_abi:64,v8:"6.7"},"10.9.0":{node_abi:64,v8:"6.8"},"10.10.0":{node_abi:64,v8:"6.8"},"10.11.0":{node_abi:64,v8:"6.8"},"10.12.0":{node_abi:64,v8:"6.8"},"10.13.0":{node_abi:64,v8:"6.8"},"11.0.0":{node_abi:67,v8:"7.0"},"11.1.0":{node_abi:67,v8:"7.0"}}},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=452},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=453},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2015 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(16),i=r(70),o=r(106),s=r(105),a=r(73),c=r(9),u=c.Readable,l=c.Writable,h=c.Duplex,p=r(4),f=r(12).EventEmitter;function d(e,t){var r=new s,n={code:a.status.UNKNOWN,details:"Unknown Error"};t.hasOwnProperty("message")&&(n.details=t.message),t.hasOwnProperty("code")&&Number.isInteger(t.code)&&(n.code=t.code,t.hasOwnProperty("details")&&(n.details=t.details)),t.hasOwnProperty("metadata")&&(r=t.metadata),n.metadata=r._getCoreRepresentation();var o={};e.metadataSent||(o[i.opType.SEND_INITIAL_METADATA]=(new s)._getCoreRepresentation()),o[i.opType.SEND_STATUS_FROM_SERVER]=n,e.startBatch(o,function(){})}function g(e,t,r,n,o){var c,u={},l=new s,h={code:a.status.OK,details:"OK"};n&&(l=n);try{c=r(t)}catch(t){return t.code=a.status.INTERNAL,void d(e,t)}h.metadata=l._getCoreRepresentation(),e.metadataSent||(u[i.opType.SEND_INITIAL_METADATA]=(new s)._getCoreRepresentation(),e.metadataSent=!0),c.grpcWriteFlags=o,u[i.opType.SEND_MESSAGE]=c,u[i.opType.SEND_STATUS_FROM_SERVER]=h,e.startBatch(u,function(){})}function m(e,t){e.finished=!1,e.status={code:a.status.OK,details:"OK",metadata:new s},e.serialize=o.wrapIgnoreNull(t),e.on("finish",function(){var t={};e.call.metadataSent||(e.call.metadataSent=!0,t[i.opType.SEND_INITIAL_METADATA]=(new s)._getCoreRepresentation()),e.status.metadata&&(e.status.metadata=e.status.metadata._getCoreRepresentation()),t[i.opType.SEND_STATUS_FROM_SERVER]=e.status,e.call.startBatch(t,function(){})}),e.on("error",function(t){!function(t){var r=a.status.UNKNOWN,n="Unknown Error",i=new s;t.hasOwnProperty("message")&&(n=t.message),t.hasOwnProperty("code")&&(r=t.code,t.hasOwnProperty("details")&&(n=t.details)),t.hasOwnProperty("metadata")&&(i=t.metadata),e.status={code:r,details:n,metadata:i}}(t),e.end()}),e.end=function(t){t&&(e.status.metadata=t),l.prototype.end.call(this)}}function y(e,t){e.deserialize=o.wrapIgnoreNull(t),e.finished=!1,e.reading=!1,e.terminate=function(){e.finished=!0,e.on("data",function(){})},e.on("cancelled",function(){e.terminate()})}function v(e,t){f.call(this),this.call=e,this.cancelled=!1,this.metadata=t,this.request=void 0}function b(e,t,r){l.call(this,{objectMode:!0}),this.call=e,this.finished=!1,m(this,r),this.cancelled=!1,this.metadata=t,this.request=void 0}function _(e,t,r){var o,c={},u=this;try{o=this.serialize(e)}catch(e){return e.code=a.status.INTERNAL,void r(e)}this.call.metadataSent||(c[i.opType.SEND_INITIAL_METADATA]=(new s)._getCoreRepresentation(),this.call.metadataSent=!0),n.isFinite(t)&&(o.grpcWriteFlags=t),c[i.opType.SEND_MESSAGE]=o,this.call.startBatch(c,function(e,t){e?u.emit("error",e):r()})}function E(e,t,r){u.call(this,{objectMode:!0}),this.call=e,y(this,r),this.cancelled=!1,this.metadata=t}function C(e){var t=this;if(t.finished)t.push(null);else if(!t.reading){t.reading=!0;var r={};r[i.opType.RECV_MESSAGE]=!0,t.call.startBatch(r,function e(r,n){if(r)t.terminate();else if(t.finished)t.push(null);else{var o,s=n.read;try{o=t.deserialize(s)}catch(e){return e.code=a.status.INTERNAL,void t.emit("error",e)}if(t.push(o)&&null!==s){var c={};c[i.opType.RECV_MESSAGE]=!0,t.call.startBatch(c,e)}else t.reading=!1}})}}function w(e,t,r,n){h.call(this,{objectMode:!0}),this.call=e,m(this,r),y(this,n),this.cancelled=!1,this.metadata=t}function S(e){var t=this;if(!this.call.metadataSent){this.call.metadataSent=!0;var r={};r[i.opType.SEND_INITIAL_METADATA]=e._getCoreRepresentation(),this.call.startBatch(r,function(e){e&&t.emit("error",e)})}}function T(){return this.call.getPeer()}function A(){var e=this,t={};t[i.opType.RECV_CLOSE_ON_SERVER]=!0,e.call.startBatch(t,function(t,r){t&&e.emit("error",t),r.cancelled&&(e.cancelled=!0,e.emit("cancelled"))})}p.inherits(v,f),p.inherits(b,l),b.prototype._write=_,p.inherits(E,u),E.prototype._read=C,p.inherits(w,h),w.prototype._read=C,w.prototype._write=_,v.prototype.sendMetadata=S,b.prototype.sendMetadata=S,E.prototype.sendMetadata=S,w.prototype.sendMetadata=S,v.prototype.getPeer=T,E.prototype.getPeer=T,b.prototype.getPeer=T,w.prototype.getPeer=T,v.prototype.waitForCancel=A,E.prototype.waitForCancel=A,b.prototype.waitForCancel=A,w.prototype.waitForCancel=A;var I={unary:function(e,t,r){var n=new v(e,r);n.on("error",function(t){d(e,t)}),n.waitForCancel();var o={};o[i.opType.RECV_MESSAGE]=!0,e.startBatch(o,function(r,i){if(r)d(e,r);else{try{n.request=t.deserialize(i.read)}catch(t){return t.code=a.status.INTERNAL,void d(e,t)}n.cancelled||t.func(n,function(r,n,i,o){r?(i&&(r.metadata=i),d(e,r)):g(e,n,t.serialize,i,o)})}})},server_stream:function(e,t,r){var n=new b(e,r,t.serialize);n.waitForCancel();var o={};o[i.opType.RECV_MESSAGE]=!0,e.startBatch(o,function(e,r){if(e)n.emit("error",e);else{try{n.request=t.deserialize(r.read)}catch(e){return e.code=a.status.INTERNAL,void n.emit("error",e)}t.func(n)}})},client_stream:function(e,t,r){var n=new E(e,r,t.deserialize);n.on("error",function(t){d(e,t)}),n.waitForCancel(),t.func(n,function(r,i,o,s){n.terminate(),r?(o&&(r.metadata=o),d(e,r)):g(e,i,t.serialize,o,s)})},bidi:function(e,t,r){var n=new w(e,r,t.serialize,t.deserialize);n.waitForCancel(),t.func(n)}};function N(e){this.handlers={};var t=new i.Server(e);this._server=t,this.started=!1}N.prototype.start=function(){if(this.started)throw new Error("Server is already running");var e=this;this.started=!0,this._server.start(),this._server.requestCall(function t(r,n){if(!r){var o=n.new_call,c=o.call,u=o.method,l=s._fromCoreRepresentation(o.metadata);if(null!==u){var h;if(e._server.requestCall(t),!e.handlers.hasOwnProperty(u)){var p={};return p[i.opType.SEND_INITIAL_METADATA]=(new s)._getCoreRepresentation(),p[i.opType.SEND_STATUS_FROM_SERVER]={code:a.status.UNIMPLEMENTED,details:"RPC method not implemented "+u,metadata:{}},p[i.opType.RECV_CLOSE_ON_SERVER]=!0,void c.startBatch(p,function(){})}h=e.handlers[u],I[h.type](c,h,l)}}})},N.prototype.register=function(e,t,r,n,i){return!this.handlers.hasOwnProperty(e)&&(this.handlers[e]={func:t,serialize:r,deserialize:n,type:i},!0)},N.prototype.tryShutdown=function(e){this._server.tryShutdown(e)},N.prototype.forceShutdown=function(){this._server.forceShutdown()};var k={code:a.status.UNIMPLEMENTED,details:"The server does not implement this method"},R={unary:function(e,t){t(k)},client_stream:function(e,t){t(k)},server_stream:function(e){e.emit("error",k)},bidi:function(e){e.emit("error",k)}};N.prototype.addService=function(e,t){if(!n.isObject(e)||!n.isObject(t))throw new Error("addService requires two objects as arguments");if(0===n.keys(e).length)throw new Error("Cannot add an empty service to a server");if(this.started)throw new Error("Can't add a service to a started server.");var r=this;n.forOwn(e,function(e,i){var s,c;s=e.requestStream?e.responseStream?"bidi":"client_stream":e.responseStream?"server_stream":"unary",void 0===t[i]?void 0===t[e.originalName]?(o.log(a.logVerbosity.ERROR,"Method handler "+i+" for "+e.path+" expected but not provided"),c=R[s]):c=n.bind(t[e.originalName],t):c=n.bind(t[i],t);var u=e.responseSerialize,l=e.requestDeserialize;if(!r.register(e.path,c,u,l,s))throw new Error("Method handler for "+e.path+" already provided.")})},N.prototype.addProtoService=p.deprecate(function(e,t){var i,s=r(275),a=r(276);s.isProbablyProtobufJs5(e)?(i=n.defaults(e.grpc_options,o.defaultGrpcOptions),this.addService(s.getProtobufServiceAttrs(e,i),t)):a.isProbablyProtobufJs6(e)?(i=n.defaults(e.grpc_options,o.defaultGrpcOptions),this.addService(a.getProtobufServiceAttrs(e,i),t)):this.addService(e,t)},"Server#addProtoService: Use Server#addService instead"),N.prototype.bind=function(e,t){if(this.started)throw new Error("Can't bind an already running server to an address");return this._server.addHttp2Port(e,t)},N.prototype.bindAsync=function(e,t,r){const n=this.bind(e,t);n<0?setImmediate(r,new Error("Failed to bind port"),n):setImmediate(r,null,n)},t.Server=N},function(e,t,r){"use strict";
/**
 * @license
 * Copyright 2015 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */var n=r(70),i=n.CallCredentials,o=n.ChannelCredentials,s=r(105),a=r(106),c=r(73),u=r(16);const l="-----BEGIN CERTIFICATE-----",h="-----END CERTIFICATE-----";t.createSsl=function(e,t,r,n){if(n&&n.checkServerIdentity){if("function"!=typeof n.checkServerIdentity)throw new TypeError("Value of checkServerIdentity must be a function.");var i=Object.assign({},n);i.checkServerIdentity=(s=n.checkServerIdentity,function(e,t){var r=t.indexOf(l);if(-1===r)return new Error("Unable to parse certificate PEM.");var n=(t=t.substring(r)).indexOf(h);if(-1===n)return new Error("Unable to parse certificate PEM.");t=t.substring(l.length,n);var i=new Buffer(t.replace("\n","").replace(" ",""),"base64");return s(e,{raw:i})}),arguments[3]=i}var s;return o.createSsl.apply(this,arguments)},t.createFromMetadataGenerator=function(e){return i.createFromPlugin(function(t,r,n){e({service_url:t},function(e,t){var i=c.status.OK,o="";e&&(o=e.message,i=e.hasOwnProperty("code")&&u.isFinite(e.code)?e.code:c.status.UNAUTHENTICATED,t||(t=new s)),n(i,o,t._getCoreRepresentation(),r)})})},t.createFromGoogleCredential=function(e){return t.createFromMetadataGenerator(function(t,r){var n=t.service_url;!function(e,t,r){"function"==typeof e.getRequestHeaders?e.getRequestHeaders(t).then(function(e){r(null,e.Authorization)}).catch(function(e){r(e)}):e.getRequestMetadata(t,function(e,t){e?r(e):r(null,t.Authorization)})}(e,n,function(e,t){if(e)return a.log(c.logVerbosity.INFO,"Auth error:"+e),void r(e);var n=new s;n.add("authorization",t),r(null,n)})})},t.combineChannelCredentials=function(e){for(var t=e,r=1;r<arguments.length;r++)t=t.compose(arguments[r]);return t},t.combineCallCredentials=function(){for(var e=arguments[0],t=1;t<arguments.length;t++)e=e.compose(arguments[t]);return e},t.createInsecure=o.createInsecure},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(154),i=r(168),o=r(457),s=r(277);t.Client=s.Client;const a=r(49);t.logVerbosity=a.LogVerbosity,t.status=a.Status;const c=r(467),u=r(468);t.loadPackageDefinition=u.loadPackageDefinition,t.makeClientConstructor=u.makeClientConstructor,t.makeGenericClientConstructor=u.makeClientConstructor;const l=r(128);t.Metadata=l.Metadata;const h=r(469);t.StatusBuilder=h.StatusBuilder;if(!n.satisfies(process.version,"^8.11.2 || >=9.4"))throw new Error("@grpc/grpc-js only works on Node ^8.11.2 || >=9.4");t.credentials=function(...e){const t={};for(const r of e)for(const e of Object.getOwnPropertyNames(r)){const n=r[e];"function"==typeof n&&(t[e]=n)}return t}({createFromGoogleCredential:e=>i.CallCredentials.createFromMetadataGenerator((t,r)=>{e.getRequestMetadata(t.service_url,(e,t)=>{if(e)return void r(e);const n=new l.Metadata;n.add("authorization",t.Authorization),r(null,n)})}),combineChannelCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e),combineCallCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e)},o.ChannelCredentials,i.CallCredentials),t.closeClient=(e=>e.close()),t.waitForClientReady=((e,t,r)=>e.waitForReady(t,r)),t.loadObject=((e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")}),t.load=((e,t,r)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")}),t.setLogger=(e=>{c.setLogger(e)}),t.setLogVerbosity=(e=>{c.setLoggerVerbosity(e)}),t.Server=(e=>{throw new Error("Not yet implemented")}),t.ServerCredentials={createSsl:(e,t,r)=>{throw new Error("Not yet implemented")},createInsecure:()=>{throw new Error("Not yet implemented")}},t.getClientChannel=(e=>s.Client.prototype.getChannel.call(e)),t.ListenerBuilder=(()=>{throw new Error("Not yet implemented")}),t.InterceptorBuilder=(()=>{throw new Error("Not yet implemented")}),t.InterceptingCall=(()=>{throw new Error("Not yet implemented")})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(156),i=r(168);function o(e,t){if(e&&!(e instanceof Buffer))throw new TypeError(`${t}, if provided, must be a Buffer.`)}class s{constructor(e){this.callCredentials=e||i.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,i){if(o(e,"Root certificate"),o(t,"Private key"),o(r,"Certificate chain"),t&&!r)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&r)throw new Error("Certificate chain must be given with accompanying private key");const s={secureContext:n.createSecureContext({ca:e||void 0,key:t||void 0,cert:r||void 0})};return i&&i.checkServerIdentity&&(s.checkServerIdentity=((e,t)=>i.checkServerIdentity(e,{raw:t.raw}))),new c(s)}static createInsecure(){return new a}}t.ChannelCredentials=s;class a extends s{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}}class c extends s{constructor(e,t){super(t),this.connectionOptions=e}compose(e){const t=this.callCredentials.compose(e);return new c(this.connectionOptions,t)}_getConnectionOptions(){return this.connectionOptions}_isSecure(){return!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12),i=r(9),o=r(49);function s(e,t,r){let n=!1;t.on("data",n=>{let i;try{i=r(n)}catch(e){return void t.cancelWithStatus(o.Status.INTERNAL,"Failed to parse server response")}e.push(i)||t.pause()}),t.on("end",()=>{n?e.push(null):t.once("status",()=>{e.push(null)})}),t.on("status",t=>{if(t.code!==o.Status.OK){const r=Object.assign(new Error(t.details),t);e.emit("error",r)}e.emit("status",t),n=!0}),t.pause()}t.ClientUnaryCallImpl=class extends n.EventEmitter{constructor(e){super(),this.call=e,e.on("metadata",e=>{this.emit("metadata",e)}),e.on("status",e=>{this.emit("status",e)})}cancel(){this.call.cancelWithStatus(o.Status.CANCELLED,"Cancelled on client")}getPeer(){return this.call.getPeer()}};function a(e,t,r,n,i){let s;const a=Number(n);try{s=t(r)}catch(t){return e.cancelWithStatus(o.Status.INTERNAL,"Serialization failure"),void i(t)}const c={message:s};Number.isNaN(a)||(c.flags=a),e.write(c,i)}t.ClientReadableStreamImpl=class extends i.Readable{constructor(e,t){super({objectMode:!0}),this.call=e,this.deserialize=t,e.on("metadata",e=>{this.emit("metadata",e)}),s(this,e,t)}cancel(){this.call.cancelWithStatus(o.Status.CANCELLED,"Cancelled on client")}getPeer(){return this.call.getPeer()}_read(e){this.call.resume()}};t.ClientWritableStreamImpl=class extends i.Writable{constructor(e,t){super({objectMode:!0}),this.call=e,this.serialize=t,e.on("metadata",e=>{this.emit("metadata",e)}),e.on("status",e=>{this.emit("status",e)})}cancel(){this.call.cancelWithStatus(o.Status.CANCELLED,"Cancelled on client")}getPeer(){return this.call.getPeer()}_write(e,t,r){a(this.call,this.serialize,e,t,r)}_final(e){this.call.end(),e()}};t.ClientDuplexStreamImpl=class extends i.Duplex{constructor(e,t,r){super({objectMode:!0}),this.call=e,this.serialize=t,this.deserialize=r,e.on("metadata",e=>{this.emit("metadata",e)}),s(this,e,r)}cancel(){this.call.cancelWithStatus(o.Status.CANCELLED,"Cancelled on client")}getPeer(){return this.call.getPeer()}_read(e){this.call.resume()}_write(e,t,r){a(this.call,this.serialize,e,t,r)}_final(e){this.call.end(),e()}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(129);class o extends i.BaseFilter{constructor(e,t){super(),this.channel=e,this.stream=t,this.channel=e,this.stream=t;const r=t.getMethod().split("/");let n="";r.length>=2&&(n=r[1]),this.serviceUrl=`https://${t.getHost()}/${n}`}sendMetadata(e){return n(this,void 0,void 0,function*(){const t=this.channel.credentials._getCallCredentials(),r=this.stream.getCredentials(),n=t.compose(r).generateMetadata({service_url:this.serviceUrl}),i=yield e;return i.merge(yield n),i})}}t.CallCredentialsFilter=o;t.CallCredentialsFilterFactory=class{constructor(e){this.channel=e}createFilter(e){return new o(this.channel,e)}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(169),o=r(9),s=r(168),a=r(49),c=r(128),{HTTP2_HEADER_STATUS:u,HTTP2_HEADER_CONTENT_TYPE:l,NGHTTP2_CANCEL:h}=i.constants;var p;!function(e){e[e.NO_DATA=0]="NO_DATA",e[e.READING_SIZE=1]="READING_SIZE",e[e.READING_MESSAGE=2]="READING_MESSAGE"}(p||(p={}));t.Http2CallStream=class extends o.Duplex{constructor(e,t,r,n){super({objectMode:!0}),this.methodName=e,this.channel=t,this.options=r,this.credentials=s.CallCredentials.createEmpty(),this.http2Stream=null,this.pendingRead=!1,this.pendingWrite=null,this.pendingWriteCallback=null,this.pendingFinalCallback=null,this.readState=p.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0,this.isReadFilterPending=!1,this.canPush=!1,this.unpushedReadMessages=[],this.unfilteredReadMessages=[],this.mappedStatusCode=a.Status.UNKNOWN,this.handlingHeaders=Promise.resolve(),this.handlingTrailers=Promise.resolve(),this.finalStatus=null,this.filterStack=n.createFilter(this)}endCall(e){null===this.finalStatus&&(this.finalStatus=e,this.emit("status",e))}handleFilterError(e){this.cancelWithStatus(a.Status.INTERNAL,e.message)}handleFilteredRead(e){if(this.isReadFilterPending=!1,this.canPush?this.push(e)||(this.canPush=!1,this.http2Stream.pause()):this.unpushedReadMessages.push(e),this.unfilteredReadMessages.length>0){const e=this.unfilteredReadMessages.shift();this.filterReceivedMessage(e)}}filterReceivedMessage(e){null!==e?(this.isReadFilterPending=!0,this.filterStack.receiveMessage(Promise.resolve(e)).then(this.handleFilteredRead.bind(this),this.handleFilterError.bind(this))):this.canPush?this.push(null):this.unpushedReadMessages.push(null)}tryPush(e){this.isReadFilterPending?this.unfilteredReadMessages.push(e):this.filterReceivedMessage(e)}handleTrailers(e){const t=this.mappedStatusCode;let r;try{r=c.Metadata.fromHttp2Headers(e)}catch(e){r=new c.Metadata}const i={code:t,details:"",metadata:r};this.handlingTrailers=(()=>n(this,void 0,void 0,function*(){let e;try{e=yield this.filterStack.receiveTrailers(Promise.resolve(i))}catch(e){return yield this.handlingHeaders,void this.endCall({code:a.Status.INTERNAL,details:"Failed to process received status",metadata:new c.Metadata})}yield this.handlingHeaders,this.endCall(e)}))()}attachHttp2Stream(e){if(null!==this.finalStatus)e.close(h);else{if(this.http2Stream=e,e.on("response",(e,t)=>{switch(e[u]){case"400":this.mappedStatusCode=a.Status.INTERNAL;break;case"401":this.mappedStatusCode=a.Status.UNAUTHENTICATED;break;case"403":this.mappedStatusCode=a.Status.PERMISSION_DENIED;break;case"404":this.mappedStatusCode=a.Status.UNIMPLEMENTED;break;case"429":case"502":case"503":case"504":this.mappedStatusCode=a.Status.UNAVAILABLE;break;default:this.mappedStatusCode=a.Status.UNKNOWN}if(t&i.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(e);else{let t;try{t=c.Metadata.fromHttp2Headers(e)}catch(e){return void this.endCall({code:a.Status.UNKNOWN,details:e.message,metadata:new c.Metadata})}this.handlingHeaders=this.filterStack.receiveMetadata(Promise.resolve(t)).then(e=>{this.emit("metadata",e)}).catch(e=>{this.destroyHttp2Stream(),this.endCall({code:a.Status.UNKNOWN,details:e.message,metadata:new c.Metadata})})}}),e.on("trailers",this.handleTrailers.bind(this)),e.on("data",e=>{let t,r=0;for(;r<e.length;)switch(this.readState){case p.NO_DATA:this.readCompressFlag=e.slice(r,r+1),r+=1,this.readState=p.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case p.READING_SIZE:t=Math.min(e.length-r,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,r,r+t),this.readSizeRemaining-=t,r+=t,0===this.readSizeRemaining&&(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0?this.readState=p.READING_MESSAGE:(this.tryPush(Buffer.concat([this.readCompressFlag,this.readPartialSize])),this.readState=p.NO_DATA));break;case p.READING_MESSAGE:if(t=Math.min(e.length-r,this.readMessageRemaining),this.readPartialMessage.push(e.slice(r,r+t)),this.readMessageRemaining-=t,r+=t,0===this.readMessageRemaining){const e=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),t=Buffer.concat(e,this.readMessageSize+5);this.tryPush(t),this.readState=p.NO_DATA}break;default:throw new Error("This should never happen")}}),e.on("end",()=>{this.tryPush(null)}),e.on("close",e=>n(this,void 0,void 0,function*(){let t,r="";switch(e){case i.constants.NGHTTP2_REFUSED_STREAM:t=a.Status.UNAVAILABLE;break;case i.constants.NGHTTP2_CANCEL:t=a.Status.CANCELLED;break;case i.constants.NGHTTP2_ENHANCE_YOUR_CALM:t=a.Status.RESOURCE_EXHAUSTED,r="Bandwidth exhausted";break;case i.constants.NGHTTP2_INADEQUATE_SECURITY:t=a.Status.PERMISSION_DENIED,r="Protocol not secure enough";break;default:t=a.Status.INTERNAL}yield this.handlingTrailers,this.endCall({code:t,details:r,metadata:new c.Metadata})})),e.on("error",e=>{this.endCall({code:a.Status.INTERNAL,details:"Internal HTTP2 error",metadata:new c.Metadata})}),this.pendingRead||e.pause(),this.pendingWrite){if(!this.pendingWriteCallback)throw new Error("Invalid state in write handling code");e.write(this.pendingWrite,this.pendingWriteCallback)}this.pendingFinalCallback&&e.end(this.pendingFinalCallback)}}sendMetadata(e){this.channel._startHttp2Stream(this.options.host,this.methodName,this,e)}destroyHttp2Stream(){null===this.http2Stream||this.http2Stream.destroyed||this.http2Stream.close(h)}cancelWithStatus(e,t){this.destroyHttp2Stream(),(()=>n(this,void 0,void 0,function*(){yield this.handlingTrailers,this.endCall({code:e,details:t,metadata:new c.Metadata})}))()}getDeadline(){return this.options.deadline}getCredentials(){return this.credentials}setCredentials(e){this.credentials=e}getStatus(){return this.finalStatus}getPeer(){throw new Error("Not yet implemented")}getMethod(){return this.methodName}getHost(){return this.options.host}_read(e){if(this.canPush=!0,null===this.http2Stream)this.pendingRead=!0;else{for(;this.unpushedReadMessages.length>0;){const e=this.unpushedReadMessages.shift();if(this.canPush=this.push(e),null===e||!this.canPush)return void(this.canPush=!1)}this.http2Stream.resume()}}_write(e,t,r){this.filterStack.sendMessage(Promise.resolve(e)).then(e=>{null===this.http2Stream?(this.pendingWrite=e.message,this.pendingWriteCallback=r):this.http2Stream.write(e.message,r)},this.handleFilterError.bind(this))}_final(e){null===this.http2Stream?this.pendingFinalCallback=e:this.http2Stream.end(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(51),o=r(129);class s{writeMessage(e,t){return n(this,void 0,void 0,function*(){let r=e;t&&(r=yield this.compressMessage(r));const n=Buffer.allocUnsafe(r.length+5);return n.writeUInt8(t?1:0,0),n.writeUInt32BE(r.length,1),r.copy(n,5),n})}readMessage(e){return n(this,void 0,void 0,function*(){const t=1===e.readUInt8(0);let r=e.slice(5);return t&&(r=yield this.decompressMessage(r)),r})}}class a extends s{compressMessage(e){return n(this,void 0,void 0,function*(){return e})}writeMessage(e,t){return n(this,void 0,void 0,function*(){const t=Buffer.allocUnsafe(e.length+5);return t.writeUInt8(0,0),t.writeUInt32BE(e.length,1),e.copy(t,5),t})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}}class c extends s{compressMessage(e){return new Promise((t,r)=>{i.deflate(e,(e,n)=>{e?r(e):t(n)})})}decompressMessage(e){return new Promise((t,r)=>{i.inflate(e,(e,n)=>{e?r(e):t(n)})})}}class u extends s{compressMessage(e){return new Promise((t,r)=>{i.gzip(e,(e,n)=>{e?r(e):t(n)})})}decompressMessage(e){return new Promise((t,r)=>{i.unzip(e,(e,n)=>{e?r(e):t(n)})})}}class l extends s{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed wth unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}}class h extends o.BaseFilter{constructor(){super(...arguments),this.sendCompression=new a,this.receiveCompression=new a}sendMetadata(e){return n(this,void 0,void 0,function*(){const t=yield e;return t.set("grpc-encoding","identity"),t.set("grpc-accept-encoding","identity,deflate,gzip"),t})}receiveMetadata(e){return n(this,void 0,void 0,function*(){const t=yield e,r=t.get("grpc-encoding");if(r.length>0){const e=r[0];"string"==typeof e&&(this.receiveCompression=function(e){switch(e){case"identity":return new a;case"deflate":return new c;case"gzip":return new u;default:return new l(e)}}(e))}return t.remove("grpc-encoding"),t.remove("grpc-accept-encoding"),t})}sendMessage(e){return n(this,void 0,void 0,function*(){const t=yield e,r=void 0!==t.flags&&0==(2&t.flags);return{message:yield this.sendCompression.writeMessage(t.message,r),flags:t.flags}})}receiveMessage(e){return n(this,void 0,void 0,function*(){return this.receiveCompression.readMessage(yield e)})}}t.CompressionFilter=h;t.CompressionFilterFactory=class{constructor(e){this.channel=e}createFilter(e){return new h}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(278),i=r(49),o=r(129),s=[["m",1],["S",1e3],["M",6e4],["H",36e5]];class a extends o.BaseFilter{constructor(e,t){super(),this.channel=e,this.callStream=t,this.timer=null;const r=t.getDeadline();r instanceof Date?this.deadline=r.getTime():this.deadline=r;const n=(new Date).getTime();let o=this.deadline-n;o<0&&(o=0),this.deadline!==1/0&&(this.timer=setTimeout(()=>{t.cancelWithStatus(i.Status.DEADLINE_EXCEEDED,"Deadline exceeded")},o),t.on("status",()=>clearTimeout(this.timer)))}sendMetadata(e){return this.deadline===1/0?e:new Promise((t,r)=>{if(this.channel.getConnectivityState(!1)===n.ConnectivityState.READY)t(e);else{const r=i=>{i===n.ConnectivityState.READY&&(t(e),this.channel.removeListener("connectivityStateChanged",r))};this.channel.on("connectivityStateChanged",r)}}).then(e=>{const t=function(e){const t=(new Date).getTime(),r=Math.max(e-t,0);for(const[e,t]of s){const n=r/t;if(n<1e8)return String(Math.ceil(n))+e}throw new Error("Deadline is too far in the future")}(this.deadline);return e.set("grpc-timeout",t),e})}}t.DeadlineFilter=a;t.DeadlineFilterFactory=class{constructor(e){this.channel=e}createFilter(e){return new a(this.channel,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(16);class i{constructor(e){this.filters=e}sendMetadata(e){return n.flow(n.map(this.filters,e=>e.sendMetadata.bind(e)))(e)}receiveMetadata(e){return n.flowRight(n.map(this.filters,e=>e.receiveMetadata.bind(e)))(e)}sendMessage(e){return n.flow(n.map(this.filters,e=>e.sendMessage.bind(e)))(e)}receiveMessage(e){return n.flowRight(n.map(this.filters,e=>e.receiveMessage.bind(e)))(e)}receiveTrailers(e){return n.flowRight(n.map(this.filters,e=>e.receiveTrailers.bind(e)))(e)}}t.FilterStack=i;t.FilterStackFactory=class{constructor(e){this.factories=e}createFilter(e){return new i(n.map(this.factories,t=>t.createFilter(e)))}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=r(49),o=r(129);class s extends o.BaseFilter{receiveTrailers(e){return n(this,void 0,void 0,function*(){let{code:t,details:r,metadata:n}=yield e;if(t!==i.Status.UNKNOWN)return{code:t,details:r,metadata:n};const o=n.getMap();if("string"==typeof o["grpc-status"]){const e=Number(o["grpc-status"]);e in i.Status&&(t=e),n.remove("grpc-status")}return"string"==typeof o["grpc-message"]&&(r=decodeURI(o["grpc-message"]),n.remove("grpc-message")),{code:t,details:r,metadata:n}})}}t.MetadataStatusFilter=s;t.MetadataStatusFilterFactory=class{constructor(e){this.channel=e}createFilter(e){return new s}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12),i=r(169),{HTTP2_HEADER_AUTHORITY:o,HTTP2_HEADER_CONTENT_TYPE:s,HTTP2_HEADER_METHOD:a,HTTP2_HEADER_PATH:c,HTTP2_HEADER_TE:u,HTTP2_HEADER_USER_AGENT:l}=i.constants,h=~(1<<31),p=2e4;t.Http2SubChannel=class extends n.EventEmitter{constructor(e,t,r,n){super(),this.refCount=0,this.keepaliveTimeMs=h,this.keepaliveTimeoutMs=p,this.session=i.connect(e,t),this.session.on("connect",()=>{this.emit("connect")}),this.session.on("close",()=>{this.stopKeepalivePings(),this.emit("close")}),this.session.on("error",()=>{this.stopKeepalivePings(),this.emit("close")}),this.userAgent=r,n["grpc.keepalive_time_ms"]&&(this.keepaliveTimeMs=n["grpc.keepalive_time_ms"]),n["grpc.keepalive_timeout_ms"]&&(this.keepaliveTimeoutMs=n["grpc.keepalive_timeout_ms"]),this.keepaliveIntervalId=setTimeout(()=>{},0),clearTimeout(this.keepaliveIntervalId),this.keepaliveTimeoutId=setTimeout(()=>{},0),clearTimeout(this.keepaliveTimeoutId)}ref(){0===this.refCount&&(this.session.ref(),this.startKeepalivePings()),this.refCount+=1}unref(){this.refCount-=1,0===this.refCount&&(this.session.unref(),this.stopKeepalivePings())}sendPing(){this.keepaliveTimeoutId=setTimeout(()=>{this.emit("close")},this.keepaliveTimeoutMs),this.session.ping((e,t,r)=>{clearTimeout(this.keepaliveTimeoutId)})}startKeepalivePings(){this.keepaliveIntervalId=setInterval(()=>{this.sendPing()},this.keepaliveTimeMs),this.sendPing()}stopKeepalivePings(){clearInterval(this.keepaliveIntervalId),clearTimeout(this.keepaliveTimeoutId)}startCallStream(e,t){const r=e.toHttp2Headers();r[o]=t.getHost(),r[l]=this.userAgent,r[s]="application/grpc",r[a]="POST",r[c]=t.getMethod(),r[u]="trailers";const n=this.session.request(r);this.ref(),n.on("close",()=>{this.unref()}),t.attachHttp2Stream(n)}close(){this.session.close()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(49);let i=console,o=n.LogVerbosity.DEBUG;t.getLogger=(()=>i),t.setLogger=(e=>{i=e}),t.setLoggerVerbosity=(e=>{o=e}),t.log=((e,...t)=>{e>=o&&"function"==typeof i.error&&i.error(...t)})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(16),i=r(277),o={unary:i.Client.prototype.makeUnaryRequest,server_stream:i.Client.prototype.makeServerStreamRequest,client_stream:i.Client.prototype.makeClientStreamRequest,bidi:i.Client.prototype.makeBidiStreamRequest};function s(e,t,r){r||(r={});class s extends i.Client{}return n.each(e,(e,t)=>{let r;if(n.startsWith(t,"$"))throw new Error("Method names cannot start with $");r=e.requestStream?e.responseStream?"bidi":"client_stream":e.responseStream?"server_stream":"unary";const i=e.requestSerialize,a=e.responseDeserialize,c=n.partial(o[r],e.path,i,a);s.prototype[t]=c,n.assign(s.prototype[t],e),e.originalName&&(s.prototype[e.originalName]=s.prototype[t])}),s.service=e,s}t.makeClientConstructor=s,t.loadPackageDefinition=function(e){const t={};for(const r in e)if(e.hasOwnProperty(r)){const n=e[r],i=r.split("."),o=i[i.length-1];let a=t;for(const e of i.slice(0,-1))a[e]||(a[e]={}),a=a[e];a[o]=s(n,0,{})}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StatusBuilder=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){const e={};return null!==this.code&&(e.code=this.code),null!==this.details&&(e.details=this.details),null!==this.metadata&&(e.metadata=this.metadata),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(252),i=r(107),o=r(127),s=r(280),a=r(281),c=r(474);Object.assign(o,i),Object.assign(o,a),Object.assign(o,s),t.SERVICE_ADDRESS="longrunning.googleapis.com";const u=443,l="gapic/0.7.1",h={listOperations:new o.PageDescriptor("pageToken","nextPageToken","operations")};t.ALL_SCOPES=[];class p{constructor(e,r,n){n=Object.assign({servicePath:t.SERVICE_ADDRESS,port:u,clientConfig:{}},n);const i=["gl-node/"+process.versions.node];n.libName&&n.libVersion&&i.push(n.libName+"/"+n.libVersion),i.push(l,"gax/"+o.version,"grpc/"+e.grpcVersion);const s=e.constructSettings("google.longrunning.Operations",c,n.clientConfig,{"x-goog-api-client":i.join(" ")}),a=this;this.auth=e.auth;const p=e.createStub(r.google.longrunning.Operations,n);["getOperation","listOperations","cancelOperation","deleteOperation"].forEach(e=>{a["_"+e]=o.createApiCall(p.then(t=>(...r)=>t[e].apply(t,r)),s[e],h[e])})}getProjectId(e){return this.auth.getProjectId(e)}getOperation(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),void 0===t&&(t={}),this._getOperation(e,t,r)}listOperations(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),void 0===t&&(t={}),this._listOperations(e,t,r)}listOperationsStream(e,t){return void 0===t&&(t={}),h.listOperations.createStream(this._listOperations,e,t)}cancelOperation(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),void 0===t&&(t={}),this._cancelOperation(e,t,r)}deleteOperation(e,t,r){return t instanceof Function&&void 0===r&&(r=t,t={}),void 0===t&&(t={}),this._deleteOperation(e,t,r)}}t.OperationsClient=p;t.OperationsClientBuilder=class{constructor(e){const t=n.getProtoPath(".."),r=e.loadProto(t,"google/longrunning/operations.proto");Object.assign(this,r.google.longrunning),this.operationsClient=(t=>new p(e,r,t)),Object.assign(this.operationsClient,p)}}},function(e,t,r){"use strict";e.exports=function(e){var t;return t=void 0!==e.ended?e.ended:e._readableState.ended,Boolean(t).valueOf()}},function(e,t){var r="Expected a function",n="__lodash_hash_undefined__",i=1/0,o=9007199254740991,s="[object Arguments]",a="[object Function]",c="[object GeneratorFunction]",u="[object Symbol]",l=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,p=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,m=/^(?:0|[1-9]\d*)$/,y="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,b=y||v||Function("return this")();var _,E=Array.prototype,C=Function.prototype,w=Object.prototype,S=b["__core-js_shared__"],T=(_=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",A=C.toString,I=w.hasOwnProperty,N=w.toString,k=RegExp("^"+A.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=b.Symbol,O=w.propertyIsEnumerable,x=E.splice,B=H(b,"Map"),D=H(Object,"create"),P=R?R.prototype:void 0,L=P?P.toString:void 0;function j(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function U(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function M(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function F(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function V(e,t){return null!=e&&I.call(e,t)}function q(e){return!(!X(e)||(t=e,T&&T in t))&&($(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?k:g).test(function(e){if(null!=e){try{return A.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function K(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function H(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return q(r)?r:void 0}function G(e,t,r){for(var n,i,a=-1,c=(t=function(e,t){if(Q(e))return!1;var r=typeof e;if("number"==r||"symbol"==r||"boolean"==r||null==e||ee(e))return!0;return h.test(e)||!l.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:Q(n=t)?n:z(n)).length;++a<c;){var u=W(t[a]);if(!(i=null!=e&&r(e,u)))break;e=e[u]}return i||!!(c=e?e.length:0)&&J(c)&&function(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||m.test(e))&&e>-1&&e%1==0&&e<t}(u,c)&&(Q(e)||function(e){return function(e){return Z(e)&&function(e){return null!=e&&J(e.length)&&!$(e)}(e)}(e)&&I.call(e,"callee")&&(!O.call(e,"callee")||N.call(e)==s)}(e))}j.prototype.clear=function(){this.__data__=D?D(null):{}},j.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},j.prototype.get=function(e){var t=this.__data__;if(D){var r=t[e];return r===n?void 0:r}return I.call(t,e)?t[e]:void 0},j.prototype.has=function(e){var t=this.__data__;return D?void 0!==t[e]:I.call(t,e)},j.prototype.set=function(e,t){return this.__data__[e]=D&&void 0===t?n:t,this},U.prototype.clear=function(){this.__data__=[]},U.prototype.delete=function(e){var t=this.__data__,r=F(t,e);return!(r<0||(r==t.length-1?t.pop():x.call(t,r,1),0))},U.prototype.get=function(e){var t=this.__data__,r=F(t,e);return r<0?void 0:t[r][1]},U.prototype.has=function(e){return F(this.__data__,e)>-1},U.prototype.set=function(e,t){var r=this.__data__,n=F(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},M.prototype.clear=function(){this.__data__={hash:new j,map:new(B||U),string:new j}},M.prototype.delete=function(e){return K(this,e).delete(e)},M.prototype.get=function(e){return K(this,e).get(e)},M.prototype.has=function(e){return K(this,e).has(e)},M.prototype.set=function(e,t){return K(this,e).set(e,t),this};var z=Y(function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(ee(e))return L?L.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}(t);var r=[];return p.test(e)&&r.push(""),e.replace(f,function(e,t,n,i){r.push(n?i.replace(d,"$1"):t||e)}),r});function W(e){if("string"==typeof e||ee(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function Y(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(r);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s),s};return n.cache=new(Y.Cache||M),n}Y.Cache=M;var Q=Array.isArray;function $(e){var t=X(e)?N.call(e):"";return t==a||t==c}function J(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function X(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Z(e){return!!e&&"object"==typeof e}function ee(e){return"symbol"==typeof e||Z(e)&&N.call(e)==u}e.exports=function(e,t){return null!=e&&G(e,t,V)}},function(e,t,r){e.exports=(()=>{function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),{SyntaxError:e,parse:function(t){const n=arguments.length>1?arguments[1]:{},i={},o={template:V};let s=V;const a="/",c={type:"literal",value:"/",description:'"/"'},u=e=>e,l=(e,t)=>e.concat(t),h=e=>e,p="{",f={type:"literal",value:"{",description:'"{"'},d="=",g={type:"literal",value:"=",description:'"="'},m="}",y={type:"literal",value:"}",description:'"}"'},v=(e,t)=>[{kind:z.BINDING,literal:e},t,{kind:z.END_BINDING,literal:""}].reduce((e,t)=>e.concat(t),[]),b=e=>[{kind:z.BINDING,literal:e},{kind:z.TERMINAL,literal:"*"},{kind:z.END_BINDING,literal:""}],_=(e,t)=>e.concat(t),E=e=>"*"===e[0].literal||"**"===e[0].literal?[{kind:z.BINDING},e[0],{kind:z.END_BINDING,literal:""}]:e,C="**",w={type:"literal",value:"**",description:'"**"'},S="*",T={type:"literal",value:"*",description:'"*"'},A=e=>[{kind:z.TERMINAL,literal:e}],I=/^[^*=}{\/]/,N={type:"class",value:"[^*=}{/]",description:"[^*=}{/]"},k=e=>e.join("");let R=0,O=0;const x=[{line:1,column:1,seenCR:!1}];let B=0,D=[];const P=0;let L;if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');s=o[n.startRule]}function j(e){let r,n,i=x[e];if(i)return i;for(r=e-1;!x[r];)r--;for(i={line:(i=x[r]).line,column:i.column,seenCR:i.seenCR};r<e;)"\n"===(n=t.charAt(r))?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===n||"\u2028"===n||"\u2029"===n?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1),r++;return x[e]=i,i}function U(e,t){const r=j(e),n=j(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function M(e){R<B||(R>B&&(B=R,D=[]),D.push(e))}function F(t,r,n,i){return null!==r&&function(e){let t=1;for(e.sort((e,t)=>e.description<t.description?-1:e.description>t.description?1:0);t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(r),new e(null!==t?t:function(e,t){const r=new Array(e.length);let n,i,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return"Expected "+(n=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0])+" but "+(i=t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,e=>"\\x0"+t(e)).replace(/[\x10-\x1F\x80-\xFF]/g,e=>"\\x"+t(e)).replace(/[\u0100-\u0FFF]/g,e=>"\\u0"+t(e)).replace(/[\u1000-\uFFFF]/g,e=>"\\u"+t(e))}(t)+'"':"end of input")+" found."}(r,n),r,n,i)}function V(){let e,r,n;return e=R,47===t.charCodeAt(R)?(r=a,R++):(r=i,0===P&&M(c)),r!==i&&(n=q())!==i?(O=e,e=r=u(n)):(R=e,e=i),e===i&&(e=R,(r=q())!==i&&(O=e,r=u(r)),e=r),e}function q(){let e,r,n,o;return e=R,(r=K())!==i?(47===t.charCodeAt(R)?(n=a,R++):(n=i,0===P&&M(c)),n!==i&&(o=q())!==i?(O=e,e=r=l(r,o)):(R=e,e=i)):(R=e,e=i),e===i&&(e=K()),e}function K(){let e,r;return e=R,(r=function(){let e,t;return e=R,(t=H())!==i&&(O=e,t=E(t)),e=t}())===i&&(r=function(){let e,r,n,o,s,u;return e=R,123===t.charCodeAt(R)?(r=p,R++):(r=i,0===P&&M(f)),r!==i&&(n=G())!==i?(61===t.charCodeAt(R)?(o=d,R++):(o=i,0===P&&M(g)),o!==i&&(s=function e(){let r,n,o,s;return r=R,(n=H())!==i?(47===t.charCodeAt(R)?(o=a,R++):(o=i,0===P&&M(c)),o!==i&&(s=e())!==i?(O=r,n=_(n,s),r=n):(R=r,r=i)):(R=r,r=i),r===i&&(r=H()),r}())!==i?(125===t.charCodeAt(R)?(u=m,R++):(u=i,0===P&&M(y)),u!==i?(O=e,r=v(n,s),e=r):(R=e,e=i)):(R=e,e=i)):(R=e,e=i),e===i&&(e=R,123===t.charCodeAt(R)?(r=p,R++):(r=i,0===P&&M(f)),r!==i&&(n=G())!==i?(125===t.charCodeAt(R)?(o=m,R++):(o=i,0===P&&M(y)),o!==i?(O=e,r=b(n),e=r):(R=e,e=i)):(R=e,e=i)),e}()),r!==i&&(O=e,r=h(r)),e=r}function H(){let e,r;return e=R,t.substr(R,2)===C?(r=C,R+=2):(r=i,0===P&&M(w)),r===i&&(42===t.charCodeAt(R)?(r=S,R++):(r=i,0===P&&M(T)),r===i&&(r=G())),r!==i&&(O=e,r=A(r)),e=r}function G(){let e,r,n;if(e=R,r=[],I.test(t.charAt(R))?(n=t.charAt(R),R++):(n=i,0===P&&M(N)),n!==i)for(;n!==i;)r.push(n),I.test(t.charAt(R))?(n=t.charAt(R),R++):(n=i,0===P&&M(N));else r=i;return r!==i&&(O=e,r=k(r)),e=r}const z=r(282);if((L=s())!==i&&R===t.length)return L;throw L!==i&&R<t.length&&M({type:"end",description:"end of input"}),F(null,D,B<t.length?t.charAt(B):null,B<t.length?U(B,B+1):U(B,B))}}})()},function(e){e.exports={interfaces:{"google.longrunning.Operations":{retry_codes:{idempotent:["DEADLINE_EXCEEDED","UNAVAILABLE"],non_idempotent:[]},retry_params:{default:{initial_retry_delay_millis:100,retry_delay_multiplier:1.3,max_retry_delay_millis:6e4,initial_rpc_timeout_millis:9e4,rpc_timeout_multiplier:1,max_rpc_timeout_millis:9e4,total_timeout_millis:6e5}},methods:{GetOperation:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},ListOperations:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},CancelOperation:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"},DeleteOperation:{timeout_millis:6e4,retry_codes_name:"idempotent",retry_params_name:"default"}}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromParams=function(e){return Object.keys(e).map(t=>`${t}=${e[t]}`).join("&")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(477),i=r(107);function o(){}function s(e,t){const r=[];let i=!1;for(let o=0;o<t.length;++o){const s=n(e,t[o])[0];void 0===s?r.push(null):(i=!0,r.push(s))}if(i)return JSON.stringify(r)}function a(e,t){let r;return null===e?null:void 0!==e?Array.isArray(e)?(r=[],e.forEach(e=>{r.push(a(e,null))}),r):void 0!==e.copy?e.copy():e instanceof ArrayBuffer?e.slice(0):"object"==typeof e?(r={},Object.keys(e).forEach(n=>{t&&n===t.field&&Array.isArray(e[n])?r[n]=e[n].slice(t.start,t.end):r[n]=a(e[n],null)}),r):e:void 0}t.computeBundleId=s,t.deepCopyForResponse=a;class c{constructor(e,t,r,n){this._apiCall=e,this._request=t,this._bundledField=r,this._subresponseField=n,this._data=[]}getElementCount(){let e=0;for(let t=0;t<this._data.length;++t)e+=this._data[t].elements.length;return e}getRequestByteSize(){let e=0;for(let t=0;t<this._data.length;++t)e+=this._data[t].bytes;return e}run(){if(0===this._data.length)return[];const e=this._request,t=[],r=[];for(let e=0;e<this._data.length;++e)t.push.apply(t,this._data[e].elements),r.push(this._data[e].callback.id);e[this._bundledField]=t;const n=this;return this.callCanceller=this._apiCall(e,(e,t)=>{const r=[];if(e)n._data.forEach(()=>{r.push(null)});else{let e=null;n._subresponseField&&(e={field:n._subresponseField,start:0}),n._data.forEach(n=>{e&&(e.end=e.start+n.elements.length),r.push(a(t,e)),e&&(e.start=e.end)})}for(let t=0;t<n._data.length;++t)n._data[t].cancelled?n._data[t].callback(new Error("cancelled")):n._data[t].callback(e,r[t])}),r}extend(e,t,r){this._data.push({elements:e,bytes:t,callback:r})}cancel(e){if(this.callCanceller){let t=!0;return this._data.forEach(r=>{r.callback.id===e&&(r.cancelled=!0),r.cancelled||(t=!1)}),t&&this.callCanceller.cancel(),t}for(let t=0;t<this._data.length;++t)if(this._data[t].callback.id===e){this._data[t].callback(new Error("cancelled")),this._data.splice(t,1);break}return 0===this._data.length}}t.Task=c;class u{constructor(e,t){this._options=e,this._descriptor=t,this._tasks={},this._timers={},this._invocations={},this._invocationId=0}schedule(e,t,r){const n=s(t,this._descriptor.requestDiscriminatorFields);if(r=r||o,void 0===n)return console.warn("The request does not have enough information for request bundling. Invoking immediately. Request: "+JSON.stringify(t)+" discriminator fields: "+this._descriptor.requestDiscriminatorFields),e(t,r);n in this._tasks||(this._tasks[n]=new c(e,t,this._descriptor.bundledField,this._descriptor.subresponseField));let i=this._tasks[n];r.id=String(this._invocationId++),this._invocations[r.id]=n;const a=t[this._descriptor.bundledField],u=a.length;let l=0;const h=this;a.forEach(e=>{l+=this._descriptor.byteLengthFunction(e)});const p=this._options.elementCountLimit||0,f=this._options.requestByteLimit||0;if(p>0&&u>=p||f>0&&l>=f){let e;return e=p>0&&u>=p?"The number of elements "+u+" exceeds the limit "+this._options.elementCountLimit:"The required bytes "+l+" exceeds the limit "+this._options.requestByteLimit,r(new Error(e)),{cancel:o}}const d=i.getElementCount(),g=i.getRequestByteSize();(p>0&&u+d>=p||f>0&&l+g>=f)&&(this._runNow(n),this._tasks[n]=new c(e,t,this._descriptor.bundledField,this._descriptor.subresponseField),i=this._tasks[n]),i.extend(a,l,r);const m={cancel(){h._cancel(r.id)}},y=this._options.elementCountThreshold||0,v=this._options.requestByteThreshold||0;return y>0&&i.getElementCount()>=y||v>0&&i.getRequestByteSize()>=v?(this._runNow(n),m):(!(n in this._timers)&&this._options.delayThreshold>0&&(this._timers[n]=setTimeout(()=>{delete this._timers[n],this._runNow(n)},this._options.delayThreshold)),m)}_maybeClearTimeout(e){if(e in this._timers){const t=this._timers[e];delete this._timers[e],clearTimeout(t)}}_cancel(e){if(!(e in this._invocations))return;const t=this._invocations[e];if(!(t in this._tasks))return;const r=this._tasks[t];delete this._invocations[e],r.cancel(e)&&(this._maybeClearTimeout(t),delete this._tasks[t])}_runNow(e){if(!(e in this._tasks))return void console.warn("no such bundleid: "+e);this._maybeClearTimeout(e);const t=this._tasks[e];delete this._tasks[e],t.run().forEach(e=>{delete this._invocations[e]})}}t.BundleExecutor=u;class l extends i.NormalApiCaller{constructor(e){super(),this.bundler=e}call(e,t,r,n){r.isBundling?n.call((t,r)=>{this.bundler.schedule(e,t,r)},t):i.NormalApiCaller.prototype.call.call(this,e,t,r,n)}}t.Bundleable=l;t.BundleDescriptor=class{constructor(e,t,r,n){n||"function"!=typeof r||(n=r,r=null),this.bundledField=e,this.requestDiscriminatorFields=t,this.subresponseField=r,this.byteLengthFunction=n}apiCaller(e){return new l(new u(e.bundleOptions,this))}}},function(e,t){var r="Expected a function",n="__lodash_hash_undefined__",i=1/0,o=9007199254740991,s="[object Arguments]",a="[object Function]",c="[object GeneratorFunction]",u="[object Symbol]",l=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,p=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,m="object"==typeof global&&global&&global.Object===Object&&global,y="object"==typeof self&&self&&self.Object===Object&&self,v=m||y||Function("return this")();function b(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var _,E=Array.prototype,C=Function.prototype,w=Object.prototype,S=v["__core-js_shared__"],T=(_=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",A=C.toString,I=w.hasOwnProperty,N=w.toString,k=RegExp("^"+A.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=v.Symbol,O=w.propertyIsEnumerable,x=E.splice,B=R?R.isConcatSpreadable:void 0,D=Math.max,P=z(v,"Map"),L=z(Object,"create"),j=R?R.prototype:void 0,U=j?j.toString:void 0;function M(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function F(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function V(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function q(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function K(e,t){for(var r,n=0,i=(t=function(e,t){if(J(e))return!1;var r=typeof e;if("number"==r||"symbol"==r||"boolean"==r||null==e||te(e))return!0;return h.test(e)||!l.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:J(r=t)?r:Y(r)).length;null!=e&&n<i;)e=e[Q(t[n++])];return n&&n==i?e:void 0}function H(e){return!(!Z(e)||(t=e,T&&T in t))&&(X(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?k:g).test(function(e){if(null!=e){try{return A.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function G(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function z(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return H(r)?r:void 0}function W(e){return J(e)||function(e){return function(e){return ee(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!X(e)}(e)}(e)&&I.call(e,"callee")&&(!O.call(e,"callee")||N.call(e)==s)}(e)||!!(B&&e&&e[B])}M.prototype.clear=function(){this.__data__=L?L(null):{}},M.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},M.prototype.get=function(e){var t=this.__data__;if(L){var r=t[e];return r===n?void 0:r}return I.call(t,e)?t[e]:void 0},M.prototype.has=function(e){var t=this.__data__;return L?void 0!==t[e]:I.call(t,e)},M.prototype.set=function(e,t){return this.__data__[e]=L&&void 0===t?n:t,this},F.prototype.clear=function(){this.__data__=[]},F.prototype.delete=function(e){var t=this.__data__,r=q(t,e);return!(r<0||(r==t.length-1?t.pop():x.call(t,r,1),0))},F.prototype.get=function(e){var t=this.__data__,r=q(t,e);return r<0?void 0:t[r][1]},F.prototype.has=function(e){return q(this.__data__,e)>-1},F.prototype.set=function(e,t){var r=this.__data__,n=q(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},V.prototype.clear=function(){this.__data__={hash:new M,map:new(P||F),string:new M}},V.prototype.delete=function(e){return G(this,e).delete(e)},V.prototype.get=function(e){return G(this,e).get(e)},V.prototype.has=function(e){return G(this,e).has(e)},V.prototype.set=function(e,t){return G(this,e).set(e,t),this};var Y=$(function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(te(e))return U?U.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}(t);var r=[];return p.test(e)&&r.push(""),e.replace(f,function(e,t,n,i){r.push(n?i.replace(d,"$1"):t||e)}),r});function Q(e){if("string"==typeof e||te(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function $(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(r);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s),s};return n.cache=new($.Cache||V),n}$.Cache=V;var J=Array.isArray;function X(e){var t=Z(e)?N.call(e):"";return t==a||t==c}function Z(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ee(e){return!!e&&"object"==typeof e}function te(e){return"symbol"==typeof e||ee(e)&&N.call(e)==u}var re,ne,ie=(re=function(e,t){return function(e,t){for(var r=-1,n=null==e,i=t.length,o=Array(i);++r<i;)o[r]=n?void 0:oe(e,t[r]);return o}(e,function e(t,r,n,i,o){var s=-1,a=t.length;for(n||(n=W),o||(o=[]);++s<a;){var c=t[s];r>0&&n(c)?r>1?e(c,r-1,n,i,o):b(o,c):i||(o[o.length]=c)}return o}(t,1))},ne=D(void 0===ne?re.length-1:ne,0),function(){for(var e=arguments,t=-1,r=D(e.length-ne,0),n=Array(r);++t<r;)n[t]=e[ne+t];t=-1;for(var i=Array(ne+1);++t<ne;)i[t]=e[t];return i[ne]=n,function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(re,this,i)});function oe(e,t,r){var n=null==e?void 0:K(e,t);return void 0===n?r:n}e.exports=ie},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12),i=r(107),o=r(127),s=r(283);t.LongrunningDescriptor=class{constructor(e,t,r){this.operationsClient=e,this.responseDecoder=t,this.metadataDecoder=r}apiCaller(){return new a(this)}};class a extends i.NormalApiCaller{constructor(e){super(),this.longrunningDescriptor=e}call(e,t,r,n){n.call((t,n)=>this._wrapOperation(e,r,t,n),t)}_wrapOperation(e,t,r,n){let i=t.longrunning;i||(i=o.createBackoffSettings(100,1.3,6e4,null,null,null,null));const s=this.longrunningDescriptor;return e(r,(e,r)=>{if(e)return void n(e,null,r);const o=new c(r,s,i,t);n(null,o,r)})}}t.LongrunningApiCaller=a;class c extends n.EventEmitter{constructor(e,t,r,n){super(),this.completeListeners=0,this.hasActiveListeners=!1,this.latestResponse=e,this.longrunningDescriptor=t,this.result=null,this.metadata=null,this.backoffSettings=r,this._unpackResponse(e),this._listenForEvents(),this._callOptions=n}_listenForEvents(){this.on("newListener",e=>{"complete"===e&&(this.completeListeners++,this.hasActiveListeners||(this.hasActiveListeners=!0,this.startPolling_()))}),this.on("removeListener",e=>{"complete"===e&&0==--this.completeListeners&&(this.hasActiveListeners=!1)})}cancel(){return this.currentCallPromise_&&this.currentCallPromise_.cancel(),this.longrunningDescriptor.operationsClient.cancelOperation({name:this.latestResponse.name})}getOperation(e){const t=this,r=this.longrunningDescriptor.operationsClient;function n(){if(!e){return new(0,t._callOptions.promise)((e,r)=>{if(t.latestResponse.error){const e=new s.GoogleError(t.latestResponse.error.message);e.code=t.latestResponse.error.code,r(e)}else e([t.result,t.metadata,t.latestResponse])})}}if(this.latestResponse.done)return this._unpackResponse(this.latestResponse,e),n();this.currentCallPromise_=r.getOperation({name:this.latestResponse.name},this._callOptions);const i=this.currentCallPromise_.then(r=>(t.latestResponse=r[0],t._unpackResponse(r[0],e),n()));return e?void 0:i}_unpackResponse(e,t){const r=this.longrunningDescriptor.responseDecoder,n=this.longrunningDescriptor.metadataDecoder;let i,o;if(e.done){if("error"===e.result){const r=new s.GoogleError(e.error.message);return r.code=e.error.code,void(t&&t(r))}r&&e.response&&(i=r(e.response.value),this.result=i)}n&&e.metadata&&(o=n(e.metadata.value),this.metadata=o),t&&t(null,i,o,e)}startPolling_(){const e=this;let t=new Date;const r=this.backoffSettings.retryDelayMultiplier,n=this.backoffSettings.maxRetryDelayMillis;let i,o=this.backoffSettings.initialRetryDelayMillis,s=1/0;function a(){e.emit.apply(e,Array.prototype.slice.call(arguments,0))}this.backoffSettings.totalTimeoutMillis&&(s=t.getTime()+this.backoffSettings.totalTimeoutMillis),this.latestResponse.metadata&&(i=this.latestResponse.metadata.value),function c(){e.hasActiveListeners&&(t.getTime()>=s?setImmediate(a,"error",new Error("Total timeout exceeded before any response was received")):e.getOperation((e,s,u,l)=>{if(!e)return s?void setImmediate(a,"complete",s,u,l):(!l.metadata||i&&l.metadata.value.equals(i)||(setImmediate(a,"progress",u,l),i=l.metadata.value),void setTimeout(()=>{t=new Date,o=Math.min(o*r,n),c()},o));setImmediate(a,"error",e)}))}()}promise(){const e=this;return new(0,this._callOptions.promise)((t,r)=>{e.on("error",r).on("complete",(e,r,n)=>{t([e,r,n])})})}}t.Operation=c,t.operation=function(e,t,r,n){return new c(e,t,r,n)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(480),i=r(485);var o;!function(e){e[e.SERVER_STREAMING=1]="SERVER_STREAMING",e[e.CLIENT_STREAMING=2]="CLIENT_STREAMING",e[e.BIDI_STREAMING=3]="BIDI_STREAMING"}(o=t.StreamType||(t.StreamType={}));class s extends n{constructor(e,t){super(void 0,void 0,{objectMode:!0,readable:e!==o.CLIENT_STREAMING,writable:e!==o.SERVER_STREAMING}),this.type=e,this._callback=t,this._isCancelCalled=!1}cancel(){this.stream?this.stream.cancel():this._isCancelCalled=!0}forwardEvents(e){["metadata","response","status"].forEach(t=>{e.on(t,this.emit.bind(this,t))}),e.on("metadata",t=>{e.emit("response",{code:200,details:"",message:"OK",metadata:t})})}setStream(e,t){if(this.type===o.SERVER_STREAMING){const r=i(null,{objectMode:!0,request:()=>{if(this._isCancelCalled)return void(this.stream&&this.stream.cancel());const r=e(t,this._callback);return this.stream=r,this.forwardEvents(r),r}});return void this.setReadable(r)}const r=e(t,this._callback);this.stream=r,this.forwardEvents(r),this.type===o.CLIENT_STREAMING&&this.setWritable(r),this.type===o.BIDI_STREAMING&&(this.setReadable(r),this.setWritable(r)),this._isCancelCalled&&this.stream&&this.stream.cancel()}}t.StreamProxy=s;class a{constructor(e){this.descriptor=e}init(e,t){return new s(this.descriptor.type,t)}wrap(e){switch(this.descriptor.type){case o.SERVER_STREAMING:return(t,r,n)=>e(t,r,n);case o.CLIENT_STREAMING:return(t,r,n,i)=>e(r,n,i);case o.BIDI_STREAMING:return(t,r,n)=>e(r,n);default:console.error("Unknown stream type",this.descriptor.type)}return e}call(e,t,r,n){n.setStream(e,t)}fail(e,t){e.emit("error",t)}result(e){return e}}t.GrpcStreamable=a;t.StreamDescriptor=class{constructor(e){this.type=e}apiCaller(e){return e.retry=null,new a(this)}}},function(e,t,r){var n=r(139),i=r(481),o=r(19),s=r(484),a=Buffer.from&&Buffer.from!==Uint8Array.from?Buffer.from([0]):new Buffer([0]),c=function(e,t){e._corked?e.once("uncork",t):t()},u=function(e,t){return function(r){r?function(e,t){e._autoDestroy&&e.destroy(t)}(e,"premature close"===r.message?null:r):t&&!e._ended&&e.end()}},l=function(e,t,r){if(!(this instanceof l))return new l(e,t,r);n.Duplex.call(this,r),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!r||!1!==r.autoDestroy,this._forwardDestroy=!r||!1!==r.destroy,this._forwardEnd=!r||!1!==r.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)};o(l,n.Duplex),l.obj=function(e,t,r){return r||(r={}),r.objectMode=!0,r.highWaterMark=16,new l(e,t,r)},l.prototype.cork=function(){1==++this._corked&&this.emit("cork")},l.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},l.prototype.setWritable=function(e){if(this._unwrite&&this._unwrite(),this.destroyed)e&&e.destroy&&e.destroy();else if(null!==e&&!1!==e){var t=this,r=i(e,{writable:!0,readable:!1},u(this,this._forwardEnd)),n=function(){var e=t._ondrain;t._ondrain=null,e&&e()};this._unwrite&&process.nextTick(n),this._writable=e,this._writable.on("drain",n),this._unwrite=function(){t._writable.removeListener("drain",n),r()},this.uncork()}else this.end()},l.prototype.setReadable=function(e){if(this._unread&&this._unread(),this.destroyed)e&&e.destroy&&e.destroy();else{if(null===e||!1===e)return this.push(null),void this.resume();var t,r=this,o=i(e,{writable:!1,readable:!0},u(this)),s=function(){r._forward()},a=function(){r.push(null)};this._drained=!0,this._readable=e,this._readable2=e._readableState?e:(t=e,new n.Readable({objectMode:!0,highWaterMark:16}).wrap(t)),this._readable2.on("readable",s),this._readable2.on("end",a),this._unread=function(){r._readable2.removeListener("readable",s),r._readable2.removeListener("end",a),o()},this._forward()}},l.prototype._read=function(){this._drained=!0,this._forward()},l.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var e;for(this._forwarding=!0;this._drained&&null!==(e=s(this._readable2));)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}},l.prototype.destroy=function(e){if(!this.destroyed){this.destroyed=!0;var t=this;process.nextTick(function(){t._destroy(e)})}},l.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null,t?t(e):this.emit("error",e)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},l.prototype._write=function(e,t,r){return this.destroyed?r():this._corked?c(this,this._write.bind(this,e,t,r)):e===a?this._finish(r):this._writable?void(!1===this._writable.write(e)?this._ondrain=r:r()):r()},l.prototype._finish=function(e){var t=this;this.emit("preend"),c(this,function(){var r,n;r=t._forwardEnd&&t._writable,n=function(){!1===t._writableState.prefinished&&(t._writableState.prefinished=!0),t.emit("prefinish"),c(t,e)},r?r._writableState&&r._writableState.finished?n():r._writableState?r.end(n):(r.end(),n()):n()})},l.prototype.end=function(e,t,r){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this.write(a),n.Writable.prototype.end.call(this,r))},e.exports=l},function(e,t,r){var n=r(482),i=function(){},o=function(e,t,r){if("function"==typeof t)return o(e,null,t);t||(t={}),r=n(r||i);var s=e._writableState,a=e._readableState,c=t.readable||!1!==t.readable&&e.readable,u=t.writable||!1!==t.writable&&e.writable,l=function(){e.writable||h()},h=function(){u=!1,c||r.call(e)},p=function(){c=!1,u||r.call(e)},f=function(t){r.call(e,t?new Error("exited with error code: "+t):null)},d=function(t){r.call(e,t)},g=function(){return(!c||a&&a.ended)&&(!u||s&&s.ended)?void 0:r.call(e,new Error("premature close"))},m=function(){e.req.on("finish",h)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?u&&!s&&(e.on("end",l),e.on("close",l)):(e.on("complete",h),e.on("abort",g),e.req?m():e.on("request",m)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",f),e.on("end",p),e.on("finish",h),!1!==t.error&&e.on("error",d),e.on("close",g),function(){e.removeListener("complete",h),e.removeListener("abort",g),e.removeListener("request",m),e.req&&e.req.removeListener("finish",h),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",h),e.removeListener("exit",f),e.removeListener("end",p),e.removeListener("error",d),e.removeListener("close",g)}};e.exports=o},function(e,t,r){var n=r(483);function i(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function o(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}e.exports=n(i),e.exports.strict=n(o),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(e,t){e.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");Object.keys(t).forEach(function(e){n[e]=t[e]});return n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(e){n[e]=i[e]}),n}}},function(e,t){e.exports=function(e){var t=e._readableState;return t?t.objectMode?e.read():e.read((r=t,r.buffer.length?r.buffer.head?r.buffer.head.data.length:r.buffer[0].length:r.length)):null;var r}},function(e,t,r){"use strict";var n=r(486),i={objectMode:!1,retries:2,noResponseRetries:2,currentRetryAttempt:0,shouldRetryFn:function(e){for(var t,r=[[100,199],[429,429],[500,599]],n=e.statusCode;t=r.shift();)if(n>=t[0]&&n<=t[1])return!0}};function o(e){return 1e3*Math.pow(2,e)+Math.floor(1e3*Math.random())}e.exports=function(e,t,s){var a="function"!=typeof arguments[arguments.length-1];if("function"==typeof t&&(s=t),void 0===(t=t||i).objectMode&&(t.objectMode=i.objectMode),void 0===t.request)try{t.request=r(!function(){var e=new Error("Cannot find module 'request'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){throw new Error("A request library must be provided to retry-request.")}"number"!=typeof t.retries&&(t.retries=i.retries),"number"!=typeof t.currentRetryAttempt&&(t.currentRetryAttempt=i.currentRetryAttempt),"number"!=typeof t.noResponseRetries&&(t.noResponseRetries=i.noResponseRetries),"function"!=typeof t.shouldRetryFn&&(t.shouldRetryFn=i.shouldRetryFn);var c,u,l,h,p=t.currentRetryAttempt,f=0,d=!1,g={abort:function(){h&&h.abort&&h.abort()}};return a&&((c=n({objectMode:t.objectMode})).abort=m),p>0?v(p):y(),a?c:g;function m(){l=null,u&&(u.abort&&u.abort(),u.cancel&&u.cancel(),u.destroy?u.destroy():u.end&&u.end())}function y(){p++,a?(d=!1,l=n({objectMode:t.objectMode}),u=t.request(e),setImmediate(function(){c.emit("request")}),u.on("error",function(e){d||(d=!0,b(e))}).on("response",function(e,t){d||(d=!0,b(null,e,t))}).on("complete",c.emit.bind(c,"complete")),u.pipe(l)):h=t.request(e,b)}function v(e){a&&m(),setTimeout(y,o(e))}function b(e,r,n){e?++f<=t.noResponseRetries?v(f):a?(c.emit("error",e),c.end()):s(e,r,n):p<=t.retries&&t.shouldRetryFn(r)?v(p):a?(c.emit("response",r),l.pipe(c),u.on("error",function(e){c.destroy(e)})):s(e,r,n)}},e.exports.getNextRetryDelay=o},function(e,t,r){var n=r(139).Transform,i=r(4).inherits,o=r(114);function s(e){n.call(this,e),this._destroyed=!1}function a(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=a),"function"!=typeof n&&(n=null),e(t,r,n)}}i(s,n),s.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;process.nextTick(function(){e&&t.emit("error",e),t.emit("close")})}},e.exports=c(function(e,t,r){var n=new s(e);return n._transform=t,r&&(n._flush=r),n}),e.exports.ctor=c(function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=o(e,t),s.call(this,this.options)}return i(n,s),n.prototype._transform=t,r&&(n.prototype._flush=r),n}),e.exports.obj=c(function(e,t,r){var n=new s(o({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n})},function(e){e.exports={_from:"google-gax@^0.22.0",_id:"google-gax@0.22.1",_inBundle:!1,_integrity:"sha512-QLvRQ00f5eLmkVm9c8JwqDSwQ6yEJXdtwCu+Xvk2EMpzzaTPZxgX+TtU1Ljg7AHJclpxChJpNYrCw10aB1IJlQ==",_location:"/google-gax",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"google-gax@^0.22.0",name:"google-gax",escapedName:"google-gax",rawSpec:"^0.22.0",saveSpec:null,fetchSpec:"^0.22.0"},_requiredBy:["/@google-cloud/firestore"],_resolved:"https://registry.npmjs.org/google-gax/-/google-gax-0.22.1.tgz",_shasum:"62a8109648a17027d64b3c3346d74fd9c0029333",_spec:"google-gax@^0.22.0",_where:"D:\\Projects\\webhooks\\node_modules\\@google-cloud\\firestore",author:{name:"Google API Authors"},bugs:{url:"https://github.com/googleapis/gax-nodejs/issues"},bundleDependencies:!1,dependencies:{"@grpc/grpc-js":"^0.3.0","@grpc/proto-loader":"^0.3.0",duplexify:"^3.6.0","google-auth-library":"^2.0.0","google-proto-files":"^0.18.0",grpc:"^1.16.0","is-stream-ended":"^0.1.4","lodash.at":"^4.6.0","lodash.has":"^4.5.2",protobufjs:"^6.8.8","retry-request":"^4.0.0",semver:"^5.5.1",walkdir:"0.0.12"},deprecated:!1,description:"Google API Extensions",devDependencies:{"@types/chai":"^4.1.3","@types/duplexify":"^3.5.0","@types/lodash.at":"^4.6.4","@types/lodash.has":"^4.5.4","@types/mocha":"^5.2.1","@types/node":"^10.3.2","@types/proxyquire":"^1.3.28","@types/pumpify":"^1.4.1","@types/rimraf":"^2.0.2","@types/semver":"^5.5.0","@types/sinon":"^5.0.1","@types/source-map-support":"^0.4.1","@types/through2":"^2.0.33",chai:"*",codecov:"^3.1.0",gts:"^0.8.0","ink-docstrap":"^1.3.2","intelli-espower-loader":"^1.0.1",istanbul:"~0.4.5",jsdoc:"^3.5.5",mocha:"~5.2.0",nyc:"^13.1.0",pegjs:"~0.10.0",proxyquire:"^2.0.1",pumpify:"^1.5.1",rimraf:"^2.6.2",sinon:"^7.0.0","source-map-support":"^0.5.6","stream-events":"^1.0.4",through2:"^3.0.0",typescript:"~3.1.5"},engines:{node:">=6.0.0"},files:["build/src"],homepage:"https://github.com/googleapis/gax-nodejs#readme",keywords:["grpc"],license:"BSD-3-Clause",main:"build/src/index.js",name:"google-gax",nyc:{exclude:["build/system-test/**","system-test-run/**"]},repository:{type:"git",url:"git+https://github.com/googleapis/gax-nodejs.git"},scripts:{clean:"gts clean",codecov:"nyc mocha build/test --reporter spec --slow 500 && codecov",compile:"tsc -p . && cp src/*.json build/src && cp src/*.js build/src",docs:"echo no docs ",fix:"gts fix","gen-parser":"pegjs lib/path_template_parser.pegjs",lint:"gts check",posttest:"npm run lint",prepare:"npm run compile","pretest-only":"npm run compile","publish-gh-pages":"bash ./publish-gh-pages.sh","samples-test":"echo no sample tests ","system-test":"nyc mocha --timeout 1200000 build/system-test",test:"npm run test-only","test-only":"nyc mocha build/test --reporter spec --slow 500"},types:"build/src/index.d.ts",version:"0.22.1"}},function(e,t,r){(function(e){var r=200,n="__lodash_hash_undefined__",i=800,o=16,s=9007199254740991,a="[object Arguments]",c="[object AsyncFunction]",u="[object Function]",l="[object GeneratorFunction]",h="[object Null]",p="[object Object]",f="[object Proxy]",d="[object Undefined]",g=/^\[object .+?Constructor\]$/,m=/^(?:0|[1-9]\d*)$/,y={};y["[object Float32Array]"]=y["[object Float64Array]"]=y["[object Int8Array]"]=y["[object Int16Array]"]=y["[object Int32Array]"]=y["[object Uint8Array]"]=y["[object Uint8ClampedArray]"]=y["[object Uint16Array]"]=y["[object Uint32Array]"]=!0,y[a]=y["[object Array]"]=y["[object ArrayBuffer]"]=y["[object Boolean]"]=y["[object DataView]"]=y["[object Date]"]=y["[object Error]"]=y[u]=y["[object Map]"]=y["[object Number]"]=y[p]=y["[object RegExp]"]=y["[object Set]"]=y["[object String]"]=y["[object WeakMap]"]=!1;var v="object"==typeof global&&global&&global.Object===Object&&global,b="object"==typeof self&&self&&self.Object===Object&&self,_=v||b||Function("return this")(),E=t&&!t.nodeType&&t,C=E&&"object"==typeof e&&e&&!e.nodeType&&e,w=C&&C.exports===E,S=w&&v.process,T=function(){try{return S&&S.binding&&S.binding("util")}catch(e){}}(),A=T&&T.isTypedArray;function I(e,t){return"__proto__"==t?void 0:e[t]}var N,k,R,O=Array.prototype,x=Function.prototype,B=Object.prototype,D=_["__core-js_shared__"],P=x.toString,L=B.hasOwnProperty,j=(N=/[^.]+$/.exec(D&&D.keys&&D.keys.IE_PROTO||""))?"Symbol(src)_1."+N:"",U=B.toString,M=P.call(Object),F=RegExp("^"+P.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=w?_.Buffer:void 0,q=_.Symbol,K=_.Uint8Array,H=V?V.allocUnsafe:void 0,G=(k=Object.getPrototypeOf,R=Object,function(e){return k(R(e))}),z=Object.create,W=B.propertyIsEnumerable,Y=O.splice,Q=q?q.toStringTag:void 0,$=function(){try{var e=Ee(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),J=V?V.isBuffer:void 0,X=Math.max,Z=Date.now,ee=Ee(_,"Map"),te=Ee(Object,"create"),re=function(){function e(){}return function(t){if(!xe(t))return{};if(z)return z(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function ne(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function se(e){var t=this.__data__=new ie(e);this.size=t.size}function ae(e,t){var r=Ie(e),n=!r&&Ae(e),i=!r&&!n&&ke(e),o=!r&&!n&&!i&&De(e),s=r||n||i||o,a=s?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=a.length;for(var u in e)!t&&!L.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ce(u,c))||a.push(u);return a}function ce(e,t,r){(void 0===r||Te(e[t],r))&&(void 0!==r||t in e)||he(e,t,r)}function ue(e,t,r){var n=e[t];L.call(e,t)&&Te(n,r)&&(void 0!==r||t in e)||he(e,t,r)}function le(e,t){for(var r=e.length;r--;)if(Te(e[r][0],t))return r;return-1}function he(e,t,r){"__proto__"==t&&$?$(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}ne.prototype.clear=function(){this.__data__=te?te(null):{},this.size=0},ne.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ne.prototype.get=function(e){var t=this.__data__;if(te){var r=t[e];return r===n?void 0:r}return L.call(t,e)?t[e]:void 0},ne.prototype.has=function(e){var t=this.__data__;return te?void 0!==t[e]:L.call(t,e)},ne.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=te&&void 0===t?n:t,this},ie.prototype.clear=function(){this.__data__=[],this.size=0},ie.prototype.delete=function(e){var t=this.__data__,r=le(t,e);return!(r<0||(r==t.length-1?t.pop():Y.call(t,r,1),--this.size,0))},ie.prototype.get=function(e){var t=this.__data__,r=le(t,e);return r<0?void 0:t[r][1]},ie.prototype.has=function(e){return le(this.__data__,e)>-1},ie.prototype.set=function(e,t){var r=this.__data__,n=le(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},oe.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(ee||ie),string:new ne}},oe.prototype.delete=function(e){var t=_e(this,e).delete(e);return this.size-=t?1:0,t},oe.prototype.get=function(e){return _e(this,e).get(e)},oe.prototype.has=function(e){return _e(this,e).has(e)},oe.prototype.set=function(e,t){var r=_e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},se.prototype.clear=function(){this.__data__=new ie,this.size=0},se.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ie){var i=n.__data__;if(!ee||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new oe(i)}return n.set(e,t),this.size=n.size,this};var pe,fe=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[pe?s:++n];if(!1===t(i[a],a,i))break}return e};function de(e){return null==e?void 0===e?d:h:Q&&Q in Object(e)?function(e){var t=L.call(e,Q),r=e[Q];try{e[Q]=void 0;var n=!0}catch(e){}var i=U.call(e);n&&(t?e[Q]=r:delete e[Q]);return i}(e):function(e){return U.call(e)}(e)}function ge(e){return Be(e)&&de(e)==a}function me(e){return!(!xe(e)||(t=e,j&&j in t))&&(Re(e)?F:g).test(function(e){if(null!=e){try{return P.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function ye(e){if(!xe(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=we(e),r=[];for(var n in e)("constructor"!=n||!t&&L.call(e,n))&&r.push(n);return r}function ve(e,t,r,n,i){e!==t&&fe(t,function(o,s){if(xe(o))i||(i=new se),function(e,t,r,n,i,o,s){var a=I(e,r),c=I(t,r),u=s.get(c);if(u)return void ce(e,r,u);var l=o?o(a,c,r+"",e,t,s):void 0,h=void 0===l;if(h){var f=Ie(c),d=!f&&ke(c),g=!f&&!d&&De(c);l=c,f||d||g?Ie(a)?l=a:Be(_=a)&&Ne(_)?l=function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(a):d?(h=!1,l=function(e,t){if(t)return e.slice();var r=e.length,n=H?H(r):new e.constructor(r);return e.copy(n),n}(c,!0)):g?(h=!1,m=c,y=!0?(v=m.buffer,b=new v.constructor(v.byteLength),new K(b).set(new K(v)),b):m.buffer,l=new m.constructor(y,m.byteOffset,m.length)):l=[]:function(e){if(!Be(e)||de(e)!=p)return!1;var t=G(e);if(null===t)return!0;var r=L.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&P.call(r)==M}(c)||Ae(c)?(l=a,Ae(a)?l=function(e){return function(e,t,r,n){var i=!r;r||(r={});var o=-1,s=t.length;for(;++o<s;){var a=t[o],c=n?n(r[a],e[a],a,r,e):void 0;void 0===c&&(c=e[a]),i?he(r,a,c):ue(r,a,c)}return r}(e,Pe(e))}(a):(!xe(a)||n&&Re(a))&&(l=function(e){return"function"!=typeof e.constructor||we(e)?{}:re(G(e))}(c))):h=!1}var m,y,v,b;var _;h&&(s.set(c,l),i(l,c,n,o,s),s.delete(c));ce(e,r,l)}(e,t,s,r,ve,n,i);else{var a=n?n(I(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),ce(e,s,a)}},Pe)}function be(e,t){return Se(function(e,t,r){return t=X(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=X(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,a)}}(e,t,Ue),e+"")}function _e(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Ee(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return me(r)?r:void 0}function Ce(e,t){var r=typeof e;return!!(t=null==t?s:t)&&("number"==r||"symbol"!=r&&m.test(e))&&e>-1&&e%1==0&&e<t}function we(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||B)}var Se=function(e){var t=0,r=0;return function(){var n=Z(),s=o-(n-r);if(r=n,s>0){if(++t>=i)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}($?function(e,t){return $(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:Ue);function Te(e,t){return e===t||e!=e&&t!=t}var Ae=ge(function(){return arguments}())?ge:function(e){return Be(e)&&L.call(e,"callee")&&!W.call(e,"callee")},Ie=Array.isArray;function Ne(e){return null!=e&&Oe(e.length)&&!Re(e)}var ke=J||function(){return!1};function Re(e){if(!xe(e))return!1;var t=de(e);return t==u||t==l||t==c||t==f}function Oe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function xe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Be(e){return null!=e&&"object"==typeof e}var De=A?function(e){return function(t){return e(t)}}(A):function(e){return Be(e)&&Oe(e.length)&&!!y[de(e)]};function Pe(e){return Ne(e)?ae(e,!0):ye(e)}var Le,je=(Le=function(e,t,r){ve(e,t,r)},be(function(e,t){var r=-1,n=t.length,i=n>1?t[n-1]:void 0,o=n>2?t[2]:void 0;for(i=Le.length>3&&"function"==typeof i?(n--,i):void 0,o&&function(e,t,r){if(!xe(r))return!1;var n=typeof t;return!!("number"==n?Ne(r)&&Ce(t,r.length):"string"==n&&t in r)&&Te(r[t],e)}(t[0],t[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++r<n;){var s=t[r];s&&Le(e,s,r,i)}return e}));function Ue(e){return e}e.exports=je}).call(this,r(228)(e))},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(50),o=r(11),s="console.firebase.google.com",a=443,c="/v1/",u=1e4,l={400:"Malformed instance ID argument.",401:"Request not authorized.",403:"Project does not match instance ID or the client does not have sufficient privileges.",404:"Failed to find the instance ID.",409:"Already deleted.",429:"Request throttled out by the backend server.",500:"Internal server error.",503:"Backend servers are over capacity. Try again later."},h=function(){function e(e,t){this.host=s,this.port=a,this.timeout=u,this.httpClient=new i.AuthorizedHttpClient(e),this.path=c+"project/"+t+"/instanceId/"}return e.prototype.deleteInstanceId=function(e){return o.isNonEmptyString(e)?this.invokeRequestHandler(new i.ApiSettings(e,"DELETE")):Promise.reject(new n.FirebaseInstanceIdError(n.InstanceIdClientErrorCode.INVALID_INSTANCE_ID,"Instance ID must be a non-empty string."))},e.prototype.invokeRequestHandler=function(e){var t=this,r=this.path+e.getEndpoint();return Promise.resolve().then(function(){var n={url:"https://"+t.host+r,method:e.getHttpMethod(),timeout:t.timeout};return t.httpClient.send(n)}).then(function(e){return e.data}).catch(function(t){if(t instanceof i.HttpError){var r=t.response,o=r.isJson()&&"error"in r.data?r.data.error:r.text,s=l[r.status],a=s?'Instance ID "'+e.getEndpoint()+'": '+s:o;throw new n.FirebaseInstanceIdError(n.InstanceIdClientErrorCode.API_ERROR,a)}throw t})},e}();t.FirebaseInstanceIdRequestHandler=h},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(11),o=r(170),s=function(){function e(e,t){if(this.appId=e,this.requestHandler=t,!i.isNonEmptyString(e))throw new n.FirebaseProjectManagementError("invalid-argument","appId must be a non-empty string.")}return e.prototype.getMetadata=function(){return this.requestHandler.getAndroidMetadata(this.appId).then(function(e){o.assertServerResponse(i.isNonNullObject(e),e,"getMetadata()'s responseData must be a non-null object.");return["name","appId","projectId","packageName"].forEach(function(t){o.assertServerResponse(i.isNonEmptyString(e[t]),e,"getMetadata()'s responseData."+t+" must be a non-empty string.")}),{resourceName:e.name,appId:e.appId,displayName:e.displayName||null,projectId:e.projectId,packageName:e.packageName}})},e.prototype.setDisplayName=function(e){return this.requestHandler.setAndroidDisplayName(this.appId,e)},e.prototype.getShaCertificates=function(){return this.requestHandler.getAndroidShaCertificates(this.appId).then(function(e){if(o.assertServerResponse(i.isNonNullObject(e),e,"getShaCertificates()'s responseData must be a non-null object."),!e.certificates)return[];o.assertServerResponse(i.isArray(e.certificates),e,'"certificates" field must be present in the getShaCertificates() response data.');var t=["name","shaHash"];return e.certificates.map(function(r){return t.forEach(function(t){o.assertServerResponse(i.isNonEmptyString(r[t]),e,"getShaCertificates()'s responseData.certificates[]."+t+" must be a non-empty string.")}),new a(r.shaHash,r.name)})})},e.prototype.addShaCertificate=function(e){return this.requestHandler.addAndroidShaCertificate(this.appId,e)},e.prototype.deleteShaCertificate=function(e){return this.requestHandler.deleteAndroidShaCertificate(e)},e.prototype.getConfig=function(){return this.requestHandler.getAndroidConfig(this.appId).then(function(e){o.assertServerResponse(i.isNonNullObject(e),e,"getConfig()'s responseData must be a non-null object.");var t=e.configFileContents;return o.assertServerResponse(i.isBase64String(t),e,"getConfig()'s responseData.configFileContents must be a base64 string."),Buffer.from(t,"base64").toString("utf8")})},e}();t.AndroidApp=s;var a=function(){return function(e,t){if(this.shaHash=e,this.resourceName=t,/^[a-fA-F0-9]{40}$/.test(e))this.certType="sha1";else{if(!/^[a-fA-F0-9]{64}$/.test(e))throw new n.FirebaseProjectManagementError("invalid-argument","shaHash must be either a sha256 hash or a sha1 hash.");this.certType="sha256"}}}();t.ShaCertificate=a},function(e,t,r){"use strict";
/*! firebase-admin v6.3.0 */
/*!
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(11),o=r(170),s=function(){function e(e,t){if(this.appId=e,this.requestHandler=t,!i.isNonEmptyString(e))throw new n.FirebaseProjectManagementError("invalid-argument","appId must be a non-empty string.")}return e.prototype.getMetadata=function(){return this.requestHandler.getIosMetadata(this.appId).then(function(e){o.assertServerResponse(i.isNonNullObject(e),e,"getMetadata()'s responseData must be a non-null object.");return["name","appId","projectId","bundleId"].forEach(function(t){o.assertServerResponse(i.isNonEmptyString(e[t]),e,"getMetadata()'s responseData."+t+" must be a non-empty string.")}),{resourceName:e.name,appId:e.appId,displayName:e.displayName||null,projectId:e.projectId,bundleId:e.bundleId}})},e.prototype.setDisplayName=function(e){return this.requestHandler.setIosDisplayName(this.appId,e)},e.prototype.getConfig=function(){return this.requestHandler.getIosConfig(this.appId).then(function(e){o.assertServerResponse(i.isNonNullObject(e),e,"getConfig()'s responseData must be a non-null object.");var t=e.configFileContents;return o.assertServerResponse(i.isBase64String(t),e,"getConfig()'s responseData.configFileContents must be a base64 string."),Buffer.from(t,"base64").toString("utf8")})},e}();t.IosApp=s}]));